<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Martin Schweinberger">

<title>Power Analysis in R – Language Technology and Data Analysis Laboratory (LADAL)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script>
    // Wait for the document to be fully loaded
    document.addEventListener("DOMContentLoaded", function () {
        // Create a new div element to hold the dynamic content
        var newContainer = document.createElement("div");
        newContainer.classList.add("custom-banner");  // You can assign a class to the new container for styling

        // You can also add content inside the new container
        newContainer.innerHTML = `
          <div class="banner">
              <img src="images/ladal_icon_white.png" alt="Icon" class="banner-icon">
              <span class="banner-text">Language Technology and Data Analysis Laboratory</span>
          </div>
      `

        // Select the header element
        var header = document.getElementById("quarto-header");

        // Select the nav element inside the header to place the new container just above it
        var navbar = header.querySelector("nav");

        // Insert the new container before the navbar element
        header.insertBefore(newContainer, navbar);
    });
</script>
<script src="../../site_libs/clipboard-1.7.1/clipboard.min.js"></script>
<link href="../../site_libs/primer-tooltips-1.4.0/build.css" rel="stylesheet">
<link href="../../site_libs/klippy-0.0.0.9500/css/klippy.min.css" rel="stylesheet">
<script src="../../site_libs/klippy-0.0.0.9500/js/klippy.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../css/styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Language Technology and Data Analysis Laboratory (LADAL)</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">HOME</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">ABOUT</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../events.html"> 
<span class="menu-text">EVENTS</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials.html"> 
<span class="menu-text">TUTORIALS</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../tools.html"> 
<span class="menu-text">TOOLS</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../resources.html"> 
<span class="menu-text">RESOURCES</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../contact.html"> 
<span class="menu-text">CONTACT</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul class="collapse">
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#what-determines-if-you-find-an-effect" id="toc-what-determines-if-you-find-an-effect" class="nav-link" data-scroll-target="#what-determines-if-you-find-an-effect">What determines if you find an effect?</a></li>
  <li><a href="#sample-size" id="toc-sample-size" class="nav-link" data-scroll-target="#sample-size">Sample size</a></li>
  <li><a href="#variability" id="toc-variability" class="nav-link" data-scroll-target="#variability">Variability</a></li>
  <li><a href="#preparation-and-session-set-up" id="toc-preparation-and-session-set-up" class="nav-link" data-scroll-target="#preparation-and-session-set-up">Preparation and session set up</a></li>
  </ul></li>
  <li><a href="#basic-power-analysis" id="toc-basic-power-analysis" class="nav-link" data-scroll-target="#basic-power-analysis">Basic Power Analysis</a>
  <ul class="collapse">
  <li><a href="#one-way-anova" id="toc-one-way-anova" class="nav-link" data-scroll-target="#one-way-anova">One-way ANOVA</a></li>
  <li><a href="#power-analysis-for-glms" id="toc-power-analysis-for-glms" class="nav-link" data-scroll-target="#power-analysis-for-glms">Power Analysis for GLMs</a></li>
  <li><a href="#power-analysis-for-t-tests" id="toc-power-analysis-for-t-tests" class="nav-link" data-scroll-target="#power-analysis-for-t-tests">Power Analysis for t-tests</a></li>
  <li><a href="#power-analysis-for-chi2-tests" id="toc-power-analysis-for-chi2-tests" class="nav-link" data-scroll-target="#power-analysis-for-chi2-tests">Power Analysis for <span class="math inline">\(\chi\)</span><sup>2</sup>-tests</a></li>
  <li><a href="#excursion-language-is-never-ever-random" id="toc-excursion-language-is-never-ever-random" class="nav-link" data-scroll-target="#excursion-language-is-never-ever-random">Excursion: Language is never ever random</a></li>
  </ul></li>
  <li><a href="#advanced-power-analysis" id="toc-advanced-power-analysis" class="nav-link" data-scroll-target="#advanced-power-analysis">Advanced Power Analysis</a>
  <ul class="collapse">
  <li><a href="#using-piloted-data-and-a-lmer" id="toc-using-piloted-data-and-a-lmer" class="nav-link" data-scroll-target="#using-piloted-data-and-a-lmer">Using piloted data and a lmer</a></li>
  <li><a href="#extending-data" id="toc-extending-data" class="nav-link" data-scroll-target="#extending-data">Extending Data</a></li>
  <li><a href="#generating-data-and-a-glmer" id="toc-generating-data-and-a-glmer" class="nav-link" data-scroll-target="#generating-data-and-a-glmer">Generating data and a glmer</a></li>
  <li><a href="#extending-the-data" id="toc-extending-the-data" class="nav-link" data-scroll-target="#extending-the-data">Extending the data</a></li>
  <li><a href="#post-hoc-analyses" id="toc-post-hoc-analyses" class="nav-link" data-scroll-target="#post-hoc-analyses">Post-Hoc Analyses</a></li>
  </ul></li>
  <li><a href="#resources-and-links" id="toc-resources-and-links" class="nav-link" data-scroll-target="#resources-and-links">Resources and Links</a></li>
  <li><a href="#citation-session-info" id="toc-citation-session-info" class="nav-link" data-scroll-target="#citation-session-info">Citation &amp; Session Info</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Power Analysis in R</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Martin Schweinberger </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<p><img src="../../images/uq1.jpg" class="img-fluid" style="width:100.0%"></p>
<section id="introduction" class="level1 unnumbered">
<h1 class="unnumbered">Introduction</h1>
<p>This tutorial introduces power analysis using R. Power analysis is a method primarily used to determine the appropriate sample size for empirical studies.</p>
<p><img src="../../images/gy_chili.png" class="img-fluid" style="float:right; padding:10px;width:15.0%"></p>
<p>This tutorial is aimed at intermediate and advanced users of R with the aim of showcasing how to perform power analyses for basic inferential tests using the <code>pwr</code> package <span class="citation" data-cites="pwr">(<a href="#ref-pwr" role="doc-biblioref">Champely 2020</a>)</span> and for mixed-effect models (generated with the <code>lme4</code> package) using the <code>simr</code> package <span class="citation" data-cites="simr">(<a href="#ref-simr" role="doc-biblioref">Green and MacLeod 2016</a>)</span> in R. The aim is not to provide a fully-fledged analysis but rather to show and exemplify a handy method for estimating the power of experimental and observational designs and how to implement this in R.</p>
<p>A list of very recommendable papers discussing research on effect sizes and power analyses on linguistic data can be found <a href="http://crr.ugent.be/archives/2014">here</a>. Here are some main findings coming from these papers as stated in <span class="citation" data-cites="brysbaert2018power">Brysbaert and Stevens (<a href="#ref-brysbaert2018power" role="doc-biblioref">2018</a>)</span> and on the <a href="http://crr.ugent.be">http://crr.ugent.be</a> website:</p>
<ul>
<li><p>In experimental psychology we can do replicable research with 20 participants or less if we have multiple observations per participant per condition, because we can turn rather small differences between conditions into effect sizes of d &gt; .8 by averaging across observations.</p></li>
<li><p>The more sobering finding is that the required number of observations is higher than the numbers currently used (which is why we run underpowered studies). The ballpark figure we propose for RT experiments with repeated measures is 1600 observations per condition (e.g., 40 participants and 40 stimuli per condition).</p></li>
<li><p>The 1600 observations we propose is when you start a new line of research and don’t know what to expect.</p></li>
<li><p>Standardized effect sizes in analyses over participants (e.g., Cohen’s d) depend on the number of stimuli that were presented. Hence, you must include the same number of observations per condition if you want to replicate the results. The fact that the effect size depends on the number of stimuli also has implications for meta-analyses.</p></li>
</ul>
<div class="warning" style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
The entire R Notebook for the tutorial can be downloaded <a href="tutorials/pwr/pwr.qmd">here</a>. If you want to render the R Notebook on your machine, i.e.&nbsp;knitting the document to html or a pdf, you need to make sure that you have R and RStudio installed and you also need to download the <a href="../../assets/bibliography.bib"><strong>bibliography file</strong></a> and store it in the same folder where you store the Rmd file. <br>
</p>
<p style="margin-left:1em;">
</p>
<p></p>
</span></div>
<p><br></p>
<p>The basis for the present tutorial is <span class="citation" data-cites="green2016simr">Green and MacLeod</span> (which you can find <a href="https://besjournals.onlinelibrary.wiley.com/doi/full/10.1111/2041-210X.12504">here</a>). <span class="citation" data-cites="green2016simr">Green and MacLeod</span> is a highly recommendable and thorough tutorial on performing power analysis in R. Recommendable literature on this topic are, e.g. <span class="citation" data-cites="arnold2011simulation">Arnold et al.</span> and <span class="citation" data-cites="johnson2015power">Johnson et al.</span> and <a href="https://www.journalofcognition.org/articles/10.5334/joc.10/">this tutorial</a>.</p>
<section id="what-determines-if-you-find-an-effect" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="what-determines-if-you-find-an-effect">What determines if you find an effect?</h2>
<p>To explore this issue, let us have a look at some distributions of samples with varying features sampled from either one or two distributions.</p>
<p>Let us start with the distribution of two samples (N = 30) sampled from the same population.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="pwr_files/figure-html/displot1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The means of the samples are very similar and a t-test confirms that we can assume that the samples are drawn from the same population (as the p-value is greater than .05).</p>
<p>Let us now draw another two samples (N = 30) but from different populations where the effect of group is weak (the population difference is small).</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="pwr_files/figure-html/weak-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Let us briefly check if the effect size, Cohen’s <em>d</em> of 0.2, is correct (for this, we increase the sample size dramatically to get very accurate estimates). If the above effect size is correct (Cohen’s <em>d</em> = 0.2), then the reported effect size should be 0.2 (or -0.2). This is so because Cohen’s <em>d</em> represents distances between group means measured in standard deviations (in our example, the standard deviation is 10 and the difference between the means is 2, i.e., 20 percent of a standard deviation; which is equal to a Cohen’s <em>d</em> value of 0.2). Let’s check the effect size now (we will only do this for this distribution but you can easily check for yourself that the effect sizes provided in the plot headers below are correct by adapting the code chunk below and using the numbers provided in the plot headers).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate two vectors with numbers using the means and sd from above</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># means = 101, 99, sd = 10</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>num1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000000</span>, <span class="at">mean =</span> <span class="dv">101</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>num2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000000</span>, <span class="at">mean =</span> <span class="dv">99</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># perform t-test</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>tt <span class="ot">&lt;-</span> <span class="fu">t.test</span>(num1, num2, <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># extract effect size</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>effectsize<span class="sc">::</span><span class="fu">effectsize</span>(tt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cohen's d | 95% CI
------------------
0.20      |       

- Estimated using un-pooled SD.</code></pre>
</div>
</div>
<p>Based on the t-test results in the distribution plot, we assume that the data represents two samples from the same population (which is false) because the p-value is higher than .05. This means that the sample size is insufficient or <em>does not enough power</em> to show that they are actually from two different populations given the variability in the data nd the size of the effect (which is weak).</p>
<p>What happens if we increase the effect size to medium? This means that we again draw two samples from two different populations but the difference between the populations is a bit larger (group has a medium effect, Cohen’s <em>d</em> = .5)</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="pwr_files/figure-html/medium-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Now, lets have a look at at the distribution of two different groups (group has a strong effect, Cohen’s <em>d</em> = .8)</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="pwr_files/figure-html/strong-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Now, lets have a look at at the distribution of two different groups (group has a very strong effect, Cohen’s <em>d</em> = 1.2)</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="pwr_files/figure-html/vstrong-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>If variability and sample size remain constant, larger effects are easier to detect than smaller effects!</strong></p>
</section>
<section id="sample-size" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="sample-size">Sample size</h2>
<p>And let’s now look at sample size.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="pwr_files/figure-html/n30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Let us now increase the sample size to N = 50.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="pwr_files/figure-html/n50-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>If variability and effect size remain constant, effects are easier to detect with increasing sample size!</strong></p>
</section>
<section id="variability" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="variability">Variability</h2>
<p>And let’s now look at variability.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="pwr_files/figure-html/sd10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Let’s decrease the variability to sd = 5.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="pwr_files/figure-html/sd5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>If the sample and effect size remain constant, effects are easier to detect with decreasing variability!</strong></p>
<p><strong>In summary</strong>, there are three main factors that determine if a model finds an effect. The accuracy (i.e., the probability of finding an effect):</p>
<ul>
<li>the size of the effect (bigger effects are easier to detect)</li>
<li>the variability of the effect (less variability makes it easier to detect an effect), and</li>
<li>the sample size (the bigger the sample size, the easier it is to detect an effect);
<ul>
<li>number of subjects/participants</li>
<li>number of items/questions</li>
<li>number of observations per item within subjects/participants</li>
</ul></li>
</ul>
<p>Now, if a) we dealing with a very big effect, then we need only few participants and few items to accurately find this effect.</p>
<p>Or b) if we dealing with an effect that has low variability (it is observable for all subjects with the same strength), then we need only few participants and few items to accurately find this effect.</p>
<p>Before we conduct a study, we should figure out, what sample we need to detect a small/medium effect with medium variability so that our model is sufficient to detect this kind of effect. In order to do this, we would generate a data set that mirrors the kind of data that we expect to get (with the properties that we expect to get). We can then fit a model to this data and check if a model would be able to detect the expected effect. However, because a single model does not tell us that much (it could simply be luck that it happened to find the effect), we run many different models on variations of the data and see how many of them find the effect. As a general rule of thumb, we want a data set that allows a model to find a medium sized effect with at least an accuracy of 80 percent <span class="citation" data-cites="field2007making">(<a href="#ref-field2007making" role="doc-biblioref">Field et al.</a>)</span>.</p>
<p>In the following, we will go through how to determine what sample size we need for an example analysis.</p>
</section>
<section id="preparation-and-session-set-up" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="preparation-and-session-set-up">Preparation and session set up</h2>
<p>This tutorial is based on R. If you have not installed R or are new to it, you will find an introduction to and more information how to use R <a href="tutorials/intror/intror.html">here</a>. For this tutorials, we need to install certain <em>packages</em> into the R <em>library</em> on your computer so that the scripts shown below are executed without errors. Before turning to the code below, please install the packages by running the code below this paragraph. If you have already installed the packages mentioned below, then you can skip ahead and ignore this section. To install the necessary packages, simply run the following code - it may take some time (between 1 and 5 minutes to install all of the libraries so you do not need to worry if it takes some time).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install libraries</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">"tidyverse"</span>, <span class="st">"pwr"</span>, <span class="st">"lme4"</span>, <span class="st">"sjPlot"</span>, <span class="st">"simr"</span>, <span class="st">"effectsize"</span>))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">"DT"</span>, <span class="st">"knitr"</span>, <span class="st">"flextable"</span>))</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"DescTools"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># install klippy for copy-to-clipboard button in code chunks</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"remotes"</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"rlesur/klippy"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now that we have installed the packages, we can activate them as shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set options</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">stringsAsFactors =</span> F) <span class="co"># no automatic conversion of factors</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">"scipen"</span> <span class="ot">=</span> <span class="dv">100</span>, <span class="st">"digits"</span> <span class="ot">=</span> <span class="dv">4</span>) <span class="co"># suppress math annotation</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">max.print =</span> <span class="dv">1000</span>) <span class="co"># print max 1000 results</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pwr)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(simr)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effectsize)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load_gh</span>(<span class="st">"trinker/entity"</span>)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="co"># activate klippy for copy-to-clipboard button</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>klippy<span class="sc">::</span><span class="fu">klippy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<script>
  addClassKlippyTo("pre.r, pre.markdown");
  addKlippy('left', 'top', 'auto', '1', 'Copy code', 'Copied!');
</script>
</div>
</div>
<p>Once you have installed R and RStudio and initiated the session by executing the code shown above, you are good to go.</p>
</section>
</section>
<section id="basic-power-analysis" class="level1 unnumbered">
<h1 class="unnumbered">Basic Power Analysis</h1>
<p>Let’s start with a simple power analysis to see how power analyses work for simpler or basic statistical tests such as t-test, <span class="math inline">\(\chi\)</span><sup>2</sup>-test, or linear regression.</p>
<p>The <code>pwr</code> package <span class="citation" data-cites="pwr">(<a href="#ref-pwr" role="doc-biblioref">Champely 2020</a>)</span> implements power analysis as outlined by <span class="citation" data-cites="cohen1988statistical">Cohen</span> and allows to perform power analyses for the following tests (selection):</p>
<ul>
<li><p>balanced one way ANOVA (<code>pwr.anova.test</code>)</p></li>
<li><p>chi-square test (<code>pwr.chisq.test</code>)</p></li>
<li><p>Correlation (<code>pwr.r.test</code>)</p></li>
<li><p>general linear model (<code>pwr.f2.test</code>)</p></li>
<li><p>paired (one and two sample) t-test (<code>pwr.t.test</code>)</p></li>
<li><p>two sample t-test with unequal N (<code>pwr.t2n.test</code>)</p></li>
</ul>
<p>For each of these functions, you enter three of the four parameters (effect size, sample size, significance level, power) and the fourth is calculated.</p>
<p>So how does this work? Have a look at the code chunk below.</p>
<section id="one-way-anova" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="one-way-anova">One-way ANOVA</h2>
<p>Let check how to calculate the necessary sample size for each group for a one-way ANOVA that compares 5 groups (<code>k</code>) and that has a power of 0.80 (80 percent), when the effect size is moderate (<em>f</em> = 0.25) and the significance level is 0.05 (5 percent)..</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load package</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pwr)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate minimal sample size</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.anova.test</span>(</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">k =</span> <span class="dv">5</span>, <span class="co"># 5 groups are compared</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">f =</span> .<span class="dv">25</span>, <span class="co"># moderate effect size</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> .<span class="dv">05</span>, <span class="co"># alpha/sig. level = .05</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">power =</span> .<span class="dv">8</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>) <span class="co"># confint./power = .8</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Balanced one-way analysis of variance power calculation 

              k = 5
              n = 39.15
              f = 0.25
      sig.level = 0.05
          power = 0.8

NOTE: n is number in each group</code></pre>
</div>
</div>
<p>In this case, the minimum number of participants in each group would be 40.</p>
<p>Let’s check how we could calculate the power if we had already collected data (with 30 participants in each group) and we want to report the power of our analysis (and let us assume that the effect size was medium).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate minimal sample size</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.anova.test</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">k =</span> <span class="dv">5</span>, <span class="co"># 5 groups are compared</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">f =</span> .<span class="dv">25</span>, <span class="co"># moderate effect size</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> .<span class="dv">05</span>, <span class="co"># alpha/sig. level = .05</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">30</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>) <span class="co"># n of participants</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Balanced one-way analysis of variance power calculation 

              k = 5
              n = 30
              f = 0.25
      sig.level = 0.05
          power = 0.6676

NOTE: n is number in each group</code></pre>
</div>
</div>
<p>In this case our analysis would only have a power or 66.8 percent. This means that we would only detect a medium sized effect in 66.7 percent of cases (which is considered insufficient).</p>
</section>
<section id="power-analysis-for-glms" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="power-analysis-for-glms">Power Analysis for GLMs</h2>
<p>When determining the power of a generalized linear model, we need to provide</p>
<ul>
<li><p>the degrees of freedom for numerator (´u´)</p></li>
<li><p>the degrees of freedom for denominator (<code>v</code>)</p></li>
<li><p>the effect size (the estimate of the intercept and the slope/estimates of the predictors)</p></li>
<li><p>the level of significance (i.e., the type I error probability)</p></li>
</ul>
<p>The values of the parameters in the example below are adapted from the fixed-effects regression example that was used to analyze different teaching styles (see <a href="tutorials/regression/regression.html#Example_2:_Teaching_Styles">here</a>).</p>
<p>The effect size used here is <span class="math inline">\(f^2^\)</span> that has be categorized as follows <span class="citation" data-cites="cohen1988statistical">(see <a href="#ref-cohen1988statistical" role="doc-biblioref">Cohen</a>)</span>: small <span class="math inline">\(≥\)</span> 0.02, medium <span class="math inline">\(≥\)</span> 0.15, and large <span class="math inline">\(≥\)</span> 0.35. So in order to determine if the data is sufficient to find a weak effect when comparing 2 groups with 30 participants in both groups (df_numerator_: 2-1; df_denominator_: (30-1) + (30-1)) and a significance level at <span class="math inline">\(\alpha\)</span> = .05, we can use the following code.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># general linear model</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>pwrglm <span class="ot">&lt;-</span> <span class="fu">pwr.f2.test</span>(</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">u =</span> <span class="dv">1</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">v =</span> <span class="dv">58</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">f2 =</span> .<span class="dv">02</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> <span class="fl">0.05</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect results</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>pwrglm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Multiple regression power calculation 

              u = 1
              v = 58
             f2 = 0.02
      sig.level = 0.05
          power = 0.1899</code></pre>
</div>
</div>
<p>The results show that the regression analyses used to evaluate the effectiveness of different teaching styles only had a power of 0.1899206.</p>
</section>
<section id="power-analysis-for-t-tests" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="power-analysis-for-t-tests">Power Analysis for t-tests</h2>
<p>For t-tests (both paired and 2-sample t-tests), the effect size measure is Cohen’s <span class="math inline">\(d\)</span> that has be categorized as follows <span class="citation" data-cites="cohen1988statistical">(see <a href="#ref-cohen1988statistical" role="doc-biblioref">Cohen</a>)</span>: small <span class="math inline">\(≥\)</span> 0.2, medium <span class="math inline">\(≥\)</span> 0.5, and large <span class="math inline">\(≥\)</span> 0.8.</p>
<p><strong>Paired t-test</strong></p>
<p>So in order to determine if the data is sufficient to find a weak effect when comparing the pre- and post-test results of a group with 30 participants, evaluating an undirected hypothesis (thus the <em>two-tailed</em> approach), and a significance level at <span class="math inline">\(\alpha\)</span> = .05, we can use the following code.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># paired t-test</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>pwrpt <span class="ot">&lt;-</span> <span class="fu">pwr.t.test</span>(</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">d =</span> <span class="fl">0.2</span>,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">30</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> <span class="fl">0.05</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"paired"</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">"two.sided"</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>pwrpt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Paired t test power calculation 

              n = 30
              d = 0.2
      sig.level = 0.05
          power = 0.1852
    alternative = two.sided

NOTE: n is number of *pairs*</code></pre>
</div>
</div>
<p>Given the data, a weak effect in this design can only be detected with a certainty of 0.1851834 percent. This means that we would need to substantively increase the sample size to detect a small effect with this design.</p>
<p><strong>Two-sample (independent) t-test</strong></p>
<p>The power in a similar scenario but with two different groups (with 25 and 35 subjects) can be determined as follows (in this case we test a directed hypothesis that checks if the intervention leads to an increase in the outcome - hence the <em>greater</em> in the <code>alternative</code> argument):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># independent t-test</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>pwr2t <span class="ot">&lt;-</span> <span class="fu">pwr.t2n.test</span>(</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">d =</span> <span class="fl">0.2</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">n1 =</span> <span class="dv">35</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">n2 =</span> <span class="dv">25</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> <span class="fl">0.05</span>,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">"greater"</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>pwr2t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     t test power calculation 

             n1 = 35
             n2 = 25
              d = 0.2
      sig.level = 0.05
          power = 0.1867
    alternative = greater</code></pre>
</div>
</div>
<p>Given the data, a weak effect in this design can only be detected with a certainty of 0.1867382 percent. This means that we would need to substantively increase the sample size to detect a small effect with this design.</p>
</section>
<section id="power-analysis-for-chi2-tests" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="power-analysis-for-chi2-tests">Power Analysis for <span class="math inline">\(\chi\)</span><sup>2</sup>-tests</h2>
<p>Let us now check the power of a <span class="math inline">\(\chi^2\)</span>^-test. For <span class="math inline">\(\chi^2\)</span>^-test, the effect size measure used in the power analysis is <span class="math inline">\(w\)</span> that has be categorized as follows <span class="citation" data-cites="cohen1988statistical">(see <a href="#ref-cohen1988statistical" role="doc-biblioref">Cohen</a>)</span>: small <span class="math inline">\(≥\)</span> 0.1, medium <span class="math inline">\(≥\)</span> 0.3, and large <span class="math inline">\(≥\)</span> 0.5. Also, keep in mind that for <span class="math inline">\(\chi^2\)</span>^-tests, at least 80 percent of cells need to have values <span class="math inline">\(≥\)</span> 5 and none of the cells should have expected values smaller than 1 <span class="citation" data-cites="bortz109verteilungsfreie">(see <a href="#ref-bortz109verteilungsfreie" role="doc-biblioref">Bortz, Lienert, and Boehnke</a>)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># x2-test</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>pwrx2 <span class="ot">&lt;-</span> <span class="fu">pwr.chisq.test</span>(</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">w =</span> <span class="fl">0.2</span>,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">N =</span> <span class="dv">25</span>, <span class="co"># total number of observations</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">df =</span> <span class="dv">1</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> <span class="fl">0.05</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>pwrx2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Chi squared power calculation 

              w = 0.2
              N = 25
             df = 1
      sig.level = 0.05
          power = 0.1701

NOTE: N is the number of observations</code></pre>
</div>
</div>
<p>Given the data, a weak effect in this design can only be detected with a certainty of 0.170075 percent. This means that we would need to substantively increase the sample size to detect a small effect with this design.</p>
<hr>
<div class="warning" style="padding:0.1em; background-color:#51247a; color:#f2f2f2">
<span>
<p style="margin-top:1em; text-align:center">
<b>EXERCISE TIME!</b>
</p>
<p style="margin-left:1em;">
</p>
<p></p>
</span></div>
<div class="question">
<p>`</p>
<ol type="1">
<li>For the tests above (anova, glm, paired and independent t-test, and the <span class="math inline">\(\chi^2\)</span>-test), how many participants would you need to have a power of 80 percent?<br></li>
</ol>
<p>Here are the commands we used to help you:<br></p>
<ul>
<li><p>ANOVA: <code>pwr.anova.test(k=5, f=.25, sig.level=.05, n=30)</code></p></li>
<li><p>GLM: <code>pwr.f2.test(u = 1, v = 58, f2 = .02, sig.level = 0.05)</code></p></li>
<li><p>paired t-test: <code>pwr.t.test(d=0.2, n=30, sig.level=0.05, type="paired", alternative="two.sided")</code></p></li>
<li><p>independent t-test: <code>pwr.t2n.test(d=0.2,n1=35, n2 = 25, sig.level=0.05, alternative="greater")</code></p></li>
<li><p><span class="math inline">\(\chi^2\)</span>-test: <code>pwr.chisq.test(w=0.2, N = 25,  df = 1, sig.level=0.05)</code> <br></p>
<details>
<summary>
<p>Answer</p>
</summary></details></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.anova.test</span>(<span class="at">k =</span> <span class="dv">5</span>, <span class="at">f =</span> .<span class="dv">25</span>, <span class="at">sig.level =</span> .<span class="dv">05</span>, <span class="at">p =</span> .<span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Balanced one-way analysis of variance power calculation 

              k = 5
              n = 39.1534
              f = 0.25
      sig.level = 0.05
          power = 0.8

NOTE: n is number in each group</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.f2.test</span>(<span class="at">u =</span> <span class="dv">1</span>, <span class="at">f2 =</span> .<span class="dv">02</span>, <span class="at">sig.level =</span> <span class="fl">0.05</span>, <span class="at">p =</span> .<span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Multiple regression power calculation 

              u = 1
              v = 392.373
             f2 = 0.02
      sig.level = 0.05
          power = 0.8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.t.test</span>(<span class="at">d =</span> <span class="fl">0.2</span>, <span class="at">p =</span> .<span class="dv">8</span>, <span class="at">sig.level =</span> <span class="fl">0.05</span>, <span class="at">type =</span> <span class="st">"paired"</span>, <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Paired t test power calculation 

              n = 198.1508
              d = 0.2
      sig.level = 0.05
          power = 0.8
    alternative = two.sided

NOTE: n is number of *pairs*</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.t2n.test</span>(<span class="at">d =</span> <span class="fl">0.2</span>, <span class="at">n1 =</span> <span class="dv">310</span>, <span class="at">n2 =</span> <span class="dv">310</span>, <span class="at">sig.level =</span> <span class="fl">0.05</span>, <span class="at">alternative =</span> <span class="st">"greater"</span>) <span class="co"># by checking N values</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     t test power calculation 

             n1 = 310
             n2 = 310
              d = 0.2
      sig.level = 0.05
          power = 0.8002178
    alternative = greater</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.chisq.test</span>(<span class="at">w =</span> <span class="fl">0.2</span>, <span class="at">p =</span> .<span class="dv">8</span>, <span class="at">df =</span> <span class="dv">1</span>, <span class="at">sig.level =</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Chi squared power calculation 

              w = 0.2
              N = 196.2215
             df = 1
      sig.level = 0.05
          power = 0.8

NOTE: N is the number of observations</code></pre>
</div>
</div>

</div>
<hr>
</section>
<section id="excursion-language-is-never-ever-random" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="excursion-language-is-never-ever-random">Excursion: Language is never ever random</h2>
<p>In 2005, Adam <span class="citation" data-cites="kilgarriff2005language">Kilgarriff (<a href="#ref-kilgarriff2005language" role="doc-biblioref">2005</a>)</span> made a point that <em>Language is never, ever, ever, random</em>. Here is part of the abstract:</p>
<blockquote class="blockquote">
<p>Language users never choose words randomly, and language is essentially non-random. Statistical hypothesis testing uses a null hypothesis, which posits randomness. Hence, when we look at linguistic phenomena in corpora, the null hypothesis will never be true. Moreover, where there is enough data, we shall (almost) always be able to establish that it is not true. In corpus studies, we frequently do have enough data, so the fact that a relation between two phenomena is demonstrably non-random, does not support the inference that it is not arbitrary. We present experimental evidence of how arbitrary associations between word frequencies and corpora are systematically non-random.</p>
</blockquote>
<p>This is a problem because if we are using ever bigger corpora, even the tiniest of difference will become significant. have a look at the following example.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># first let us generate some data</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>freqs1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">28</span>, <span class="dv">30</span>, <span class="dv">92</span>), <span class="at">byrow =</span> T, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect data</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>freqs1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]   10   28
[2,]   30   92</code></pre>
</div>
</div>
<p>Now, we perform a simple <span class="math inline">\(\chi^2\)</span>-test and extract the effect size.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># x2-test</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>x21 <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(freqs1)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect results</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>x21</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test with Yates' continuity correction

data:  freqs1
X-squared = 0, df = 1, p-value = 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># effect size</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>effectsize<span class="sc">::</span><span class="fu">effectsize</span>(x21)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cramer's V (adj.) |       95% CI
--------------------------------
0.00              | [0.00, 1.00]

- One-sided CIs: upper bound fixed at [1.00].</code></pre>
</div>
</div>
<p>the output shows that the difference is not significant and that the effect size is extremely(!) small.</p>
<p>Now, let us simply increase the sample size by a factor of 1000 and also perform a <span class="math inline">\(\chi^2\)</span>-test on this extended data set and extract the effect size.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>freqs2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">10000</span>, <span class="dv">28000</span>, <span class="dv">30000</span>, <span class="dv">92000</span>), <span class="at">byrow =</span> T, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co"># first let us generate some data</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>x22 <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(freqs2)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect results</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>x22</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test with Yates' continuity correction

data:  freqs2
X-squared = 46, df = 1, p-value = 0.00000000001</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># effect size</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>effectsize<span class="sc">::</span><span class="fu">effectsize</span>(x22)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cramer's V (adj.) |       95% CI
--------------------------------
0.02              | [0.01, 1.00]

- One-sided CIs: upper bound fixed at [1.00].</code></pre>
</div>
</div>
<p>The output shows that the difference is not significant but that the effect size has remain the same. For this reason, in a response to Kilgariff, Stefan <span class="citation" data-cites="gries2005kilgariff">(<a href="#ref-gries2005kilgariff" role="doc-biblioref">Gries 2005</a>)</span> suggested to always also report effect size in addition to significance so that the reader has an understanding of whether a significant effect is meaningful.</p>
<p>This is relevant here because we have focused on the power for finding small effects as these can be considered the smallest <em>meaningful</em> effects. However, even tiny effects can be meaningful under certain circumstances - as such, focusing on small effects is only a rule of thumb, should be taken with a pinch of salt, and should be re-evaluated in the context of the study at hand.</p>
</section>
</section>
<section id="advanced-power-analysis" class="level1 unnumbered">
<h1 class="unnumbered">Advanced Power Analysis</h1>
<p>In this section, we will perform power analyses for mixed-effects models (both linear and generalized linear mixed models). The basis for this section is <span class="citation" data-cites="green2016simr">Green and MacLeod</span> (which you can find <a href="https://besjournals.onlinelibrary.wiley.com/doi/full/10.1111/2041-210X.12504">here</a>). <span class="citation" data-cites="green2016simr">Green and MacLeod</span> is a highly recommendable and thorough tutorial on performing power analysis in R. Recommendable literature on this topic are, e.g. <span class="citation" data-cites="arnold2011simulation">Arnold et al.</span> and <span class="citation" data-cites="johnson2015power">Johnson et al.</span> and <a href="https://www.journalofcognition.org/articles/10.5334/joc.10/">this tutorial</a>.</p>
<p>Before we conduct a study, we should figure out, what sample we need to detect a small/medium effect with medium variability so that our model is sufficient to detect this kind of effect. In order to do this, we would generate a data set that mirrors the kind of data that we expect to get (with the properties that we expect to get). We can then fit a model to this data and check if a model would be able to detect the expected effect. However, because a single model does not tell us that much (it could simply be luck that it happened to find the effect), we run many different models on variations of the data and see how many of them find the effect. As a general rule of thumb, we want a data set that allows a model to find a medium sized effect with at least an accuracy of 80 percent <span class="citation" data-cites="field2007making">(<a href="#ref-field2007making" role="doc-biblioref">Field et al.</a>)</span>.</p>
<p>In the following, we will go through how to determine what sample size we need for an example analysis.</p>
<section id="using-piloted-data-and-a-lmer" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="using-piloted-data-and-a-lmer">Using piloted data and a lmer</h2>
<p>For this analysis, we load an existing data set resulting from a piloted study that only contains the predictors (not the response variable).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>regdat <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="st">"tutorials/pwr/data/regdat.rda"</span>, <span class="st">"rb"</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(regdat, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       ID   Sentence     Group WordOrder SentenceType
1  Part01 Sentence01 L1English        V2  NoAdverbial
2  Part01 Sentence02 L1English        V3  NoAdverbial
3  Part01 Sentence03 L1English        V3  NoAdverbial
4  Part01 Sentence04 L1English        V2  NoAdverbial
5  Part01 Sentence05 L1English        V2  NoAdverbial
6  Part01 Sentence06 L1English        V3  NoAdverbial
7  Part01 Sentence07 L1English        V2  NoAdverbial
8  Part01 Sentence08 L1English        V3  NoAdverbial
9  Part01 Sentence09 L1English        V3  NoAdverbial
10 Part01 Sentence10 L1English        V2  NoAdverbial</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(regdat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   480 obs. of  5 variables:
 $ ID          : Factor w/ 20 levels "Part01","Part02",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ Sentence    : Factor w/ 24 levels "Sentence01","Sentence02",..: 1 2 3 4 5 6 7 8 9 10 ...
 $ Group       : Factor w/ 2 levels "L1English","L2English": 1 1 1 1 1 1 1 1 1 1 ...
 $ WordOrder   : Factor w/ 2 levels "V2","V3": 1 2 2 1 1 2 1 2 2 1 ...
 $ SentenceType: Factor w/ 2 levels "NoAdverbial",..: 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
</div>
</div>
<p>We inspect the data and check how many levels we have for each predictor and if the levels are distributed correctly (so that we do not have incomplete information).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(regdat<span class="sc">$</span>Group, regdat<span class="sc">$</span>WordOrder)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           
             V2  V3
  L1English 120 120
  L2English 120 120</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(regdat<span class="sc">$</span>Group, regdat<span class="sc">$</span>SentenceType)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           
            NoAdverbial SentenceAdverbial
  L1English         120               120
  L2English         120               120</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(regdat<span class="sc">$</span>ID)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Part01 Part02 Part03 Part04 Part05 Part06 Part07 Part08 Part09 Part10 Part11 
    24     24     24     24     24     24     24     24     24     24     24 
Part12 Part13 Part14 Part15 Part16 Part17 Part18 Part19 Part20 
    24     24     24     24     24     24     24     24     24 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(regdat<span class="sc">$</span>Sentence)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Sentence01 Sentence02 Sentence03 Sentence04 Sentence05 Sentence06 Sentence07 
        20         20         20         20         20         20         20 
Sentence08 Sentence09 Sentence10 Sentence11 Sentence12 Sentence13 Sentence14 
        20         20         20         20         20         20         20 
Sentence15 Sentence16 Sentence17 Sentence18 Sentence19 Sentence20 Sentence21 
        20         20         20         20         20         20         20 
Sentence22 Sentence23 Sentence24 
        20         20         20 </code></pre>
</div>
</div>
<p>We could also add a response variable (but we will do this later when we deal with post-hoc power analyses).</p>
<section id="generating-the-model" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="generating-the-model">Generating the model</h3>
<p>We now generate model that has per-defined parameters. We begin by specifying the parameters by setting effect sizes of the fixed effects and the intercept, the variability accounted fro by the random effects and the residuals.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Intercept + slopes for fixed effects</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (Intercept + Group, SentenceType, WordOrder, and an interaction between Group * SentenceType)</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>fixed <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">52</span>, .<span class="dv">52</span>, .<span class="dv">52</span>, .<span class="dv">52</span>, .<span class="dv">52</span>)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Random intercepts for Sentence and ID</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>rand <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fl">0.5</span>, <span class="fl">0.1</span>)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="co"># res. variance</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We now generate the model and fit it to our data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">makeLmer</span>(y <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> Sentence) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID) <span class="sc">+</span> Group <span class="sc">*</span> SentenceType <span class="sc">+</span> WordOrder,</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">fixef =</span> fixed,</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">VarCorr =</span> rand,</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigma =</span> res,</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> regdat</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>m1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: y ~ (1 | Sentence) + (1 | ID) + Group * SentenceType + WordOrder
   Data: regdat
REML criterion at convergence: 2100
Random effects:
 Groups   Name        Std.Dev.
 Sentence (Intercept) 0.707   
 ID       (Intercept) 0.316   
 Residual             2.000   
Number of obs: 480, groups:  Sentence, 24; ID, 20
Fixed Effects:
                                 (Intercept)  
                                        0.52  
                              GroupL2English  
                                        0.52  
               SentenceTypeSentenceAdverbial  
                                        0.52  
                                 WordOrderV3  
                                        0.52  
GroupL2English:SentenceTypeSentenceAdverbial  
                                        0.52  </code></pre>
</div>
</div>
<p>Inspect summary table</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">y</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.52</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.14&nbsp;–&nbsp;1.18</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.124</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Group [L2English]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.52</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.06&nbsp;–&nbsp;1.10</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.078</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">SentenceType<br>[SentenceAdverbial]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.52</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.24&nbsp;–&nbsp;1.28</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.180</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">WordOrder [V3]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.52</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.15&nbsp;–&nbsp;1.19</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.129</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Group [L2English] ×<br>SentenceType<br>[SentenceAdverbial]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.52</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-0.20&nbsp;–&nbsp;1.24</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.155</td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">4.00</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>Sentence</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.50</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>ID</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.10</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.13</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>Sentence</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">24</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>ID</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">20</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">480</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.078 / 0.198</td>
</tr>

</tbody></table>

</div>
</div>
<p><strong>The summary table shows that the effects are correct but none of them are reported as being significant!</strong></p>
</section>
<section id="power-analysis" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="power-analysis">Power analysis</h3>
<p>Let us now check if the data is sufficient to detect the main effect of <code>WordOrder</code>. In the <code>test</code> argument we use <code>fcompare</code> which allows us to compare a model with that effect (our <em>m1</em> model) to a model without that effect. Fortunately, we only need to specify the fixed effects structure.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>sim_wo <span class="ot">&lt;-</span> simr<span class="sc">::</span><span class="fu">powerSim</span>(m1,</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsim =</span> <span class="dv">20</span>,</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">test =</span> <span class="fu">fcompare</span>(y <span class="sc">~</span> Group <span class="sc">*</span> SentenceType)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simulating: |                                                                  |Simulating: |===                                                               |Simulating: |======                                                            |Simulating: |=========                                                         |Simulating: |=============                                                     |Simulating: |================                                                  |Simulating: |===================                                               |Simulating: |=======================                                           |Simulating: |==========================                                        |Simulating: |=============================                                     |Simulating: |=================================                                 |Simulating: |====================================                              |Simulating: |=======================================                           |Simulating: |==========================================                        |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Simulating: |==============================================                    |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Simulating: |=================================================                 |Simulating: |====================================================              |Simulating: |========================================================          |Simulating: |===========================================================       |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Simulating: |==============================================================    |Simulating: |==================================================================|</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect results</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>sim_wo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Power for model comparison, (95% confidence interval):
      35.00% (15.39, 59.22)

Test: Likelihood ratio
      Comparison to y ~ Group * SentenceType + [re]

Based on 20 simulations, (0 warnings, 0 errors)
alpha = 0.05, nrow = 480

Time elapsed: 0 h 0 m 1 s</code></pre>
</div>
</div>
<p><em>The data is not sufficient and would only detect a weak effect of <code>WordOrder</code> with 7 percent accuracy!</em></p>
<p>Before we continue to see how to test the power of data to find interactions, let us briefly think about why I chose 0.52 when we specified the effect sizes.</p>
</section>
<section id="why-did-i-set-the-estimates-to-0.52" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="why-did-i-set-the-estimates-to-0.52">Why did I set the estimates to 0.52?</h3>
<p>Let us now inspect the effect sizes and see why I used 0.52 as an effect size in the model. We need to determine the odds ratios of the fixed effects and then convert them into Cohen’s <em>d</em> values for which we have associations between traditional denominations (small, medium, and large) and effect size values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract fixed effect estimates</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>estimatesfixedeffects <span class="ot">&lt;-</span> <span class="fu">fixef</span>(m1)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="co"># convert estimates into odds ratios</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(estimatesfixedeffects)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                 (Intercept) 
                                       1.682 
                              GroupL2English 
                                       1.682 
               SentenceTypeSentenceAdverbial 
                                       1.682 
                                 WordOrderV3 
                                       1.682 
GroupL2English:SentenceTypeSentenceAdverbial 
                                       1.682 </code></pre>
</div>
</div>
<p>We will now check the effect size which can be interpreted according to <span class="citation" data-cites="chen2010big cohen1988statistical perugini2018practical">Chen, Cohen, and Chen (see also <a href="#ref-cohen1988statistical" role="doc-biblioref">Cohen</a>; <a href="#ref-perugini2018practical" role="doc-biblioref">Perugini, Gallucci, and Costantini, 2</a>)</span>.</p>
<ul>
<li><p>small effect (Cohen’s d 0.2, OR = 1.68)</p></li>
<li><p>medium effect (Cohen’s d 0.5, OR = 3.47)</p></li>
<li><p>strong effect (Cohen’s d 0.8, OR = 6.71)</p></li>
</ul>
</section>
<section id="power-analysis-for-interactions" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="power-analysis-for-interactions">Power analysis for interactions</h3>
<p>Let us now check if the data set has enough power to detect a weak effect for the interaction between <code>Group:SentenceType</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>sim_gst <span class="ot">&lt;-</span> simr<span class="sc">::</span><span class="fu">powerSim</span>(m1,</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsim =</span> <span class="dv">20</span>,</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># compare model with interaction to model without interaction</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">test =</span> <span class="fu">fcompare</span>(y <span class="sc">~</span> WordOrder <span class="sc">+</span> Group <span class="sc">+</span> SentenceType)</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simulating: |                                                                  |Simulating: |===                                                               |Simulating: |======                                                            |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Simulating: |=========                                                         |Simulating: |=============                                                     |Simulating: |================                                                  |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Simulating: |===================                                               |Simulating: |=======================                                           |Simulating: |==========================                                        |Simulating: |=============================                                     |Simulating: |=================================                                 |Simulating: |====================================                              |Simulating: |=======================================                           |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Simulating: |==========================================                        |Simulating: |==============================================                    |Simulating: |=================================================                 |Simulating: |====================================================              |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Simulating: |========================================================          |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Simulating: |===========================================================       |Simulating: |==============================================================    |Simulating: |==================================================================|</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>sim_gst</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Power for model comparison, (95% confidence interval):
      25.00% ( 8.66, 49.10)

Test: Likelihood ratio
      Comparison to y ~ WordOrder + Group + SentenceType + [re]

Based on 20 simulations, (0 warnings, 0 errors)
alpha = 0.05, nrow = 480

Time elapsed: 0 h 0 m 1 s</code></pre>
</div>
</div>
<p><strong>The data is not sufficient to detect a weak effect of <code>Group:SentenceType</code> with 5 percent accuracy!</strong></p>
<hr>
<div class="warning" style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
<b>NOTE</b><br>Oh no… What can we do?
</p>
<p style="margin-left:1em;">
</p>
<p></p>
</span></div>
<hr>
</section>
</section>
<section id="extending-data" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="extending-data">Extending Data</h2>
<p>We will now extend the data to see what sample size is needed to get to the 80 percent accuracy threshold. We begin by increasing the number of sentences from 10 to 30 to see if this would lead to a sufficient sample size. After increasing the number of sentences, we will extend the data to see how many participants we would need.</p>
<section id="adding-sentences" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="adding-sentences">Adding sentences</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>m1_as <span class="ot">&lt;-</span> simr<span class="sc">::</span><span class="fu">extend</span>(m1,</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">along =</span> <span class="st">"Sentence"</span>,</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">120</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect model</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>m1_as</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: y ~ (1 | Sentence) + (1 | ID) + Group * SentenceType + WordOrder
   Data: regdat
REML criterion at convergence: 2100
Random effects:
 Groups   Name        Std.Dev.
 Sentence (Intercept) 0.707   
 ID       (Intercept) 0.316   
 Residual             2.000   
Number of obs: 480, groups:  Sentence, 24; ID, 20
Fixed Effects:
                                 (Intercept)  
                                        0.52  
                              GroupL2English  
                                        0.52  
               SentenceTypeSentenceAdverbial  
                                        0.52  
                                 WordOrderV3  
                                        0.52  
GroupL2English:SentenceTypeSentenceAdverbial  
                                        0.52  </code></pre>
</div>
</div>
<p>Check power when using 120 sentences</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>sim_m1_as_gst <span class="ot">&lt;-</span> <span class="fu">powerSim</span>(m1_as,</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsim =</span> <span class="dv">20</span>,</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">test =</span> <span class="fu">fcompare</span>(y <span class="sc">~</span> WordOrder <span class="sc">+</span> Group <span class="sc">+</span> SentenceType)</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simulating: |                                                                  |Simulating: |===                                                               |Simulating: |======                                                            |Simulating: |=========                                                         |Simulating: |=============                                                     |Simulating: |================                                                  |Simulating: |===================                                               |Simulating: |=======================                                           |Simulating: |==========================                                        |Simulating: |=============================                                     |Simulating: |=================================                                 |Simulating: |====================================                              |Simulating: |=======================================                           |Simulating: |==========================================                        |Simulating: |==============================================                    |Simulating: |=================================================                 |Simulating: |====================================================              |Simulating: |========================================================          |Simulating: |===========================================================       |Simulating: |==============================================================    |Simulating: |==================================================================|</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>sim_m1_as_gst</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Power for model comparison, (95% confidence interval):
      90.00% (68.30, 98.77)

Test: Likelihood ratio
      Comparison to y ~ WordOrder + Group + SentenceType + [re]

Based on 20 simulations, (0 warnings, 0 errors)
alpha = 0.05, nrow = 2400

Time elapsed: 0 h 0 m 2 s</code></pre>
</div>
</div>
<p><strong>The data with 120 sentences is sufficient and would detect a weak effect of <code>Group:SentenceType</code> with 18 percent accuracy!</strong></p>
<p>Let us now plot a power curve to see where we cross the 80 percent threshold.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>pcurve_m1_as_gst <span class="ot">&lt;-</span> simr<span class="sc">::</span><span class="fu">powerCurve</span>(m1_as,</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">test =</span> <span class="fu">fcompare</span>(y <span class="sc">~</span> WordOrder <span class="sc">+</span> Group <span class="sc">+</span> SentenceType),</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">along =</span> <span class="st">"Sentence"</span>,</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsim =</span> <span class="dv">20</span>,</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">20</span>, <span class="dv">120</span>, <span class="dv">20</span>)</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a><span class="co"># show plot</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pcurve_m1_as_gst)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="pwr_files/figure-html/ext04-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Using more items (or in this case sentences) is rather easy but it can make experiments longer which may lead to participants becoming tired or annoyed. An alternative would be to use more participants. Let us thus check how we can determine how many subjects we would need to reach a power of at least 80 percent.</p>
</section>
<section id="checking-participants" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="checking-participants">Checking participants</h3>
<p>What about increasing the number of participants?</p>
<p>We increase the number of participants to 120.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>m1_ap <span class="ot">&lt;-</span> simr<span class="sc">::</span><span class="fu">extend</span>(m1,</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">along =</span> <span class="st">"ID"</span>,</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">120</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect model</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>m1_ap</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: y ~ (1 | Sentence) + (1 | ID) + Group * SentenceType + WordOrder
   Data: regdat
REML criterion at convergence: 2100
Random effects:
 Groups   Name        Std.Dev.
 Sentence (Intercept) 0.707   
 ID       (Intercept) 0.316   
 Residual             2.000   
Number of obs: 480, groups:  Sentence, 24; ID, 20
Fixed Effects:
                                 (Intercept)  
                                        0.52  
                              GroupL2English  
                                        0.52  
               SentenceTypeSentenceAdverbial  
                                        0.52  
                                 WordOrderV3  
                                        0.52  
GroupL2English:SentenceTypeSentenceAdverbial  
                                        0.52  </code></pre>
</div>
</div>
<p>Check power when using 120 participants</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>sim_m1_ap_gst <span class="ot">&lt;-</span> <span class="fu">powerSim</span>(m1_ap,</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsim =</span> <span class="dv">20</span>,</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">test =</span> <span class="fu">fcompare</span>(y <span class="sc">~</span> WordOrder <span class="sc">+</span> Group <span class="sc">+</span> SentenceType)</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simulating: |                                                                  |Simulating: |===                                                               |Simulating: |======                                                            |Simulating: |=========                                                         |Simulating: |=============                                                     |Simulating: |================                                                  |Simulating: |===================                                               |Simulating: |=======================                                           |Simulating: |==========================                                        |Simulating: |=============================                                     |Simulating: |=================================                                 |Simulating: |====================================                              |Simulating: |=======================================                           |Simulating: |==========================================                        |Simulating: |==============================================                    |Simulating: |=================================================                 |Simulating: |====================================================              |Simulating: |========================================================          |Simulating: |===========================================================       |Simulating: |==============================================================    |Simulating: |==================================================================|</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>sim_m1_ap_gst</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Power for model comparison, (95% confidence interval):
      80.00% (56.34, 94.27)

Test: Likelihood ratio
      Comparison to y ~ WordOrder + Group + SentenceType + [re]

Based on 20 simulations, (0 warnings, 0 errors)
alpha = 0.05, nrow = 2880

Time elapsed: 0 h 0 m 2 s</code></pre>
</div>
</div>
<p><strong>The data with 120 participants is sufficient and would detect a weak effect of <code>Group * SentenceType</code> with 16 percent accuracy</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>pcurve_m1_ap_gst <span class="ot">&lt;-</span> simr<span class="sc">::</span><span class="fu">powerCurve</span>(m1_ap,</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">test =</span> <span class="fu">fcompare</span>(y <span class="sc">~</span> Group <span class="sc">+</span> SentenceType <span class="sc">+</span> WordOrder),</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">along =</span> <span class="st">"ID"</span>,</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsim =</span> <span class="dv">20</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating power at 10 sample sizes along ID</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')
boundary (singular) fit: see help('isSingular')
boundary (singular) fit: see help('isSingular')
boundary (singular) fit: see help('isSingular')
boundary (singular) fit: see help('isSingular')
boundary (singular) fit: see help('isSingular')
boundary (singular) fit: see help('isSingular')
boundary (singular) fit: see help('isSingular')
boundary (singular) fit: see help('isSingular')
boundary (singular) fit: see help('isSingular')
boundary (singular) fit: see help('isSingular')
boundary (singular) fit: see help('isSingular')
boundary (singular) fit: see help('isSingular')
boundary (singular) fit: see help('isSingular')
boundary (singular) fit: see help('isSingular')
boundary (singular) fit: see help('isSingular')
boundary (singular) fit: see help('isSingular')
boundary (singular) fit: see help('isSingular')
boundary (singular) fit: see help('isSingular')
boundary (singular) fit: see help('isSingular')
boundary (singular) fit: see help('isSingular')
boundary (singular) fit: see help('isSingular')
boundary (singular) fit: see help('isSingular')
boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show plot</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pcurve_m1_ap_gst)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="pwr_files/figure-html/ext17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="generating-data-and-a-glmer" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="generating-data-and-a-glmer">Generating data and a glmer</h2>
<p>In order to perform a power analysis, we will start by loading the tidyverse package to process the data and by generating a data that we will use to determine the power of a regression model.</p>
<p>This simulated data set has</p>
<ul>
<li>200 data points</li>
<li>2 Conditions (Control, Test)</li>
<li>10 Subjects</li>
<li>10 Items</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate data</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>simdat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>  sub <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">"Sub"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>), <span class="at">each =</span> <span class="dv">20</span>),</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>  cond <span class="ot">&lt;-</span> <span class="fu">rep</span>(</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">"Control"</span>, <span class="dv">10</span>),</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">"Test"</span>, <span class="dv">10</span>)</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>    <span class="dv">10</span></span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>  itm <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">20</span>))</span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(</span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">Subject =</span> <span class="dv">1</span>,</span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">Condition =</span> <span class="dv">2</span>,</span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">Item =</span> <span class="dv">3</span></span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_if</span>(is.character, factor)</span>
<span id="cb88-19"><a href="#cb88-19" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb88-20"><a href="#cb88-20" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(simdat, <span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Subject Condition Item
1     Sub1   Control    1
2     Sub1   Control    2
3     Sub1   Control    3
4     Sub1   Control    4
5     Sub1   Control    5
6     Sub1   Control    6
7     Sub1   Control    7
8     Sub1   Control    8
9     Sub1   Control    9
10    Sub1   Control   10
11    Sub1      Test    1
12    Sub1      Test    2
13    Sub1      Test    3
14    Sub1      Test    4
15    Sub1      Test    5</code></pre>
</div>
</div>
<hr>
<div class="warning" style="padding:0.1em; background-color:#51247a; color:#f2f2f2">
<span>
<p style="margin-top:1em; text-align:center">
<b>EXERCISE TIME!</b>
</p>
<p style="margin-left:1em;">
</p>
<p></p>
</span></div>
<div class="question">
<p>`</p>
<ol type="1">
<li>Can you create a data set with 5 Subjects, 5 Items (each) for 4 Conditions? <br></li>
</ol>
<details>
<summary>
Answer
</summary>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   Subjects Items  Condition
1  Subject1 Item1 Condition1
2  Subject1 Item2 Condition1
3  Subject1 Item3 Condition1
4  Subject1 Item4 Condition1
5  Subject1 Item5 Condition1
6  Subject1 Item1 Condition2
7  Subject1 Item2 Condition2
8  Subject1 Item3 Condition2
9  Subject1 Item4 Condition2
10 Subject1 Item5 Condition2
11 Subject1 Item1 Condition3
12 Subject1 Item2 Condition3
13 Subject1 Item3 Condition3
14 Subject1 Item4 Condition3
15 Subject1 Item5 Condition3
16 Subject1 Item1 Condition4
17 Subject1 Item2 Condition4
18 Subject1 Item3 Condition4
19 Subject1 Item4 Condition4
20 Subject1 Item5 Condition4</code></pre>
</div>
</div>
</details>
</div>
<hr>
<section id="generating-the-model-1" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="generating-the-model-1">Generating the model</h3>
<p>As before with the lmer, we specify the model parameters - but when generating glmers, we only need to specify the effects for the fixed effects and the intercept and define the variability in the random effects (we do not need to specify the residuals).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Intercept + slopes for fixed effects</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (Group, SentenceType, WordOrder, and an interaction between Group * SentenceType)</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>fixed <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">52</span>, .<span class="dv">52</span>)</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Random intercepts for Sentence and ID</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>rand <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fl">0.5</span>, <span class="fl">0.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We now generate the model and fit it to the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> simr<span class="sc">::</span><span class="fu">makeGlmer</span>(y <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> Subject) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Item) <span class="sc">+</span> Condition,</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"binomial"</span>,</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">fixef =</span> fixed,</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">VarCorr =</span> rand,</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> simdat</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">y</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Odds Ratios</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.68</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.89&nbsp;–&nbsp;3.17</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.108</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Condition [Test]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.68</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.94&nbsp;–&nbsp;3.02</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.081</td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">3.29</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>Subject</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.50</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>Item</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.10</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.15</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>Subject</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">10</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>Item</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">10</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">200</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.017 / 0.169</td>
</tr>

</tbody></table>

</div>
</div>
<p>Next, we extract power. In this case, we use <code>fixed</code> in the <code>test</code> argument which allows us to test a specific predictor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed for replicability</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="co"># perform power analysis for present model</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>rsim_m2_c <span class="ot">&lt;-</span> <span class="fu">powerSim</span>(m2, <span class="fu">fixed</span>(<span class="st">"ConditionTest"</span>, <span class="st">"z"</span>),</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsim =</span> <span class="dv">20</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simulating: |                                                                  |Simulating: |===                                                               |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Simulating: |======                                                            |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Simulating: |=========                                                         |Simulating: |=============                                                     |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Simulating: |================                                                  |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Simulating: |===================                                               |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Simulating: |=======================                                           |Simulating: |==========================                                        |Simulating: |=============================                                     |Simulating: |=================================                                 |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Simulating: |====================================                              |Simulating: |=======================================                           |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Simulating: |==========================================                        |Simulating: |==============================================                    |Simulating: |=================================================                 |Simulating: |====================================================              |Simulating: |========================================================          |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Simulating: |===========================================================       |Simulating: |==============================================================    |Simulating: |==================================================================|</code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>rsim_m2_c</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Power for predictor 'ConditionTest', (95% confidence interval):
      35.00% (15.39, 59.22)

Test: z-test
      Effect size for ConditionTest is 0.52

Based on 20 simulations, (0 warnings, 0 errors)
alpha = 0.05, nrow = 200

Time elapsed: 0 h 0 m 1 s</code></pre>
</div>
</div>
<p><strong>The data is sufficient and would detect a weak effect of <code>ConditionTest</code> with only 7 percent accuracy</strong></p>
</section>
</section>
<section id="extending-the-data" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="extending-the-data">Extending the data</h2>
<p>Like before, we can now extend the data to see how many participants or items we would need to reach the 80 percent confidence threshold.</p>
<section id="adding-items" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="adding-items">Adding Items</h3>
<p>We start of by increasing the number of items from 10 to 40. This means that our <em>new</em> data/model has the following characteristics.</p>
<ul>
<li><p>2 Conditions</p></li>
<li><p>10 Subjects</p></li>
<li><p>40 Items (from 10)</p></li>
</ul>
<p>Keep in mind though that when extending the data/model in this way, each combination occurs only once!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>m2_ai <span class="ot">&lt;-</span> simr<span class="sc">::</span><span class="fu">extend</span>(m2,</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">along =</span> <span class="st">"Item"</span>,</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">40</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we plot the power curve.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>pcurve_m2_ai_c <span class="ot">&lt;-</span> <span class="fu">powerCurve</span>(m2_ai,</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fixed</span>(<span class="st">"ConditionTest"</span>, <span class="st">"z"</span>),</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">along =</span> <span class="st">"Item"</span>,</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsim =</span> <span class="dv">20</span>,</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">40</span>, <span class="dv">5</span>)</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating power at 7 sample sizes along Item</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Simulating: |                                                                  |Simulating: |===                                                               |Simulating: |======                                                            |Simulating: |=========                                                         |Simulating: |=============                                                     |Simulating: |================                                                  |Simulating: |===================                                               |Simulating: |=======================                                           |Simulating: |==========================                                        |Simulating: |=============================                                     |Simulating: |=================================                                 |Simulating: |====================================                              |Simulating: |=======================================                           |Simulating: |==========================================                        |Simulating: |==============================================                    |Simulating: |=================================================                 |Simulating: |====================================================              |Simulating: |========================================================          |Simulating: |===========================================================       |Simulating: |==============================================================    |Simulating: |==================================================================|(1/7) (1/7) Simulating: |                                                            |(1/7) Simulating: |===                                                         |(1/7) Simulating: |======                                                      |(1/7) Simulating: |=========                                                   |(1/7) Simulating: |============                                                |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(1/7) Simulating: |===============                                             |(1/7) Simulating: |==================                                          |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(1/7) Simulating: |=====================                                       |(1/7) Simulating: |========================                                    |(1/7) Simulating: |===========================                                 |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(1/7) Simulating: |==============================                              |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(1/7) Simulating: |=================================                           |(1/7) Simulating: |====================================                        |(1/7) Simulating: |=======================================                     |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(1/7) Simulating: |==========================================                  |(1/7) Simulating: |=============================================               |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(1/7) Simulating: |================================================            |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(1/7) Simulating: |===================================================         |(1/7) Simulating: |======================================================      |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(1/7) Simulating: |=========================================================   |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(1/7) Simulating: |============================================================|(1/7) (2/7) (2/7) Simulating: |                                                            |(2/7) Simulating: |===                                                         |(2/7) Simulating: |======                                                      |(2/7) Simulating: |=========                                                   |(2/7) Simulating: |============                                                |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(2/7) Simulating: |===============                                             |(2/7) Simulating: |==================                                          |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(2/7) Simulating: |=====================                                       |(2/7) Simulating: |========================                                    |(2/7) Simulating: |===========================                                 |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(2/7) Simulating: |==============================                              |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(2/7) Simulating: |=================================                           |(2/7) Simulating: |====================================                        |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(2/7) Simulating: |=======================================                     |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(2/7) Simulating: |==========================================                  |(2/7) Simulating: |=============================================               |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(2/7) Simulating: |================================================            |(2/7) Simulating: |===================================================         |(2/7) Simulating: |======================================================      |(2/7) Simulating: |=========================================================   |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(2/7) Simulating: |============================================================|(2/7) (3/7) (3/7) Simulating: |                                                            |(3/7) Simulating: |===                                                         |(3/7) Simulating: |======                                                      |(3/7) Simulating: |=========                                                   |(3/7) Simulating: |============                                                |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(3/7) Simulating: |===============                                             |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(3/7) Simulating: |==================                                          |(3/7) Simulating: |=====================                                       |(3/7) Simulating: |========================                                    |(3/7) Simulating: |===========================                                 |(3/7) Simulating: |==============================                              |(3/7) Simulating: |=================================                           |(3/7) Simulating: |====================================                        |(3/7) Simulating: |=======================================                     |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(3/7) Simulating: |==========================================                  |(3/7) Simulating: |=============================================               |(3/7) Simulating: |================================================            |(3/7) Simulating: |===================================================         |(3/7) Simulating: |======================================================      |(3/7) Simulating: |=========================================================   |(3/7) Simulating: |============================================================|(3/7) (4/7) (4/7) Simulating: |                                                            |(4/7) Simulating: |===                                                         |(4/7) Simulating: |======                                                      |(4/7) Simulating: |=========                                                   |(4/7) Simulating: |============                                                |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(4/7) Simulating: |===============                                             |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(4/7) Simulating: |==================                                          |(4/7) Simulating: |=====================                                       |(4/7) Simulating: |========================                                    |(4/7) Simulating: |===========================                                 |(4/7) Simulating: |==============================                              |(4/7) Simulating: |=================================                           |(4/7) Simulating: |====================================                        |(4/7) Simulating: |=======================================                     |(4/7) Simulating: |==========================================                  |(4/7) Simulating: |=============================================               |(4/7) Simulating: |================================================            |(4/7) Simulating: |===================================================         |(4/7) Simulating: |======================================================      |(4/7) Simulating: |=========================================================   |(4/7) Simulating: |============================================================|(4/7) (5/7) (5/7) Simulating: |                                                            |(5/7) Simulating: |===                                                         |(5/7) Simulating: |======                                                      |(5/7) Simulating: |=========                                                   |(5/7) Simulating: |============                                                |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(5/7) Simulating: |===============                                             |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(5/7) Simulating: |==================                                          |(5/7) Simulating: |=====================                                       |(5/7) Simulating: |========================                                    |(5/7) Simulating: |===========================                                 |(5/7) Simulating: |==============================                              |(5/7) Simulating: |=================================                           |(5/7) Simulating: |====================================                        |(5/7) Simulating: |=======================================                     |(5/7) Simulating: |==========================================                  |(5/7) Simulating: |=============================================               |(5/7) Simulating: |================================================            |(5/7) Simulating: |===================================================         |(5/7) Simulating: |======================================================      |(5/7) Simulating: |=========================================================   |(5/7) Simulating: |============================================================|(5/7) (6/7) (6/7) Simulating: |                                                            |(6/7) Simulating: |===                                                         |(6/7) Simulating: |======                                                      |(6/7) Simulating: |=========                                                   |(6/7) Simulating: |============                                                |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(6/7) Simulating: |===============                                             |(6/7) Simulating: |==================                                          |(6/7) Simulating: |=====================                                       |(6/7) Simulating: |========================                                    |(6/7) Simulating: |===========================                                 |(6/7) Simulating: |==============================                              |(6/7) Simulating: |=================================                           |(6/7) Simulating: |====================================                        |(6/7) Simulating: |=======================================                     |(6/7) Simulating: |==========================================                  |(6/7) Simulating: |=============================================               |(6/7) Simulating: |================================================            |(6/7) Simulating: |===================================================         |(6/7) Simulating: |======================================================      |(6/7) Simulating: |=========================================================   |(6/7) Simulating: |============================================================|(6/7) (7/7) (7/7) Simulating: |                                                            |(7/7) Simulating: |===                                                         |(7/7) Simulating: |======                                                      |(7/7) Simulating: |=========                                                   |(7/7) Simulating: |============                                                |(7/7) Simulating: |===============                                             |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(7/7) Simulating: |==================                                          |(7/7) Simulating: |=====================                                       |(7/7) Simulating: |========================                                    |(7/7) Simulating: |===========================                                 |(7/7) Simulating: |==============================                              |(7/7) Simulating: |=================================                           |(7/7) Simulating: |====================================                        |(7/7) Simulating: |=======================================                     |(7/7) Simulating: |==========================================                  |(7/7) Simulating: |=============================================               |(7/7) Simulating: |================================================            |(7/7) Simulating: |===================================================         |(7/7) Simulating: |======================================================      |(7/7) Simulating: |=========================================================   |(7/7) Simulating: |============================================================|(7/7) </code></pre>
</div>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show plot</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pcurve_m2_ai_c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="pwr_files/figure-html/glmer08-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The power curve shows that we breach the 80 percent threshold with about 35 items.</p>
</section>
<section id="adding-subjects" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="adding-subjects">Adding subjects</h3>
<p>An alternative to adding items is, of course, to use more subjects or participants. We thus continue by increasing the number of participants from 10 to 40. This means that our <em>new</em> data/model has the following characteristics.</p>
<ul>
<li><p>2 Conditions</p></li>
<li><p>10 Items</p></li>
<li><p>40 Subjects (from 10)</p></li>
</ul>
<p>Again, keep in mind though that when extending the data/model in this way, each combination occurs only once!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>m2_as <span class="ot">&lt;-</span> simr<span class="sc">::</span><span class="fu">extend</span>(m2,</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">along =</span> <span class="st">"Subject"</span>,</span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">40</span></span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect model</span></span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(m2_as)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">y</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Odds Ratios</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.68</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.89&nbsp;–&nbsp;3.17</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.108</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Condition [Test]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.68</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.94&nbsp;–&nbsp;3.02</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.081</td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">3.29</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>Subject</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.50</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>Item</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.10</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.15</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>Subject</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">10</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>Item</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">10</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">200</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.017 / 0.169</td>
</tr>

</tbody></table>

</div>
</div>
<p>As before, we plot power curve.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>pcurve_m2_as_c <span class="ot">&lt;-</span> <span class="fu">powerCurve</span>(m2_as,</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fixed</span>(<span class="st">"ConditionTest"</span>, <span class="st">"z"</span>),</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">along =</span> <span class="st">"Subject"</span>,</span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsim =</span> <span class="dv">20</span>,</span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">40</span>, <span class="dv">5</span>)</span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating power at 7 sample sizes along Subject</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Simulating: |                                                                  |Simulating: |===                                                               |Simulating: |======                                                            |Simulating: |=========                                                         |Simulating: |=============                                                     |Simulating: |================                                                  |Simulating: |===================                                               |Simulating: |=======================                                           |Simulating: |==========================                                        |Simulating: |=============================                                     |Simulating: |=================================                                 |Simulating: |====================================                              |Simulating: |=======================================                           |Simulating: |==========================================                        |Simulating: |==============================================                    |Simulating: |=================================================                 |Simulating: |====================================================              |Simulating: |========================================================          |Simulating: |===========================================================       |Simulating: |==============================================================    |Simulating: |==================================================================|(1/7) (1/7) Simulating: |                                                            |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(1/7) Simulating: |===                                                         |(1/7) Simulating: |======                                                      |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(1/7) Simulating: |=========                                                   |(1/7) Simulating: |============                                                |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(1/7) Simulating: |===============                                             |(1/7) Simulating: |==================                                          |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(1/7) Simulating: |=====================                                       |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(1/7) Simulating: |========================                                    |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(1/7) Simulating: |===========================                                 |(1/7) Simulating: |==============================                              |(1/7) Simulating: |=================================                           |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(1/7) Simulating: |====================================                        |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(1/7) Simulating: |=======================================                     |(1/7) Simulating: |==========================================                  |(1/7) Simulating: |=============================================               |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(1/7) Simulating: |================================================            |(1/7) Simulating: |===================================================         |(1/7) Simulating: |======================================================      |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(1/7) Simulating: |=========================================================   |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(1/7) Simulating: |============================================================|(1/7) (2/7) (2/7) Simulating: |                                                            |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(2/7) Simulating: |===                                                         |(2/7) Simulating: |======                                                      |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(2/7) Simulating: |=========                                                   |(2/7) Simulating: |============                                                |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(2/7) Simulating: |===============                                             |(2/7) Simulating: |==================                                          |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(2/7) Simulating: |=====================                                       |(2/7) Simulating: |========================                                    |(2/7) Simulating: |===========================                                 |(2/7) Simulating: |==============================                              |(2/7) Simulating: |=================================                           |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(2/7) Simulating: |====================================                        |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(2/7) Simulating: |=======================================                     |(2/7) Simulating: |==========================================                  |(2/7) Simulating: |=============================================               |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(2/7) Simulating: |================================================            |(2/7) Simulating: |===================================================         |(2/7) Simulating: |======================================================      |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(2/7) Simulating: |=========================================================   |(2/7) Simulating: |============================================================|(2/7) (3/7) (3/7) Simulating: |                                                            |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(3/7) Simulating: |===                                                         |(3/7) Simulating: |======                                                      |(3/7) Simulating: |=========                                                   |(3/7) Simulating: |============                                                |(3/7) Simulating: |===============                                             |(3/7) Simulating: |==================                                          |(3/7) Simulating: |=====================                                       |(3/7) Simulating: |========================                                    |(3/7) Simulating: |===========================                                 |(3/7) Simulating: |==============================                              |(3/7) Simulating: |=================================                           |(3/7) Simulating: |====================================                        |(3/7) Simulating: |=======================================                     |(3/7) Simulating: |==========================================                  |(3/7) Simulating: |=============================================               |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(3/7) Simulating: |================================================            |(3/7) Simulating: |===================================================         |(3/7) Simulating: |======================================================      |(3/7) Simulating: |=========================================================   |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(3/7) Simulating: |============================================================|(3/7) (4/7) (4/7) Simulating: |                                                            |(4/7) Simulating: |===                                                         |(4/7) Simulating: |======                                                      |(4/7) Simulating: |=========                                                   |(4/7) Simulating: |============                                                |(4/7) Simulating: |===============                                             |(4/7) Simulating: |==================                                          |(4/7) Simulating: |=====================                                       |(4/7) Simulating: |========================                                    |(4/7) Simulating: |===========================                                 |(4/7) Simulating: |==============================                              |(4/7) Simulating: |=================================                           |(4/7) Simulating: |====================================                        |(4/7) Simulating: |=======================================                     |(4/7) Simulating: |==========================================                  |(4/7) Simulating: |=============================================               |(4/7) Simulating: |================================================            |(4/7) Simulating: |===================================================         |(4/7) Simulating: |======================================================      |(4/7) Simulating: |=========================================================   |(4/7) Simulating: |============================================================|(4/7) (5/7) (5/7) Simulating: |                                                            |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(5/7) Simulating: |===                                                         |(5/7) Simulating: |======                                                      |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(5/7) Simulating: |=========                                                   |(5/7) Simulating: |============                                                |(5/7) Simulating: |===============                                             |(5/7) Simulating: |==================                                          |(5/7) Simulating: |=====================                                       |(5/7) Simulating: |========================                                    |(5/7) Simulating: |===========================                                 |(5/7) Simulating: |==============================                              |(5/7) Simulating: |=================================                           |(5/7) Simulating: |====================================                        |(5/7) Simulating: |=======================================                     |(5/7) Simulating: |==========================================                  |(5/7) Simulating: |=============================================               |(5/7) Simulating: |================================================            |(5/7) Simulating: |===================================================         |(5/7) Simulating: |======================================================      |(5/7) Simulating: |=========================================================   |(5/7) Simulating: |============================================================|(5/7) (6/7) (6/7) Simulating: |                                                            |(6/7) Simulating: |===                                                         |(6/7) Simulating: |======                                                      |(6/7) Simulating: |=========                                                   |(6/7) Simulating: |============                                                |(6/7) Simulating: |===============                                             |(6/7) Simulating: |==================                                          |(6/7) Simulating: |=====================                                       |(6/7) Simulating: |========================                                    |(6/7) Simulating: |===========================                                 |(6/7) Simulating: |==============================                              |(6/7) Simulating: |=================================                           |(6/7) Simulating: |====================================                        |(6/7) Simulating: |=======================================                     |(6/7) Simulating: |==========================================                  |(6/7) Simulating: |=============================================               |(6/7) Simulating: |================================================            |(6/7) Simulating: |===================================================         |(6/7) Simulating: |======================================================      |(6/7) Simulating: |=========================================================   |(6/7) Simulating: |============================================================|(6/7) (7/7) (7/7) Simulating: |                                                            |(7/7) Simulating: |===                                                         |(7/7) Simulating: |======                                                      |(7/7) Simulating: |=========                                                   |(7/7) Simulating: |============                                                |(7/7) Simulating: |===============                                             |(7/7) Simulating: |==================                                          |(7/7) Simulating: |=====================                                       |(7/7) Simulating: |========================                                    |(7/7) Simulating: |===========================                                 |(7/7) Simulating: |==============================                              |(7/7) Simulating: |=================================                           |(7/7) Simulating: |====================================                        |(7/7) Simulating: |=======================================                     |(7/7) Simulating: |==========================================                  |(7/7) Simulating: |=============================================               |(7/7) Simulating: |================================================            |(7/7) Simulating: |===================================================         |(7/7) Simulating: |======================================================      |(7/7) Simulating: |=========================================================   |(7/7) Simulating: |============================================================|(7/7) </code></pre>
</div>
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show plot</span></span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pcurve_m2_as_c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="pwr_files/figure-html/glmer12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>How often does each <em>combination</em> occur?</p>
<p><strong>Only once!</strong></p>
<p>So, what if we increase the number of combinations (this is particularly important when using a *repeated measures** design)? Below, we increase the number of <em>configuration</em> from 1 to 10 so that each item is shown 10 times to the same participant. This means that our <em>new</em> data/model has the following characteristics.</p>
<ul>
<li><p>2 Conditions</p></li>
<li><p>10 Items</p></li>
<li><p>10 Subjects</p></li>
</ul>
<p>Now each combination of item and subject occurs 10 times!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a>m2_asi_c <span class="ot">&lt;-</span> <span class="fu">extend</span>(m2,</span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">within =</span> <span class="st">"Subject+Item"</span>,</span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">10</span></span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb215-5"><a href="#cb215-5" aria-hidden="true" tabindex="-1"></a><span class="co"># perform power calculation</span></span>
<span id="cb215-6"><a href="#cb215-6" aria-hidden="true" tabindex="-1"></a>pcurve_m2_asi_c <span class="ot">&lt;-</span> <span class="fu">powerCurve</span>(m2_asi_c,</span>
<span id="cb215-7"><a href="#cb215-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fixed</span>(<span class="st">"ConditionTest"</span>, <span class="st">"z"</span>),</span>
<span id="cb215-8"><a href="#cb215-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">within =</span> <span class="st">"Subject+Item"</span>,</span>
<span id="cb215-9"><a href="#cb215-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsim =</span> <span class="dv">20</span>,</span>
<span id="cb215-10"><a href="#cb215-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="dv">10</span>, <span class="dv">2</span>)</span>
<span id="cb215-11"><a href="#cb215-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating power at 5 sample sizes within Subject+Item</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Simulating: |                                                                  |Simulating: |===                                                               |Simulating: |======                                                            |Simulating: |=========                                                         |Simulating: |=============                                                     |Simulating: |================                                                  |Simulating: |===================                                               |Simulating: |=======================                                           |Simulating: |==========================                                        |Simulating: |=============================                                     |Simulating: |=================================                                 |Simulating: |====================================                              |Simulating: |=======================================                           |Simulating: |==========================================                        |Simulating: |==============================================                    |Simulating: |=================================================                 |Simulating: |====================================================              |Simulating: |========================================================          |Simulating: |===========================================================       |Simulating: |==============================================================    |Simulating: |==================================================================|(1/5) (1/5) Simulating: |                                                            |(1/5) Simulating: |===                                                         |(1/5) Simulating: |======                                                      |(1/5) Simulating: |=========                                                   |(1/5) Simulating: |============                                                |(1/5) Simulating: |===============                                             |(1/5) Simulating: |==================                                          |(1/5) Simulating: |=====================                                       |(1/5) Simulating: |========================                                    |(1/5) Simulating: |===========================                                 |(1/5) Simulating: |==============================                              |(1/5) Simulating: |=================================                           |(1/5) Simulating: |====================================                        |(1/5) Simulating: |=======================================                     |(1/5) Simulating: |==========================================                  |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(1/5) Simulating: |=============================================               |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(1/5) Simulating: |================================================            |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(1/5) Simulating: |===================================================         |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(1/5) Simulating: |======================================================      |(1/5) Simulating: |=========================================================   |(1/5) Simulating: |============================================================|(1/5) (2/5) (2/5) Simulating: |                                                            |(2/5) Simulating: |===                                                         |(2/5) Simulating: |======                                                      |(2/5) Simulating: |=========                                                   |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(2/5) Simulating: |============                                                |(2/5) Simulating: |===============                                             |(2/5) Simulating: |==================                                          |(2/5) Simulating: |=====================                                       |(2/5) Simulating: |========================                                    |(2/5) Simulating: |===========================                                 |(2/5) Simulating: |==============================                              |(2/5) Simulating: |=================================                           |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(2/5) Simulating: |====================================                        |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(2/5) Simulating: |=======================================                     |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(2/5) Simulating: |==========================================                  |(2/5) Simulating: |=============================================               |(2/5) Simulating: |================================================            |(2/5) Simulating: |===================================================         |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(2/5) Simulating: |======================================================      |(2/5) Simulating: |=========================================================   |(2/5) Simulating: |============================================================|(2/5) (3/5) (3/5) Simulating: |                                                            |(3/5) Simulating: |===                                                         |(3/5) Simulating: |======                                                      |(3/5) Simulating: |=========                                                   |(3/5) Simulating: |============                                                |(3/5) Simulating: |===============                                             |(3/5) Simulating: |==================                                          |(3/5) Simulating: |=====================                                       |(3/5) Simulating: |========================                                    |(3/5) Simulating: |===========================                                 |(3/5) Simulating: |==============================                              |(3/5) Simulating: |=================================                           |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(3/5) Simulating: |====================================                        |(3/5) Simulating: |=======================================                     |(3/5) Simulating: |==========================================                  |(3/5) Simulating: |=============================================               |(3/5) Simulating: |================================================            |(3/5) Simulating: |===================================================         |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(3/5) Simulating: |======================================================      |(3/5) Simulating: |=========================================================   |(3/5) Simulating: |============================================================|(3/5) (4/5) (4/5) Simulating: |                                                            |(4/5) Simulating: |===                                                         |(4/5) Simulating: |======                                                      |(4/5) Simulating: |=========                                                   |(4/5) Simulating: |============                                                |(4/5) Simulating: |===============                                             |(4/5) Simulating: |==================                                          |(4/5) Simulating: |=====================                                       |(4/5) Simulating: |========================                                    |(4/5) Simulating: |===========================                                 |(4/5) Simulating: |==============================                              |(4/5) Simulating: |=================================                           |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(4/5) Simulating: |====================================                        |(4/5) Simulating: |=======================================                     |(4/5) Simulating: |==========================================                  |(4/5) Simulating: |=============================================               |(4/5) Simulating: |================================================            |(4/5) Simulating: |===================================================         |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(4/5) Simulating: |======================================================      |(4/5) Simulating: |=========================================================   |(4/5) Simulating: |============================================================|(4/5) (5/5) (5/5) Simulating: |                                                            |(5/5) Simulating: |===                                                         |(5/5) Simulating: |======                                                      |(5/5) Simulating: |=========                                                   |(5/5) Simulating: |============                                                |(5/5) Simulating: |===============                                             |(5/5) Simulating: |==================                                          |(5/5) Simulating: |=====================                                       |(5/5) Simulating: |========================                                    |(5/5) Simulating: |===========================                                 |(5/5) Simulating: |==============================                              |(5/5) Simulating: |=================================                           |(5/5) Simulating: |====================================                        |(5/5) Simulating: |=======================================                     |(5/5) Simulating: |==========================================                  |(5/5) Simulating: |=============================================               |(5/5) Simulating: |================================================            |(5/5) Simulating: |===================================================         |(5/5) Simulating: |======================================================      |(5/5) Simulating: |=========================================================   |(5/5) Simulating: |============================================================|(5/5) </code></pre>
</div>
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show plot</span></span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pcurve_m2_asi_c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="pwr_files/figure-html/glmer14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>If we did this, then even 5 subjects may be enough to reach the 80 percent threshold.</p>
</section>
<section id="adding-subjects-and-items" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="adding-subjects-and-items">Adding subjects and items</h3>
<p>We can also add subjects and items <em>simultaneously</em> to address questions like <em>How many subjects would I need if I had 30 items?</em>. Hence, we increase both subjects and items from 10 to 30. This means that our <em>new</em> data/model has the following characteristics.</p>
<ul>
<li><p>2 Conditions</p></li>
<li><p>30 Items (from 10)</p></li>
<li><p>30 Subjects (from 10)</p></li>
</ul>
<p>In this case, we return to each combination only occurring once.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a>m2_as <span class="ot">&lt;-</span> simr<span class="sc">::</span><span class="fu">extend</span>(m2,</span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">along =</span> <span class="st">"Subject"</span>,</span>
<span id="cb245-3"><a href="#cb245-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">30</span></span>
<span id="cb245-4"><a href="#cb245-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb245-5"><a href="#cb245-5" aria-hidden="true" tabindex="-1"></a>m2_asi <span class="ot">&lt;-</span> simr<span class="sc">::</span><span class="fu">extend</span>(m2_as,</span>
<span id="cb245-6"><a href="#cb245-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">along =</span> <span class="st">"Item"</span>,</span>
<span id="cb245-7"><a href="#cb245-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">30</span></span>
<span id="cb245-8"><a href="#cb245-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb245-9"><a href="#cb245-9" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect model</span></span>
<span id="cb245-10"><a href="#cb245-10" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(m2_asi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">y</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Odds Ratios</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.68</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.89&nbsp;–&nbsp;3.17</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.108</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Condition [Test]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.68</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.94&nbsp;–&nbsp;3.02</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.081</td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">3.29</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>Subject</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.50</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>Item</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.10</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.15</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>Subject</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">10</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>Item</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">10</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">200</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.017 / 0.169</td>
</tr>

</tbody></table>

</div>
</div>
<p>We can now plot power curve to answer the question <em>How many subjects do you need if you have 30 Items?</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a>pcurve_m2_asi_c <span class="ot">&lt;-</span> <span class="fu">powerCurve</span>(m2_asi,</span>
<span id="cb246-2"><a href="#cb246-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fixed</span>(<span class="st">"ConditionTest"</span>, <span class="st">"z"</span>),</span>
<span id="cb246-3"><a href="#cb246-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">along =</span> <span class="st">"Subject"</span>,</span>
<span id="cb246-4"><a href="#cb246-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">5</span>, <span class="dv">30</span>, <span class="dv">5</span>),</span>
<span id="cb246-5"><a href="#cb246-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsim =</span> <span class="dv">20</span></span>
<span id="cb246-6"><a href="#cb246-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating power at 6 sample sizes along Subject</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Simulating: |                                                                  |Simulating: |===                                                               |Simulating: |======                                                            |Simulating: |=========                                                         |Simulating: |=============                                                     |Simulating: |================                                                  |Simulating: |===================                                               |Simulating: |=======================                                           |Simulating: |==========================                                        |Simulating: |=============================                                     |Simulating: |=================================                                 |Simulating: |====================================                              |Simulating: |=======================================                           |Simulating: |==========================================                        |Simulating: |==============================================                    |Simulating: |=================================================                 |Simulating: |====================================================              |Simulating: |========================================================          |Simulating: |===========================================================       |Simulating: |==============================================================    |Simulating: |==================================================================|(1/6) (1/6) Simulating: |                                                            |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(1/6) Simulating: |===                                                         |(1/6) Simulating: |======                                                      |(1/6) Simulating: |=========                                                   |(1/6) Simulating: |============                                                |(1/6) Simulating: |===============                                             |(1/6) Simulating: |==================                                          |(1/6) Simulating: |=====================                                       |(1/6) Simulating: |========================                                    |(1/6) Simulating: |===========================                                 |(1/6) Simulating: |==============================                              |(1/6) Simulating: |=================================                           |(1/6) Simulating: |====================================                        |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(1/6) Simulating: |=======================================                     |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(1/6) Simulating: |==========================================                  |(1/6) Simulating: |=============================================               |(1/6) Simulating: |================================================            |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(1/6) Simulating: |===================================================         |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(1/6) Simulating: |======================================================      |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(1/6) Simulating: |=========================================================   |(1/6) Simulating: |============================================================|(1/6) (2/6) (2/6) Simulating: |                                                            |(2/6) Simulating: |===                                                         |(2/6) Simulating: |======                                                      |(2/6) Simulating: |=========                                                   |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(2/6) Simulating: |============                                                |(2/6) Simulating: |===============                                             |(2/6) Simulating: |==================                                          |(2/6) Simulating: |=====================                                       |(2/6) Simulating: |========================                                    |(2/6) Simulating: |===========================                                 |(2/6) Simulating: |==============================                              |(2/6) Simulating: |=================================                           |(2/6) Simulating: |====================================                        |(2/6) Simulating: |=======================================                     |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(2/6) Simulating: |==========================================                  |(2/6) Simulating: |=============================================               |(2/6) Simulating: |================================================            |(2/6) Simulating: |===================================================         |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(2/6) Simulating: |======================================================      |(2/6) Simulating: |=========================================================   |(2/6) Simulating: |============================================================|(2/6) (3/6) (3/6) Simulating: |                                                            |(3/6) Simulating: |===                                                         |(3/6) Simulating: |======                                                      |(3/6) Simulating: |=========                                                   |(3/6) Simulating: |============                                                |(3/6) Simulating: |===============                                             |(3/6) Simulating: |==================                                          |(3/6) Simulating: |=====================                                       |(3/6) Simulating: |========================                                    |(3/6) Simulating: |===========================                                 |(3/6) Simulating: |==============================                              |(3/6) Simulating: |=================================                           |(3/6) Simulating: |====================================                        |(3/6) Simulating: |=======================================                     |(3/6) Simulating: |==========================================                  |(3/6) Simulating: |=============================================               |(3/6) Simulating: |================================================            |(3/6) Simulating: |===================================================         |(3/6) Simulating: |======================================================      |(3/6) Simulating: |=========================================================   |(3/6) Simulating: |============================================================|(3/6) (4/6) (4/6) Simulating: |                                                            |(4/6) Simulating: |===                                                         |(4/6) Simulating: |======                                                      |(4/6) Simulating: |=========                                                   |(4/6) Simulating: |============                                                |(4/6) Simulating: |===============                                             |(4/6) Simulating: |==================                                          |(4/6) Simulating: |=====================                                       |(4/6) Simulating: |========================                                    |(4/6) Simulating: |===========================                                 |(4/6) Simulating: |==============================                              |(4/6) Simulating: |=================================                           |(4/6) Simulating: |====================================                        |(4/6) Simulating: |=======================================                     |(4/6) Simulating: |==========================================                  |(4/6) Simulating: |=============================================               |(4/6) Simulating: |================================================            |(4/6) Simulating: |===================================================         |(4/6) Simulating: |======================================================      |(4/6) Simulating: |=========================================================   |(4/6) Simulating: |============================================================|(4/6) (5/6) (5/6) Simulating: |                                                            |(5/6) Simulating: |===                                                         |(5/6) Simulating: |======                                                      |(5/6) Simulating: |=========                                                   |(5/6) Simulating: |============                                                |(5/6) Simulating: |===============                                             |(5/6) Simulating: |==================                                          |(5/6) Simulating: |=====================                                       |(5/6) Simulating: |========================                                    |(5/6) Simulating: |===========================                                 |(5/6) Simulating: |==============================                              |(5/6) Simulating: |=================================                           |(5/6) Simulating: |====================================                        |(5/6) Simulating: |=======================================                     |(5/6) Simulating: |==========================================                  |(5/6) Simulating: |=============================================               |(5/6) Simulating: |================================================            |(5/6) Simulating: |===================================================         |(5/6) Simulating: |======================================================      |(5/6) Simulating: |=========================================================   |(5/6) Simulating: |============================================================|(5/6) (6/6) (6/6) Simulating: |                                                            |(6/6) Simulating: |===                                                         |(6/6) Simulating: |======                                                      |(6/6) Simulating: |=========                                                   |(6/6) Simulating: |============                                                |(6/6) Simulating: |===============                                             |(6/6) Simulating: |==================                                          |(6/6) Simulating: |=====================                                       |(6/6) Simulating: |========================                                    |(6/6) Simulating: |===========================                                 |(6/6) Simulating: |==============================                              |(6/6) Simulating: |=================================                           |(6/6) Simulating: |====================================                        |(6/6) Simulating: |=======================================                     |(6/6) Simulating: |==========================================                  |(6/6) Simulating: |=============================================               |(6/6) Simulating: |================================================            |(6/6) Simulating: |===================================================         |(6/6) Simulating: |======================================================      |(6/6) Simulating: |=========================================================   |(6/6) Simulating: |============================================================|(6/6) </code></pre>
</div>
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show plot</span></span>
<span id="cb267-2"><a href="#cb267-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pcurve_m2_asi_c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="pwr_files/figure-html/glmer18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can see that with 30 items, we would need only about 15 subjects to reach the 80 percent threshold.</p>
<p>We can also check the results in tabular form as shown below.</p>
<p>The results are shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb268"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print results</span></span>
<span id="cb268-2"><a href="#cb268-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pcurve_m2_asi_c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Power for predictor 'ConditionTest', (95% confidence interval),
by number of levels in Subject:
      5: 65.00% (40.78, 84.61) - 300 rows
     10: 95.00% (75.13, 99.87) - 600 rows
     15: 100.0% (83.16, 100.0) - 900 rows
     20: 100.0% (83.16, 100.0) - 1200 rows
     25: 100.0% (83.16, 100.0) - 1500 rows
     30: 100.0% (83.16, 100.0) - 1800 rows

Time elapsed: 0 h 0 m 12 s</code></pre>
</div>
</div>
</section>
</section>
<section id="post-hoc-analyses" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="post-hoc-analyses">Post-Hoc Analyses</h2>
<hr>
<div class="warning" style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
<b>NOTE</b><br>Power analysis have also been used post-hoc to test if the sample size of studies was sufficient to detect meaningful effects. However, such post-hoc power calculations where the target effect size comes from the data, give misleading results <span class="citation" data-cites="hoenig2001abuse perugini2018practical">(<a href="#ref-hoenig2001abuse" role="doc-biblioref">Hoenig and Heisey</a>; <a href="#ref-perugini2018practical" role="doc-biblioref">Perugini, Gallucci, and Costantini</a>)</span> and should thus be treated with extreme care!
</p>
<p style="margin-left:1em;">
</p>
<p></p>
</span></div>
<p><br></p>
<p>We begin by adding a response variable to our data. In this case, we vary the response variable ti a higher likelihood of obtaining gazes in the <em>area of interests</em> (AOI) in the test condition.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb270"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a>simdat2 <span class="ot">&lt;-</span> simdat <span class="sc">%&gt;%</span></span>
<span id="cb270-2"><a href="#cb270-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(Condition) <span class="sc">%&gt;%</span></span>
<span id="cb270-3"><a href="#cb270-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb270-4"><a href="#cb270-4" aria-hidden="true" tabindex="-1"></a>    dep <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb270-5"><a href="#cb270-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"yes"</span>, <span class="st">"no"</span>), <span class="dv">100</span>, <span class="at">replace =</span> T, <span class="at">prob =</span> <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">5</span>)),</span>
<span id="cb270-6"><a href="#cb270-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"yes"</span>, <span class="st">"no"</span>), <span class="dv">100</span>, <span class="at">replace =</span> T, <span class="at">prob =</span> <span class="fu">c</span>(.<span class="dv">7</span>, .<span class="dv">3</span>))</span>
<span id="cb270-7"><a href="#cb270-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb270-8"><a href="#cb270-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb270-9"><a href="#cb270-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_if</span>(is.character, factor) <span class="sc">%&gt;%</span></span>
<span id="cb270-10"><a href="#cb270-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">AOI =</span> <span class="dv">4</span>)</span>
<span id="cb270-11"><a href="#cb270-11" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb270-12"><a href="#cb270-12" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(simdat2, <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Subject Condition Item AOI
1     Sub1   Control    1  no
2     Sub1   Control    2 yes
3     Sub1   Control    3  no
4     Sub1   Control    4 yes
5     Sub1   Control    5  no
6     Sub1   Control    6 yes
7     Sub1   Control    7  no
8     Sub1   Control    8 yes
9     Sub1   Control    9  no
10    Sub1   Control   10 yes
11    Sub2   Control    1  no
12    Sub2   Control    2  no
13    Sub2   Control    3 yes
14    Sub2   Control    4  no
15    Sub2   Control    5  no
16    Sub2   Control    6 yes
17    Sub2   Control    7  no
18    Sub2   Control    8 yes
19    Sub2   Control    9 yes
20    Sub2   Control   10 yes</code></pre>
</div>
</div>
<p>Now that we have generated some data, we will fit a model to it and perform a power analysis on the observed effects.</p>
<p>We will fit a first model to the data. Thus, in a first step, we load the <code>lme4</code> package to create a model, set a seed (to save the results and so that the results can be replicated), and then create an initial mixed-effects model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb272"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed for replicability</span></span>
<span id="cb272-2"><a href="#cb272-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb272-3"><a href="#cb272-3" aria-hidden="true" tabindex="-1"></a><span class="co"># fit model</span></span>
<span id="cb272-4"><a href="#cb272-4" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(AOI <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> Subject) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Item) <span class="sc">+</span> Condition,</span>
<span id="cb272-5"><a href="#cb272-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"binomial"</span>,</span>
<span id="cb272-6"><a href="#cb272-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> simdat2</span>
<span id="cb272-7"><a href="#cb272-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb272-8"><a href="#cb272-8" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect results</span></span>
<span id="cb272-9"><a href="#cb272-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: AOI ~ (1 | Subject) + (1 | Item) + Condition
   Data: simdat2

     AIC      BIC   logLik deviance df.resid 
   259.3    272.5   -125.6    251.3      196 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-1.687 -1.151  0.593  0.869  0.869 

Random effects:
 Groups  Name        Variance Std.Dev.
 Subject (Intercept) 0        0       
 Item    (Intercept) 0        0       
Number of obs: 200, groups:  Subject, 10; Item, 10

Fixed effects:
              Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept)      0.282      0.202    1.40    0.163  
ConditionTest    0.764      0.305    2.51    0.012 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr)
ConditinTst -0.663
optimizer (Nelder_Mead) convergence code: 0 (OK)
boundary (singular) fit: see help('isSingular')</code></pre>
</div>
</div>
<p>We now check the effect sizes of the predictors in the model. We can do this by displaying the results of the model using the <code>tab_model</code> function from the <code>sjPlot</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb274"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tabulate results</span></span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(m3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">AOI</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Odds Ratios</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.33</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.89&nbsp;–&nbsp;1.97</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.163</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Condition [Test]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.15</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.18&nbsp;–&nbsp;3.90</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.012</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">3.29</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>Subject</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.00</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>Item</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.00</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>Subject</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">10</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>Item</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">10</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">200</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.043 / NA</td>
</tr>

</tbody></table>

</div>
</div>
<p>Now, we perform power analysis on an observed effect. This analysis tells us how likely the model is to find an observed effect given the data.</p>
<hr>
<div class="warning" style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
<b>NOTE</b><br>We use a very low number of simulations (10) and we use the default z-test which is suboptimal for small samples <span class="citation" data-cites="bolker2009generalized">(<a href="#ref-bolker2009generalized" role="doc-biblioref">Bolker et al.</a>)</span>. In a proper study, you should increase the number of simulations (to at least 1000) and you should use a bootstrapping rather than a z-test <span class="citation" data-cites="halekoh2014kenward">(cf. <a href="#ref-halekoh2014kenward" role="doc-biblioref">Halekoh, Højsgaard, et al.</a>)</span>.
</p>
<p style="margin-left:1em;">
</p>
<p></p>
</span></div>
<hr>
<p><em>What is the probability of finding the observed effect given the data?</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb275"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed for replicability</span></span>
<span id="cb275-2"><a href="#cb275-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb275-3"><a href="#cb275-3" aria-hidden="true" tabindex="-1"></a><span class="co"># perform power analysis for present model</span></span>
<span id="cb275-4"><a href="#cb275-4" aria-hidden="true" tabindex="-1"></a>m3_pwr <span class="ot">&lt;-</span> <span class="fu">powerSim</span>(m3,</span>
<span id="cb275-5"><a href="#cb275-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fixed</span>(<span class="st">"ConditionTest"</span>, <span class="st">"z"</span>),</span>
<span id="cb275-6"><a href="#cb275-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsim =</span> <span class="dv">20</span></span>
<span id="cb275-7"><a href="#cb275-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb275-8"><a href="#cb275-8" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect results</span></span>
<span id="cb275-9"><a href="#cb275-9" aria-hidden="true" tabindex="-1"></a>m3_pwr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The results of the power analysis show that, given the data at hand, the model would have detected the effect of <code>Conidition:Test</code> with a probability of <code>m3_pwr$x</code> percent. However, and as stated above, the results of such post-hoc power calculations (where the target effect size comes from the data) give misleading results <span class="citation" data-cites="hoenig2001abuse">(<a href="#ref-hoenig2001abuse" role="doc-biblioref">Hoenig and Heisey</a>)</span> and should thus be treated with extreme care!</p>
<section id="fixing-effects" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="fixing-effects">Fixing effects</h3>
<p>We will set the effects that we obtained based on our “observed” data to check if, given the size of the data, we have enough power to detect a small effect of <em>Condition</em>. In a first step, we check the observed effects.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb276"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a>estimatesfixedeffects <span class="ot">&lt;-</span> <span class="fu">fixef</span>(m3)</span>
<span id="cb276-2"><a href="#cb276-2" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(estimatesfixedeffects)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept) ConditionTest 
        1.326         2.147 </code></pre>
</div>
</div>
<p>We can see that the effect of <em>Condition</em> is rather small which makes it very hard to detect an effect. We will now change the size of the effect of ConditionTest to represent a truly <em>small</em> effect, i.e.&nbsp;on the brink of being noise but being just strong enough to be considered small. In other words, we will set the effect so that its odds ratio is exactly 1.68.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb278"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed for replicability</span></span>
<span id="cb278-2"><a href="#cb278-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb278-3"><a href="#cb278-3" aria-hidden="true" tabindex="-1"></a><span class="co"># perform power analysis for small effect</span></span>
<span id="cb278-4"><a href="#cb278-4" aria-hidden="true" tabindex="-1"></a><span class="fu">fixef</span>(m3)[<span class="st">"ConditionTest"</span>] <span class="ot">&lt;-</span> <span class="fl">0.519</span></span>
<span id="cb278-5"><a href="#cb278-5" aria-hidden="true" tabindex="-1"></a>estimatesfixedeffects <span class="ot">&lt;-</span> <span class="fu">fixef</span>(m3)</span>
<span id="cb278-6"><a href="#cb278-6" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(estimatesfixedeffects)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept) ConditionTest 
        1.326         1.680 </code></pre>
</div>
</div>
<p><em>What is the probability of finding a weak effect given the data?</em></p>
<p>We now perform the power analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb280"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed for replicability</span></span>
<span id="cb280-2"><a href="#cb280-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb280-3"><a href="#cb280-3" aria-hidden="true" tabindex="-1"></a><span class="co"># perform power analysis for present model</span></span>
<span id="cb280-4"><a href="#cb280-4" aria-hidden="true" tabindex="-1"></a>m3_pwr_se <span class="ot">&lt;-</span> <span class="fu">powerSim</span>(m3,</span>
<span id="cb280-5"><a href="#cb280-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fixed</span>(<span class="st">"ConditionTest"</span>, <span class="st">"z"</span>),</span>
<span id="cb280-6"><a href="#cb280-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsim =</span> <span class="dv">20</span></span>
<span id="cb280-7"><a href="#cb280-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb280-8"><a href="#cb280-8" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect results</span></span>
<span id="cb280-9"><a href="#cb280-9" aria-hidden="true" tabindex="-1"></a>m3_pwr_se</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>The data is not sufficient and would detect a weak effect of <code>Condition</code> with only 8 percent accuracy</strong></p>
</section>
<section id="power-analysis-of-extended-data" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="power-analysis-of-extended-data">Power Analysis of Extended Data</h3>
<p>We will now extend the data to see what sample size is needed to get to the 80 percent accuracy threshold. We begin by increasing the number of items from 10 to 30 to see if this would lead to a sufficient sample size.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb281"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a><span class="co"># increase sample size</span></span>
<span id="cb281-2"><a href="#cb281-2" aria-hidden="true" tabindex="-1"></a>m3_ai <span class="ot">&lt;-</span> <span class="fu">extend</span>(m3,</span>
<span id="cb281-3"><a href="#cb281-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">along =</span> <span class="st">"Item"</span>,</span>
<span id="cb281-4"><a href="#cb281-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">30</span></span>
<span id="cb281-5"><a href="#cb281-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb281-6"><a href="#cb281-6" aria-hidden="true" tabindex="-1"></a><span class="co"># perform power simulation</span></span>
<span id="cb281-7"><a href="#cb281-7" aria-hidden="true" tabindex="-1"></a>m3_ai_pwr <span class="ot">&lt;-</span> <span class="fu">powerSim</span>(m3_ai,</span>
<span id="cb281-8"><a href="#cb281-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fixed</span>(<span class="st">"ConditionTest"</span>, <span class="st">"z"</span>),</span>
<span id="cb281-9"><a href="#cb281-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsim =</span> <span class="dv">20</span></span>
<span id="cb281-10"><a href="#cb281-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb281-11"><a href="#cb281-11" aria-hidden="true" tabindex="-1"></a><span class="co"># show results</span></span>
<span id="cb281-12"><a href="#cb281-12" aria-hidden="true" tabindex="-1"></a>m3_ai_pwr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>The data with 30 Items is sufficient and would detect a weak effect of <code>Condition</code> with 18 percent accuracy</strong></p>
<p><em>At what number of sentences are the data sufficient to detect an effect?</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb282"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a>pcurve_m3_asi_c <span class="ot">&lt;-</span> <span class="fu">powerCurve</span>(m3_ai,</span>
<span id="cb282-2"><a href="#cb282-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fixed</span>(<span class="st">"ConditionTest"</span>, <span class="st">"z"</span>),</span>
<span id="cb282-3"><a href="#cb282-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">along =</span> <span class="st">"Item"</span>,</span>
<span id="cb282-4"><a href="#cb282-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">5</span>, <span class="dv">30</span>, <span class="dv">5</span>),</span>
<span id="cb282-5"><a href="#cb282-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsim =</span> <span class="dv">20</span></span>
<span id="cb282-6"><a href="#cb282-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simulating: |                                                                  |Simulating: |===                                                               |Simulating: |======                                                            |Simulating: |=========                                                         |Simulating: |=============                                                     |Simulating: |================                                                  |Simulating: |===================                                               |Simulating: |=======================                                           |Simulating: |==========================                                        |Simulating: |=============================                                     |Simulating: |=================================                                 |Simulating: |====================================                              |Simulating: |=======================================                           |Simulating: |==========================================                        |Simulating: |==============================================                    |Simulating: |=================================================                 |Simulating: |====================================================              |Simulating: |========================================================          |Simulating: |===========================================================       |Simulating: |==============================================================    |Simulating: |==================================================================|(1/6) (1/6) Simulating: |                                                            |(1/6) Simulating: |===                                                         |(1/6) Simulating: |======                                                      |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(1/6) Simulating: |=========                                                   |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(1/6) Simulating: |============                                                |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(1/6) Simulating: |===============                                             |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(1/6) Simulating: |==================                                          |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(1/6) Simulating: |=====================                                       |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(1/6) Simulating: |========================                                    |(1/6) Simulating: |===========================                                 |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(1/6) Simulating: |==============================                              |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(1/6) Simulating: |=================================                           |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(1/6) Simulating: |====================================                        |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(1/6) Simulating: |=======================================                     |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(1/6) Simulating: |==========================================                  |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(1/6) Simulating: |=============================================               |(1/6) Simulating: |================================================            |(1/6) Simulating: |===================================================         |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(1/6) Simulating: |======================================================      |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(1/6) Simulating: |=========================================================   |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(1/6) Simulating: |============================================================|(1/6) (2/6) (2/6) Simulating: |                                                            |(2/6) Simulating: |===                                                         |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(2/6) Simulating: |======                                                      |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(2/6) Simulating: |=========                                                   |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(2/6) Simulating: |============                                                |(2/6) Simulating: |===============                                             |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(2/6) Simulating: |==================                                          |(2/6) Simulating: |=====================                                       |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(2/6) Simulating: |========================                                    |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(2/6) Simulating: |===========================                                 |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(2/6) Simulating: |==============================                              |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(2/6) Simulating: |=================================                           |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(2/6) Simulating: |====================================                        |(2/6) Simulating: |=======================================                     |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(2/6) Simulating: |==========================================                  |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(2/6) Simulating: |=============================================               |(2/6) Simulating: |================================================            |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(2/6) Simulating: |===================================================         |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(2/6) Simulating: |======================================================      |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(2/6) Simulating: |=========================================================   |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(2/6) Simulating: |============================================================|(2/6) (3/6) (3/6) Simulating: |                                                            |(3/6) Simulating: |===                                                         |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(3/6) Simulating: |======                                                      |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(3/6) Simulating: |=========                                                   |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(3/6) Simulating: |============                                                |(3/6) Simulating: |===============                                             |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(3/6) Simulating: |==================                                          |(3/6) Simulating: |=====================                                       |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(3/6) Simulating: |========================                                    |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(3/6) Simulating: |===========================                                 |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(3/6) Simulating: |==============================                              |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(3/6) Simulating: |=================================                           |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(3/6) Simulating: |====================================                        |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(3/6) Simulating: |=======================================                     |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(3/6) Simulating: |==========================================                  |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(3/6) Simulating: |=============================================               |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(3/6) Simulating: |================================================            |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(3/6) Simulating: |===================================================         |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(3/6) Simulating: |======================================================      |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(3/6) Simulating: |=========================================================   |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(3/6) Simulating: |============================================================|(3/6) (4/6) (4/6) Simulating: |                                                            |(4/6) Simulating: |===                                                         |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(4/6) Simulating: |======                                                      |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(4/6) Simulating: |=========                                                   |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(4/6) Simulating: |============                                                |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(4/6) Simulating: |===============                                             |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(4/6) Simulating: |==================                                          |(4/6) Simulating: |=====================                                       |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(4/6) Simulating: |========================                                    |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(4/6) Simulating: |===========================                                 |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(4/6) Simulating: |==============================                              |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(4/6) Simulating: |=================================                           |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(4/6) Simulating: |====================================                        |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(4/6) Simulating: |=======================================                     |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(4/6) Simulating: |==========================================                  |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(4/6) Simulating: |=============================================               |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(4/6) Simulating: |================================================            |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(4/6) Simulating: |===================================================         |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(4/6) Simulating: |======================================================      |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(4/6) Simulating: |=========================================================   |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(4/6) Simulating: |============================================================|(4/6) (5/6) (5/6) Simulating: |                                                            |(5/6) Simulating: |===                                                         |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(5/6) Simulating: |======                                                      |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(5/6) Simulating: |=========                                                   |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(5/6) Simulating: |============                                                |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(5/6) Simulating: |===============                                             |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(5/6) Simulating: |==================                                          |(5/6) Simulating: |=====================                                       |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(5/6) Simulating: |========================                                    |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(5/6) Simulating: |===========================                                 |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(5/6) Simulating: |==============================                              |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(5/6) Simulating: |=================================                           |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(5/6) Simulating: |====================================                        |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(5/6) Simulating: |=======================================                     |(5/6) Simulating: |==========================================                  |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(5/6) Simulating: |=============================================               |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(5/6) Simulating: |================================================            |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(5/6) Simulating: |===================================================         |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(5/6) Simulating: |======================================================      |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(5/6) Simulating: |=========================================================   |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(5/6) Simulating: |============================================================|(5/6) (6/6) (6/6) Simulating: |                                                            |(6/6) Simulating: |===                                                         |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(6/6) Simulating: |======                                                      |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(6/6) Simulating: |=========                                                   |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(6/6) Simulating: |============                                                |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(6/6) Simulating: |===============                                             |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(6/6) Simulating: |==================                                          |(6/6) Simulating: |=====================                                       |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(6/6) Simulating: |========================                                    |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(6/6) Simulating: |===========================                                 |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(6/6) Simulating: |==============================                              |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(6/6) Simulating: |=================================                           |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(6/6) Simulating: |====================================                        |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(6/6) Simulating: |=======================================                     |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(6/6) Simulating: |==========================================                  |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(6/6) Simulating: |=============================================               |(6/6) Simulating: |================================================            |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(6/6) Simulating: |===================================================         |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(6/6) Simulating: |======================================================      |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(6/6) Simulating: |=========================================================   |</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(6/6) Simulating: |============================================================|(6/6) </code></pre>
</div>
<div class="sourceCode cell-code" id="cb383"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb383-1"><a href="#cb383-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show plot</span></span>
<span id="cb383-2"><a href="#cb383-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pcurve_m3_asi_c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="pwr_files/figure-html/glmer36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We reach the 80 percent threshold with about 25 subjects.</p>
</section>
</section>
</section>
<section id="resources-and-links" class="level1 unnumbered">
<h1 class="unnumbered">Resources and Links</h1>
<p>If you want to know more, please have a look/go at the following resources:</p>
<ul>
<li><p><a href="https://besjournals.onlinelibrary.wiley.com/doi/full/10.1111/2041-210X.12504">SIMR: an R package for power analysis of generalized linear mixed models by simulation</a></p></li>
<li><p><a href="https://www.r-bloggers.com/2021/05/power-analysis-in-statistics-with-r/">Power analysis in Statistics with R</a></p></li>
<li><p><a href="https://humburg.github.io/Power-Analysis/simr_power_analysis.html">Power Analysis with simr</a></p></li>
<li><p><a href="https://www.r-bloggers.com/2021/07/parallelizing-simrpowercurve-in-r/">Parallelizing simr::powercurve() in R</a></p></li>
<li><p><a href="tutorials/pwr.html">Power Analysis in R</a></p></li>
</ul>
<p>Also check out Jacob Westfall’s website for <a href="https://jakewestfall.shinyapps.io/crossedpower/">Power Analysis with Crossed Random Effects</a> based on <span class="citation" data-cites="westfall2014power"><span>“Statistical Power and Optimal Design in Experiments in Which Samples of Participants Respond to Samples of Stimuli”</span> (<a href="#ref-westfall2014power" role="doc-biblioref">2014</a>)</span>.</p>
<p>See <span class="citation" data-cites="baayen2017shadows"><span>“The Cave of Shadows: Addressing the Human Factor with Generalized Additive Mixed Models”</span> (<a href="#ref-baayen2017shadows" role="doc-biblioref">2017</a>)</span> for power in generalized additive mixed models and why maximal models can be ill-advised. Also, see <span class="citation" data-cites="matuscheka2017balancing">Matuscheka et al. (<a href="#ref-matuscheka2017balancing" role="doc-biblioref">2017</a>)</span> for a simulation study on the detrimental effects of complex random effect structures on power.</p>
</section>
<section id="citation-session-info" class="level1 unnumbered">
<h1 class="unnumbered">Citation &amp; Session Info</h1>
<p>Schweinberger, Martin. 2024. <em>Power Analysis in R</em>. Brisbane: The University of Queensland. url: https://ladal.edu.au/tutorials/pwr.html (Version 2024.12.22).</p>
<pre><code>@manual{schweinberger2024pwr,
  author = {Schweinberger, Martin},
  title = {Power Analysis in R},
  note = {tutorials/pwr/pwr.html},
  year = {2024},
  organization = "The University of Queensland, Australia. School of Languages and Cultures},
  address = {Brisbane},
  edition = {2024.12.22}
}</code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb385"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb385-1"><a href="#cb385-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.4.1 (2024-06-14)
Platform: aarch64-apple-darwin20
Running under: macOS Sonoma 14.6.1

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: Australia/Brisbane
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] entity_0.1.0      flextable_0.9.7   knitr_1.48        DT_0.33          
 [5] effectsize_0.8.9  simr_1.0.7        sjPlot_2.8.16     lme4_1.1-35.5    
 [9] Matrix_1.7-1      pwr_1.3-0         DescTools_0.99.57 lubridate_1.9.3  
[13] forcats_1.0.0     stringr_1.5.1     dplyr_1.1.4       purrr_1.0.2      
[17] readr_2.1.5       tidyr_1.3.1       tibble_3.2.1      ggplot2_3.5.1    
[21] tidyverse_2.0.0  

loaded via a namespace (and not attached):
  [1] gld_2.6.6               sandwich_3.1-1          readxl_1.4.3           
  [4] rlang_1.1.4             magrittr_2.0.3          multcomp_1.4-26        
  [7] e1071_1.7-16            compiler_4.4.1          mgcv_1.9-1             
 [10] systemfonts_1.1.0       vctrs_0.6.5             pkgconfig_2.0.3        
 [13] fastmap_1.2.0           backports_1.5.0         labeling_0.4.3         
 [16] utf8_1.2.4              rmarkdown_2.28          tzdb_0.4.0             
 [19] nloptr_2.1.1            ragg_1.3.3              xfun_0.49              
 [22] jsonlite_1.8.9          uuid_1.2-1              sjmisc_2.8.10          
 [25] ggeffects_1.7.2         parallel_4.4.1          broom_1.0.7            
 [28] R6_2.5.1                stringi_1.8.4           car_3.1-3              
 [31] boot_1.3-31             cellranger_1.1.0        estimability_1.5.1     
 [34] assertthat_0.2.1        Rcpp_1.0.13             iterators_1.0.14       
 [37] klippy_0.0.0.9500       zoo_1.8-12              pacman_0.5.1           
 [40] parameters_0.23.0       splines_4.4.1           timechange_0.3.0       
 [43] tidyselect_1.2.1        rstudioapi_0.17.1       abind_1.4-8            
 [46] codetools_0.2-20        RLRsim_3.1-8            sjlabelled_1.2.0       
 [49] plyr_1.8.9              lattice_0.22-6          withr_3.0.2            
 [52] bayestestR_0.15.0       askpass_1.2.1           coda_0.19-4.1          
 [55] evaluate_1.0.1          survival_3.7-0          proxy_0.4-27           
 [58] zip_2.3.1               xml2_1.3.6              pillar_1.9.0           
 [61] carData_3.0-5           insight_0.20.5          generics_0.1.3         
 [64] hms_1.1.3               munsell_0.5.1           scales_1.3.0           
 [67] rootSolve_1.8.2.4       minqa_1.2.8             xtable_1.8-4           
 [70] class_7.3-22            glue_1.8.0              gdtools_0.4.0          
 [73] emmeans_1.10.5          lmom_3.2                tools_4.4.1            
 [76] data.table_1.16.2       Exact_3.3               mvtnorm_1.3-1          
 [79] grid_4.4.1              plotrix_3.8-4           datawizard_0.13.0      
 [82] colorspace_2.1-1        nlme_3.1-166            performance_0.12.4     
 [85] Formula_1.2-5           cli_3.6.3               textshaping_0.4.0      
 [88] officer_0.6.7           fontBitstreamVera_0.1.1 fansi_1.0.6            
 [91] expm_1.0-0              binom_1.1-1.1           sjstats_0.19.0         
 [94] gtable_0.3.6            fontquiver_0.2.1        digest_0.6.37          
 [97] pbkrtest_0.5.3          TH.data_1.1-2           htmlwidgets_1.6.4      
[100] farver_2.1.2            htmltools_0.5.8.1       lifecycle_1.0.4        
[103] httr_1.4.7              openssl_2.2.2           fontLiberation_0.1.0   
[106] MASS_7.3-61            </code></pre>
</div>
</div>
<hr>
<p><a href="#introduction">Back to top</a></p>
<p><a href="../../index.html">Back to HOME</a></p>
<hr>
</section>
<section id="references" class="level1 unnumbered">




</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-arnold2011simulation" class="csl-entry" role="listitem">
Arnold, Benjamin F, Daniel R Hogan, John M Colford, and Alan E Hubbard. <span>“Simulation Methods to Estimate Design Power: An Overview for Applied Research.”</span> <em>BMC Medical Research Methodology</em>, 1–10.
</div>
<div id="ref-bolker2009generalized" class="csl-entry" role="listitem">
Bolker, Benjamin M, Mollie E Brooks, Connie J Clark, Shane W Geange, John R Poulsen, M Henry H Stevens, and Jada-Simone S White. <span>“Generalized Linear Mixed Models: A Practical Guide for Ecology and Evolution.”</span> <em>Trends in Ecology &amp; Evolution</em>, 127–35.
</div>
<div id="ref-bortz109verteilungsfreie" class="csl-entry" role="listitem">
Bortz, J, GA Lienert, and K Boehnke. <em>Verteilungsfreie Methoden in Der Biostatistik</em>. Berlin: Springer Verlag.
</div>
<div id="ref-brysbaert2018power" class="csl-entry" role="listitem">
Brysbaert, M., and M Stevens. 2018. <span>“Power Analysis and Effect Size in Mixed Effects Models: A Tutorial.”</span> <em>Journal of Cognition</em> 1 (9): 1–20.
</div>
<div id="ref-pwr" class="csl-entry" role="listitem">
Champely, Stephane. 2020. <em>Pwr: Basic Functions for Power Analysis</em>. <a href="https://CRAN.R-project.org/package = pwr">https://CRAN.R-project.org/package = pwr</a>.
</div>
<div id="ref-chen2010big" class="csl-entry" role="listitem">
Chen, Henian, Patricia Cohen, and Sophie Chen. <span>“How Big Is a Big Odds Ratio? Interpreting the Magnitudes of Odds Ratios in Epidemiological Studies.”</span> <em>Communications in Statistics–Simulation and Computation<span></span></em>, 860–64.
</div>
<div id="ref-cohen1988statistical" class="csl-entry" role="listitem">
Cohen, Jacob. <em>Statistical Power Analysis for the Behavioral Sciences</em>. Hillsdale, NJ: Erlbaum.
</div>
<div id="ref-field2007making" class="csl-entry" role="listitem">
Field, Scott A, Patrick J O’Connor, Andrew J Tyre, and Hugh P Possingham. <span>“Making Monitoring Meaningful.”</span> <em>Austral Ecology</em>, 485–91.
</div>
<div id="ref-green2016simr" class="csl-entry" role="listitem">
Green, Peter, and Catriona J MacLeod. <span>“SIMR: An r Package for Power Analysis of Generalized Linear Mixed Models by Simulation.”</span> <em>Methods in Ecology and Evolution</em>, 493–98.
</div>
<div id="ref-simr" class="csl-entry" role="listitem">
Green, Peter, and Catriona J. MacLeod. 2016. <span>“Simr: An r Package for Power Analysis of Generalised Linear Mixed Models by Simulation.”</span> <em>Methods in Ecology and Evolution</em> 7 (4): 493–98. <a href="https://doi.org/10.1111/2041-210X.12504">https://doi.org/10.1111/2041-210X.12504</a>.
</div>
<div id="ref-gries2005kilgariff" class="csl-entry" role="listitem">
Gries, Stefan Th. 2005. <span>“Null-Hypothesis Significance Testing of Word Frequencies: A Follow-up on Kilgarriff.”</span> <em>Corpus Linguistics and Linguistic Theory</em> 1 (2): 277–94.
</div>
<div id="ref-halekoh2014kenward" class="csl-entry" role="listitem">
Halekoh, Ulrich, Søren Højsgaard, et al. <span>“A Kenward-Roger Approximation and Parametric Bootstrap Methods for Tests in Linear Mixed Models–the r Package Pbkrtest.”</span> <em>Journal of Statistical Software</em>, 1–30.
</div>
<div id="ref-hoenig2001abuse" class="csl-entry" role="listitem">
Hoenig, John M, and Dennis M Heisey. <span>“The Abuse of Power: The Pervasive Fallacy of Power Calculations for Data Analysis.”</span> <em>The American Statistician</em>, 19–24.
</div>
<div id="ref-johnson2015power" class="csl-entry" role="listitem">
Johnson, Paul CD, Sarah JE Barry, Heather M Ferguson, and Pie Müller. <span>“Power Analysis for Generalized Linear Mixed Models in Ecology and Evolution.”</span> <em>Methods in Ecology and Evolution</em>, 133–42.
</div>
<div id="ref-kilgarriff2005language" class="csl-entry" role="listitem">
Kilgarriff, Adam. 2005. <span>“Language Is Never, Ever, Ever, Random.”</span> <em>Corpus Linguistics and Linguistic Theory</em> 1 (2): 263–76.
</div>
<div id="ref-matuscheka2017balancing" class="csl-entry" role="listitem">
Matuscheka, Hannes, Reinhold Kliegl, Shravan Vasishth, Harald Baayen, and Douglas Bates. 2017. <span>“Balancing Type i Error and Power in Linear Mixed Models.”</span> <em>Journal of Memory and Language</em> 94: 305–15.
</div>
<div id="ref-perugini2018practical" class="csl-entry" role="listitem">
Perugini, Marco, Marcello Gallucci, and Giulio Costantini. <span>“A Practical Primer to Power Analysis for Simple Experimental Designs.”</span> <em>International Review of Social Psychology</em>, 1–23.
</div>
<div id="ref-westfall2014power" class="csl-entry" role="listitem">
<span>“Statistical Power and Optimal Design in Experiments in Which Samples of Participants Respond to Samples of Stimuli.”</span> 2014. <em>Journal of Experimental Psychology: General</em> 143 (5): 2020–45.
</div>
<div id="ref-baayen2017shadows" class="csl-entry" role="listitem">
<span>“The Cave of Shadows: Addressing the Human Factor with Generalized Additive Mixed Models.”</span> 2017. <em>Journal of Memory and Language</em> 94: 206–34.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>