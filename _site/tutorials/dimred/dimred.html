<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Martin Schweinberger">

<title>Introduction to Dimension Reduction Methods with R - AcqVA Aurora workshop – quarto_websites</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script>
  // Wait for the document to be fully loaded
  document.addEventListener("DOMContentLoaded", function () {
    // Create a new div element to hold the dynamic content
    var newContainer = document.createElement("div");
    newContainer.classList.add("custom-banner");  // You can assign a class to the new container for styling

    // You can also add content inside the new container
    newContainer.innerHTML = `
        <div class="banner">
            <img src="/images/ladal_icon_white.png" alt="Icon" class="banner-icon">
            <span class="banner-text">Language Technology and Data Analysis Laboratory</span>
        </div>
    `

    // Select the header element
    var header = document.getElementById("quarto-header");

    // Select the nav element inside the header to place the new container just above it
    var navbar = header.querySelector("nav");

    // Insert the new container before the navbar element
    header.insertBefore(newContainer, navbar);
  });
</script>
<link href="../../site_libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">
<script src="../../site_libs/tabwid-1.1.3/tabwid.js"></script>


<link rel="stylesheet" href="../../css/styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">quarto_websites</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">HOME</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">ABOUT</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../events.html"> 
<span class="menu-text">EVENTS</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials.html"> 
<span class="menu-text">TUTORIALS</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../tools.html"> 
<span class="menu-text">TOOLS</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../resources.html"> 
<span class="menu-text">RESOURCES</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../contact.html"> 
<span class="menu-text">CONTACT</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul class="collapse">
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#what-are-dimension-reduction-methods" id="toc-what-are-dimension-reduction-methods" class="nav-link" data-scroll-target="#what-are-dimension-reduction-methods">What are dimension reduction methods?</a></li>
  <li><a href="#principal-component-analysis" id="toc-principal-component-analysis" class="nav-link" data-scroll-target="#principal-component-analysis">Principal Component Analysis</a></li>
  <li><a href="#multidimensional-scaling" id="toc-multidimensional-scaling" class="nav-link" data-scroll-target="#multidimensional-scaling">Multidimensional Scaling</a></li>
  <li><a href="#factor-analysis" id="toc-factor-analysis" class="nav-link" data-scroll-target="#factor-analysis">Factor Analysis</a></li>
  <li><a href="#citation-session-info" id="toc-citation-session-info" class="nav-link" data-scroll-target="#citation-session-info">Citation &amp; Session Info</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Introduction to Dimension Reduction Methods with R - AcqVA Aurora workshop</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Martin Schweinberger </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<p><img src="../../images/uq1.jpg" class="img-fluid" style="width:100.0%"></p>
<section id="introduction" class="level1 unnumbered">
<h1 class="unnumbered">Introduction</h1>
<p>This tutorial introduces dimension reduction methods with R with the aim of showcasing how these methods work, how to prepare data and how to implement selected dimension reduction methods (Principal Component Analysis, Factor Analysis, and Multidimensional Scaling). Unfortunately, we cannot deal with other, more complex dimension reduction methods such as Uniform Manifold Approximation and Projection (UMAP) or t-Distributed Stochastic Neighbor Embedding (t-SNE) in this tutorial (but we plan on adding a separate tutorial for these methods in the future). The reduction of multiple variables is useful for many things, e.g., for visualization, noise reduction, and simplifying complex data sets. However, it’s essential to note that interpretability of the principal components may not always be straightforward, as they are linear combinations of the original features.</p>
<p><img src="../../images/gy_chili.png" class="img-fluid" style="float:right; padding:10px;width:15.0%"></p>
<p>This tutorial is aimed at beginners and intermediate users of R. The aim is not to provide a fully-fledged guide but rather to show and exemplify some common dimension reduction methods with R.</p>
<div class="warning" style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
The entire R Notebook for the tutorial can be downloaded <a href="https://slcladal.github.io/content/dimred.Rmd"><strong>here</strong></a>. If you want to render the R Notebook on your machine, i.e.&nbsp;knitting the document to html or a pdf, you need to make sure that you have R and RStudio installed and you also need to download the <a href="https://slcladal.github.io/content/bibliography.bib"><strong>bibliography file</strong></a> and store it in the same folder where you store the Rproj file. <br><br> <strong><a href="https://colab.research.google.com/drive/16VNNnRXAC6CFU9oBwLlQsoG_Xpub-CRl?usp=sharing">Here</a></strong> is a <strong>link to an interactive version of this tutorial on Binder</strong>. The interactive tutorial is based on a Jupyter notebook of this tutorial. This interactive Jupyter notebook allows you to execute code yourself and - if you copy the Jupyter notebook - you can also change and edit the notebook, e.g.&nbsp;you can change code and upload your own data.<br>
</p>
<p style="margin-left:1em;">
</p>
<p></p>
</span></div>
<p><br></p>
<div class="warning" style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
To be able to follow this tutorial, we suggest you check out and familiarize yourself with the content of the following <strong>R Basics</strong> tutorials:<br>
</p>
<p style="margin-top:1em; text-align:left">
</p><ul>
<li>
<a href="https://ladal.edu.au/introquant.html">Introduction to Quantitative Reasoning</a>
</li>
<li>
<a href="https://ladal.edu.au/basicquant.html">Basic Concepts in Quantitative Research</a>
</li>
<li>
<a href="https://ladal.edu.au/intror.html">Getting started with R</a>
</li>
<li>
<a href="https://ladal.edu.au/load.html">Loading, saving, and generating data in R</a>
</li>
</ul>
<p></p>
<p style="margin-top:1em; text-align:center">
Click <a href="https://ladal.edu.au/content/kwics.Rmd"><strong>here</strong></a><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> to download the <strong>entire R Notebook</strong> for this tutorial.<br><br> <a href="https://mybinder.org/v2/gh/SLCLADAL/interactive-notebooks-environment/main?urlpath=git-pull%3Frepo%3Dhttps%253A%252F%252Fgithub.com%252FSLCLADAL%252Finteractive-notebooks%26urlpath%3Dlab%252Ftree%252Finteractive-notebooks%252Fnotebooks%252Fdimred_cb.ipynb%26branch%3Dmain"><img src="https://mybinder.org/badge_logo.svg" class="img-fluid" alt="Binder"></a><br> Click <a href="https://mybinder.org/v2/gh/SLCLADAL/interactive-notebooks-environment/main?urlpath=git-pull%3Frepo%3Dhttps%253A%252F%252Fgithub.com%252FSLCLADAL%252Finteractive-notebooks%26urlpath%3Dlab%252Ftree%252Finteractive-notebooks%252Fnotebooks%252Fdimred_cb.ipynb%26branch%3Dmain"><strong>here</strong></a> to open an interactive Jupyter notebook that allows you to execute, change, and edit the code as well as to upload your own data. <br>
</p>
<p style="margin-left:1em;">
</p>
<p></p>
</span></div>
<p><br></p>
<p><strong>Preparation and session set up</strong></p>
<p>This tutorial is based on R. If you have not installed R or are new to it, you will find an introduction to and more information how to use R <a href="https://slcladal.github.io/intror.html">here</a>. For this tutorials, we need to install certain <em>packages</em> from an R <em>library</em> so that the scripts shown below are executed without errors. Before turning to the code below, please install the packages by running the code below this paragraph. If you have already installed the packages mentioned below, then you can skip ahead and ignore this section. To install the necessary packages, simply run the following code - it may take some time (between 1 and 5 minutes to install all of the libraries so you do not need to worry if it takes some time).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"dplyr"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"stringr"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"writexl"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"here"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"flextable"</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"tidyr"</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"MASS"</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"factoextra"</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"report"</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"psych"</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"tufte"</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># install klippy for copy-to-clipboard button in code chunks</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"remotes"</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"rlesur/klippy"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now that we have installed the packages, we activate them as shown below.</p>
<p>After installing these packages, we fetch them from the library to activate the packages.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>) <span class="co"># supress math. notation</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(report)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tufte)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="what-are-dimension-reduction-methods" class="level1 unnumbered">
<h1 class="unnumbered">What are dimension reduction methods?</h1>
<p>Dimension reduction methods such as Principal Component Analysis (PCA), Multidimensional Scaling (MDS), and Factor Analysis are techniques used to <em>reduce the number of variables or dimensions in a data set while preserving as much relevant information as possible</em>.</p>
<p>The choice of method depends on the specific goals of the analysis and the nature of the data being analyzed. Each method addresses different aspects of dimension reduction:</p>
<ul>
<li><p>PCA emphasizes variance</p></li>
<li><p>MDS emphasizes pairwise distances</p></li>
<li><p>Factor Analysis emphasizes the underlying latent factors.</p></li>
</ul>
<p>Below are brief explanations of the three commonly used dimension reduction methods.</p>
<p><strong>Principal Component Analysis (PCA)</strong></p>
<p>Principal Component Analysis is a statistical technique that transforms a data set into a new coordinate system where the variables (features) are linearly uncorrelated.</p>
<p>It aims to find a set of orthogonal axes (principal components) in such a way that the first principal component accounts for the maximum variance in the data, the second principal component for the second maximum variance, and so on. By selecting a subset of these principal components, you can achieve dimension reduction while retaining the most significant information in the data.</p>
<p>Unfortunately, PCA only works really well when the number of features (or variables) isn’t too big and when the majority of the variance is explained by 2 or 3 principal components. If you are dealing with a very large data set with many features, UMAP is a better alternative.</p>
<p><strong>Multidimensional Scaling (MDS)</strong></p>
<p>Multidimensional Scaling is a method used to represent high-dimensional data in a lower-dimensional space (usually 2D or 3D) while maintaining pairwise distances or similarities between data points. MDS attempts to preserve the relationships among data points as much as possible. It’s often used in visualization to represent complex data in a way that makes it easier to interpret or analyze.</p>
<p>Like PCA, MDS only works really well when the number of variables isn’t too big and when the majority of the variance is explained by 2 or 3 dimensions.</p>
<p><strong>Factor Analysis</strong></p>
<p>Factor Analysis is a statistical technique that aims to uncover underlying latent factors that contribute to the observed variables in a data set. It’s particularly useful when dealing with data where variables may be correlated, and you want to identify common factors that explain the shared variance. Factor Analysis assumes that observed variables are influenced by both the common factors and unique factors specific to each variable.</p>
</section>
<section id="principal-component-analysis" class="level1 unnumbered">
<h1 class="unnumbered">Principal Component Analysis</h1>
<p>Principal Component Analysis (PCA) <span class="citation" data-cites="clark2011introduction">(see, e.g., <a href="#ref-clark2011introduction" role="doc-biblioref">Clark and Ma’ayan 2011</a>)</span> is used for dimensionality reduction and data compression while preserving as much variance as possible in the data. It achieves this by transforming the original data into a new coordinate system defined by a set of orthogonal axes called <em>principal components</em>. The first principal component captures the maximum variance in the data, the second captures the second maximum variance, and so on.</p>
<blockquote class="blockquote">
<p>“Imagine you have just opened a cider shop. You have 50 varieties of cider and you want to work out how to allocate them onto shelves, so that similar-tasting ciders are put on the same shelf. There are lots of different tastes and textures in cider - sweetness, tartness, bitterness, yeastiness, fruitiness, clarity, fizziness etc etc. So what you need to do to put the bottles into categories is answer two questions:</p>
<ol type="1">
<li><p>What qualities are most important for identifying groups of ciders? e.g.&nbsp;does classifying based on sweetness make it easier to cluster your ciders into similar-tasting groups than classifying based on fruitiness?</p></li>
<li><p>Can we reduce our list of variables by combining some of them? e.g.&nbsp;is there actually a variable that is some combination of “yeastiness and clarity and fizziness” and which makes a really good scale for classifying varieties?</p></li>
</ol>
This is essentially what PCA does. Principal components are variables that usefully explain variation in a data set - in this case, that usefully differentiate between groups. Each principal component is one of your original explanatory variables, or a combination of some of your original explanatory variables.”
<footer>
Freya Harrison
</footer>
</blockquote>
<p>Let’s delve into an easy example to get a better understanding of the theoretical underpinnings of PCA and to see how it works <span class="citation" data-cites="stackpca3">(this section is based on <a href="#ref-stackpca3" role="doc-biblioref">Starmer 2018</a>)</span> and a very brief, nice, and easy to understand explanation of PCA is available <a href="https://stats.stackexchange.com/questions/2691/making-sense-of-principal-component-analysis-eigenvectors-eigenvalues/2700#2700">here</a> <span class="citation" data-cites="stackpca4">(<a href="#ref-stackpca4" role="doc-biblioref">Amoeba 2022</a>)</span>…</p>
<p><strong>Primer: Why should I use a PCA and what does PCA tell us?</strong></p>
<p>Imagine we have a data set representing measurements of 4 features across a sample of 6 languages. We now want to see if the languages from groups based on the frequencies of these features.</p>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-d4b1ce04{}.cl-d4ae4dce{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-d4afb966{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-d4afb970{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-d4afc88e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d4afc88f{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d4afc890{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d4afc891{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d4afc898{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d4afc899{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-d4b1ce04"><thead><tr style="overflow-wrap:break-word;"><th class="cl-d4afc88e"><p class="cl-d4afb966"><span class="cl-d4ae4dce">Language</span></p></th><th class="cl-d4afc88f"><p class="cl-d4afb970"><span class="cl-d4ae4dce">Feat1</span></p></th><th class="cl-d4afc88f"><p class="cl-d4afb970"><span class="cl-d4ae4dce">Feat2</span></p></th><th class="cl-d4afc88f"><p class="cl-d4afb970"><span class="cl-d4ae4dce">Feat3</span></p></th><th class="cl-d4afc88f"><p class="cl-d4afb970"><span class="cl-d4ae4dce">Feat4</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-d4afc890"><p class="cl-d4afb966"><span class="cl-d4ae4dce">Lang1</span></p></td><td class="cl-d4afc891"><p class="cl-d4afb970"><span class="cl-d4ae4dce">10</span></p></td><td class="cl-d4afc891"><p class="cl-d4afb970"><span class="cl-d4ae4dce">6.0</span></p></td><td class="cl-d4afc891"><p class="cl-d4afb970"><span class="cl-d4ae4dce">12.0</span></p></td><td class="cl-d4afc891"><p class="cl-d4afb970"><span class="cl-d4ae4dce">5</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d4afc890"><p class="cl-d4afb966"><span class="cl-d4ae4dce">Lang2</span></p></td><td class="cl-d4afc891"><p class="cl-d4afb970"><span class="cl-d4ae4dce">11</span></p></td><td class="cl-d4afc891"><p class="cl-d4afb970"><span class="cl-d4ae4dce">4.0</span></p></td><td class="cl-d4afc891"><p class="cl-d4afb970"><span class="cl-d4ae4dce">9.0</span></p></td><td class="cl-d4afc891"><p class="cl-d4afb970"><span class="cl-d4ae4dce">7</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d4afc890"><p class="cl-d4afb966"><span class="cl-d4ae4dce">Lang3</span></p></td><td class="cl-d4afc891"><p class="cl-d4afb970"><span class="cl-d4ae4dce">8</span></p></td><td class="cl-d4afc891"><p class="cl-d4afb970"><span class="cl-d4ae4dce">5.0</span></p></td><td class="cl-d4afc891"><p class="cl-d4afb970"><span class="cl-d4ae4dce">10.0</span></p></td><td class="cl-d4afc891"><p class="cl-d4afb970"><span class="cl-d4ae4dce">6</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d4afc890"><p class="cl-d4afb966"><span class="cl-d4ae4dce">Lang4</span></p></td><td class="cl-d4afc891"><p class="cl-d4afb970"><span class="cl-d4ae4dce">3</span></p></td><td class="cl-d4afc891"><p class="cl-d4afb970"><span class="cl-d4ae4dce">3.0</span></p></td><td class="cl-d4afc891"><p class="cl-d4afb970"><span class="cl-d4ae4dce">2.5</span></p></td><td class="cl-d4afc891"><p class="cl-d4afb970"><span class="cl-d4ae4dce">2</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d4afc890"><p class="cl-d4afb966"><span class="cl-d4ae4dce">Lang5</span></p></td><td class="cl-d4afc891"><p class="cl-d4afb970"><span class="cl-d4ae4dce">1</span></p></td><td class="cl-d4afc891"><p class="cl-d4afb970"><span class="cl-d4ae4dce">2.8</span></p></td><td class="cl-d4afc891"><p class="cl-d4afb970"><span class="cl-d4ae4dce">1.3</span></p></td><td class="cl-d4afc891"><p class="cl-d4afb970"><span class="cl-d4ae4dce">4</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d4afc898"><p class="cl-d4afb966"><span class="cl-d4ae4dce">Lang6</span></p></td><td class="cl-d4afc899"><p class="cl-d4afb970"><span class="cl-d4ae4dce">2</span></p></td><td class="cl-d4afc899"><p class="cl-d4afb970"><span class="cl-d4ae4dce">1.0</span></p></td><td class="cl-d4afc899"><p class="cl-d4afb970"><span class="cl-d4ae4dce">2.0</span></p></td><td class="cl-d4afc899"><p class="cl-d4afb970"><span class="cl-d4ae4dce">7</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>To understand how PCA works, let us start by plotting the first feature (Feat1).</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dimred_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>When we check the visualization of the first feature, we see that there appear to be two groups in our data!</p>
<p>We now add the second feature (Feat2) to check if the second feature adds information and supports our hypothesis that there are two types of languages in our data based on the features we collected.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dimred_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>While adding the second feature has not added much information (in that sense, Feat2 not as distinctive), there still appear to be two groups. However, we continue by adding the third feature (Feat3) by adding size as a way to show the third feature.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dimred_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Feat3 supports the two group hypothesis as small dots have values below 5 and big dots have values above 5 on the first feature scale. Finally, we add the fourth feature (Feat4) and use color to visualize this 4<sup>th</sup> dimension.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dimred_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Like the second feature, Feat4 has not added much information.</p>
<p>Now, what would we use a PCA for in this context?</p>
<blockquote class="blockquote">
<p><strong>PCA can tell us if and how many groups there are in our data and it can tell use what features are responsible for the division into groups!</strong></p>
</blockquote>
<p>Let’s now go through a PCA step-by-step. Also, we only consider Feat1 and Feat2 to keep things very simple.</p>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-d51267b4{}.cl-d50fa0ce{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-d510c38c{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-d510c38d{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-d510d052{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d510d053{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d510d054{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d510d055{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d510d05c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d510d05d{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-d51267b4"><thead><tr style="overflow-wrap:break-word;"><th class="cl-d510d052"><p class="cl-d510c38c"><span class="cl-d50fa0ce">Language</span></p></th><th class="cl-d510d053"><p class="cl-d510c38d"><span class="cl-d50fa0ce">Feat1</span></p></th><th class="cl-d510d053"><p class="cl-d510c38d"><span class="cl-d50fa0ce">Feat2</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-d510d054"><p class="cl-d510c38c"><span class="cl-d50fa0ce">Lang1</span></p></td><td class="cl-d510d055"><p class="cl-d510c38d"><span class="cl-d50fa0ce">10</span></p></td><td class="cl-d510d055"><p class="cl-d510c38d"><span class="cl-d50fa0ce">6.0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d510d054"><p class="cl-d510c38c"><span class="cl-d50fa0ce">Lang2</span></p></td><td class="cl-d510d055"><p class="cl-d510c38d"><span class="cl-d50fa0ce">11</span></p></td><td class="cl-d510d055"><p class="cl-d510c38d"><span class="cl-d50fa0ce">4.0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d510d054"><p class="cl-d510c38c"><span class="cl-d50fa0ce">Lang3</span></p></td><td class="cl-d510d055"><p class="cl-d510c38d"><span class="cl-d50fa0ce">8</span></p></td><td class="cl-d510d055"><p class="cl-d510c38d"><span class="cl-d50fa0ce">5.0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d510d054"><p class="cl-d510c38c"><span class="cl-d50fa0ce">Lang4</span></p></td><td class="cl-d510d055"><p class="cl-d510c38d"><span class="cl-d50fa0ce">3</span></p></td><td class="cl-d510d055"><p class="cl-d510c38d"><span class="cl-d50fa0ce">3.0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d510d054"><p class="cl-d510c38c"><span class="cl-d50fa0ce">Lang5</span></p></td><td class="cl-d510d055"><p class="cl-d510c38d"><span class="cl-d50fa0ce">1</span></p></td><td class="cl-d510d055"><p class="cl-d510c38d"><span class="cl-d50fa0ce">2.8</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d510d05c"><p class="cl-d510c38c"><span class="cl-d50fa0ce">Lang6</span></p></td><td class="cl-d510d05d"><p class="cl-d510c38d"><span class="cl-d50fa0ce">2</span></p></td><td class="cl-d510d05d"><p class="cl-d510c38d"><span class="cl-d50fa0ce">1.0</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>We start by calculating the center of the data.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dimred_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Next we scale and center the data so that the center is at (0,0).</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dimred_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The relationship between data points is unchanged!</p>
<blockquote class="blockquote">
<p>Important: <strong>always center and scale your data</strong> as the scales will impact the magnitude of variance! In other words, if you do not center and scale, components can be deemed important simply because the scale of the variables is bigger (not because they are more important)!</p>
</blockquote>
<p>Now, we fit a line through the data.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dimred_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="warning" style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
<b>IMPORTANT!</b>
</p>
<p style="margin-left:1em;">
</p><p>But how do we arrive at this line and what is there always talk about “orthogonal” when talking about PCA?</p>
Let’s have a look at simple the Ordinary Least Squared (OLS) procedure that underlies regression:
<p></p>
<p style="margin-top:1em; text-align:center">
</p><div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dimred_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p></p>
<p style="margin-left:1em;">
</p><p>In OLS, the lines that represent variance (or residuals) are perpendicular to the x-axis.</p>
However, in PCA, the line are perpendicular to the regression line as shown below!
<p></p>
<p style="margin-top:1em; text-align:center">
</p><div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dimred_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p></p>
<p></p>
</span></div>
<p>The line that minimizes variance is called <strong>Principal Component 1</strong> (PC1) and it is different from a regression line. The PC1 can be found by minimizing the orthogonal distances (blue lines above) between data points and their projections (green points above)!.</p>
<p>An alternative way to find PC1 is actually not to try and minimize the distance between the data point and its projection but to maximize the distance between the projection (the green points on the line) and the origin (the center of the coordinate system). We can then square the distances between projections and the origin and add these squared distances, which gives us the <em>sum of squared distances</em> or <em>SS(distances)</em>.</p>
<p>PC1 has a slope of 0.9411239 - this already shows us that the data is spread much more along PC1 that along PC2!</p>
<p>We go about 1.0625593 units (1 / 0.9411) to the right and 1 unit up.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dimred_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Now, we find the value for a (square root of b<sup>2</sup> + c<sup>2</sup>) = 1.4591204.</p>
<p>Next, we scale b and c so that a is 1.</p>
<p>a<sup>2</sup> = b<sup>2</sup> + c<sup>2</sup></p>
<p>b = 1.0625593 / 1.4591204 = 0.7282191</p>
<p>c = 1 / 1.4591204 = 0.6853444</p>
<p>To make PC1, we need 0.738 of Feat1 and 0.685 of Feat2.</p>
<p>This 1 unit long vector (a) is called the Eigenvector for PC1.</p>
<blockquote class="blockquote">
<p>Eigenvector and Eigenvalue are not the same! Eigenvector represent the factor loadings for each observed variable on a specific factor. Eigenvalue represents the amount of variance explained by an entire factor.</p>
</blockquote>
<p>The proportions (0.738 and 0.685) are called the loading scores.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dimred_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>PC2 is simply the perpendicular line to PC1 that goes through 0,0.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dimred_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>As PC1 and PC2 are perpendicular, the Eigenvector of PC2 is -0.685 of Feat1 and 0.728 of Feat2.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dimred_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can (but have to) rotate the PC1 and make the points smaller (so that our plot looks more like a proper PCA plot).</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dimred_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>To plot the results of a PCA, we simply rotate the plot so that the PCs reflect the axes and we project the points onto the PCs.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate data</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  pcadat<span class="sc">$</span>Feat1,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  pcadat<span class="sc">$</span>Feat2</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Feat1"</span>, <span class="st">"Feat2"</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># perform PCA</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>pcaex <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(df, <span class="at">center =</span> T, <span class="at">scale =</span> T)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co"># visualize PCA results</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_ind</span>(pcaex, <span class="at">label =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"PCA plot"</span>) <span class="sc">+</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dimred_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Now we have an understanding of how we arrive at the visual representation of a PCA. But how do we arrive at the explained variance?</p>
<p>In the context of PCA, variance refers to summative variance or overall/total variability.</p>
<p>To get a better grasp of what this means, let’s consider a covariance matrix of some 3 variables (rather than just 2 variables as above). Their variances are on the diagonal, and the sum of the 3 values (3.248) is the overall variability.</p>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-d5d84128{}.cl-d5d587da{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-d5d6a728{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-d5d6b36c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d5d6b36d{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d5d6b36e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-d5d84128"><thead><tr style="overflow-wrap:break-word;"><th class="cl-d5d6b36c"><p class="cl-d5d6a728"><span class="cl-d5d587da">V1</span></p></th><th class="cl-d5d6b36c"><p class="cl-d5d6a728"><span class="cl-d5d587da">V2</span></p></th><th class="cl-d5d6b36c"><p class="cl-d5d6a728"><span class="cl-d5d587da">V3</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-d5d6b36d"><p class="cl-d5d6a728"><span class="cl-d5d587da">1.3437305</span></p></td><td class="cl-d5d6b36d"><p class="cl-d5d6a728"><span class="cl-d5d587da">-0.1601523</span></p></td><td class="cl-d5d6b36d"><p class="cl-d5d6a728"><span class="cl-d5d587da">0.1864702</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d5d6b36d"><p class="cl-d5d6a728"><span class="cl-d5d587da">-0.1601523</span></p></td><td class="cl-d5d6b36d"><p class="cl-d5d6a728"><span class="cl-d5d587da">0.6192056</span></p></td><td class="cl-d5d6b36d"><p class="cl-d5d6a728"><span class="cl-d5d587da">-0.1266843</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d5d6b36e"><p class="cl-d5d6a728"><span class="cl-d5d587da">0.1864702</span></p></td><td class="cl-d5d6b36e"><p class="cl-d5d6a728"><span class="cl-d5d587da">-0.1266843</span></p></td><td class="cl-d5d6b36e"><p class="cl-d5d6a728"><span class="cl-d5d587da">1.4855496</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>Now, PCA replaces original variables with new variables, called principal components, which are orthogonal (i.e.&nbsp;they have zero covariation!) and have variances (called eigenvalues) in decreasing order. So, the covariance matrix between the principal components extracted from the above data is this:</p>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-d5e0e7a6{}.cl-d5ddfafa{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-d5df3e56{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-d5df49fa{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d5df4a04{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d5df4a22{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-d5e0e7a6"><thead><tr style="overflow-wrap:break-word;"><th class="cl-d5df49fa"><p class="cl-d5df3e56"><span class="cl-d5ddfafa">V1</span></p></th><th class="cl-d5df49fa"><p class="cl-d5df3e56"><span class="cl-d5ddfafa">V2</span></p></th><th class="cl-d5df49fa"><p class="cl-d5df3e56"><span class="cl-d5ddfafa">V3</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-d5df4a04"><p class="cl-d5df3e56"><span class="cl-d5ddfafa">1.651354</span></p></td><td class="cl-d5df4a04"><p class="cl-d5df3e56"><span class="cl-d5ddfafa">0.000000</span></p></td><td class="cl-d5df4a04"><p class="cl-d5df3e56"><span class="cl-d5ddfafa">0.0000000</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d5df4a04"><p class="cl-d5df3e56"><span class="cl-d5ddfafa">0.000000</span></p></td><td class="cl-d5df4a04"><p class="cl-d5df3e56"><span class="cl-d5ddfafa">1.220288</span></p></td><td class="cl-d5df4a04"><p class="cl-d5df3e56"><span class="cl-d5ddfafa">0.0000000</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d5df4a22"><p class="cl-d5df3e56"><span class="cl-d5ddfafa">0.000000</span></p></td><td class="cl-d5df4a22"><p class="cl-d5df3e56"><span class="cl-d5ddfafa">0.000000</span></p></td><td class="cl-d5df4a22"><p class="cl-d5df3e56"><span class="cl-d5ddfafa">0.5768431</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>Note that the diagonal sum is still 3.448, which says that all 3 components account for all the multivariate variability. The PC1 accounts for or “explains” 1.651/3.448 = 47.9% of the overall variability; the PC2 explains 1.220/3.448 = 35.4% of it; the 3rd one explains .577/3.448 = 16.7% of it.</p>
<p>So, what do they mean when they say that PCA explains maximal variance? That is not, of course, that it finds the largest variance among three values 1.343730519 .619205620 1.485549631. PCA finds, in the data space, the dimension (direction) with the largest variance out of the overall variance 1.343730519+.619205620+1.485549631 = 3.448. That largest variance would be 1.651354285. Then it finds the dimension of the second largest variance, orthogonal to the first one, out of the remaining 3.448-1.651354285 overall variance. That 2nd dimension would be 1.220288343 variance. And so on. The last remaining dimension is .576843142 variance.</p>
<p>For our example, we can extract the amount of variance accounted for as shown below:</p>
<p>Step 1: get loading scores</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>pcaex<span class="sc">$</span>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            PC1        PC2
[1,] -1.6229306  0.2698980
[2,] -0.9855078 -0.6922526
[3,] -0.8983094  0.1947325
[4,]  0.7132969  0.2067653
[5,]  1.1180034  0.4515144
[6,]  1.6754475 -0.4306576</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dimred_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Step 2: calculate standard deviations of PC1 and PC2</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>sdpc1 <span class="ot">&lt;-</span> <span class="fu">sd</span>(pcaex<span class="sc">$</span>x[, <span class="dv">1</span>])</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>sdpc2 <span class="ot">&lt;-</span> <span class="fu">sd</span>(pcaex<span class="sc">$</span>x[, <span class="dv">2</span>])</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>sdpc1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.339995</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>sdpc2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.45212</code></pre>
</div>
</div>
<p>Step 3: use standard deviations to calculate the amount of variance explained by each component</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportion of Variance PC1 = sd PC1 squared / (sd PC1 squared + sd PC2 squared)</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>sdpc1<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (sdpc1<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> sdpc2<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8977938</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportion of Variance PC2 = sd PC2 squared / (sd PC1 squared + sd PC2 squared)</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>sdpc2<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (sdpc1<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> sdpc2<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1022062</code></pre>
</div>
</div>
<p>According to our manual calculation, PC1 explains 0.8978 % of the variation while PC2 explains 0.1022 % of the variation. To check if this is correct, we check our results against the results provided by the <code>prcomp</code> function.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                          PC1    PC2
Standard deviation     1.3400 0.4521
Proportion of Variance 0.8978 0.1022
Cumulative Proportion  0.8978 1.0000</code></pre>
</div>
</div>
<p>But how do we arrive at the standard deviations of the PCs? The standard deviations of the PCs are the covariance matrix values for the respective PCs! So let’s have a look at the covariance matrices of the raw data, the scales data, and the rotated, final data.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>          Feat1    Feat2
Feat1 18.966667 6.126667
Feat2  6.126667 3.126667</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>          Feat1     Feat2
Feat1 1.0000000 0.7955875
Feat2 0.7955875 1.0000000</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                          PC1                       PC2
PC1  1.7955875066756541436064 -0.0000000000000004884981
PC2 -0.0000000000000004884981  0.2044124933243467445720</code></pre>
</div>
</div>
<p>We see that the standard deviation of PC1 is equal to the sum of the first row (or column) of the scaled covariance matrix. But more importantly, we see that the <strong>squared standard deviations of the PCs are equal to the variances (eigenvalues) of the PCs in the covariance matrix</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>sdpc1<span class="sc">^</span><span class="dv">2</span> <span class="co"># sd of PC1 squared</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.795588</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># which is equal to</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">cov</span>(pcaex<span class="sc">$</span>x)[<span class="dv">1</span>, ])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.795588</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>sdpc2<span class="sc">^</span><span class="dv">2</span> <span class="co"># sd of PC2 squared</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2044125</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># which is equal to</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">cov</span>(pcaex<span class="sc">$</span>x)[<span class="dv">2</span>, ])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2044125</code></pre>
</div>
</div>
<p>Now that we have worked through one example of a PCA manually, we turn to several examples to show how one can implement PCA in R to showcase what PCA can be used for.</p>
<section id="example-1" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="example-1">Example 1</h3>
<p>Here, we will show</p>
<ul>
<li><p>how to use the <code>prcomp()</code> function to perform PCA</p></li>
<li><p>how to draw a PCA plot using ggplot2</p></li>
<li><p>how to determine how much variation each component accounts for</p></li>
<li><p>how to examine the loading scores to determine what variables have the largest effect on the graph</p></li>
</ul>
<p>In this example, the data is in a matrix called <code>pcadat</code> where columns are individual samples (i.e.&nbsp;languages) and rows are measurements taken for all the samples (i.e.&nbsp;features).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>pcadat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="dv">100</span>, <span class="at">ncol =</span> <span class="dv">10</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(pcadat) <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste</span>(<span class="st">"indoeu"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">sep =</span> <span class="st">""</span>), <span class="co"># Indo-European languages</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste</span>(<span class="st">"austro"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>) <span class="co"># Austronesian languages</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(pcadat) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"feature"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  indoeu.values <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">5</span>, <span class="at">lambda =</span> <span class="fu">sample</span>(<span class="at">x =</span> <span class="dv">10</span><span class="sc">:</span><span class="dv">1000</span>, <span class="at">size =</span> <span class="dv">1</span>))</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  austro.values <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">5</span>, <span class="at">lambda =</span> <span class="fu">sample</span>(<span class="at">x =</span> <span class="dv">10</span><span class="sc">:</span><span class="dv">1000</span>, <span class="at">size =</span> <span class="dv">1</span>))</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  pcadat[i, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(indoeu.values, austro.values)</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect data</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pcadat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         indoeu1 indoeu2 indoeu3 indoeu4 indoeu5 austro1 austro2 austro3
feature1     777     753     798     751     788     656     730     689
feature2     992     994    1026     974    1059     632     675     682
feature3      42      39      44      45      45      92      90      79
feature4     803     805     744     765     792     353     325     352
feature5     612     612     667     619     661     753     788     780
feature6     281     284     280     331     301     699     726     677
         austro4 austro5
feature1     649     734
feature2     634     670
feature3     102      81
feature4     333     306
feature5     742     745
feature6     665     682</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(pcadat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 100  10</code></pre>
</div>
</div>
<p>We now implement the PCA using the <code>prcomp</code> function from the <code>stats</code> package. In our case, we specify that we want to transpose the data (using the <code>t</code> function) because <strong>we need features to represent columns (not rows!)</strong> and we set the argument <code>scale</code> to TRUE as the data has to be normalised for a PCA to provide reliable results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(<span class="fu">t</span>(pcadat), <span class="at">scale =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, we generate a scree plot to show how much variance is accounted for by each component. We start by preparing the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare data</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>pca.var <span class="ot">&lt;-</span> pca<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co"># extract percentage of contribution</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>pca.var.per <span class="ot">&lt;-</span> <span class="fu">round</span>(pca.var <span class="sc">/</span> <span class="fu">sum</span>(pca.var) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co"># generate data frame for visualization</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>pcascreedat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Component =</span> <span class="fu">paste0</span>(<span class="st">"PC"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>),</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Percent =</span> <span class="fu">round</span>(pca.var <span class="sc">/</span> <span class="fu">sum</span>(pca.var) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Text =</span> <span class="fu">paste0</span>(Percent, <span class="st">"%"</span>),</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Component =</span> <span class="fu">factor</span>(Component,</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"PC1"</span>, <span class="st">"PC2"</span>, <span class="st">"PC3"</span>, <span class="st">"PC4"</span>, <span class="st">"PC5"</span>, <span class="st">"PC6"</span>, <span class="st">"PC7"</span>, <span class="st">"PC8"</span>, <span class="st">"PC9"</span>, <span class="st">"PC10"</span>)</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>pcascreedat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Component Percent   Text
1        PC1   91.83 91.83%
2        PC2    2.84  2.84%
3        PC3    1.26  1.26%
4        PC4    1.08  1.08%
5        PC5    0.94  0.94%
6        PC6    0.61  0.61%
7        PC7    0.56  0.56%
8        PC8    0.55  0.55%
9        PC9    0.33  0.33%
10      PC10    0.00     0%</code></pre>
</div>
</div>
<p>Now that the dtaa is formatted appropriately, we generate the scree plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pcascreedat, <span class="fu">aes</span>(<span class="at">x =</span> Component, <span class="at">y =</span> Percent, <span class="at">label =</span> Text)) <span class="sc">+</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">vjust =</span> <span class="sc">-</span><span class="fl">1.6</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Scree Plot"</span>) <span class="sc">+</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Principal Components"</span>, <span class="at">y =</span> <span class="st">"Percent Variation"</span>) <span class="sc">+</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dimred_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The scree plots shows that the PC1 accounts for 87.69% of the variability while the PC2 only accounts for 3.52% of the variability. This means that one component suffices to differentiate the data.</p>
<p>Now we make a fancy looking plot that shows the PCs and the variation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sample =</span> <span class="fu">rownames</span>(pca<span class="sc">$</span>x),</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> pca<span class="sc">$</span>x[, <span class="dv">1</span>],</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y =</span> pca<span class="sc">$</span>x[, <span class="dv">2</span>]</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y, <span class="at">label =</span> Sample)) <span class="sc">+</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>() <span class="sc">+</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">paste</span>(<span class="st">"PC1 ("</span>, pca.var.per[<span class="dv">1</span>], <span class="st">"%)"</span>, <span class="at">sep =</span> <span class="st">""</span>)) <span class="sc">+</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">paste</span>(<span class="st">"PC2 ("</span>, pca.var.per[<span class="dv">2</span>], <span class="st">"%)"</span>, <span class="at">sep =</span> <span class="st">""</span>)) <span class="sc">+</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"PCA Graph"</span>) <span class="sc">+</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">11</span>, <span class="dv">11</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dimred_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Next, we get the names of the most important 5 features that contribute most to PC1.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>loading_scores <span class="ot">&lt;-</span> pca<span class="sc">$</span>rotation[, <span class="dv">1</span>]</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co"># extract the magnitudes of the scores</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>feature_scores <span class="ot">&lt;-</span> <span class="fu">abs</span>(loading_scores)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co"># extract the 5 highest scores</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>feature_score_ranked <span class="ot">&lt;-</span> <span class="fu">sort</span>(feature_scores, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>top_5_features <span class="ot">&lt;-</span> <span class="fu">names</span>(feature_score_ranked[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="co"># show the names of the top 5 features</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>top_5_features</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "feature38" "feature15" "feature43" "feature47" "feature53"</code></pre>
</div>
</div>
<p>Now, we show the scores (and +/- sign)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>pca<span class="sc">$</span>rotation[top_5_features, <span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> feature38  feature15  feature43  feature47  feature53 
-0.1042985  0.1042909 -0.1042813 -0.1042760  0.1042701 </code></pre>
</div>
</div>
</section>
<section id="example-2" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="example-2">Example 2</h3>
<p>In this example, we explore the use of PCA for survey data. Specifically, we want to use PCA to check if 5 items reflect the underlying factor appropriately or if one of the items needs to be replaced.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>surveydata <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="fu">url</span>(<span class="st">"https://slcladal.github.io/data/sud.rda"</span>, <span class="st">"rb"</span>))</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>flextable<span class="sc">::</span><span class="fu">flextable</span>(<span class="fu">head</span>(surveydata, <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-d68648f4{}.cl-d6824c36{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-d68396fe{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-d68396ff{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-d683a4c8{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d683a4c9{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d683a4d2{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d683a4dc{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d683a4dd{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d683a4e6{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-d68648f4"><thead><tr style="overflow-wrap:break-word;"><th class="cl-d683a4c8"><p class="cl-d68396fe"><span class="cl-d6824c36">Respondent</span></p></th><th class="cl-d683a4c9"><p class="cl-d68396ff"><span class="cl-d6824c36">Q01_Outgoing</span></p></th><th class="cl-d683a4c9"><p class="cl-d68396ff"><span class="cl-d6824c36">Q02_Outgoing</span></p></th><th class="cl-d683a4c9"><p class="cl-d68396ff"><span class="cl-d6824c36">Q03_Outgoing</span></p></th><th class="cl-d683a4c9"><p class="cl-d68396ff"><span class="cl-d6824c36">Q04_Outgoing</span></p></th><th class="cl-d683a4c9"><p class="cl-d68396ff"><span class="cl-d6824c36">Q05_Outgoing</span></p></th><th class="cl-d683a4c9"><p class="cl-d68396ff"><span class="cl-d6824c36">Q06_Intelligence</span></p></th><th class="cl-d683a4c9"><p class="cl-d68396ff"><span class="cl-d6824c36">Q07_Intelligence</span></p></th><th class="cl-d683a4c9"><p class="cl-d68396ff"><span class="cl-d6824c36">Q08_Intelligence</span></p></th><th class="cl-d683a4c9"><p class="cl-d68396ff"><span class="cl-d6824c36">Q09_Intelligence</span></p></th><th class="cl-d683a4c9"><p class="cl-d68396ff"><span class="cl-d6824c36">Q10_Intelligence</span></p></th><th class="cl-d683a4c9"><p class="cl-d68396ff"><span class="cl-d6824c36">Q11_Attitude</span></p></th><th class="cl-d683a4c9"><p class="cl-d68396ff"><span class="cl-d6824c36">Q12_Attitude</span></p></th><th class="cl-d683a4c9"><p class="cl-d68396ff"><span class="cl-d6824c36">Q13_Attitude</span></p></th><th class="cl-d683a4c9"><p class="cl-d68396ff"><span class="cl-d6824c36">Q14_Attitude</span></p></th><th class="cl-d683a4c9"><p class="cl-d68396ff"><span class="cl-d6824c36">Q15_Attitude</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-d683a4d2"><p class="cl-d68396fe"><span class="cl-d6824c36">Respondent_01</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">4</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">4</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">4</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">2</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">3</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">3</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">2</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">2</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">3</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">3</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">2</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">3</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">3</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d683a4d2"><p class="cl-d68396fe"><span class="cl-d6824c36">Respondent_02</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">4</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">4</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">4</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">2</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">2</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">2</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">1</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">2</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">4</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">4</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">4</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">4</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d683a4d2"><p class="cl-d68396fe"><span class="cl-d6824c36">Respondent_03</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">4</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">4</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">2</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">1</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">1</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">2</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">2</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">4</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">4</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">4</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">4</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d683a4d2"><p class="cl-d68396fe"><span class="cl-d6824c36">Respondent_04</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">4</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">1</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">1</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">1</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">1</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">1</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">4</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d683a4d2"><p class="cl-d68396fe"><span class="cl-d6824c36">Respondent_05</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">4</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">4</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">2</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">2</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">1</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">2</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">1</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">4</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">4</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d683a4d2"><p class="cl-d68396fe"><span class="cl-d6824c36">Respondent_06</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">4</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">4</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">2</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">2</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">1</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">2</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">1</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">2</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d683a4d2"><p class="cl-d68396fe"><span class="cl-d6824c36">Respondent_07</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">4</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">4</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">4</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">4</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">4</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">2</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">1</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">1</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">2</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d683a4d2"><p class="cl-d68396fe"><span class="cl-d6824c36">Respondent_08</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">4</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">4</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">4</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">4</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">4</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">1</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">2</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">1</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">1</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">2</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d683a4d2"><p class="cl-d68396fe"><span class="cl-d6824c36">Respondent_09</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">4</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">4</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">4</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">4</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">4</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">1</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">2</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">2</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">1</span></p></td><td class="cl-d683a4dc"><p class="cl-d68396ff"><span class="cl-d6824c36">2</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d683a4dd"><p class="cl-d68396fe"><span class="cl-d6824c36">Respondent_10</span></p></td><td class="cl-d683a4e6"><p class="cl-d68396ff"><span class="cl-d6824c36">4</span></p></td><td class="cl-d683a4e6"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4e6"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4e6"><p class="cl-d68396ff"><span class="cl-d6824c36">4</span></p></td><td class="cl-d683a4e6"><p class="cl-d68396ff"><span class="cl-d6824c36">4</span></p></td><td class="cl-d683a4e6"><p class="cl-d68396ff"><span class="cl-d6824c36">4</span></p></td><td class="cl-d683a4e6"><p class="cl-d68396ff"><span class="cl-d6824c36">4</span></p></td><td class="cl-d683a4e6"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4e6"><p class="cl-d68396ff"><span class="cl-d6824c36">4</span></p></td><td class="cl-d683a4e6"><p class="cl-d68396ff"><span class="cl-d6824c36">5</span></p></td><td class="cl-d683a4e6"><p class="cl-d68396ff"><span class="cl-d6824c36">2</span></p></td><td class="cl-d683a4e6"><p class="cl-d68396ff"><span class="cl-d6824c36">1</span></p></td><td class="cl-d683a4e6"><p class="cl-d68396ff"><span class="cl-d6824c36">2</span></p></td><td class="cl-d683a4e6"><p class="cl-d68396ff"><span class="cl-d6824c36">2</span></p></td><td class="cl-d683a4e6"><p class="cl-d68396ff"><span class="cl-d6824c36">1</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>We now implement the PCA.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># entering raw data and extracting PCs  from the correlation matrix</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>pca_res2 <span class="ot">&lt;-</span> <span class="fu">princomp</span>(surveydata[<span class="fu">c</span>(</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Q01_Outgoing"</span>,</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Q02_Outgoing"</span>,</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Q03_Outgoing"</span>,</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Q04_Outgoing"</span>,</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Q05_Outgoing"</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>)])</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="co"># print variance accounted for</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pca_res2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                          Comp.1     Comp.2     Comp.3     Comp.4      Comp.5
Standard deviation     3.2317383 0.62656643 0.50633614 0.44585671 0.332592305
Proportion of Variance 0.9159511 0.03442977 0.02248422 0.01743374 0.009701174
Cumulative Proportion  0.9159511 0.95038087 0.97286509 0.99029883 1.000000000</code></pre>
</div>
</div>
<p>The cumulative proportion of variance already shows that the five items represent a single underlying factor as 91.5% of the variance is explained by PC1 alone!</p>
<p>The loading scores for PC1 are very similar for all items and thus show that none of the items under performs. In such a case, it might make sense to remove items, not because they do not capture the underlying concept but to reduce the items for participants.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare data</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>pca2.var <span class="ot">&lt;-</span> pca_res2<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="co"># extract percentage of contribution</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>pca2.var.per <span class="ot">&lt;-</span> <span class="fu">round</span>(pca.var <span class="sc">/</span> <span class="fu">sum</span>(pca.var) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="co"># generate data frame for visualization</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Component =</span> <span class="fu">paste0</span>(<span class="st">"PC"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>),</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Percent =</span> <span class="fu">round</span>(pca2.var <span class="sc">/</span> <span class="fu">sum</span>(pca2.var) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>)</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Text =</span> <span class="fu">paste0</span>(Percent, <span class="st">"%"</span>),</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Component =</span> <span class="fu">factor</span>(Component,</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"PC1"</span>, <span class="st">"PC2"</span>, <span class="st">"PC3"</span>, <span class="st">"PC4"</span>, <span class="st">"PC5"</span>)</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Component, <span class="at">y =</span> Percent, <span class="at">label =</span> Text)) <span class="sc">+</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">vjust =</span> <span class="sc">-</span><span class="fl">1.6</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Scree Plot"</span>) <span class="sc">+</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Principal Components"</span>, <span class="at">y =</span> <span class="st">"Percent Variation"</span>) <span class="sc">+</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dimred_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We now plot the loading scores for each participant to see if we can see groups among the participants based on outgoingness.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>pca_res2<span class="sc">$</span>scores <span class="sc">%&gt;%</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">PC1 =</span> <span class="dv">1</span>,</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">PC2 =</span> <span class="dv">2</span>,</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">PC3 =</span> <span class="dv">3</span>,</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">PC4 =</span> <span class="dv">4</span>,</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">PC5 =</span> <span class="dv">5</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Participants =</span> <span class="fu">paste0</span>(<span class="st">"P"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>),</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">clr =</span> <span class="fu">ifelse</span>(PC1 <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PC1, <span class="at">y =</span> PC2, <span class="at">color =</span> clr, <span class="at">label =</span> Participants)) <span class="sc">+</span></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">nudge_x =</span> <span class="sc">-</span>.<span class="dv">2</span>, <span class="at">check_overlap =</span> T) <span class="sc">+</span></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_b</span>() <span class="sc">+</span></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dimred_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The figure shows that based on PC1, we can distinguish between subjects who are very outgoign and subjects that are not very outgoing.</p>
</section>
<section id="example-3" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="example-3">Example 3</h3>
<p>In this example, we use the <code>biopsy</code> data to see what variables can be used to predict malignant melanomas.</p>
<p>In a first step, we remove any data points with missing values and add meaningful variable names.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(biopsy)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>biopsy_nona <span class="ot">&lt;-</span> biopsy <span class="sc">%&gt;%</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">drop_na</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add meaningful variable names</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">ClumpSize =</span> V1,</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">CellSize =</span> V2,</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">CellShape =</span> V3,</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Adhesion =</span> V4,</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">EpithelialSize =</span> V5,</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Nuclei =</span> V6,</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Chromatin =</span> V7,</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Nucleoli =</span> V8,</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mitoses =</span> V9</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect data</span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>flextable<span class="sc">::</span><span class="fu">flextable</span>(<span class="fu">head</span>(biopsy_nona, <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-d6b882ce{}.cl-d6b53362{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-d6b67f60{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-d6b67f6a{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-d6b68c58{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d6b68c59{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d6b68c62{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d6b68c63{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d6b68c6c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d6b68c6d{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-d6b882ce"><thead><tr style="overflow-wrap:break-word;"><th class="cl-d6b68c58"><p class="cl-d6b67f60"><span class="cl-d6b53362">ID</span></p></th><th class="cl-d6b68c59"><p class="cl-d6b67f6a"><span class="cl-d6b53362">ClumpSize</span></p></th><th class="cl-d6b68c59"><p class="cl-d6b67f6a"><span class="cl-d6b53362">CellSize</span></p></th><th class="cl-d6b68c59"><p class="cl-d6b67f6a"><span class="cl-d6b53362">CellShape</span></p></th><th class="cl-d6b68c59"><p class="cl-d6b67f6a"><span class="cl-d6b53362">Adhesion</span></p></th><th class="cl-d6b68c59"><p class="cl-d6b67f6a"><span class="cl-d6b53362">EpithelialSize</span></p></th><th class="cl-d6b68c59"><p class="cl-d6b67f6a"><span class="cl-d6b53362">Nuclei</span></p></th><th class="cl-d6b68c59"><p class="cl-d6b67f6a"><span class="cl-d6b53362">Chromatin</span></p></th><th class="cl-d6b68c59"><p class="cl-d6b67f6a"><span class="cl-d6b53362">Nucleoli</span></p></th><th class="cl-d6b68c59"><p class="cl-d6b67f6a"><span class="cl-d6b53362">Mitoses</span></p></th><th class="cl-d6b68c58"><p class="cl-d6b67f60"><span class="cl-d6b53362">class</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-d6b68c62"><p class="cl-d6b67f60"><span class="cl-d6b53362">1000025</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">5</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">1</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">1</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">1</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">2</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">1</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">3</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">1</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">1</span></p></td><td class="cl-d6b68c62"><p class="cl-d6b67f60"><span class="cl-d6b53362">benign</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d6b68c62"><p class="cl-d6b67f60"><span class="cl-d6b53362">1002945</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">5</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">4</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">4</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">5</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">7</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">10</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">3</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">2</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">1</span></p></td><td class="cl-d6b68c62"><p class="cl-d6b67f60"><span class="cl-d6b53362">benign</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d6b68c62"><p class="cl-d6b67f60"><span class="cl-d6b53362">1015425</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">3</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">1</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">1</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">1</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">2</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">2</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">3</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">1</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">1</span></p></td><td class="cl-d6b68c62"><p class="cl-d6b67f60"><span class="cl-d6b53362">benign</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d6b68c62"><p class="cl-d6b67f60"><span class="cl-d6b53362">1016277</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">6</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">8</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">8</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">1</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">3</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">4</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">3</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">7</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">1</span></p></td><td class="cl-d6b68c62"><p class="cl-d6b67f60"><span class="cl-d6b53362">benign</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d6b68c62"><p class="cl-d6b67f60"><span class="cl-d6b53362">1017023</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">4</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">1</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">1</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">3</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">2</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">1</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">3</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">1</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">1</span></p></td><td class="cl-d6b68c62"><p class="cl-d6b67f60"><span class="cl-d6b53362">benign</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d6b68c62"><p class="cl-d6b67f60"><span class="cl-d6b53362">1017122</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">8</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">10</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">10</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">8</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">7</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">10</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">9</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">7</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">1</span></p></td><td class="cl-d6b68c62"><p class="cl-d6b67f60"><span class="cl-d6b53362">malignant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d6b68c62"><p class="cl-d6b67f60"><span class="cl-d6b53362">1018099</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">1</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">1</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">1</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">1</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">2</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">10</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">3</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">1</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">1</span></p></td><td class="cl-d6b68c62"><p class="cl-d6b67f60"><span class="cl-d6b53362">benign</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d6b68c62"><p class="cl-d6b67f60"><span class="cl-d6b53362">1018561</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">2</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">1</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">2</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">1</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">2</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">1</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">3</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">1</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">1</span></p></td><td class="cl-d6b68c62"><p class="cl-d6b67f60"><span class="cl-d6b53362">benign</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d6b68c62"><p class="cl-d6b67f60"><span class="cl-d6b53362">1033078</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">2</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">1</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">1</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">1</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">2</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">1</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">1</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">1</span></p></td><td class="cl-d6b68c63"><p class="cl-d6b67f6a"><span class="cl-d6b53362">5</span></p></td><td class="cl-d6b68c62"><p class="cl-d6b67f60"><span class="cl-d6b53362">benign</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d6b68c6c"><p class="cl-d6b67f60"><span class="cl-d6b53362">1033078</span></p></td><td class="cl-d6b68c6d"><p class="cl-d6b67f6a"><span class="cl-d6b53362">4</span></p></td><td class="cl-d6b68c6d"><p class="cl-d6b67f6a"><span class="cl-d6b53362">2</span></p></td><td class="cl-d6b68c6d"><p class="cl-d6b67f6a"><span class="cl-d6b53362">1</span></p></td><td class="cl-d6b68c6d"><p class="cl-d6b67f6a"><span class="cl-d6b53362">1</span></p></td><td class="cl-d6b68c6d"><p class="cl-d6b67f6a"><span class="cl-d6b53362">2</span></p></td><td class="cl-d6b68c6d"><p class="cl-d6b67f6a"><span class="cl-d6b53362">1</span></p></td><td class="cl-d6b68c6d"><p class="cl-d6b67f6a"><span class="cl-d6b53362">2</span></p></td><td class="cl-d6b68c6d"><p class="cl-d6b67f6a"><span class="cl-d6b53362">1</span></p></td><td class="cl-d6b68c6d"><p class="cl-d6b67f6a"><span class="cl-d6b53362">1</span></p></td><td class="cl-d6b68c6c"><p class="cl-d6b67f60"><span class="cl-d6b53362">benign</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>Next, we remove non-numeric variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>biopsy_num <span class="ot">&lt;-</span> biopsy_nona <span class="sc">%&gt;%</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select_if</span>(is.numeric)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect data</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>flextable<span class="sc">::</span><span class="fu">flextable</span>(<span class="fu">head</span>(biopsy_num, <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-d6c78bb6{}.cl-d6c36fcc{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-d6c4b9f4{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-d6c4c5f2{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d6c4c5fc{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d6c4c5fd{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-d6c78bb6"><thead><tr style="overflow-wrap:break-word;"><th class="cl-d6c4c5f2"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">ClumpSize</span></p></th><th class="cl-d6c4c5f2"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">CellSize</span></p></th><th class="cl-d6c4c5f2"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">CellShape</span></p></th><th class="cl-d6c4c5f2"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">Adhesion</span></p></th><th class="cl-d6c4c5f2"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">EpithelialSize</span></p></th><th class="cl-d6c4c5f2"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">Nuclei</span></p></th><th class="cl-d6c4c5f2"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">Chromatin</span></p></th><th class="cl-d6c4c5f2"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">Nucleoli</span></p></th><th class="cl-d6c4c5f2"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">Mitoses</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">5</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">1</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">1</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">1</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">2</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">1</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">3</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">1</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">5</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">4</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">4</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">5</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">7</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">10</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">3</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">2</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">3</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">1</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">1</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">1</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">2</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">2</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">3</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">1</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">6</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">8</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">8</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">1</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">3</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">4</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">3</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">7</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">4</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">1</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">1</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">3</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">2</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">1</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">3</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">1</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">8</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">10</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">10</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">8</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">7</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">10</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">9</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">7</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">1</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">1</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">1</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">1</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">2</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">10</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">3</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">1</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">2</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">1</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">2</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">1</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">2</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">1</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">3</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">1</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">2</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">1</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">1</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">1</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">2</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">1</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">1</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">1</span></p></td><td class="cl-d6c4c5fc"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">5</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d6c4c5fd"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">4</span></p></td><td class="cl-d6c4c5fd"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">2</span></p></td><td class="cl-d6c4c5fd"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">1</span></p></td><td class="cl-d6c4c5fd"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">1</span></p></td><td class="cl-d6c4c5fd"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">2</span></p></td><td class="cl-d6c4c5fd"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">1</span></p></td><td class="cl-d6c4c5fd"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">2</span></p></td><td class="cl-d6c4c5fd"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">1</span></p></td><td class="cl-d6c4c5fd"><p class="cl-d6c4b9f4"><span class="cl-d6c36fcc">1</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>We can perform the PCA.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>biopsy_pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(biopsy_num,</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">scale =</span> T</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co"># summary</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(biopsy_pca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                          PC1     PC2     PC3     PC4     PC5     PC6     PC7
Standard deviation     2.4289 0.88088 0.73434 0.67796 0.61667 0.54943 0.54259
Proportion of Variance 0.6555 0.08622 0.05992 0.05107 0.04225 0.03354 0.03271
Cumulative Proportion  0.6555 0.74172 0.80163 0.85270 0.89496 0.92850 0.96121
                           PC8     PC9
Standard deviation     0.51062 0.29729
Proportion of Variance 0.02897 0.00982
Cumulative Proportion  0.99018 1.00000</code></pre>
</div>
</div>
<p>First, we create a scree plot of the variance captured by each component.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>factoextra<span class="sc">::</span><span class="fu">fviz_eig</span>(biopsy_pca,</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">addlabels =</span> T,</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">80</span>),</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">barfill =</span> <span class="st">"gray50"</span>,</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">barcolor =</span> <span class="st">"gray20"</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dimred_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We now create a pretty biplot to show the results of the PCA.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_biplot</span>(biopsy_pca,</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">geom =</span> <span class="st">"point"</span>,</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># no data point labels</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="st">"var"</span>,</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># color by class</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">habillage =</span> biopsy_nona<span class="sc">$</span>class,</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># change variable color</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">col.var =</span> <span class="st">"black"</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># adapt data point color</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"orange"</span>, <span class="st">"purple"</span>)) <span class="sc">+</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add title</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"A pretty biplot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dimred_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The plot above is also known as variable correlation plot or biplot. A biplot overlays a score plot with a loading plot and thus shows individual data points as well as the relationships between all variables (in the form of arrows). It can be interpreted as follow:</p>
<ul>
<li>Positively correlated variables are grouped together.<br>
</li>
<li>Negatively correlated variables would be positioned on opposite sides of the plot origin (opposed quadrants).<br>
</li>
<li>The distance between variables and the origin measures the quality of the variables on the factor map.<br>
</li>
<li>Variables that are away from the origin are well represented on the factor map.</li>
</ul>
<p>But why are all variables cluster together?</p>
<p>Let’s have a look at the correlations between variables.</p>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-d6ffe6f0{}.cl-d6fcaf26{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-d6fdf25a{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-d6fe002e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d6fe002f{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d6fe0038{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-d6ffe6f0"><thead><tr style="overflow-wrap:break-word;"><th class="cl-d6fe002e"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">ClumpSize</span></p></th><th class="cl-d6fe002e"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">CellSize</span></p></th><th class="cl-d6fe002e"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">CellShape</span></p></th><th class="cl-d6fe002e"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">Adhesion</span></p></th><th class="cl-d6fe002e"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">EpithelialSize</span></p></th><th class="cl-d6fe002e"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">Nuclei</span></p></th><th class="cl-d6fe002e"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">Chromatin</span></p></th><th class="cl-d6fe002e"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">Nucleoli</span></p></th><th class="cl-d6fe002e"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">Mitoses</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">1.0000000</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.6424815</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.6534700</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.4878287</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.5235960</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.5930914</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.5537424</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.5340659</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.3509572</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.6424815</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">1.0000000</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.9072282</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.7069770</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.7535440</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.6917088</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.7555592</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.7193460</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.4607547</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.6534700</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.9072282</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">1.0000000</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.6859481</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.7224624</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.7138775</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.7353435</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.7179634</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.4412576</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.4878287</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.7069770</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.6859481</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">1.0000000</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.5945478</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.6706483</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.6685671</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.6031211</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.4188983</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.5235960</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.7535440</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.7224624</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.5945478</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">1.0000000</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.5857161</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.6181279</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.6289264</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.4805833</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.5930914</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.6917088</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.7138775</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.6706483</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.5857161</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">1.0000000</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.6806149</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.5842802</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.3392104</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.5537424</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.7555592</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.7353435</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.6685671</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.6181279</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.6806149</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">1.0000000</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.6656015</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.3460109</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.5340659</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.7193460</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.7179634</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.6031211</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.6289264</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.5842802</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.6656015</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">1.0000000</span></p></td><td class="cl-d6fe002f"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.4337573</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d6fe0038"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.3509572</span></p></td><td class="cl-d6fe0038"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.4607547</span></p></td><td class="cl-d6fe0038"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.4412576</span></p></td><td class="cl-d6fe0038"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.4188983</span></p></td><td class="cl-d6fe0038"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.4805833</span></p></td><td class="cl-d6fe0038"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.3392104</span></p></td><td class="cl-d6fe0038"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.3460109</span></p></td><td class="cl-d6fe0038"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">0.4337573</span></p></td><td class="cl-d6fe0038"><p class="cl-d6fdf25a"><span class="cl-d6fcaf26">1.0000000</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>The correlation matrix shows that all variables are positively correlated which explains why all variables cluster together. The low correlations between the other variables and <em>Mitosis</em> explain why it stands out.</p>
</section>
</section>
<section id="multidimensional-scaling" class="level1 unnumbered">
<h1 class="unnumbered">Multidimensional Scaling</h1>
<p>Multidimensional Scaling (MDS, see <span class="citation" data-cites="davison1983introduction">Davison (<a href="#ref-davison1983introduction" role="doc-biblioref">1983</a>)</span> or <span class="citation" data-cites="jacoby2018multidimensional">Jacoby and Ciuk (<a href="#ref-jacoby2018multidimensional" role="doc-biblioref">2018</a>)</span>) is used for visualizing high-dimensional data in a lower-dimensional space <strong>while preserving pairwise distances</strong> or similarities between data points. MDS aims to represent the data in a way that maintains the relationships among data points as much as possible.</p>
<p>There are two types of MDS:</p>
<ul>
<li><p><strong>metric or classical MDS</strong>: metric MDS aims to represent the distances between objects in a way that preserves the original dissimilarity/similarity relationships as accurately as possible. It assumes that the input data reflects actual distances or dissimilarities and it uses algorithms such as <em>Principal Coordinate Analysis</em> (PCoA) to transform the data into a lower-dimensional space while trying to maintain the original pairwise distances.</p></li>
<li><p><strong>non-metric MDS</strong>: non-metric MDS aims to represent the rank order of the distances or dissimilarities between objects, rather than the actual distances. It is more suitable when the input data does not have a direct metric interpretation or when the distances are only known in terms of ordinal rankings.</p></li>
</ul>
<p>MDS works exactly like PCA with one important difference: <strong>while PCA starts off with correlations between variables (the covariance matrix), MDS start of with distances (and thus relies on a distance matrix)!</strong></p>
<section id="example-1-1" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="example-1-1">Example 1</h3>
<p>We begin by loading data. This fictitious data set represents responses to 15 items by 20 participants. The 15 items aim to assess 3 different psychological constructs:</p>
<ul>
<li><p>outgoingness (extroversion)</p></li>
<li><p>intelligence</p></li>
<li><p>attitude</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>surveydata <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="fu">url</span>(<span class="st">"https://slcladal.github.io/data/sud.rda"</span>, <span class="st">"rb"</span>))</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(surveydata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The data contains 20 observations of the following 16 variables:

  - Respondent: 20 entries, such as Respondent_01 (n = 1); Respondent_02 (n = 1);
Respondent_03 (n = 1) and 17 others (0 missing)
  - Q01_Outgoing: n = 20, Mean = 3.15, SD = 1.53, Median = 3.50, MAD = 2.22,
range: [1, 5], Skewness = -0.18, Kurtosis = -1.52, 0 missing
  - Q02_Outgoing: n = 20, Mean = 3.25, SD = 1.59, Median = 3.50, MAD = 2.22,
range: [1, 5], Skewness = -0.10, Kurtosis = -1.73, 0 missing
  - Q03_Outgoing: n = 20, Mean = 3.15, SD = 1.50, Median = 3.50, MAD = 2.22,
range: [1, 5], Skewness = -0.07, Kurtosis = -1.58, 0 missing
  - Q04_Outgoing: n = 20, Mean = 3.00, SD = 1.56, Median = 3.50, MAD = 2.22,
range: [1, 5], Skewness = -0.09, Kurtosis = -1.64, 0 missing
  - Q05_Outgoing: n = 20, Mean = 3.20, SD = 1.58, Median = 3.50, MAD = 2.22,
range: [1, 5], Skewness = -0.19, Kurtosis = -1.59, 0 missing
  - Q06_Intelligence: n = 20, Mean = 2.90, SD = 1.45, Median = 2.00, MAD = 1.48,
range: [1, 5], Skewness = 0.31, Kurtosis = -1.43, 0 missing
  - Q07_Intelligence: n = 20, Mean = 3.05, SD = 1.39, Median = 3.00, MAD = 1.48,
range: [1, 5], Skewness = 0.03, Kurtosis = -1.24, 0 missing
  - Q08_Intelligence: n = 20, Mean = 2.95, SD = 1.54, Median = 2.50, MAD = 2.22,
range: [1, 5], Skewness = 0.19, Kurtosis = -1.54, 0 missing
  - Q09_Intelligence: n = 20, Mean = 2.80, SD = 1.51, Median = 2.00, MAD = 1.48,
range: [1, 5], Skewness = 0.38, Kurtosis = -1.48, 0 missing
  - Q10_Intelligence: n = 20, Mean = 3.60, SD = 1.50, Median = 4.00, MAD = 1.48,
range: [1, 5], Skewness = -0.58, Kurtosis = -1.33, 0 missing
  - Q11_Attitude: n = 20, Mean = 2.75, SD = 1.62, Median = 2.50, MAD = 2.22,
range: [1, 5], Skewness = 0.20, Kurtosis = -1.65, 0 missing
  - Q12_Attitude: n = 20, Mean = 2.95, SD = 1.43, Median = 2.50, MAD = 2.22,
range: [1, 5], Skewness = 0.22, Kurtosis = -1.40, 0 missing
  - Q13_Attitude: n = 20, Mean = 2.75, SD = 1.65, Median = 2.00, MAD = 1.48,
range: [1, 5], Skewness = 0.21, Kurtosis = -1.77, 0 missing
  - Q14_Attitude: n = 20, Mean = 2.95, SD = 1.54, Median = 2.50, MAD = 2.22,
range: [1, 5], Skewness = 0.19, Kurtosis = -1.54, 0 missing
  - Q15_Attitude: n = 20, Mean = 2.95, SD = 1.70, Median = 2.50, MAD = 2.22,
range: [1, 5], Skewness = 0.09, Kurtosis = -1.82, 0 missing</code></pre>
</div>
</div>
<p>As MDS, like PCA and FA, works only on numeric data, we remove non-numeric variables from the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>surveydata <span class="ot">&lt;-</span> surveydata <span class="sc">%&gt;%</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>Respondent)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(surveydata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   20 obs. of  15 variables:
 $ Q01_Outgoing    : int  4 5 5 5 4 5 4 4 5 4 ...
 $ Q02_Outgoing    : int  5 4 4 5 5 5 5 4 5 5 ...
 $ Q03_Outgoing    : int  4 5 4 5 4 5 4 5 4 5 ...
 $ Q04_Outgoing    : int  4 4 5 4 5 5 5 4 4 4 ...
 $ Q05_Outgoing    : int  5 4 5 5 5 4 5 5 4 4 ...
 $ Q06_Intelligence: int  2 2 2 1 2 5 4 5 5 4 ...
 $ Q07_Intelligence: int  3 2 1 1 2 4 5 4 5 4 ...
 $ Q08_Intelligence: int  3 2 1 1 1 5 4 5 4 5 ...
 $ Q09_Intelligence: int  2 1 2 1 2 2 4 4 4 4 ...
 $ Q10_Intelligence: int  2 2 2 1 1 2 5 5 5 5 ...
 $ Q11_Attitude    : int  3 4 5 5 4 1 2 1 1 2 ...
 $ Q12_Attitude    : int  3 4 4 4 5 2 1 2 2 1 ...
 $ Q13_Attitude    : int  2 4 4 5 4 1 1 1 2 2 ...
 $ Q14_Attitude    : int  3 5 4 5 5 2 2 1 1 2 ...
 $ Q15_Attitude    : int  3 4 4 5 5 1 1 2 2 1 ...</code></pre>
</div>
</div>
<p>For MDS, we first calculate the distance matrix using the Euclidian distance. Note that we are transposing, scaling and centering the data just like for PCA.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>survey_dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(<span class="fu">scale</span>(<span class="fu">t</span>(surveydata), <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>),</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"euclidean"</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, we generate an MDS object (this is basically eigenvalue decomposition)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>mds.obj <span class="ot">&lt;-</span> <span class="fu">cmdscale</span>(survey_dist,</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">eig =</span> <span class="cn">TRUE</span>, <span class="co"># adds a matrix of eignevalues to the mds object</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x.ret =</span> <span class="cn">TRUE</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>) <span class="co"># adds a symmetric distance matrix to the mds object</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, we calculate the percentage of variation that each MDS axis accounts for…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>mds.var.per <span class="ot">&lt;-</span> <span class="fu">round</span>(mds.obj<span class="sc">$</span>eig <span class="sc">/</span> <span class="fu">sum</span>(mds.obj<span class="sc">$</span>eig) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>mds.var.per</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 54.8 29.0  4.8  2.7  2.1  1.7  1.5  1.0  0.9  0.6  0.4  0.3  0.1  0.0  0.0</code></pre>
</div>
</div>
<p>We make a fancy looking plot that shows the MDS axes and the variation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>mds.values <span class="ot">&lt;-</span> mds.obj<span class="sc">$</span>points</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>mds.data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sample =</span> <span class="fu">rownames</span>(mds.values),</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> mds.values[, <span class="dv">1</span>],</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y =</span> mds.values[, <span class="dv">2</span>]</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>mds.data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                           Sample          X          Y
Q01_Outgoing         Q01_Outgoing  1.2441258 -2.9521948
Q02_Outgoing         Q02_Outgoing  1.3832771 -3.2215742
Q03_Outgoing         Q03_Outgoing  0.8464687 -2.8364303
Q04_Outgoing         Q04_Outgoing  0.6884322 -3.1352690
Q05_Outgoing         Q05_Outgoing  0.3742058 -3.2123840
Q06_Intelligence Q06_Intelligence  3.7001253  1.1236968
Q07_Intelligence Q07_Intelligence  3.4292730  1.8623706
Q08_Intelligence Q08_Intelligence  4.0132660  1.5106590
Q09_Intelligence Q09_Intelligence  3.8680562  2.5632774
Q10_Intelligence Q10_Intelligence  1.5665476  3.9359300
Q11_Attitude         Q11_Attitude -4.4171807  0.6011738
Q12_Attitude         Q12_Attitude -3.8486419  1.2134235
Q13_Attitude         Q13_Attitude -4.6650593  1.4927673
Q14_Attitude         Q14_Attitude -3.8067797  0.1881540
Q15_Attitude         Q15_Attitude -4.3761161  0.8663999</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mds.data, <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y, <span class="at">label =</span> Sample)) <span class="sc">+</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>() <span class="sc">+</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">paste</span>(<span class="st">"MDS1 - "</span>, mds.var.per[<span class="dv">1</span>], <span class="st">"%"</span>, <span class="at">sep =</span> <span class="st">""</span>)) <span class="sc">+</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">paste</span>(<span class="st">"MDS2 - "</span>, mds.var.per[<span class="dv">2</span>], <span class="st">"%"</span>, <span class="at">sep =</span> <span class="st">""</span>)) <span class="sc">+</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"MDS plot using Euclidean distance"</span>) <span class="sc">+</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">7</span>, <span class="dv">7</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dimred_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The plot shows that we are dealing with 3 groups that are neatly separated along 2 dimensions. We also see that Q10 behaves different from the other items aiming to assess IQ. We could use this to optimize the item set of our survey.</p>
</section>
</section>
<section id="factor-analysis" class="level1 unnumbered">
<h1 class="unnumbered">Factor Analysis</h1>
<p>Factor Analysis is used to identify underlying latent factors that explain the observed correlations among variables in a data set <span class="citation" data-cites="kim1978introduction field2012discovering">(<a href="#ref-kim1978introduction" role="doc-biblioref">Kim and Mueller 1978</a>; <a href="#ref-field2012discovering" role="doc-biblioref">Field, Miles, and Field, 749–811</a>)</span>. It aims to reduce the complexity of high-dimensional data by identifying a smaller number of factors (latent variables) that contribute to the variance and covariance among (observed) variables. Ideally those observed variables that represent an underlying factor should be highly correlated with each other but not correlated with (observed) variables that represent other factors (underlying variables). Like PCA and MDS, we find factors by aiming to reduce variability in the data but unlike PCA, which is based on a co-variance matrix, or MDS, which is based on a distance matrix, EFA is based on a correlation matrix.</p>
<p>There are two types of factor analysis:</p>
<ul>
<li><p>exploratory factor analysis (EFA)</p></li>
<li><p>confirmatory factor analysis (CFA)</p></li>
</ul>
<p>Here, we are only going to look at EFA which is used to identify how many latent variables (factors) are present in a data set. In contrast to CFA, EFA allows factors to be correlated with each other and it uses a rotation step to transform the initial factor structure into a more interpretable form. The rotation aims to maximize the loadings of variables on only a single factor and it thereby maximizes the separation between factors. Common rotation methods include <em>Varimax</em>, <em>Oblimin</em>, and <em>Promax</em>. The <em>Varimax</em> rotation is an orthogonal rotation and it is the most common rotation method. It assumes that the factors are not correlated; another type of rotation are <em>oblique</em> rotations, such as <em>Oblimin</em> and <em>Promax</em>, which do not assume that the factors are not correlated <span class="citation" data-cites="field2012discovering">(<a href="#ref-field2012discovering" role="doc-biblioref">Field, Miles, and Field, 755</a>)</span>.</p>
<p>CFA is used for hypothesis testing to confirm structures assumed to be present in the data. In R, we can use the <code>sem</code> or <code>lavaan</code> packages that implement Structural Equation Models (SEM)) to implement CFA and test specific hypothesis about the existence and interactions of latent factors.</p>
<section id="example-1-2" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="example-1-2">Example 1</h3>
<p>We continue with the survey data set and we can now implement the EFA using the <code>factanal</code> function from the base <code>stats</code> package. Although <code>factanal</code> implements a EFA, we need to provide it with the number of factors (latent variables) it should look for (commonly, you need to vary this to find the optimal number of factors).</p>
<p>As a first step, we generate a scree plot to assess how many factors are in our data. There are different approaches to interpret the output: (a) we choose the number of factors where there is a noticeable bend in the eigenvalues of the factors or, if there is no noticeable bend (the so-called <em>point of inflexion</em> <span class="citation" data-cites="field2012discovering">(<a href="#ref-field2012discovering" role="doc-biblioref">Field, Miles, and Field, 763</a>)</span>), (b) select the last value above 1 (following <span class="citation" data-cites="kaiser1960application">Kaiser (<a href="#ref-kaiser1960application" role="doc-biblioref">1960</a>)</span> - however, <span class="citation" data-cites="jolliffe1987rotation">Jolliffe (<a href="#ref-jolliffe1987rotation" role="doc-biblioref">1987</a>)</span> suggests using .7 as 1 is too strict) <span class="citation" data-cites="field2012discovering">(see <a href="#ref-field2012discovering" role="doc-biblioref">Field, Miles, and Field, 763</a> for more details on this discussion)</span>. Alternatively, we perform the analysis with different numbers of factors and then check if the <code>SS loadings</code> (the sum-of-squared loadings) of each factor has a value greater than 1.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract eigenvalues</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>eigenvalues <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cor</span>(surveydata))</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="co"># eigenvalues</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="co"># create scree plot</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>eigenvalues<span class="sc">$</span>values <span class="sc">%&gt;%</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Eigenvalues =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Factors =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(.)) <span class="sc">%&gt;%</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Factors, <span class="at">y =</span> Eigenvalues, <span class="at">label =</span> <span class="fu">round</span>(Eigenvalues, <span class="dv">2</span>))) <span class="sc">+</span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"lightgray"</span>) <span class="sc">+</span></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">vjust =</span> <span class="sc">-</span><span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Scree plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dimred_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>As there is a noticeable bend in the Eigenvalues of the factors at 3 factors, we are justified by assuming that there are 3 factors (latent or hidden variables) in our data. We can now perform the factor analysis and set the number of expected factors to 3.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>factoranalysis <span class="ot">&lt;-</span> <span class="fu">factanal</span>(</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  surveydata, <span class="co"># data</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">3</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>) <span class="co"># number of factors</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(factoranalysis,</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">digits =</span> <span class="dv">2</span>, <span class="co"># round to x decimals</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">cutoff =</span> .<span class="dv">2</span>, <span class="co"># do not show loadings smaller than .2</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">sort =</span> <span class="cn">TRUE</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>) <span class="co"># show items sorted</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
factanal(x = surveydata, factors = 3)

Uniquenesses:
    Q01_Outgoing     Q02_Outgoing     Q03_Outgoing     Q04_Outgoing 
            0.09             0.06             0.12             0.07 
    Q05_Outgoing Q06_Intelligence Q07_Intelligence Q08_Intelligence 
            0.14             0.10             0.13             0.10 
Q09_Intelligence Q10_Intelligence     Q11_Attitude     Q12_Attitude 
            0.28             0.41             0.08             0.14 
    Q13_Attitude     Q14_Attitude     Q15_Attitude 
            0.04             0.09             0.06 

Loadings:
                 Factor1 Factor2 Factor3
Q06_Intelligence -0.82    0.25    0.41  
Q07_Intelligence -0.80            0.47  
Q08_Intelligence -0.85            0.42  
Q09_Intelligence -0.79            0.29  
Q11_Attitude      0.96                  
Q12_Attitude      0.92                  
Q13_Attitude      0.97                  
Q14_Attitude      0.95                  
Q15_Attitude      0.96                  
Q01_Outgoing              0.94          
Q02_Outgoing              0.96          
Q03_Outgoing              0.93          
Q04_Outgoing              0.96          
Q05_Outgoing              0.92          
Q10_Intelligence -0.22   -0.46    0.57  

               Factor1 Factor2 Factor3
SS loadings       7.29    4.78    1.02
Proportion Var    0.49    0.32    0.07
Cumulative Var    0.49    0.80    0.87

Test of the hypothesis that 3 factors are sufficient.
The chi square statistic is 62.79 on 63 degrees of freedom.
The p-value is 0.484 </code></pre>
</div>
</div>
<p>Let us examine the output.</p>
<p>We start with the <em>function call</em>, followed by <em>uniqueness</em> scores. Uniqueness refers to the portion of the variance in an observed variable that is not explained by the underlying factors extracted from the data. It represents the variability in a variable that is unique to that variable and cannot be accounted for by the common factors identified in the analysis (uniqueness is the variance that is unique to that variable whereas commonness is the variance it shares with other variables or factors) <span class="citation" data-cites="field2012discovering">(see <a href="#ref-field2012discovering" role="doc-biblioref">Field, Miles, and Field, 759</a>)</span>. This means that items that do not capture or represent a latent variable well, will have high uniqueness scores (see, e.g., <em>Q10_Intelligence</em>).</p>
<p>Next, the output shows a table with factor loadings. <em>Loadings</em> are correlations between an observed variable and a latent factor. Loadings indicate how strongly each observed variable is associated with each extracted factor. They provide insights into which factors influence the variation in each observed variable. Factor loadings can be categorized as low (&lt;0.4), acceptable (0.4–0.6), or high <span class="citation" data-cites="stevens1992applied tabachnick2007using kline2014easy">(&gt;0.6 <a href="#ref-stevens1992applied" role="doc-biblioref">Stevens 1992</a>; <a href="#ref-tabachnick2007using" role="doc-biblioref">Tabachnick, Fidell, and Ullman 2007</a>; <a href="#ref-kline2014easy" role="doc-biblioref">Kline 2014</a>)</span>. The fact that Q10_Intelligence loads across factors shows that it does not represent its intended factor (IQ) not very well.</p>
<p>We then get a table showing the sum-of-squares loadings with the amount of variance explained by each latent variable which can help identify the optimal or necessary number of latent variables (factors) that we should or need to look for. As stated above, all factors should have a value greater than 1 - if there is a value below 1 for the <code>SS loadings</code>, then this could mean that at least one factor could be removed.</p>
<p>The p-value should not be significant (if it is significant, then you have missed factors). In our case, 2 factors would also report a non significant result due to the low number of data points (but p is highest for 3 factors). If this test is significant, then this suggests that you may need more factors than you currently have in your PA (but be careful: more factors can also lead to situations where you get factors that are more difficult to interpret. So make sure that the factors you include <em>make sense</em>).</p>
<p>We can now plot the results to see if and how the different items group together. We start by created a data frame from the FA results containing the information we need for the visualization.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>fadat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Factor1 =</span> factoranalysis<span class="sc">$</span>loadings[, <span class="dv">1</span>],</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Factor2 =</span> factoranalysis<span class="sc">$</span>loadings[, <span class="dv">2</span>],</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Items =</span> <span class="fu">names</span>(surveydata)</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(fadat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     Factor1   Factor2            Items
Q01_Outgoing     -0.13793094 0.9411952     Q01_Outgoing
Q02_Outgoing     -0.15957196 0.9560680     Q02_Outgoing
Q03_Outgoing     -0.06826263 0.9334254     Q03_Outgoing
Q04_Outgoing     -0.05828165 0.9619694     Q04_Outgoing
Q05_Outgoing      0.07146568 0.9228791     Q05_Outgoing
Q06_Intelligence -0.82137535 0.2535663 Q06_Intelligence</code></pre>
</div>
</div>
<p>Now, that the data is formatted appropriately, we can plot it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>fadat <span class="sc">%&gt;%</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Factor1, <span class="at">y =</span> Factor2, <span class="at">label =</span> Items, <span class="at">color =</span> Factor1)) <span class="sc">+</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>() <span class="sc">+</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="fl">1.5</span>)) <span class="sc">+</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_b</span>() <span class="sc">+</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Factor 1 (49 %)"</span>, <span class="at">y =</span> <span class="st">"Factor 2 (32 %)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="dimred_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>As we can see, there are 3 groups (factors) with <em>Q10_Intelligence</em> not aligning well with the other elements in that group. This could suggest that <em>Q10_Intelligence</em> is not an optimal item / variable for reflecting (or capturing) the latent intelligence factor.</p>
<p>That’s all folks!</p>
</section>
</section>
<section id="citation-session-info" class="level1 unnumbered">
<h1 class="unnumbered">Citation &amp; Session Info</h1>
<p>Schweinberger, Martin. 2023. <em>Introduction to Dimension Reduction Methods with R</em>. The University of Queensland, Australia. School of Languages and Culture. url: www.ladal.edu.au/dimred.html (Version 2023.09.09).</p>
<pre><code>@manual{schweinberger2023dimred,
  author = {Schweinberger, Martin},
  title = {Introduction to Dimension Reduction Methods with R},
  note = {www.ladal.edu.au/dimred.html},
    year = {2023},
  organization = {The University of Queensland, Australia. School of Languages and Cultures},
  address = {Brisbane},
  edition = {2023.09.09}
}</code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.4.1 (2024-06-14)
Platform: aarch64-apple-darwin20
Running under: macOS Sonoma 14.6.1

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: Australia/Brisbane
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] tufte_0.13       psych_2.4.6.26   report_0.5.9     factoextra_1.0.7
 [5] ggplot2_3.5.1    MASS_7.3-61      tidyr_1.3.1      stringr_1.5.1   
 [9] flextable_0.9.7  here_1.0.1       dplyr_1.1.4     

loaded via a namespace (and not attached):
 [1] gtable_0.3.6            xfun_0.49               htmlwidgets_1.6.4      
 [4] rstatix_0.7.2           insight_0.20.5          ggrepel_0.9.6          
 [7] lattice_0.22-6          vctrs_0.6.5             tools_4.4.1            
[10] generics_0.1.3          datawizard_0.13.0       parallel_4.4.1         
[13] tibble_3.2.1            fansi_1.0.6             pkgconfig_2.0.3        
[16] data.table_1.16.2       uuid_1.2-1              lifecycle_1.0.4        
[19] farver_2.1.2            compiler_4.4.1          textshaping_0.4.0      
[22] munsell_0.5.1           mnormt_2.1.1            codetools_0.2-20       
[25] carData_3.0-5           fontquiver_0.2.1        fontLiberation_0.1.0   
[28] htmltools_0.5.8.1       Formula_1.2-5           car_3.1-3              
[31] ggpubr_0.6.0            pillar_1.9.0            openssl_2.2.2          
[34] abind_1.4-8             nlme_3.1-166            fontBitstreamVera_0.1.1
[37] tidyselect_1.2.1        zip_2.3.1               digest_0.6.37          
[40] stringi_1.8.4           purrr_1.0.2             labeling_0.4.3         
[43] rprojroot_2.0.4         fastmap_1.2.0           grid_4.4.1             
[46] colorspace_2.1-1        cli_3.6.3               magrittr_2.0.3         
[49] utf8_1.2.4              broom_1.0.7             withr_3.0.2            
[52] backports_1.5.0         gdtools_0.4.0           scales_1.3.0           
[55] rmarkdown_2.28          officer_0.6.7           ggsignif_0.6.4         
[58] askpass_1.2.1           ragg_1.3.3              evaluate_1.0.1         
[61] knitr_1.48              viridisLite_0.4.2       rlang_1.1.4            
[64] Rcpp_1.0.13             glue_1.8.0              xml2_1.3.6             
[67] jsonlite_1.8.9          R6_2.5.1                systemfonts_1.1.0      </code></pre>
</div>
</div>
<hr>
<p><a href="#introduction">Back to top</a></p>
<hr>
</section>
<section id="references" class="level1 unnumbered">




</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-stackpca4" class="csl-entry" role="listitem">
Amoeba. 2022. <span>“Making Sense of Principal Component Analysis, Eigenvectors &amp;Amp; Eigenvalues.”</span> Cross Validated. <a href="https://stats.stackexchange.com/q/140579">https://stats.stackexchange.com/q/140579</a>.
</div>
<div id="ref-clark2011introduction" class="csl-entry" role="listitem">
Clark, Neil R, and Avi Ma’ayan. 2011. <span>“Introduction to Statistical Methods to Analyze Large Data Sets: Principal Components Analysis.”</span> <em>Science Signaling</em> 4 (190): tr3–3.
</div>
<div id="ref-davison1983introduction" class="csl-entry" role="listitem">
Davison, Mark L. 1983. <span>“Introduction to Multidimensional Scaling and Its Applications.”</span> <em>Applied Psychological Measurement</em>. Sage Publications Sage CA: Thousand Oaks, CA.
</div>
<div id="ref-field2012discovering" class="csl-entry" role="listitem">
Field, Andy, Jeremy Miles, and Zoe Field. <em>Discovering Statistics Using r</em>. Sage.
</div>
<div id="ref-jacoby2018multidimensional" class="csl-entry" role="listitem">
Jacoby, William G, and David J Ciuk. 2018. <span>“Multidimensional Scaling: An Introduction.”</span> <em>The Wiley Handbook of Psychometric Testing: A Multidisciplinary Reference on Survey, Scale and Test Development</em>, 375–412.
</div>
<div id="ref-jolliffe1987rotation" class="csl-entry" role="listitem">
Jolliffe, Ian T. 1987. <span>“Rotation of Principal Components: Some Comments.”</span> <em>Journal of Climatology</em> 7 (5): 507–10.
</div>
<div id="ref-kaiser1960application" class="csl-entry" role="listitem">
Kaiser, Henry F. 1960. <span>“The Application of Electronic Computers to Factor Analysis.”</span> <em>Educational and Psychological Measurement</em> 20 (1): 141–51.
</div>
<div id="ref-kim1978introduction" class="csl-entry" role="listitem">
Kim, Jae-On, and Charles W Mueller. 1978. <em>Introduction to Factor Analysis: What It Is and How to Do It</em>. 13. Sage.
</div>
<div id="ref-kline2014easy" class="csl-entry" role="listitem">
Kline, Paul. 2014. <em>An Easy Guide to Factor Analysis</em>. Routledge.
</div>
<div id="ref-stackpca3" class="csl-entry" role="listitem">
Starmer, Josh. 2018. <span>“StatQuest: Principal Component Analysis (PCA), Step-by-Step.”</span> YouTube. <a href="https://www.youtube.com/watch?v = FgakZw6K1QQ">https://www.youtube.com/watch?v = FgakZw6K1QQ</a>.
</div>
<div id="ref-stevens1992applied" class="csl-entry" role="listitem">
Stevens, James. 1992. <em>Applied Statistics for the Social Sciences</em>. Hillsdale, New Jersey: Lawrence Erlbaum Associates.
</div>
<div id="ref-tabachnick2007using" class="csl-entry" role="listitem">
Tabachnick, Barbara G, Linda S Fidell, and Jodie B Ullman. 2007. <em>Using Multivariate Statistics</em>. 5th ed. Boston: Pearson.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>If you want to render the R Notebook on your machine, i.e.&nbsp;knitting the document to html or a pdf, you need to make sure that you have R and RStudio installed and you also need to download the <a href="https://slcladal.github.io/content/bibliography.bib"><strong>bibliography file</strong></a> and store it in the same folder where you store the Rmd file.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>