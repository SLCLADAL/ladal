"0","Height <- c(169, 171, 164, 160, 158, 173, 166, 161, 180, 187, 170, 177, 163, 161, 157)"
"0","Weight <- c(68, 67, 65, 66, 64, 80, 75, 70, 85, 92, 86, 87, 85, 82, 80)"
"0","Group <- c(""a"", ""a"", ""a"", ""a"", ""a"", ""b"", ""b"", ""b"", ""b"", ""b"", ""c"", ""c"", ""c"", ""c"", ""c"")"
"0","# create data sets"
"0","tb <- data.frame(Height, Weight, Group)"
"0","m1 <- lm(Weight ~ Height + Group, data = tb)"
"0","m2 <- lmer(Weight ~ Height + (1 | Group), data = tb)"
"0","tb <- tb %>%"
"0","  dplyr::mutate("
"0","    PWeight = predict(m1, tb),"
"0","    PWeight_lme = predict(m2, tb)"
"0","  )"
"0","# plot"
"0","p1 <- ggplot(tb, aes(Height, Weight)) +"
"0","  geom_point(size = 2)"
"0","p2 <- ggplot(tb, aes(Height, Weight)) +"
"0","  geom_abline("
"0","    intercept = summary(m2)$coefficients[1], slope = summary(m2)$coefficients[2],"
"0","    color = ""orange"", size = .75"
"0","  ) +"
"0","  geom_point(size = 2) +"
"0","  ggtitle(""Fixed-effects model \n(with fixed intercept)"")"
"0",""
"0","p3 <- ggplot(tb, aes(Height, Weight)) +"
"0","  geom_point(size = 2, aes(shape = Group, color = Group)) +"
"0","  geom_abline("
"0","    intercept = fixef(m2)[1], slope = fixef(m2)[2],"
"0","    color = ""orange"", size = .75"
"0","  ) +"
"0","  geom_smooth(method = ""lm"", se = F, aes(x = Height, y = PWeight, color = Group), size = .5) +"
"0","  theme(legend.position = ""none"") +"
"0","  ggtitle(""Mixed-effects model \n (with random intercepts)"")"
"0",""
"0","p4 <- ggplot(tb, aes(Height, Weight)) +"
"0","  geom_smooth(se = F, method = ""lm"", size = .5, aes(shape = Group, color = Group)) +"
"0","  geom_abline("
"0","    intercept = fixef(m2)[1], slope = fixef(m2)[2],"
"0","    color = ""orange"", size = .75"
"0","  ) +"
"0","  geom_point(size = 2, aes(shape = Group, color = Group)) +"
"0","  theme(legend.position = ""none"") +"
"0","  ggtitle(""Mixed-effects model \n(with random intercepts + \nrandom slops)"")"
"0","# show plot"
"0","ggpubr::ggarrange(p2, p3, p4, ncol = 3)"
