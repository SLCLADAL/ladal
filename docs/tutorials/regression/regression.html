<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Martin Schweinberger">

<title>Regression Analysis in R – Language Technology and Data Analysis Laboratory (LADAL)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-c00ead3b610a61ca0c1a529afe17c12f.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-VSGK4KYDQZ"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-VSGK4KYDQZ', { 'anonymize_ip': true});
</script>
<style>html{ scroll-behavior: smooth; }</style>
<script>
    // Wait for the document to be fully loaded
    document.addEventListener("DOMContentLoaded", function () {
        // Create a new div element to hold the dynamic content
        var newContainer = document.createElement("div");
        newContainer.classList.add("custom-banner");  // You can assign a class to the new container for styling

        // You can also add content inside the new container
        newContainer.innerHTML = `
          <div class="banner">
              <img src="/images/ladal_icon_white.png" alt="Icon" class="banner-icon">
              <span class="banner-text">Language Technology and Data Analysis Laboratory</span>
          </div>
      `

        // Select the header element
        var header = document.getElementById("quarto-header");

        // Select the nav element inside the header to place the new container just above it
        var navbar = header.querySelector("nav");

        // Insert the new container before the navbar element
        header.insertBefore(newContainer, navbar);
    });
</script>
<link href="../../site_libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">
<script src="../../site_libs/tabwid-1.1.3/tabwid.js"></script>
<script src="../../site_libs/clipboard-1.7.1/clipboard.min.js"></script>
<link href="../../site_libs/primer-tooltips-1.4.0/build.css" rel="stylesheet">
<link href="../../site_libs/klippy-0.0.0.9500/css/klippy.min.css" rel="stylesheet">
<script src="../../site_libs/klippy-0.0.0.9500/js/klippy.min.js"></script>
<script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../css/styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Language Technology and Data Analysis Laboratory (LADAL)</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">HOME</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">ABOUT</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../events.html"> 
<span class="menu-text">EVENTS</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials.html"> 
<span class="menu-text">TUTORIALS</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../tools.html"> 
<span class="menu-text">TOOLS</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../resources.html"> 
<span class="menu-text">RESOURCES</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../contact.html"> 
<span class="menu-text">CONTACT</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul class="collapse">
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#fixed-effects-regression" id="toc-fixed-effects-regression" class="nav-link" data-scroll-target="#fixed-effects-regression">Fixed Effects Regression</a>
  <ul class="collapse">
  <li><a href="#simple-linear-regression" id="toc-simple-linear-regression" class="nav-link" data-scroll-target="#simple-linear-regression">Simple Linear Regression</a></li>
  <li><a href="#multiple-linear-regression" id="toc-multiple-linear-regression" class="nav-link" data-scroll-target="#multiple-linear-regression">Multiple Linear Regression</a></li>
  <li><a href="#multiple-binomial-logistic-regression" id="toc-multiple-binomial-logistic-regression" class="nav-link" data-scroll-target="#multiple-binomial-logistic-regression">Multiple Binomial Logistic Regression</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Regression Analysis in R</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Martin Schweinberger </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<p><img src="../../images/uq1.jpg" class="img-fluid" style="width:100.0%"></p>
<section id="introduction" class="level1 unnumbered">
<h1 class="unnumbered">Introduction</h1>
<p>This tutorial introduces regression analyses (also called regression modeling) using R.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> Regression models are among the most widely used quantitative methods in the language sciences to assess if and how predictors (variables or interactions between variables) correlate with a certain response.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="images/yr_chili.jpg" class="img-fluid figure-img" style="float:right; padding:10px;width:15.0%"></p>
</figure>
</div>
</div>
</div>
<p>This tutorial is aimed at intermediate and advanced users of R with the aim of showcasing how to perform regression analysis using R. The aim is not to provide a fully-fledged analysis but rather to show and exemplify common regression types, model diagnostics, and model fitting using R.</p>
<br>
<div class="warning" style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
The entire R Notebook for the tutorial can be downloaded <a href="tutorials/regression/regression.qmd">here</a>. If you want to render the R Notebook on your machine, i.e.&nbsp;knitting the document to html or a pdf, you need to make sure that you have R and RStudio installed and you also need to download the <a href="../../assets/bibliography.bib"><strong>bibliography file</strong></a> and store it in the same folder where you store the Rmd or the Rproj file. <br>
</p>
<p style="margin-left:1em;">
</p>
<p></p>
</span></div>
<p><br></p>
<p>Regression models are so popular because they can</p>
<ul>
<li><p>incorporate many predictors in a single model (multivariate: allows to test the impact of one predictor while the impact of (all) other predictors is controlled for)</p></li>
<li><p>extremely flexible and and can be fitted to different types of predictors and dependent variables</p></li>
<li><p>provide output that can be easily interpreted</p></li>
<li><p>conceptually relative simple and not overly complex from a mathematical perspective</p></li>
</ul>
<p>R offers various ready-made functions with which implementing different types of regression models is very easy.</p>
<p>The most widely use regression models are</p>
<ul>
<li><p>linear regression (dependent variable is numeric, no outliers)</p></li>
<li><p>logistic regression (dependent variable is binary)</p></li>
<li><p>ordinal regression (dependent variable represents an ordered factor, e.g.&nbsp;Likert items)</p></li>
<li><p>multinomial regression (dependent variable is categorical)</p></li>
</ul>
<p>The major difference between these types of models is that they take different types of dependent variables: linear regressions take numeric, logistic regressions take nominal variables, ordinal regressions take ordinal variables, and Poisson regressions take dependent variables that reflect counts of (rare) events. Robust regression, in contrast, is a simple multiple linear regression that is able to handle outliers due to a weighing procedure.</p>
<p>If regression models contain a random effect structure which is used to model nestedness or dependence among data points, the regression models are called <em>mixed-effect models</em>. regressions that do not have a random effect component to model nestedness or dependence are referred to as fixed-effect regressions (we will have a closer look at the difference between fixed and random effects below).</p>
<p>There are two basic types of regression models:</p>
<ul>
<li><p>fixed-effects regression models</p></li>
<li><p>mixed-effects regression models (which are fitted using the <code>lme4</code> package <span class="citation" data-cites="lme4">(<a href="#ref-lme4" role="doc-biblioref">Bates et al. 2015</a>)</span> in this tutorial).</p></li>
</ul>
<p>Fixed-effects regression models are models that assume a non-hierarchical data structure, i.e.&nbsp;data where data points are not nested or grouped in higher order categories (e.g.&nbsp;students within classes). The first part of this tutorial focuses on fixed-effects regression models while the second part focuses on mixed-effects regression models.</p>
<p>There exists a wealth of literature focusing on regression analysis and the concepts it is based on. For instance, there are <span class="citation" data-cites="achen1982interpreting">Achen</span>, <span class="citation" data-cites="bortz2006statistik">Bortz</span>, <span class="citation" data-cites="crawley2005statistics">Crawley</span>, <span class="citation" data-cites="faraway2002practical">Faraway</span>, <span class="citation" data-cites="field2012discovering">Field, Miles, and Field</span> (my personal favorite), <span class="citation" data-cites="gries2021statistics">Gries</span>, <span class="citation" data-cites="levshina2015linguistics">Levshina</span>, and <span class="citation" data-cites="wilcox2009basic">Wilcox</span> to name just a few. Introductions to regression modeling in R are <span class="citation" data-cites="baayen2008analyzing">Baayen</span>, <span class="citation" data-cites="crawley2012r">Crawley</span>, <span class="citation" data-cites="gries2021statistics">Gries</span>, or <span class="citation" data-cites="levshina2015linguistics">Levshina</span>.</p>
<p><strong>The basic principle</strong></p>
<p>The idea behind regression analysis is expressed formally in the equation below where <span class="math inline">\(f_{(x)}\)</span> is the <span class="math inline">\(y\)</span>-value we want to predict, <span class="math inline">\(\alpha\)</span> is the intercept (the point where the regression line crosses the <span class="math inline">\(y\)</span>-axis), <span class="math inline">\(\beta\)</span> is the coefficient (the slope of the regression line).</p>
<p><span class="math display">\[\begin{equation}
f_{(x)} = \alpha + \beta_{i}x + \epsilon
\end{equation}\]</span></p>
<p>To understand what this means, let us imagine that we have collected information about the how tall people are and what they weigh. Now we want to predict the weight of people of a certain height - let’s say 180cm.</p>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-85a0a008{table-layout:auto;width:75%;}.cl-8598f31c{font-family:'DejaVu Sans';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8598f326{font-family:'DejaVu Sans';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-859cd108{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-859cede6{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-859cedfa{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-859cedfb{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-859cee04{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-859cee05{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-859cee0e{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-859cee0f{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-859cee10{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-85a0a008"><thead><tr style="overflow-wrap:break-word;"><th class="cl-859cede6"><p class="cl-859cd108"><span class="cl-8598f31c">Height</span></p></th><th class="cl-859cedfa"><p class="cl-859cd108"><span class="cl-8598f31c">Weight</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-859cedfb"><p class="cl-859cd108"><span class="cl-8598f326">173</span></p></td><td class="cl-859cee04"><p class="cl-859cd108"><span class="cl-8598f326">80</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-859cee05"><p class="cl-859cd108"><span class="cl-8598f326">169</span></p></td><td class="cl-859cee0e"><p class="cl-859cd108"><span class="cl-8598f326">68</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-859cedfb"><p class="cl-859cd108"><span class="cl-8598f326">176</span></p></td><td class="cl-859cee04"><p class="cl-859cd108"><span class="cl-8598f326">72</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-859cee05"><p class="cl-859cd108"><span class="cl-8598f326">166</span></p></td><td class="cl-859cee0e"><p class="cl-859cd108"><span class="cl-8598f326">75</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-859cedfb"><p class="cl-859cd108"><span class="cl-8598f326">161</span></p></td><td class="cl-859cee04"><p class="cl-859cd108"><span class="cl-8598f326">70</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-859cee05"><p class="cl-859cd108"><span class="cl-8598f326">164</span></p></td><td class="cl-859cee0e"><p class="cl-859cd108"><span class="cl-8598f326">65</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-859cedfb"><p class="cl-859cd108"><span class="cl-8598f326">160</span></p></td><td class="cl-859cee04"><p class="cl-859cd108"><span class="cl-8598f326">62</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-859cee05"><p class="cl-859cd108"><span class="cl-8598f326">158</span></p></td><td class="cl-859cee0e"><p class="cl-859cd108"><span class="cl-8598f326">60</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-859cedfb"><p class="cl-859cd108"><span class="cl-8598f326">180</span></p></td><td class="cl-859cee04"><p class="cl-859cd108"><span class="cl-8598f326">85</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-859cee0f"><p class="cl-859cd108"><span class="cl-8598f326">187</span></p></td><td class="cl-859cee10"><p class="cl-859cd108"><span class="cl-8598f326">92</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>We can run a simple linear regression on the data and we get the following output:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># model for upper panels</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">glm</span>(Weight <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> df))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Weight ~ 1, data = df)

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   72.900      3.244   22.48 3.24e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for gaussian family taken to be 105.2111)

    Null deviance: 946.9  on 9  degrees of freedom
Residual deviance: 946.9  on 9  degrees of freedom
AIC: 77.885

Number of Fisher Scoring iterations: 2</code></pre>
</div>
</div>
<p>To estimate how much some weights who is 180cm tall, we would multiply the coefficient (slope of the line) with 180 (<span class="math inline">\(x\)</span>) and add the value of the intercept (point where line crosses the <span class="math inline">\(y\)</span>-axis). If we plug in the numbers from the regression model below, we get</p>
<p><span class="math display">\[\begin{equation}
-93.77 + 0.98 ∗ 180 = 83.33 (kg)
\end{equation}\]</span></p>
<p>A person who is 180cm tall is predicted to weigh 83.33kg. Thus, the predictions of the weights are visualized as the red line in the figure below. Such lines are called <em>regression lines</em>. Regression lines are those lines where the sum of the red lines should be minimal. The slope of the regression line is called <em>coefficient</em> and the point where the regression line crosses the y-axis at x = 0 is called the <em>intercept</em>. Other important concepts in regression analysis are <em>variance</em> and <em>residuals</em>. <em>Residuals</em> are the distance between the line and the points (the red lines) and it is also called <em>variance</em>.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/intro01-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Some words about the plots in the figure above: the upper left panel shows the raw observed data (black dots). The upper right panel shows the mean weight (blue line) and the residuals (in red). residuals are the distances from the expected or predicted values to the observed values (in this case the mean is the most most basic model which we use to predict values while the observed values simply represent the actual data points). The lower left panel shows observed values and the regression line, i.e, that line which, when drawn through the data points, will have the lowest sum of residuals. The lower right panel shows the regression line and the residuals, i.e.&nbsp;the distances between the expected or predicted values to the actual observed values (in red). Note that the sum of residuals in the lower right panel is much smaller than the sum of residuals in the upper right panel. This suggest that considering Height is a good idea as it explains a substantive amount of residual error and reduces the sum of residuals (or variance).<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<p>Now that we are familiar with the basic principle of regression modeling - i.e.&nbsp;finding the line through data that has the smallest sum of residuals, we will apply this to a linguistic example.</p>
<p><strong>Preparation and session set up</strong></p>
<p>This tutorial is based on R. If you have not installed R or are new to it, you will find an introduction to and more information how to use R <a href="tutorials/intror/intror.html">here</a>. For this tutorials, we need to install certain <em>packages</em> from an R <em>library</em> so that the scripts shown below are executed without errors. Before turning to the code below, please install the packages by running the code below this paragraph. If you have already installed the packages mentioned below, then you can skip ahead and ignore this section. To install the necessary packages, simply run the following code - it may take some time (between 1 and 5 minutes to install all of the libraries so you do not need to worry if it takes some time).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"Boruta"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"car"</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"emmeans"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"effects"</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"flextable"</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"glmulti"</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"ggpubr"</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"Hmisc"</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"knitr"</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"lme4"</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"MASS"</span>)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"mclogit"</span>)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"MuMIn"</span>)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"nlme"</span>)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"ordinal"</span>)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"rms"</span>)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"robustbase"</span>)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"sjPlot"</span>)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"stringr"</span>)</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"tibble"</span>)</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"dplyr"</span>)</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"vcd"</span>)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"vip"</span>)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"gridExtra"</span>)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"performance"</span>)</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"see"</span>)</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="co"># install klippy for copy-to-clipboard button in code chunks</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"remotes"</span>)</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"rlesur/klippy"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now that we have installed the packages, we activate them as shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set options</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">stringsAsFactors =</span> F)          <span class="co"># no automatic data transformation</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">"scipen"</span> <span class="ot">=</span> <span class="dv">100</span>, <span class="st">"digits"</span> <span class="ot">=</span> <span class="dv">12</span>) <span class="co"># suppress math annotation</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Boruta)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effects)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmulti)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Hmisc)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mclogit)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MuMIn)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme)</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ordinal)</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rms)</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(robustbase)</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot)</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vcd)</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vip)</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(see)</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a><span class="co"># activate klippy for copy-to-clipboard button</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>klippy<span class="sc">::</span><span class="fu">klippy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<script>
  addClassKlippyTo("pre.r, pre.markdown");
  addKlippy('left', 'top', 'auto', '1', 'Copy code', 'Copied!');
</script>
</div>
</div>
<p>Once you have installed R and RStudio and initiated the session by executing the code shown above, you are good to go.</p>
</section>
<section id="fixed-effects-regression" class="level1">
<h1>Fixed Effects Regression</h1>
<p>Before turning to mixed-effects models which are able to represent hierarchical data structures, we will focus on traditional fixed effects regression models and begin with multiple linear regression.</p>
<section id="simple-linear-regression" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="simple-linear-regression">Simple Linear Regression</h2>
<p>This section focuses on a very widely used statistical method which is called regression. Regressions are used when we try to understand how independent variables correlate with a dependent or outcome variable. So, if you want to investigate how a certain factor affects an outcome, then a regression is the way to go. We will have a look at two simple examples to understand what the concepts underlying a regression mean and how a regression works. The R code, that we will use, is adapted from many highly recommendable introductions which also focus on regression (among other types of analyses), for example, <span class="citation" data-cites="gries2021statistics">Gries</span>, <span class="citation" data-cites="winter2019statistics">Winter</span>, <span class="citation" data-cites="levshina2015linguistics">Levshina</span>, <span class="citation" data-cites="winter2019statistics">Winter</span> or <span class="citation" data-cites="wilcox2009basic">Wilcox</span>. <span class="citation" data-cites="baayen2008analyzing">Baayen</span> is also very good but probably not the first book one should read about statistics but it is highly recommendable for advanced learners.</p>
<p>Although the basic logic underlying regressions is identical to the conceptual underpinnings of <em>analysis of variance</em> (ANOVA), a related method, sociolinguists have traditionally favored regression analysis in their studies while ANOVAs have been the method of choice in psycholinguistics. The preference for either method is grounded in historical happenstances and the culture of these subdisciplines rather than in methodological reasoning. However, ANOVA are more restricted in that they can only take numeric dependent variables and they have stricter model assumptions that are violated more readily. In addition, a minor difference between regressions and ANOVA lies in the fact that regressions are based on the <span class="math inline">\(t\)</span>-distribution while ANOVAs use the F-distribution (however, the F-value is simply the value of t squared or t<sup>2</sup>). Both t- and F-values report on the ratio between explained and unexplained variance.</p>
<p>The idea behind regression analysis is expressed formally in the equation below where<span class="math inline">\(f_{(x)}\)</span> is the y-value we want to predict, <span class="math inline">\(\alpha\)</span> is the intercept (the point where the regression line crosses the y-axis at x = 0), <span class="math inline">\(\beta\)</span> is the coefficient (the slope of the regression line).</p>
<p><span class="math display">\[\begin{equation}
f_{(x)} = \alpha + \beta_{i}x + \epsilon
\end{equation}\]</span></p>
<p>In other words, to estimate how much some weights who is 180cm tall, we would multiply the coefficient (slope of the line) with 180 (x) and add the value of the intercept (point where line crosses the y-axis at x = 0).</p>
<p>However, the idea behind regressions can best be described graphically: imagine a cloud of points (like the points in the scatterplot in the upper left panel below). Regressions aim to find that line which has the minimal summed distance between points and the line (like the line in the lower panels). Technically speaking, the aim of a regression is to find the line with the minimal deviance (or the line with the minimal sum of residuals). Residuals are the distance between the line and the points (the red lines) and it is also called <em>variance</em>.</p>
<p>Thus, regression lines are those lines where the sum of the red lines should be minimal. The slope of the regression line is called <em>coefficient</em> and the point where the regression line crosses the y-axis at x = 0 is called the <em>intercept</em>.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/slr1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>A word about standard errors (SE) is in order here because most commonly used statistics programs will provide SE values when reporting regression models. The SE is a measure that tells us how much the coefficients were to vary if the same regression were applied to many samples from the same population. A relatively small SE value therefore indicates that the coefficients will remain very stable if the same regression model is fitted to many different samples with identical parameters. In contrast, a large SE tells you that the model is volatile and not very stable or reliable as the coefficients vary substantially if the model is applied to many samples.</p>
<p>Mathematically, the SE is the standard deviation (SD) divided by the square root of the sample size (N) (see below).The SD is the square root of the deviance (that is, the SD is the square root of the sum of the mean <span class="math inline">\(\bar{x}\)</span> minus each data point (x<sub>i</sub>) squared divided by the sample size (N) minus 1).</p>
<p><span class="math display">\[\begin{equation}
Standard Error (SE) = \frac{\sum (\bar{x}-x_{i})^2/N-1}{\sqrt{N}} = \frac{SD}{\sqrt{N}}
\end{equation}\]</span></p>
<section id="example-1-preposition-use-across-real-time" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="example-1-preposition-use-across-real-time">Example 1: Preposition Use across Real-Time</h3>
<p>We will now turn to our first example. In this example, we will investigate whether the frequency of prepositions has changed from Middle English to Late Modern English. The reasoning behind this example is that Old English was highly synthetic compared with Present-Day English which comparatively analytic. In other words, while Old English speakers used case to indicate syntactic relations, speakers of Present-Day English use word order and prepositions to indicate syntactic relationships. This means that the loss of case had to be compensated by different strategies and maybe these strategies continued to develop and increase in frequency even after the change from synthetic to analytic had been mostly accomplished. And this prolonged change in compensatory strategies is what this example will focus on.</p>
<p>The analysis is based on data extracted from the <em>Penn Corpora of Historical English</em> (see http://www.ling.upenn.edu/hist-corpora/), that consists of 603 texts written between 1125 and 1900. In preparation of this example, all elements that were part-of-speech tagged as prepositions were extracted from the PennCorpora.</p>
<p>Then, the relative frequencies (per 1,000 words) of prepositions per text were calculated. This frequency of prepositions per 1,000 words represents our dependent variable. In a next step, the date when each letter had been written was extracted. The resulting two vectors were combined into a table which thus contained for each text, when it was written (independent variable) and its relative frequency of prepositions (dependent or outcome variable).</p>
<p>A regression analysis will follow the steps described below:</p>
<ol type="1">
<li><p>Extraction and processing of the data</p></li>
<li><p>Data visualization</p></li>
<li><p>Applying the regression analysis to the data</p></li>
<li><p>Diagnosing the regression model and checking whether or not basic model assumptions have been violated.</p></li>
</ol>
<p>In a first step, we load functions that we may need (which in this case is a function that we will use to summarize the results of the analysis).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load functions</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"rscripts/slrsummary.r"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>After preparing our session, we can now load and inspect the data to get a first impression of its properties.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>slrdata  <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="st">"tutorials/regression/data/sld.rda"</span>, <span class="st">"rb"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-88739e0c{table-layout:auto;width:75%;}.cl-886e18ba{font-family:'DejaVu Sans';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-886e18c4{font-family:'DejaVu Sans';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-88705e18{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-88705e22{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-887075d8{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-887075e2{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-887075ec{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-887075ed{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-887075f6{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-887075f7{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88707600{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88707601{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8870760a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8870760b{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88707614{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88707615{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8870761e{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8870761f{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88707620{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88707628{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-88739e0c"><thead><tr style="overflow-wrap:break-word;"><th class="cl-887075d8"><p class="cl-88705e18"><span class="cl-886e18ba">Date</span></p></th><th class="cl-887075e2"><p class="cl-88705e22"><span class="cl-886e18ba">Genre</span></p></th><th class="cl-887075e2"><p class="cl-88705e22"><span class="cl-886e18ba">Text</span></p></th><th class="cl-887075ec"><p class="cl-88705e18"><span class="cl-886e18ba">Prepositions</span></p></th><th class="cl-887075ed"><p class="cl-88705e22"><span class="cl-886e18ba">Region</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-887075f6"><p class="cl-88705e18"><span class="cl-886e18c4">1,736</span></p></td><td class="cl-887075f7"><p class="cl-88705e22"><span class="cl-886e18c4">Science</span></p></td><td class="cl-887075f7"><p class="cl-88705e22"><span class="cl-886e18c4">albin</span></p></td><td class="cl-88707600"><p class="cl-88705e18"><span class="cl-886e18c4">166.01</span></p></td><td class="cl-88707601"><p class="cl-88705e22"><span class="cl-886e18c4">North</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8870760a"><p class="cl-88705e18"><span class="cl-886e18c4">1,711</span></p></td><td class="cl-8870760b"><p class="cl-88705e22"><span class="cl-886e18c4">Education</span></p></td><td class="cl-8870760b"><p class="cl-88705e22"><span class="cl-886e18c4">anon</span></p></td><td class="cl-88707614"><p class="cl-88705e18"><span class="cl-886e18c4">139.86</span></p></td><td class="cl-88707615"><p class="cl-88705e22"><span class="cl-886e18c4">North</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-887075f6"><p class="cl-88705e18"><span class="cl-886e18c4">1,808</span></p></td><td class="cl-887075f7"><p class="cl-88705e22"><span class="cl-886e18c4">PrivateLetter</span></p></td><td class="cl-887075f7"><p class="cl-88705e22"><span class="cl-886e18c4">austen</span></p></td><td class="cl-88707600"><p class="cl-88705e18"><span class="cl-886e18c4">130.78</span></p></td><td class="cl-88707601"><p class="cl-88705e22"><span class="cl-886e18c4">North</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8870760a"><p class="cl-88705e18"><span class="cl-886e18c4">1,878</span></p></td><td class="cl-8870760b"><p class="cl-88705e22"><span class="cl-886e18c4">Education</span></p></td><td class="cl-8870760b"><p class="cl-88705e22"><span class="cl-886e18c4">bain</span></p></td><td class="cl-88707614"><p class="cl-88705e18"><span class="cl-886e18c4">151.29</span></p></td><td class="cl-88707615"><p class="cl-88705e22"><span class="cl-886e18c4">North</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-887075f6"><p class="cl-88705e18"><span class="cl-886e18c4">1,743</span></p></td><td class="cl-887075f7"><p class="cl-88705e22"><span class="cl-886e18c4">Education</span></p></td><td class="cl-887075f7"><p class="cl-88705e22"><span class="cl-886e18c4">barclay</span></p></td><td class="cl-88707600"><p class="cl-88705e18"><span class="cl-886e18c4">145.72</span></p></td><td class="cl-88707601"><p class="cl-88705e22"><span class="cl-886e18c4">North</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8870760a"><p class="cl-88705e18"><span class="cl-886e18c4">1,908</span></p></td><td class="cl-8870760b"><p class="cl-88705e22"><span class="cl-886e18c4">Education</span></p></td><td class="cl-8870760b"><p class="cl-88705e22"><span class="cl-886e18c4">benson</span></p></td><td class="cl-88707614"><p class="cl-88705e18"><span class="cl-886e18c4">120.77</span></p></td><td class="cl-88707615"><p class="cl-88705e22"><span class="cl-886e18c4">North</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-887075f6"><p class="cl-88705e18"><span class="cl-886e18c4">1,906</span></p></td><td class="cl-887075f7"><p class="cl-88705e22"><span class="cl-886e18c4">Diary</span></p></td><td class="cl-887075f7"><p class="cl-88705e22"><span class="cl-886e18c4">benson</span></p></td><td class="cl-88707600"><p class="cl-88705e18"><span class="cl-886e18c4">119.17</span></p></td><td class="cl-88707601"><p class="cl-88705e22"><span class="cl-886e18c4">North</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8870760a"><p class="cl-88705e18"><span class="cl-886e18c4">1,897</span></p></td><td class="cl-8870760b"><p class="cl-88705e22"><span class="cl-886e18c4">Philosophy</span></p></td><td class="cl-8870760b"><p class="cl-88705e22"><span class="cl-886e18c4">boethja</span></p></td><td class="cl-88707614"><p class="cl-88705e18"><span class="cl-886e18c4">132.96</span></p></td><td class="cl-88707615"><p class="cl-88705e22"><span class="cl-886e18c4">North</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-887075f6"><p class="cl-88705e18"><span class="cl-886e18c4">1,785</span></p></td><td class="cl-887075f7"><p class="cl-88705e22"><span class="cl-886e18c4">Philosophy</span></p></td><td class="cl-887075f7"><p class="cl-88705e22"><span class="cl-886e18c4">boethri</span></p></td><td class="cl-88707600"><p class="cl-88705e18"><span class="cl-886e18c4">130.49</span></p></td><td class="cl-88707601"><p class="cl-88705e22"><span class="cl-886e18c4">North</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8870760a"><p class="cl-88705e18"><span class="cl-886e18c4">1,776</span></p></td><td class="cl-8870760b"><p class="cl-88705e22"><span class="cl-886e18c4">Diary</span></p></td><td class="cl-8870760b"><p class="cl-88705e22"><span class="cl-886e18c4">boswell</span></p></td><td class="cl-88707614"><p class="cl-88705e18"><span class="cl-886e18c4">135.94</span></p></td><td class="cl-88707615"><p class="cl-88705e22"><span class="cl-886e18c4">North</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-887075f6"><p class="cl-88705e18"><span class="cl-886e18c4">1,905</span></p></td><td class="cl-887075f7"><p class="cl-88705e22"><span class="cl-886e18c4">Travel</span></p></td><td class="cl-887075f7"><p class="cl-88705e22"><span class="cl-886e18c4">bradley</span></p></td><td class="cl-88707600"><p class="cl-88705e18"><span class="cl-886e18c4">154.20</span></p></td><td class="cl-88707601"><p class="cl-88705e22"><span class="cl-886e18c4">North</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8870760a"><p class="cl-88705e18"><span class="cl-886e18c4">1,711</span></p></td><td class="cl-8870760b"><p class="cl-88705e22"><span class="cl-886e18c4">Education</span></p></td><td class="cl-8870760b"><p class="cl-88705e22"><span class="cl-886e18c4">brightland</span></p></td><td class="cl-88707614"><p class="cl-88705e18"><span class="cl-886e18c4">149.14</span></p></td><td class="cl-88707615"><p class="cl-88705e22"><span class="cl-886e18c4">North</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-887075f6"><p class="cl-88705e18"><span class="cl-886e18c4">1,762</span></p></td><td class="cl-887075f7"><p class="cl-88705e22"><span class="cl-886e18c4">Sermon</span></p></td><td class="cl-887075f7"><p class="cl-88705e22"><span class="cl-886e18c4">burton</span></p></td><td class="cl-88707600"><p class="cl-88705e18"><span class="cl-886e18c4">159.71</span></p></td><td class="cl-88707601"><p class="cl-88705e22"><span class="cl-886e18c4">North</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8870760a"><p class="cl-88705e18"><span class="cl-886e18c4">1,726</span></p></td><td class="cl-8870760b"><p class="cl-88705e22"><span class="cl-886e18c4">Sermon</span></p></td><td class="cl-8870760b"><p class="cl-88705e22"><span class="cl-886e18c4">butler</span></p></td><td class="cl-88707614"><p class="cl-88705e18"><span class="cl-886e18c4">157.49</span></p></td><td class="cl-88707615"><p class="cl-88705e22"><span class="cl-886e18c4">North</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8870761e"><p class="cl-88705e18"><span class="cl-886e18c4">1,835</span></p></td><td class="cl-8870761f"><p class="cl-88705e22"><span class="cl-886e18c4">PrivateLetter</span></p></td><td class="cl-8870761f"><p class="cl-88705e22"><span class="cl-886e18c4">carlyle</span></p></td><td class="cl-88707620"><p class="cl-88705e18"><span class="cl-886e18c4">124.16</span></p></td><td class="cl-88707628"><p class="cl-88705e22"><span class="cl-886e18c4">North</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>Inspecting the data is very important because it can happen that a data set may not load completely or that variables which should be numeric have been converted to character variables. If unchecked, then such issues could go unnoticed and cause trouble.</p>
<p>We will now plot the data to get a better understanding of what the data looks like.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(slrdata, <span class="fu">aes</span>(Date, Prepositions)) <span class="sc">+</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Prepositions per 1,000 words"</span>) <span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(slrdata, <span class="fu">aes</span>(Date, Prepositions)) <span class="sc">+</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Prepositions per 1,000 words"</span>) <span class="sc">+</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="co"># with linear model smoothing!</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co"># display plots</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggarrange</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/slr6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Before beginning with the regression analysis, we will center the year. We center the values of year by subtracting each value from the mean of year. This can be useful when dealing with numeric variables because if we did not center year, we would get estimated values for year 0 (a year when English did not even exist yet). If a variable is centered, the regression provides estimates of the model refer to the mean of that numeric variable. In other words, centering can be very helpful, especially with respect to the interpretation of the results that regression models report.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># center date</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>slrdata<span class="sc">$</span>Date <span class="ot">&lt;-</span> slrdata<span class="sc">$</span>Date <span class="sc">-</span> <span class="fu">mean</span>(slrdata<span class="sc">$</span>Date) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will now begin the regression analysis by generating a first regression model and inspect its results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create initial model</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>m1.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Prepositions <span class="sc">~</span> Date, <span class="at">data =</span> slrdata)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect results</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1.lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Prepositions ~ Date, data = slrdata)

Residuals:
        Min          1Q      Median          3Q         Max 
-69.1012471 -13.8549421   0.5779091  13.3208913  62.8580401 

Coefficients:
                   Estimate      Std. Error   t value             Pr(&gt;|t|)    
(Intercept) 132.19009310987   0.83863748040 157.62483 &lt; 0.0000000000000002 ***
Date          0.01732180307   0.00726746646   2.38347             0.017498 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 19.4339648 on 535 degrees of freedom
Multiple R-squared:  0.010507008,   Adjusted R-squared:  0.00865748837 
F-statistic: 5.68093894 on 1 and 535 DF,  p-value: 0.017498081</code></pre>
</div>
</div>
<p>The summary output starts by repeating the regression equation. Then, the model provides the distribution of the residuals. The residuals should be distributed normally with the absolute values of the Min and Max as well as the 1Q (first quartile) and 3Q (third quartile) being similar or ideally identical. In our case, the values are very similar which suggests that the residuals are distributed evenly and follow a normal distribution. The next part of the report is the coefficients table. The estimate for the intercept is the value of y at x = 0. The estimate for Date represents the slope of the regression line and tells us that with each year, the predicted frequency of prepositions increase by .01732 prepositions. The t-value is the Estimate divided by the standard error (Std. Error). Based on the t-value, the p-value can be calculated manually as shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use pt function (which uses t-values and the degrees of freedom)</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">*</span><span class="fu">pt</span>(<span class="sc">-</span><span class="fl">2.383</span>, <span class="fu">nrow</span>(slrdata)<span class="sc">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0175196401501</code></pre>
</div>
</div>
<p>The R<sup>2</sup>-values tell us how much variance is explained by our model. The baseline value represents a model that uses merely the mean. 0.0105 means that our model explains only 1.05 percent of the variance (0.010 x 100) - which is a tiny amount. The problem of the multiple R<sup>2</sup> is that it will increase even if we add variables that explain almost no variance. Hence, multiple R<sup>2</sup> encourages the inclusion of <em>junk</em> variables.</p>
<p><span class="math display">\[\begin{equation}
R^2 = R^2_{multiple} = 1 - \frac{\sum (y_i - \hat{y_i})^2}{\sum (y_i - \bar y)^2}
\end{equation}\]</span></p>
<p>The adjusted R<sup>2</sup>-value takes the number of predictors into account and, thus, the adjusted R<sup>2</sup> will always be lower than the multiple R<sup>2</sup>. This is so because the adjusted R<sup>2</sup> penalizes models for having predictors. The equation for the adjusted R<sup>2</sup> below shows that the amount of variance that is explained by all the variables in the model (the top part of the fraction) must outweigh the inclusion of the number of variables (k) (lower part of the fraction). Thus, the adjusted R<sup>2</sup> will decrease when variables are added that explain little or even no variance while it will increase if variables are added that explain a lot of variance.</p>
<p><span class="math display">\[\begin{equation}
R^2_{adjusted} = 1 - (\frac{(1 - R^2)(n - 1)}{n - k - 1})
\end{equation}\]</span></p>
<p>If there is a big difference between the two R<sup>2</sup>-values, then the model contains (many) predictors that do not explain much variance which is not good. The F-statistic and the associated p-value tell us that the model, despite explaining almost no variance, is still significantly better than an intercept-only base-line model (or using the overall mean to predict the frequency of prepositions per text).</p>
<p>We can test this and also see where the F-values comes from by comparing the</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create intercept-only base-line model</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>m0.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Prepositions <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> slrdata)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># compare the base-line and the more saturated model</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m1.lm, m0.lm, <span class="at">test =</span> <span class="st">"F"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: Prepositions ~ Date
Model 2: Prepositions ~ 1
  Res.Df         RSS Df   Sum of Sq       F   Pr(&gt;F)  
1    535 202058.2576                                  
2    536 204203.8289 -1 -2145.57126 5.68094 0.017498 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>The F- and p-values are exactly those reported by the summary which shows where the F-values comes from and what it means; namely it denote the difference between the base-line and the more saturated model.</p>
<p>The degrees of freedom associated with the residual standard error are the number of cases in the model minus the number of predictors (including the intercept). The residual standard error is square root of the sum of the squared residuals of the model divided by the degrees of freedom. Have a look at he following to clear this up:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DF = N - number of predictors (including intercept)</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>DegreesOfFreedom <span class="ot">&lt;-</span> <span class="fu">nrow</span>(slrdata)<span class="sc">-</span><span class="fu">length</span>(<span class="fu">coef</span>(m1.lm))</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># sum of the squared residuals</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>SumSquaredResiduals <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">resid</span>(m1.lm)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Residual Standard Error</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(SumSquaredResiduals<span class="sc">/</span>DegreesOfFreedom); DegreesOfFreedom</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 19.4339647585</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 535</code></pre>
</div>
</div>
<p>We will now check if mathematical assumptions have been violated (homogeneity of variance) or whether the data contains outliers. We check this using diagnostic plots.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate data</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">resid</span>(m1.lm)),</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">residuals =</span> <span class="fu">resid</span>(m1.lm),</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">standard =</span> <span class="fu">rstandard</span>(m1.lm),</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">studend =</span> <span class="fu">rstudent</span>(m1.lm))</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co"># generate plots</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df2, <span class="fu">aes</span>(<span class="at">x =</span> id, <span class="at">y =</span> residuals)) <span class="sc">+</span> </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Residuals"</span>, <span class="at">x =</span> <span class="st">"Index"</span>)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df2, <span class="fu">aes</span>(<span class="at">x =</span> id, <span class="at">y =</span> standard)) <span class="sc">+</span> </span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Standardized Residuals"</span>, <span class="at">x =</span> <span class="st">"Index"</span>)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df2, <span class="fu">aes</span>(<span class="at">x =</span> id, <span class="at">y =</span> studend)) <span class="sc">+</span> </span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Studentized Residuals"</span>, <span class="at">x =</span> <span class="st">"Index"</span>)</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="co"># display plots</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggarrange</span>(p1, p2, p3, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/slr12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The left graph shows the residuals of the model (i.e., the differences between the observed and the values predicted by the regression model). The problem with this plot is that the residuals are not standardized and so they cannot be compared to the residuals of other models. To remedy this deficiency, residuals are normalized by dividing the residuals by their standard deviation. Then, the normalized residuals can be plotted against the observed values (center panel). In this way, not only are standardized residuals obtained, but the values of the residuals are transformed into z-values, and one can use the z-distribution to find problematic data points. There are three rules of thumb regarding finding problematic data points through standardized residuals <span class="citation" data-cites="field2012discovering">(<a href="#ref-field2012discovering" role="doc-biblioref">Field, Miles, and Field, 268–69</a>)</span>:</p>
<ul>
<li><p>Points with values higher than 3.29 should be removed from the data.</p></li>
<li><p>If more than 1% of the data points have values higher than 2.58, then the error rate of our model is too high.</p></li>
<li><p>If more than 5% of the data points have values greater than 1.96, then the error rate of our model is too high.</p></li>
</ul>
<p>The right panel shows the * studentized residuals* (adjusted predicted values: each data point is divided by the standard error of the residuals). In this way, it is possible to use Student’s t-distribution to diagnose our model.</p>
<p>Adjusted predicted values are residuals of a special kind: the model is calculated without a data point and then used to predict this data point. The difference between the observed data point and its predicted value is then called the adjusted predicted value. In summary, studentized residuals are very useful because they allow us to identify influential data points.</p>
<p>The plots show that there are two potentially problematic data points (the top-most and bottom-most point). These two points are clearly different from the other data points and may therefore be outliers. We will test later if these points need to be removed.</p>
<p>We will now generate more diagnostic plots.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate plots</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(m1.lm) <span class="sc">+</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/slr13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The diagnostic plots are very positive and we will go through why this is so for each panel. The graph in the upper left panel is useful for finding outliers or for determining the correlation between residuals and predicted values: when a trend becomes visible in the line or points (e.g., a rising trend or a zigzag line), then this would indicate that the model would be problematic (in such cases, it can help to remove data points that are too influential (outliers)).</p>
<p>The graphic in the upper right panel indicates whether the residuals are normally distributed (which is desirable) or whether the residuals do not follow a normal distribution. If the points lie on the line, the residuals follow a normal distribution. For example, if the points are not on the line at the top and bottom, it shows that the model does not predict small and large values well and that it therefore does not have a good fit.</p>
<p>The graphic in the lower left panel provides information about <em>homoscedasticity</em>. Homoscedasticity means that the variance of the residuals remains constant and does not correlate with any independent variable. In unproblematic cases, the graphic shows a flat line. If there is a trend in the line, we are dealing with heteroscedasticity, that is, a correlation between independent variables and the residuals, which is very problematic for regressions.</p>
<p>The graph in the lower right panel shows problematic influential data points that disproportionately affect the regression (this would be problematic). If such influential data points are present, they should be either weighted (one could generate a robust rather than a simple linear regression) or they must be removed. The graph displays Cook’s distance, which shows how the regression changes when a model without this data point is calculated. The cook distance thus shows the influence a data point has on the regression as a whole. Data points that have a Cook’s distance value greater than 1 are problematic <span class="citation" data-cites="field2012discovering">(<a href="#ref-field2012discovering" role="doc-biblioref">Field, Miles, and Field, 269</a>)</span>.</p>
<p>The so-called leverage is also a measure that indicates how strongly a data point affects the accuracy of the regression. Leverage values range between 0 (no influence) and 1 (strong influence: suboptimal!). To test whether a specific data point has a high leverage value, we calculate a cut-off point that indicates whether the leverage is too strong or still acceptable. The following two formulas are used for this:</p>
<p><span class="math display">\[\begin{equation}
Leverage = \frac{3(k + 1)}{n} |  \frac{2(k + 1)}{n}
\end{equation}\]</span></p>
<p>We will look more closely at leverage in the context of multiple linear regression and will therefore end the current analysis by summarizing the results of the regression analysis in a table.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create summary table</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">slrsummary</span>(m1.lm)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-89cfc532{table-layout:auto;width:75%;}.cl-89cac28a{font-family:'DejaVu Sans';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-89cac294{font-family:'DejaVu Sans';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-89ccd8c2{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-89ccec90{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-89ccec91{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-89ccec9a{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-89ccec9b{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-89cceca4{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-89cceca5{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-89ccecae{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-89ccecaf{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-89ccecb0{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-89ccecb8{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-89ccecb9{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-89ccecc2{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-89cfc532"><thead><tr style="overflow-wrap:break-word;"><th class="cl-89ccec90"><p class="cl-89ccd8c2"><span class="cl-89cac28a">Parameters</span></p></th><th class="cl-89ccec91"><p class="cl-89ccd8c2"><span class="cl-89cac28a">Estimate</span></p></th><th class="cl-89ccec91"><p class="cl-89ccd8c2"><span class="cl-89cac28a">Pearson's r</span></p></th><th class="cl-89ccec91"><p class="cl-89ccd8c2"><span class="cl-89cac28a">Std. Error</span></p></th><th class="cl-89ccec91"><p class="cl-89ccd8c2"><span class="cl-89cac28a">t value</span></p></th><th class="cl-89ccec91"><p class="cl-89ccd8c2"><span class="cl-89cac28a">Pr(&gt;|t|)</span></p></th><th class="cl-89ccec9a"><p class="cl-89ccd8c2"><span class="cl-89cac28a">P-value sig.</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-89ccec9b"><p class="cl-89ccd8c2"><span class="cl-89cac294">(Intercept)</span></p></td><td class="cl-89cceca4"><p class="cl-89ccd8c2"><span class="cl-89cac294">132.19</span></p></td><td class="cl-89cceca4"><p class="cl-89ccd8c2"><span class="cl-89cac294"></span></p></td><td class="cl-89cceca4"><p class="cl-89ccd8c2"><span class="cl-89cac294">0.84</span></p></td><td class="cl-89cceca4"><p class="cl-89ccd8c2"><span class="cl-89cac294">157.62</span></p></td><td class="cl-89cceca4"><p class="cl-89ccd8c2"><span class="cl-89cac294">0</span></p></td><td class="cl-89cceca5"><p class="cl-89ccd8c2"><span class="cl-89cac294">p &lt; .001***</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-89ccecae"><p class="cl-89ccd8c2"><span class="cl-89cac294">Date</span></p></td><td class="cl-89ccecaf"><p class="cl-89ccd8c2"><span class="cl-89cac294">0.02</span></p></td><td class="cl-89ccecaf"><p class="cl-89ccd8c2"><span class="cl-89cac294">0.1</span></p></td><td class="cl-89ccecaf"><p class="cl-89ccd8c2"><span class="cl-89cac294">0.01</span></p></td><td class="cl-89ccecaf"><p class="cl-89ccd8c2"><span class="cl-89cac294">2.38</span></p></td><td class="cl-89ccecaf"><p class="cl-89ccd8c2"><span class="cl-89cac294">0.0175</span></p></td><td class="cl-89ccecb0"><p class="cl-89ccd8c2"><span class="cl-89cac294">p &lt; .05*</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-89ccec9b"><p class="cl-89ccd8c2"><span class="cl-89cac294">Model statistics</span></p></td><td class="cl-89cceca4"><p class="cl-89ccd8c2"><span class="cl-89cac294"></span></p></td><td class="cl-89cceca4"><p class="cl-89ccd8c2"><span class="cl-89cac294"></span></p></td><td class="cl-89cceca4"><p class="cl-89ccd8c2"><span class="cl-89cac294"></span></p></td><td class="cl-89cceca4"><p class="cl-89ccd8c2"><span class="cl-89cac294"></span></p></td><td class="cl-89cceca4"><p class="cl-89ccd8c2"><span class="cl-89cac294"></span></p></td><td class="cl-89cceca5"><p class="cl-89ccd8c2"><span class="cl-89cac294">Value</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-89ccecae"><p class="cl-89ccd8c2"><span class="cl-89cac294">Number of cases in model</span></p></td><td class="cl-89ccecaf"><p class="cl-89ccd8c2"><span class="cl-89cac294"></span></p></td><td class="cl-89ccecaf"><p class="cl-89ccd8c2"><span class="cl-89cac294"></span></p></td><td class="cl-89ccecaf"><p class="cl-89ccd8c2"><span class="cl-89cac294"></span></p></td><td class="cl-89ccecaf"><p class="cl-89ccd8c2"><span class="cl-89cac294"></span></p></td><td class="cl-89ccecaf"><p class="cl-89ccd8c2"><span class="cl-89cac294"></span></p></td><td class="cl-89ccecb0"><p class="cl-89ccd8c2"><span class="cl-89cac294">537</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-89ccec9b"><p class="cl-89ccd8c2"><span class="cl-89cac294">Residual standard error on 535 DF</span></p></td><td class="cl-89cceca4"><p class="cl-89ccd8c2"><span class="cl-89cac294"></span></p></td><td class="cl-89cceca4"><p class="cl-89ccd8c2"><span class="cl-89cac294"></span></p></td><td class="cl-89cceca4"><p class="cl-89ccd8c2"><span class="cl-89cac294"></span></p></td><td class="cl-89cceca4"><p class="cl-89ccd8c2"><span class="cl-89cac294"></span></p></td><td class="cl-89cceca4"><p class="cl-89ccd8c2"><span class="cl-89cac294"></span></p></td><td class="cl-89cceca5"><p class="cl-89ccd8c2"><span class="cl-89cac294">19.43</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-89ccecae"><p class="cl-89ccd8c2"><span class="cl-89cac294">Multiple R-squared</span></p></td><td class="cl-89ccecaf"><p class="cl-89ccd8c2"><span class="cl-89cac294"></span></p></td><td class="cl-89ccecaf"><p class="cl-89ccd8c2"><span class="cl-89cac294"></span></p></td><td class="cl-89ccecaf"><p class="cl-89ccd8c2"><span class="cl-89cac294"></span></p></td><td class="cl-89ccecaf"><p class="cl-89ccd8c2"><span class="cl-89cac294"></span></p></td><td class="cl-89ccecaf"><p class="cl-89ccd8c2"><span class="cl-89cac294"></span></p></td><td class="cl-89ccecb0"><p class="cl-89ccd8c2"><span class="cl-89cac294">0.0105</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-89ccec9b"><p class="cl-89ccd8c2"><span class="cl-89cac294">Adjusted R-squared</span></p></td><td class="cl-89cceca4"><p class="cl-89ccd8c2"><span class="cl-89cac294"></span></p></td><td class="cl-89cceca4"><p class="cl-89ccd8c2"><span class="cl-89cac294"></span></p></td><td class="cl-89cceca4"><p class="cl-89ccd8c2"><span class="cl-89cac294"></span></p></td><td class="cl-89cceca4"><p class="cl-89ccd8c2"><span class="cl-89cac294"></span></p></td><td class="cl-89cceca4"><p class="cl-89ccd8c2"><span class="cl-89cac294"></span></p></td><td class="cl-89cceca5"><p class="cl-89ccd8c2"><span class="cl-89cac294">0.0087</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-89ccecae"><p class="cl-89ccd8c2"><span class="cl-89cac294">F-statistic (1, 535)</span></p></td><td class="cl-89ccecaf"><p class="cl-89ccd8c2"><span class="cl-89cac294"></span></p></td><td class="cl-89ccecaf"><p class="cl-89ccd8c2"><span class="cl-89cac294"></span></p></td><td class="cl-89ccecaf"><p class="cl-89ccd8c2"><span class="cl-89cac294"></span></p></td><td class="cl-89ccecaf"><p class="cl-89ccd8c2"><span class="cl-89cac294"></span></p></td><td class="cl-89ccecaf"><p class="cl-89ccd8c2"><span class="cl-89cac294"></span></p></td><td class="cl-89ccecb0"><p class="cl-89ccd8c2"><span class="cl-89cac294">5.68</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-89ccecb8"><p class="cl-89ccd8c2"><span class="cl-89cac294">Model p-value</span></p></td><td class="cl-89ccecb9"><p class="cl-89ccd8c2"><span class="cl-89cac294"></span></p></td><td class="cl-89ccecb9"><p class="cl-89ccd8c2"><span class="cl-89cac294"></span></p></td><td class="cl-89ccecb9"><p class="cl-89ccd8c2"><span class="cl-89cac294"></span></p></td><td class="cl-89ccecb9"><p class="cl-89ccd8c2"><span class="cl-89cac294"></span></p></td><td class="cl-89ccecb9"><p class="cl-89ccd8c2"><span class="cl-89cac294"></span></p></td><td class="cl-89ccecc2"><p class="cl-89ccd8c2"><span class="cl-89cac294">0.0175</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>An alternative but less informative summary table of the results of a regression analysis can be generated using the <code>tab_model</code> function from the <code>sjPlot</code> package <span class="citation" data-cites="sjPlot">(<a href="#ref-sjPlot" role="doc-biblioref">Lüdecke</a>)</span> (as is shown below).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate summary table</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(m1.lm) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">&nbsp;</td>
<td colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">Prepositions</td>
</tr>
<tr class="even">
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Predictors</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">CI</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">p</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">(Intercept)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">132.19</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">130.54&nbsp;–&nbsp;133.84</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">Date</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.02</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.00&nbsp;–&nbsp;0.03</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>0.017</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">Observations</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">537</td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">R<sup>2</sup> / R<sup>2</sup> adjusted</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.011 / 0.009</td>
</tr>
</tbody>
</table>


</div>
</div>
<hr>
<p>Typically, the results of regression analyses are presented in such tables as they include all important measures of model quality and significance, as well as the magnitude of the effects.</p>
<p>In addition, the results of simple linear regressions should be summarized in writing.</p>
<p>We can use the <code>reports</code> package <span class="citation" data-cites="report">(<a href="#ref-report" role="doc-biblioref">Makowski et al. 2021</a>)</span> to summarize the analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(m1.lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear model (estimated using OLS) to predict Prepositions with
Date (formula: Prepositions ~ Date). The model explains a statistically
significant and very weak proportion of variance (R2 = 0.01, F(1, 535) = 5.68,
p = 0.017, adj. R2 = 8.66e-03). The model's intercept, corresponding to Date =
0, is at 132.19 (95% CI [130.54, 133.84], t(535) = 157.62, p &lt; .001). Within
this model:

  - The effect of Date is statistically significant and positive (beta = 0.02,
95% CI [3.05e-03, 0.03], t(535) = 2.38, p = 0.017; Std. beta = 0.10, 95% CI
[0.02, 0.19])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
</div>
<p>We can use this output to write up a final report:</p>
<p>A simple linear regression has been fitted to the data. A visual assessment of the model diagnostic graphics did not indicate any problematic or disproportionately influential data points (outliers) and performed significantly better compared to an intercept-only base line model but only explained .87 percent of the variance (adjusted R<sup>2</sup>: .0087, F-statistic (1, 535): 5,68, p-value: 0.0175*). The final minimal adequate linear regression model is based on 537 data points and confirms a significant and positive correlation between the year in which the text was written and the relative frequency of prepositions (coefficient estimate: .02 (standardized : 0.10, 95% CI [0.02, 0.19]), SE: 0.01, t-value<sub>535</sub>: 2.38, p-value: .0175*). Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using the Wald approximation.</p>
</section>
<section id="example-2-teaching-styles" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="example-2-teaching-styles">Example 2: Teaching Styles</h3>
<p>In the previous example, we dealt with two numeric variables, while the following example deals with a categorical independent variable and a numeric dependent variable. The ability for regressions to handle very different types of variables makes regressions a widely used and robust method of analysis.</p>
<p>In this example, we are dealing with two groups of students that have been randomly assigned to be exposed to different teaching methods. Both groups undergo a language learning test after the lesson with a maximum score of 20 points.</p>
<p>The question that we will try to answer is whether the students in group A have performed significantly better than those in group B which would indicate that the teaching method to which group A was exposed works better than the teaching method to which group B was exposed.</p>
<p>Let’s move on to implementing the regression in R. In a first step, we load the data set and inspect its structure.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>slrdata2  <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="st">"tutorials/regression/data/sgd.rda"</span>, <span class="st">"rb"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-8a29bfec{table-layout:auto;width:75%;}.cl-8a249cc4{font-family:'DejaVu Sans';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8a249cd8{font-family:'DejaVu Sans';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8a26e52e{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8a26e538{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8a26fc3a{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8a26fc44{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8a26fc4e{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8a26fc4f{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8a26fc50{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8a26fc58{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8a26fc59{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8a26fc62{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-8a29bfec"><thead><tr style="overflow-wrap:break-word;"><th class="cl-8a26fc3a"><p class="cl-8a26e52e"><span class="cl-8a249cc4">Group</span></p></th><th class="cl-8a26fc44"><p class="cl-8a26e538"><span class="cl-8a249cc4">Score</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-8a26fc4e"><p class="cl-8a26e52e"><span class="cl-8a249cd8">A</span></p></td><td class="cl-8a26fc4f"><p class="cl-8a26e538"><span class="cl-8a249cd8">15</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8a26fc50"><p class="cl-8a26e52e"><span class="cl-8a249cd8">A</span></p></td><td class="cl-8a26fc58"><p class="cl-8a26e538"><span class="cl-8a249cd8">12</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8a26fc4e"><p class="cl-8a26e52e"><span class="cl-8a249cd8">A</span></p></td><td class="cl-8a26fc4f"><p class="cl-8a26e538"><span class="cl-8a249cd8">11</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8a26fc50"><p class="cl-8a26e52e"><span class="cl-8a249cd8">A</span></p></td><td class="cl-8a26fc58"><p class="cl-8a26e538"><span class="cl-8a249cd8">18</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8a26fc4e"><p class="cl-8a26e52e"><span class="cl-8a249cd8">A</span></p></td><td class="cl-8a26fc4f"><p class="cl-8a26e538"><span class="cl-8a249cd8">15</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8a26fc50"><p class="cl-8a26e52e"><span class="cl-8a249cd8">A</span></p></td><td class="cl-8a26fc58"><p class="cl-8a26e538"><span class="cl-8a249cd8">15</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8a26fc4e"><p class="cl-8a26e52e"><span class="cl-8a249cd8">A</span></p></td><td class="cl-8a26fc4f"><p class="cl-8a26e538"><span class="cl-8a249cd8">9</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8a26fc50"><p class="cl-8a26e52e"><span class="cl-8a249cd8">A</span></p></td><td class="cl-8a26fc58"><p class="cl-8a26e538"><span class="cl-8a249cd8">19</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8a26fc4e"><p class="cl-8a26e52e"><span class="cl-8a249cd8">A</span></p></td><td class="cl-8a26fc4f"><p class="cl-8a26e538"><span class="cl-8a249cd8">14</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8a26fc50"><p class="cl-8a26e52e"><span class="cl-8a249cd8">A</span></p></td><td class="cl-8a26fc58"><p class="cl-8a26e538"><span class="cl-8a249cd8">13</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8a26fc4e"><p class="cl-8a26e52e"><span class="cl-8a249cd8">A</span></p></td><td class="cl-8a26fc4f"><p class="cl-8a26e538"><span class="cl-8a249cd8">11</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8a26fc50"><p class="cl-8a26e52e"><span class="cl-8a249cd8">A</span></p></td><td class="cl-8a26fc58"><p class="cl-8a26e538"><span class="cl-8a249cd8">12</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8a26fc4e"><p class="cl-8a26e52e"><span class="cl-8a249cd8">A</span></p></td><td class="cl-8a26fc4f"><p class="cl-8a26e538"><span class="cl-8a249cd8">18</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8a26fc50"><p class="cl-8a26e52e"><span class="cl-8a249cd8">A</span></p></td><td class="cl-8a26fc58"><p class="cl-8a26e538"><span class="cl-8a249cd8">15</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8a26fc59"><p class="cl-8a26e52e"><span class="cl-8a249cd8">A</span></p></td><td class="cl-8a26fc62"><p class="cl-8a26e538"><span class="cl-8a249cd8">16</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>Now, we graphically display the data. In this case, a boxplot represents a good way to visualize the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract means</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>slrdata2 <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(Group) <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Mean =</span> <span class="fu">round</span>(<span class="fu">mean</span>(Score), <span class="dv">1</span>), <span class="at">SD =</span> <span class="fu">round</span>(<span class="fu">sd</span>(Score), <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Group, Score)) <span class="sc">+</span> </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill=</span><span class="fu">c</span>(<span class="st">"orange"</span>, <span class="st">"darkgray"</span>)) <span class="sc">+</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"M = "</span>, Mean, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">y =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"SD = "</span>, SD, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Group"</span>) <span class="sc">+</span>                      </span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Test score (Points)"</span>, <span class="at">cex =</span> .<span class="dv">75</span>) <span class="sc">+</span>   </span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">20</span>)) <span class="sc">+</span>  </span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="cn">FALSE</span>)                </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/slr22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The data indicate that group A did significantly better than group B. We will test this impression by generating the regression model and creating the model and extracting the model summary.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate regression model</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>m2.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Score <span class="sc">~</span> Group, <span class="at">data =</span> slrdata2) </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect results</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2.lm)                             </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Score ~ Group, data = slrdata2)

Residuals:
        Min          1Q      Median          3Q         Max 
-6.76666667 -1.93333333  0.15000000  2.06666667  6.23333333 

Coefficients:
                Estimate   Std. Error  t value               Pr(&gt;|t|)    
(Intercept) 14.933333333  0.534571121 27.93517 &lt; 0.000000000000000222 ***
GroupB      -3.166666667  0.755997730 -4.18873            0.000096692 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.92796662 on 58 degrees of freedom
Multiple R-squared:  0.232249929,   Adjusted R-squared:  0.219012859 
F-statistic:  17.545418 on 1 and 58 DF,  p-value: 0.0000966923559</code></pre>
</div>
</div>
<p>The model summary reports that Group A performed significantly better compared with Group B. This is shown by the fact that the p-value (the value in the column with the header (Pr(&gt;|t|)) is smaller than .001 as indicated by the three * after the p-values). Also, the negative Estimate for Group B indicates that Group B has lower scores than Group A. We will now generate the diagnostic graphics.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))        <span class="co"># plot window: 1 plot/row, 3 plots/column</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">resid</span>(m2.lm))     <span class="co"># generate diagnostic plot</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">rstandard</span>(m2.lm)) <span class="co"># generate diagnostic plot</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">rstudent</span>(m2.lm)); <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))  <span class="co"># restore normal plot window</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/slr24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The graphics do not indicate outliers or other issues, so we can continue with more diagnostic graphics.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>)) <span class="co"># generate a plot window with 2x2 panels</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m2.lm); <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)) <span class="co"># restore normal plot window</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/slr25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>These graphics also show no problems. In this case, the data can be summarized in the next step.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tabulate results</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">slrsummary</span>(m2.lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-8aa2db3e{table-layout:auto;width:75%;}.cl-8a96fc42{font-family:'DejaVu Sans';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8a96fc56{font-family:'DejaVu Sans';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8a994b0a{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8a996126{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8a996130{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8a99613a{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8a99613b{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8a996144{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8a996145{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8a99614e{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8a99614f{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8a996158{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8a996159{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8a996162{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8a996163{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-8aa2db3e"><thead><tr style="overflow-wrap:break-word;"><th class="cl-8a996126"><p class="cl-8a994b0a"><span class="cl-8a96fc42">Parameters</span></p></th><th class="cl-8a996130"><p class="cl-8a994b0a"><span class="cl-8a96fc42">Estimate</span></p></th><th class="cl-8a996130"><p class="cl-8a994b0a"><span class="cl-8a96fc42">Pearson's r</span></p></th><th class="cl-8a996130"><p class="cl-8a994b0a"><span class="cl-8a96fc42">Std. Error</span></p></th><th class="cl-8a996130"><p class="cl-8a994b0a"><span class="cl-8a96fc42">t value</span></p></th><th class="cl-8a996130"><p class="cl-8a994b0a"><span class="cl-8a96fc42">Pr(&gt;|t|)</span></p></th><th class="cl-8a99613a"><p class="cl-8a994b0a"><span class="cl-8a96fc42">P-value sig.</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-8a99613b"><p class="cl-8a994b0a"><span class="cl-8a96fc56">(Intercept)</span></p></td><td class="cl-8a996144"><p class="cl-8a994b0a"><span class="cl-8a96fc56">14.93</span></p></td><td class="cl-8a996144"><p class="cl-8a994b0a"><span class="cl-8a96fc56"></span></p></td><td class="cl-8a996144"><p class="cl-8a994b0a"><span class="cl-8a96fc56">0.53</span></p></td><td class="cl-8a996144"><p class="cl-8a994b0a"><span class="cl-8a96fc56">27.94</span></p></td><td class="cl-8a996144"><p class="cl-8a994b0a"><span class="cl-8a96fc56">0</span></p></td><td class="cl-8a996145"><p class="cl-8a994b0a"><span class="cl-8a96fc56">p &lt; .001***</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8a99614e"><p class="cl-8a994b0a"><span class="cl-8a96fc56">GroupB</span></p></td><td class="cl-8a99614f"><p class="cl-8a994b0a"><span class="cl-8a96fc56">-3.17</span></p></td><td class="cl-8a99614f"><p class="cl-8a994b0a"><span class="cl-8a96fc56">0.48</span></p></td><td class="cl-8a99614f"><p class="cl-8a994b0a"><span class="cl-8a96fc56">0.76</span></p></td><td class="cl-8a99614f"><p class="cl-8a994b0a"><span class="cl-8a96fc56">-4.19</span></p></td><td class="cl-8a99614f"><p class="cl-8a994b0a"><span class="cl-8a96fc56">0.0001</span></p></td><td class="cl-8a996158"><p class="cl-8a994b0a"><span class="cl-8a96fc56">p &lt; .001***</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8a99613b"><p class="cl-8a994b0a"><span class="cl-8a96fc56">Model statistics</span></p></td><td class="cl-8a996144"><p class="cl-8a994b0a"><span class="cl-8a96fc56"></span></p></td><td class="cl-8a996144"><p class="cl-8a994b0a"><span class="cl-8a96fc56"></span></p></td><td class="cl-8a996144"><p class="cl-8a994b0a"><span class="cl-8a96fc56"></span></p></td><td class="cl-8a996144"><p class="cl-8a994b0a"><span class="cl-8a96fc56"></span></p></td><td class="cl-8a996144"><p class="cl-8a994b0a"><span class="cl-8a96fc56"></span></p></td><td class="cl-8a996145"><p class="cl-8a994b0a"><span class="cl-8a96fc56">Value</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8a99614e"><p class="cl-8a994b0a"><span class="cl-8a96fc56">Number of cases in model</span></p></td><td class="cl-8a99614f"><p class="cl-8a994b0a"><span class="cl-8a96fc56"></span></p></td><td class="cl-8a99614f"><p class="cl-8a994b0a"><span class="cl-8a96fc56"></span></p></td><td class="cl-8a99614f"><p class="cl-8a994b0a"><span class="cl-8a96fc56"></span></p></td><td class="cl-8a99614f"><p class="cl-8a994b0a"><span class="cl-8a96fc56"></span></p></td><td class="cl-8a99614f"><p class="cl-8a994b0a"><span class="cl-8a96fc56"></span></p></td><td class="cl-8a996158"><p class="cl-8a994b0a"><span class="cl-8a96fc56">60</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8a99613b"><p class="cl-8a994b0a"><span class="cl-8a96fc56">Residual standard error on 58 DF</span></p></td><td class="cl-8a996144"><p class="cl-8a994b0a"><span class="cl-8a96fc56"></span></p></td><td class="cl-8a996144"><p class="cl-8a994b0a"><span class="cl-8a96fc56"></span></p></td><td class="cl-8a996144"><p class="cl-8a994b0a"><span class="cl-8a96fc56"></span></p></td><td class="cl-8a996144"><p class="cl-8a994b0a"><span class="cl-8a96fc56"></span></p></td><td class="cl-8a996144"><p class="cl-8a994b0a"><span class="cl-8a96fc56"></span></p></td><td class="cl-8a996145"><p class="cl-8a994b0a"><span class="cl-8a96fc56">2.93</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8a99614e"><p class="cl-8a994b0a"><span class="cl-8a96fc56">Multiple R-squared</span></p></td><td class="cl-8a99614f"><p class="cl-8a994b0a"><span class="cl-8a96fc56"></span></p></td><td class="cl-8a99614f"><p class="cl-8a994b0a"><span class="cl-8a96fc56"></span></p></td><td class="cl-8a99614f"><p class="cl-8a994b0a"><span class="cl-8a96fc56"></span></p></td><td class="cl-8a99614f"><p class="cl-8a994b0a"><span class="cl-8a96fc56"></span></p></td><td class="cl-8a99614f"><p class="cl-8a994b0a"><span class="cl-8a96fc56"></span></p></td><td class="cl-8a996158"><p class="cl-8a994b0a"><span class="cl-8a96fc56">0.2322</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8a99613b"><p class="cl-8a994b0a"><span class="cl-8a96fc56">Adjusted R-squared</span></p></td><td class="cl-8a996144"><p class="cl-8a994b0a"><span class="cl-8a96fc56"></span></p></td><td class="cl-8a996144"><p class="cl-8a994b0a"><span class="cl-8a96fc56"></span></p></td><td class="cl-8a996144"><p class="cl-8a994b0a"><span class="cl-8a96fc56"></span></p></td><td class="cl-8a996144"><p class="cl-8a994b0a"><span class="cl-8a96fc56"></span></p></td><td class="cl-8a996144"><p class="cl-8a994b0a"><span class="cl-8a96fc56"></span></p></td><td class="cl-8a996145"><p class="cl-8a994b0a"><span class="cl-8a96fc56">0.219</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8a99614e"><p class="cl-8a994b0a"><span class="cl-8a96fc56">F-statistic (1, 58)</span></p></td><td class="cl-8a99614f"><p class="cl-8a994b0a"><span class="cl-8a96fc56"></span></p></td><td class="cl-8a99614f"><p class="cl-8a994b0a"><span class="cl-8a96fc56"></span></p></td><td class="cl-8a99614f"><p class="cl-8a994b0a"><span class="cl-8a96fc56"></span></p></td><td class="cl-8a99614f"><p class="cl-8a994b0a"><span class="cl-8a96fc56"></span></p></td><td class="cl-8a99614f"><p class="cl-8a994b0a"><span class="cl-8a96fc56"></span></p></td><td class="cl-8a996158"><p class="cl-8a994b0a"><span class="cl-8a96fc56">17.55</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8a996159"><p class="cl-8a994b0a"><span class="cl-8a96fc56">Model p-value</span></p></td><td class="cl-8a996162"><p class="cl-8a994b0a"><span class="cl-8a96fc56"></span></p></td><td class="cl-8a996162"><p class="cl-8a994b0a"><span class="cl-8a96fc56"></span></p></td><td class="cl-8a996162"><p class="cl-8a994b0a"><span class="cl-8a96fc56"></span></p></td><td class="cl-8a996162"><p class="cl-8a994b0a"><span class="cl-8a96fc56"></span></p></td><td class="cl-8a996162"><p class="cl-8a994b0a"><span class="cl-8a96fc56"></span></p></td><td class="cl-8a996163"><p class="cl-8a994b0a"><span class="cl-8a96fc56">0.0001</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>We can use the <code>reports</code> package <span class="citation" data-cites="report">(<a href="#ref-report" role="doc-biblioref">Makowski et al. 2021</a>)</span> to summarize the analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(m2.lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear model (estimated using OLS) to predict Score with Group
(formula: Score ~ Group). The model explains a statistically significant and
moderate proportion of variance (R2 = 0.23, F(1, 58) = 17.55, p &lt; .001, adj. R2
= 0.22). The model's intercept, corresponding to Group = A, is at 14.93 (95% CI
[13.86, 16.00], t(58) = 27.94, p &lt; .001). Within this model:

  - The effect of Group [B] is statistically significant and negative (beta =
-3.17, 95% CI [-4.68, -1.65], t(58) = -4.19, p &lt; .001; Std. beta = -0.96, 95%
CI [-1.41, -0.50])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
</div>
<p>We can use this output to write up a final report:</p>
<p>A simple linear regression was fitted to the data. A visual assessment of the model diagnostics did not indicate any problematic or disproportionately influential data points (outliers). The final linear regression model is based on 60 data points, performed significantly better than an intercept-only base line model (F (1, 58): 17.55, p-value &lt;. 001<sup><span class="math inline">\(***\)</span></sup>), and reported that the model explained 21.9 percent of variance which confirmed a good model fit. According to this final model, group A scored significantly better on the language learning test than group B (coefficient: -3.17, 95% CI [-4.68, -1.65], Std. : -0.96, 95% CI [-1.41, -0.50], SE: 0.48, t-value<sub>58</sub>: -4.19, p-value &lt;. 001<sup><span class="math inline">\(***\)</span></sup>). Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using the Wald approximation.</p>
</section>
</section>
<section id="multiple-linear-regression" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="multiple-linear-regression">Multiple Linear Regression</h2>
<p>In contrast to simple linear regression, which estimates the effect of a single predictor, multiple linear regression estimates the effect of various predictor (see the equation below). A multiple linear regression can thus test the effects of various predictors simultaneously.</p>
<p><span class="math display">\[\begin{equation}

f_{(x)} = \alpha + \beta_{1}x_{i} + \beta_{2}x_{i+1} + \dots + \beta_{n}x_{i+n} + \epsilon

\end{equation}\]</span></p>
<p>There exists a wealth of literature focusing on multiple linear regressions and the concepts it is based on. For instance, there are <span class="citation" data-cites="achen1982interpreting">Achen</span>, <span class="citation" data-cites="bortz2006statistik">Bortz</span>, <span class="citation" data-cites="crawley2005statistics">Crawley</span>, <span class="citation" data-cites="faraway2002practical">Faraway</span>, <span class="citation" data-cites="field2012discovering">Field, Miles, and Field</span>, <span class="citation" data-cites="gries2021statistics">Gries</span>, <span class="citation" data-cites="levshina2015linguistics">Levshina</span>, <span class="citation" data-cites="winter2019statistics">Winter</span> and <span class="citation" data-cites="wilcox2009basic">Wilcox</span> to name just a few. Introductions to regression modeling in R are <span class="citation" data-cites="baayen2008analyzing">Baayen</span>, <span class="citation" data-cites="crawley2012r">Crawley</span>, <span class="citation" data-cites="gries2021statistics">Gries</span>, or <span class="citation" data-cites="levshina2015linguistics">Levshina</span>.</p>
<p>The model diagnostics we are dealing with here are partly identical to the diagnostic methods discussed in the section on simple linear regression. Because of this overlap, diagnostics will only be described in more detail if they have not been described in the section on simple linear regression.</p>
<hr>
<div class="warning" style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
<b>EXCURSION</b>
</p>
<p style="margin-left:1em;">
</p>
<p></p>
</span></div>
<div class="question">
<p>`</p>
<details>
<summary>
A note on sample size and power
</summary>
<p>A brief note on minimum necessary sample or data set size appears necessary here. Although there appears to be a general assumption that 25 data points per group are sufficient, this is not necessarily correct (it is merely a general rule of thumb that is actually often incorrect). Such rules of thumb are inadequate because the required sample size depends on the number of variables in a given model, the size of the effect and the variance of the effect - in other words, the minimum necessary sample size relates to <em>statistical power</em> (see <a href="tutorials/pwr/pwr.html">here</a> for a tutorial on power). If a model contains many variables, then this requires a larger sample size than a model which only uses very few predictors.</p>
<p>Also, to detect an effect with a very minor effect size, one needs a substantially larger sample compared to cases where the effect is very strong. In fact, when dealing with small effects, model require a minimum of 600 cases to reliably detect these effects. Finally, effects that are very robust and do not vary much require a much smaller sample size compared with effects that are spurious and vary substantially. Since the sample size depends on the effect size and variance as well as the number of variables, there is no final one-size-fits-all answer to what the best sample size is.</p>
Another, slightly better but still incorrect, rule of thumb is that the more data, the better. This is not correct because models based on too many cases are prone for overfitting and thus report correlations as being significant that are not. However, given that there are procedures that can correct for overfitting, larger data sets are still preferable to data sets that are simply too small to warrant reliable results. In conclusion, it remains true that the sample size depends on the effect under investigation.
</details>
</div>
<p>`</p>
<hr>
<p>Despite there being no ultimate rule of thumb, <span class="citation" data-cites="field2012discovering">Field, Miles, and Field (<a href="#ref-field2012discovering" role="doc-biblioref">273–75</a>)</span>, based on <span class="citation" data-cites="green1991many">Green</span>, provide data-driven suggestions for the minimal size of data required for regression models that aim to find medium sized effects (k = number of predictors; categorical variables with more than two levels should be transformed into dummy variables):</p>
<ul>
<li><p>If one is merely interested in the overall model fit (something I have not encountered), then the sample size should be at least 50 + k (k = number of predictors in model).</p></li>
<li><p>If one is only interested in the effect of specific variables, then the sample size should be at least 104 + k (k = number of predictors in model).</p></li>
<li><p>If one is only interested in both model fit and the effect of specific variables, then the sample size should be at least the higher value of 50 + k or 104 + k (k = number of predictors in model).</p></li>
</ul>
<p>You will see in the R code below that there is already a function that tests whether the sample size is sufficient.</p>
<section id="example-gifts-and-availability" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="example-gifts-and-availability">Example: Gifts and Availability</h3>
<p>The example we will go through here is taken from <span class="citation" data-cites="field2012discovering">Field, Miles, and Field</span>. In this example, the research question is if the money that men spend on presents for women depends on the women’s attractiveness and their relationship status. To answer this research question, we will implement a multiple linear regression and start by loading the data and inspect its structure and properties.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>mlrdata  <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="st">"tutorials/regression/data/mld.rda"</span>, <span class="st">"rb"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-8ad7c97a{table-layout:auto;width:75%;}.cl-8ad25fda{font-family:'DejaVu Sans';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8ad25fee{font-family:'DejaVu Sans';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8ad4c0c2{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8ad4c0d6{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8ad4d74c{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8ad4d756{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8ad4d757{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8ad4d760{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8ad4d761{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8ad4d76a{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8ad4d774{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8ad4d775{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8ad4d77e{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8ad4d77f{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8ad4d788{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8ad4d792{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-8ad7c97a"><thead><tr style="overflow-wrap:break-word;"><th class="cl-8ad4d74c"><p class="cl-8ad4c0c2"><span class="cl-8ad25fda">status</span></p></th><th class="cl-8ad4d756"><p class="cl-8ad4c0c2"><span class="cl-8ad25fda">attraction</span></p></th><th class="cl-8ad4d757"><p class="cl-8ad4c0d6"><span class="cl-8ad25fda">money</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-8ad4d760"><p class="cl-8ad4c0c2"><span class="cl-8ad25fee">Relationship</span></p></td><td class="cl-8ad4d761"><p class="cl-8ad4c0c2"><span class="cl-8ad25fee">NotInterested</span></p></td><td class="cl-8ad4d76a"><p class="cl-8ad4c0d6"><span class="cl-8ad25fee">86.33</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8ad4d774"><p class="cl-8ad4c0c2"><span class="cl-8ad25fee">Relationship</span></p></td><td class="cl-8ad4d775"><p class="cl-8ad4c0c2"><span class="cl-8ad25fee">NotInterested</span></p></td><td class="cl-8ad4d77e"><p class="cl-8ad4c0d6"><span class="cl-8ad25fee">45.58</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8ad4d760"><p class="cl-8ad4c0c2"><span class="cl-8ad25fee">Relationship</span></p></td><td class="cl-8ad4d761"><p class="cl-8ad4c0c2"><span class="cl-8ad25fee">NotInterested</span></p></td><td class="cl-8ad4d76a"><p class="cl-8ad4c0d6"><span class="cl-8ad25fee">68.43</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8ad4d774"><p class="cl-8ad4c0c2"><span class="cl-8ad25fee">Relationship</span></p></td><td class="cl-8ad4d775"><p class="cl-8ad4c0c2"><span class="cl-8ad25fee">NotInterested</span></p></td><td class="cl-8ad4d77e"><p class="cl-8ad4c0d6"><span class="cl-8ad25fee">52.93</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8ad4d760"><p class="cl-8ad4c0c2"><span class="cl-8ad25fee">Relationship</span></p></td><td class="cl-8ad4d761"><p class="cl-8ad4c0c2"><span class="cl-8ad25fee">NotInterested</span></p></td><td class="cl-8ad4d76a"><p class="cl-8ad4c0d6"><span class="cl-8ad25fee">61.86</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8ad4d774"><p class="cl-8ad4c0c2"><span class="cl-8ad25fee">Relationship</span></p></td><td class="cl-8ad4d775"><p class="cl-8ad4c0c2"><span class="cl-8ad25fee">NotInterested</span></p></td><td class="cl-8ad4d77e"><p class="cl-8ad4c0d6"><span class="cl-8ad25fee">48.47</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8ad4d760"><p class="cl-8ad4c0c2"><span class="cl-8ad25fee">Relationship</span></p></td><td class="cl-8ad4d761"><p class="cl-8ad4c0c2"><span class="cl-8ad25fee">NotInterested</span></p></td><td class="cl-8ad4d76a"><p class="cl-8ad4c0d6"><span class="cl-8ad25fee">32.79</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8ad4d774"><p class="cl-8ad4c0c2"><span class="cl-8ad25fee">Relationship</span></p></td><td class="cl-8ad4d775"><p class="cl-8ad4c0c2"><span class="cl-8ad25fee">NotInterested</span></p></td><td class="cl-8ad4d77e"><p class="cl-8ad4c0d6"><span class="cl-8ad25fee">35.91</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8ad4d760"><p class="cl-8ad4c0c2"><span class="cl-8ad25fee">Relationship</span></p></td><td class="cl-8ad4d761"><p class="cl-8ad4c0c2"><span class="cl-8ad25fee">NotInterested</span></p></td><td class="cl-8ad4d76a"><p class="cl-8ad4c0d6"><span class="cl-8ad25fee">30.98</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8ad4d774"><p class="cl-8ad4c0c2"><span class="cl-8ad25fee">Relationship</span></p></td><td class="cl-8ad4d775"><p class="cl-8ad4c0c2"><span class="cl-8ad25fee">NotInterested</span></p></td><td class="cl-8ad4d77e"><p class="cl-8ad4c0d6"><span class="cl-8ad25fee">44.82</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8ad4d760"><p class="cl-8ad4c0c2"><span class="cl-8ad25fee">Relationship</span></p></td><td class="cl-8ad4d761"><p class="cl-8ad4c0c2"><span class="cl-8ad25fee">NotInterested</span></p></td><td class="cl-8ad4d76a"><p class="cl-8ad4c0d6"><span class="cl-8ad25fee">35.05</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8ad4d774"><p class="cl-8ad4c0c2"><span class="cl-8ad25fee">Relationship</span></p></td><td class="cl-8ad4d775"><p class="cl-8ad4c0c2"><span class="cl-8ad25fee">NotInterested</span></p></td><td class="cl-8ad4d77e"><p class="cl-8ad4c0d6"><span class="cl-8ad25fee">64.49</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8ad4d760"><p class="cl-8ad4c0c2"><span class="cl-8ad25fee">Relationship</span></p></td><td class="cl-8ad4d761"><p class="cl-8ad4c0c2"><span class="cl-8ad25fee">NotInterested</span></p></td><td class="cl-8ad4d76a"><p class="cl-8ad4c0d6"><span class="cl-8ad25fee">54.50</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8ad4d774"><p class="cl-8ad4c0c2"><span class="cl-8ad25fee">Relationship</span></p></td><td class="cl-8ad4d775"><p class="cl-8ad4c0c2"><span class="cl-8ad25fee">NotInterested</span></p></td><td class="cl-8ad4d77e"><p class="cl-8ad4c0d6"><span class="cl-8ad25fee">61.48</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8ad4d77f"><p class="cl-8ad4c0c2"><span class="cl-8ad25fee">Relationship</span></p></td><td class="cl-8ad4d788"><p class="cl-8ad4c0c2"><span class="cl-8ad25fee">NotInterested</span></p></td><td class="cl-8ad4d792"><p class="cl-8ad4c0d6"><span class="cl-8ad25fee">55.51</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>The data set consist of three variables stored in three columns. The first column contains the relationship status of the present giver (in this study this were men), the second whether the man is interested in the woman (the present receiver in this study), and the third column represents the money spend on the present. The data set represents 100 cases and the mean amount of money spend on a present is 88.38 dollars. In a next step, we visualize the data to get a more detailed impression of the relationships between variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create plots</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mlrdata, <span class="fu">aes</span>(status, money)) <span class="sc">+</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co"># plot 2</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mlrdata, <span class="fu">aes</span>(attraction, money)) <span class="sc">+</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="co"># plot 3</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mlrdata, <span class="fu">aes</span>(<span class="at">x =</span> money)) <span class="sc">+</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span>..density..)) <span class="sc">+</span>            </span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span>         </span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha=</span>.<span class="dv">2</span>, <span class="at">fill =</span> <span class="st">"gray50"</span>) </span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="co"># plot 4</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mlrdata, <span class="fu">aes</span>(status, money)) <span class="sc">+</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">factor</span>(status))) <span class="sc">+</span> </span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"grey30"</span>, <span class="st">"grey70"</span>)) <span class="sc">+</span> </span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> attraction) <span class="sc">+</span> </span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a><span class="co"># show plots</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(<span class="at">grobs =</span> <span class="fu">list</span>(p1, p2, p3, p4), <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">layout_matrix =</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/mlr3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The upper left figure consists of a boxplot which shows how much money was spent by relationship status. The figure suggests that men spend more on women if they are not in a relationship. The next figure shows the relationship between the money spend on presents and whether or not the men were interested in the women.</p>
<p>The boxplot in the upper right panel suggests that men spend substantially more on women if the men are interested in them. The next figure depicts the distribution of the amounts of money spend on the presents for the women. In addition, the figure indicates the existence of two outliers (dots in the boxplot)</p>
<p>The histogram in the lower left panel shows that, although the mean amount of money spent on presents is 88.38 dollars, the distribution peaks around 50 dollars indicating that on average, men spend about 50 dollars on presents. Finally, we will plot the amount of money spend on presents against relationship status by attraction in order to check whether the money spent on presents is affected by an interaction between attraction and relationship status.</p>
<p>The boxplot in the lower right panel confirms the existence of an interaction (a non-additive term) as men only spend more money on women if the men single <em>and</em> they are interested in the women. If men are not interested in the women, then the relationship has no effect as they spend an equal amount of money on the women regardless of whether they are in a relationship or not.</p>
<p>We will now start to implement the regression model. In a first step, we create two saturated models that contain all possible predictors (main effects and interactions). The two models are identical but one is generated with the <code>lm</code> and the other with the <code>glm</code> function as these functions offer different model parameters in their output.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>m1.mlr <span class="ot">=</span> <span class="fu">lm</span>(                      <span class="co"># generate lm regression object</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  money <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> attraction<span class="sc">*</span>status,  <span class="co"># def. regression formula (1 = intercept)</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mlrdata)                 <span class="co"># def. data</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>m1.glm <span class="ot">=</span> <span class="fu">glm</span>(                     <span class="co"># generate glm regression object</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  money <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> attraction<span class="sc">*</span>status,  <span class="co"># def. regression formula (1 = intercept)</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> gaussian,              <span class="co"># def. linkage function</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mlrdata)                 <span class="co"># def. data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>After generating the saturated models we can now start with the model fitting. Model fitting refers to a process that aims at find the model that explains a maximum of variance with a minimum of predictors <span class="citation" data-cites="field2012discovering">(see <a href="#ref-field2012discovering" role="doc-biblioref">Field, Miles, and Field, 318</a>)</span>. Model fitting is therefore based on the <em>principle of parsimony</em> which is related to Occam’s razor according to which explanations that require fewer assumptions are more likely to be true.</p>
</section>
<section id="automatic-model-fitting-and-why-you-should-not-use-it" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="automatic-model-fitting-and-why-you-should-not-use-it">Automatic Model Fitting and Why You Should Not Use It</h3>
<p>In this section, we will use a step-wise step-down procedure that uses decreases in AIC (<em>Akaike Information Criterion</em>) as the criterion to minimize the model in a step-wise manner. This procedure aims at finding the model with the lowest AIC values by evaluating - step-by-step - whether the removal of a predictor (term) leads to a lower AIC value.</p>
<p>We use this method here just so that you know it exists and how to implement it but you should rather avoid using automated model fitting. The reason for avoiding automated model fitting is that the algorithm only checks if the AIC has decreased but not if the model is stable or reliable. Thus, automated model fitting has the problem that you can never be sure that the way that lead you to the final model is reliable and that all models were indeed stable. Imagine you want to climb down from a roof top and you have a ladder. The problem is that you do not know if and how many steps are broken. This is similar to using automated model fitting. In other sections, we will explore better methods to fit models (manual step-wise step-up and step-down procedures, for example).</p>
<p>The AIC is calculated using the equation below. The lower the AIC value, the better the balance between explained variance and the number of predictors. AIC values can and should only be compared for models that are fit on the same data set with the same (number of) cases (<em>LL</em> stands for <em>logged likelihood</em> or <em>LogLikelihood</em> and <em>k</em> represents the number of predictors in the model (including the intercept); the LL represents a measure of how good the model fits the data).</p>
<p><span class="math display">\[\begin{equation}
Akaike Information Criterion (AIC) = -2LL + 2k
\end{equation}\]</span></p>
<p>An alternative to the AIC is the BIC (Bayesian Information Criterion). Both AIC and BIC penalize models for including variables in a model. The penalty of the BIC is bigger than the penalty of the AIC and it includes the number of cases in the model (<em>LL</em> stands for <em>logged likelihood</em> or <em>LogLikelihood</em>, <em>k</em> represents the number of predictors in the model (including the intercept), and <em>N</em> represents the number of cases in the model).</p>
<p><span class="math display">\[\begin{equation}
Bayesian Information Criterion (BIC) = -2LL + 2k * log(N)
\end{equation}\]</span></p>
<p>Interactions are evaluated first and only if all insignificant interactions have been removed would the procedure start removing insignificant main effects (that are not part of significant interactions). Other model fitting procedures (forced entry, step-wise step up, hierarchical) are discussed during the implementation of other regression models. We cannot discuss all procedures here as model fitting is rather complex and a discussion of even the most common procedures would to lengthy and time consuming at this point. It is important to note though that there is not perfect model fitting procedure and automated approaches should be handled with care as they are likely to ignore violations of model parameters that can be detected during manual - but time consuming - model fitting procedures. As a general rule of thumb, it is advisable to fit models as carefully and deliberately as possible. We will now begin to fit the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># automated AIC based model fitting</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">step</span>(m1.mlr, <span class="at">direction =</span> <span class="st">"both"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=592.52
money ~ 1 + attraction * status

                    Df   Sum of Sq         RSS         AIC
&lt;none&gt;                             34557.56428 592.5211556
- attraction:status  1 24947.25481 59504.81909 644.8642395</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = money ~ 1 + attraction * status, data = mlrdata)

Coefficients:
                         (Intercept)               attractionNotInterested  
                             99.1548                              -47.6628  
                        statusSingle  attractionNotInterested:statusSingle  
                             57.6928                              -63.1788  </code></pre>
</div>
</div>
<p>The automated model fitting procedure informs us that removing predictors has not caused a decrease in the AIC. The saturated model is thus also the final minimal adequate model. We will now inspect the final minimal model and go over the model report.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>m2.mlr <span class="ot">=</span> <span class="fu">lm</span>(                       <span class="co"># generate lm regression object</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  money <span class="sc">~</span> (status <span class="sc">+</span> attraction)<span class="sc">^</span><span class="dv">2</span>, <span class="co"># def. regression formula</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mlrdata)                  <span class="co"># def. data</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>m2.glm <span class="ot">=</span> <span class="fu">glm</span>(                      <span class="co"># generate glm regression object</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  money <span class="sc">~</span> (status <span class="sc">+</span> attraction)<span class="sc">^</span><span class="dv">2</span>, <span class="co"># def. regression formula</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> gaussian,               <span class="co"># def. linkage function</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mlrdata)                  <span class="co"># def. data</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect final minimal model</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2.mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = money ~ (status + attraction)^2, data = mlrdata)

Residuals:
     Min       1Q   Median       3Q      Max 
-45.0760 -14.2580   0.4596  11.9315  44.1424 

Coefficients:
                                         Estimate   Std. Error  t value
(Intercept)                           99.15480000   3.79459947 26.13050
statusSingle                          57.69280000   5.36637403 10.75080
attractionNotInterested              -47.66280000   5.36637403 -8.88175
statusSingle:attractionNotInterested -63.17880000   7.58919893 -8.32483
                                                   Pr(&gt;|t|)    
(Intercept)                          &lt; 0.000000000000000222 ***
statusSingle                         &lt; 0.000000000000000222 ***
attractionNotInterested                 0.00000000000003751 ***
statusSingle:attractionNotInterested    0.00000000000058085 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 18.9729973 on 96 degrees of freedom
Multiple R-squared:  0.852041334,   Adjusted R-squared:  0.847417626 
F-statistic: 184.276619 on 3 and 96 DF,  p-value: &lt; 0.0000000000000002220446</code></pre>
</div>
</div>
<p>The first element of the report is called <em>Call</em> and it reports the regression formula of the model. Then, the report provides the residual distribution (the range, median and quartiles of the residuals) which allows drawing inferences about the distribution of differences between observed and expected values. If the residuals are distributed non-normally, then this is a strong indicator that the model is unstable and unreliable because mathematical assumptions on which the model is based are violated.</p>
<p>Next, the model summary reports the most important part: a table with model statistics of the fixed-effects structure of the model. The table contains the estimates (coefficients of the predictors), standard errors, t-values, and the p-values which show whether a predictor significantly correlates with the dependent variable that the model investigates.</p>
<p>All main effects (status and attraction) as well as the interaction between status and attraction is reported as being significantly correlated with the dependent variable (money). An interaction occurs if a correlation between the dependent variable and a predictor is affected by another predictor.</p>
<p>The top most term is called intercept and has a value of 99.15 which represents the base estimate to which all other estimates refer. To exemplify what this means, let us consider what the model would predict that a man would spend on a present if he interested in the woman but he is also in a relationship. The amount he would spend (based on the model would be 99.15 dollars (which is the intercept). This means that the intercept represents the predicted value if all predictors take the base or reference level. And since being in relationship but being interested are the case, and because the interaction does not apply, the predicted value in our example is exactly the intercept (see below).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#intercept  Single  NotInterested  Single:NotInterested</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fl">99.15</span>     <span class="sc">+</span> <span class="fl">57.69</span>  <span class="sc">+</span> <span class="dv">0</span>           <span class="sc">+</span> <span class="dv">0</span>     <span class="co"># 156.8 single + interested</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 156.84</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fl">99.15</span>     <span class="sc">+</span> <span class="fl">57.69</span>  <span class="sc">-</span> <span class="fl">47.66</span>       <span class="sc">-</span> <span class="fl">63.18</span> <span class="co"># 46.00 single + not interested</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 46</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fl">99.15</span>     <span class="sc">-</span> <span class="dv">0</span>      <span class="sc">+</span> <span class="dv">0</span>           <span class="sc">-</span> <span class="dv">0</span>     <span class="co"># 99.15 relationship + interested</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 99.15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fl">99.15</span>     <span class="sc">-</span> <span class="dv">0</span>      <span class="sc">-</span> <span class="fl">47.66</span>       <span class="sc">-</span> <span class="dv">0</span>     <span class="co"># 51.49 relationship + not interested</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 51.49</code></pre>
</div>
</div>
<p>Now, let us consider what a man would spend if he is in a relationship and he is not attracted to the women. In that case, the model predicts that the man would spend only 51.49 dollars on a present: the intercept (99.15) minus 47.66 because the man is not interested (and no additional subtraction because the interaction does not apply).</p>
<p>We can derive the same results easier using the <code>predict</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make prediction based on the model for original data</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>prediction <span class="ot">&lt;-</span> <span class="fu">predict</span>(m2.mlr, <span class="at">newdata =</span> mlrdata)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect predictions</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">round</span>(prediction,<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 46.01  51.49  99.15 156.85 
    25     25     25     25 </code></pre>
</div>
</div>
<p>Below the table of coefficients, the regression summary reports model statistics that provide information about how well the model performs. The difference between the values and the values in the coefficients table is that the model statistics refer to the model as a whole rather than focusing on individual predictors.</p>
<p>The multiple R<sup>2</sup>-value is a measure of how much variance the model explains. A multiple R<sup>2</sup>-value of 0 would inform us that the model does not explain any variance while a value of .852 mean that the model explains 85.2 percent of the variance. A value of 1 would inform us that the model explains 100 percent of the variance and that the predictions of the model match the observed values perfectly. Multiplying the multiple R<sup>2</sup>-value thus provides the percentage of explained variance. Models that have a multiple R<sup>2</sup>-value equal or higher than .05 are deemed substantially significant <span class="citation" data-cites="szmrecsanyi2006morphosyntactic">(see <a href="#ref-szmrecsanyi2006morphosyntactic" role="doc-biblioref">Szmrecsanyi, 55</a>)</span>. It has been claimed that models should explain a minimum of 5 percent of variance but this is problematic as it is not uncommon for models to have very low explanatory power while still performing significantly and systematically better than chance. In addition, the total amount of variance is negligible in cases where one is interested in very weak but significant effects. It is much more important for model to perform significantly better than minimal base-line models because if this is not the case, then the model does not have any predictive and therefore no explanatory power.</p>
<p>The adjusted R<sup>2</sup>-value considers the amount of explained variance in light of the number of predictors in the model (it is thus somewhat similar to the AIC and BIC) and informs about how well the model would perform if it were applied to the population that the sample is drawn from. Ideally, the difference between multiple and adjusted R<sup>2</sup>-value should be very small as this means that the model is not overfitted. If, however, the difference between multiple and adjusted R<sup>2</sup>-value is substantial, then this would strongly suggest that the model is unstable and overfitted to the data while being inadequate for drawing inferences about the population. Differences between multiple and adjusted R<sup>2</sup>-values indicate that the data contains outliers that cause the distribution of the data on which the model is based to differ from the distributions that the model mathematically requires to provide reliable estimates. The difference between multiple and adjusted R<sup>2</sup>-value in our model is very small (85.2-84.7=.05) and should not cause concern.</p>
<p>Before continuing, we will calculate the confidence intervals of the coefficients.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract confidence intervals of the coefficients</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(m2.mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                              2.5 %         97.5 %
(Intercept)                           91.6225795890 106.6870204110
statusSingle                          47.0406317400  68.3449682600
attractionNotInterested              -58.3149682600 -37.0106317400
statusSingle:attractionNotInterested -78.2432408219 -48.1143591781</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create and compare baseline- and minimal adequate model</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>m0.mlr <span class="ot">&lt;-</span> <span class="fu">lm</span>(money <span class="sc">~</span><span class="dv">1</span>, <span class="at">data =</span> mlrdata)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m0.mlr, m2.mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: money ~ 1
Model 2: money ~ (status + attraction)^2
  Res.Df          RSS Df   Sum of Sq         F                 Pr(&gt;F)    
1     99 233562.28650                                                    
2     96  34557.56428  3 199004.7222 184.27662 &lt; 0.000000000000000222 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Now, we compare the final minimal adequate model to the base-line model to test whether then final model significantly outperforms the baseline model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare baseline- and minimal adequate model</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(m0.mlr, m2.mlr, <span class="at">type =</span> <span class="st">"III"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type III tests)

Response: money
                 Sum Sq Df    F value                 Pr(&gt;F)    
(Intercept) 781015.8300  1 2169.64133 &lt; 0.000000000000000222 ***
Residuals    34557.5643 96                                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>The comparison between the two model confirms that the minimal adequate model performs significantly better (makes significantly more accurate estimates of the outcome variable) compared with the baseline model.</p>
</section>
<section id="model-diagnostics" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="model-diagnostics">Model diagnostics</h3>
<p>We now check the model performance using the <code>model_performance()</code> function and to diagnose the model, we are using the <code>check_model()</code> function from the <code>performance</code> package <span class="citation" data-cites="ludeke2021performance">(<a href="#ref-ludeke2021performance" role="doc-biblioref"><strong>ludeke2021performance?</strong></a>)</span>.</p>
<p>We start by checking the performance of the null-model against the performance values of the final minimal adequate model. Ideally, the final minimal adequate model would show higher explanatory power (higher R2 values) and better parsimony (lower AIC and AICc as well as BIC values).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">model_performance</span>(m0.mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC      |     AICc |      BIC |    R2 | R2 (adj.) |   RMSE |  Sigma
--------------------------------------------------------------------
1063.391 | 1063.515 | 1068.601 | 0.000 |     0.000 | 48.328 | 48.572</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">model_performance</span>(m2.mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC     |    AICc |     BIC |    R2 | R2 (adj.) |   RMSE |  Sigma
-----------------------------------------------------------------
878.309 | 878.947 | 891.335 | 0.852 |     0.847 | 18.590 | 18.973</code></pre>
</div>
</div>
<p>The output confirms that the final minimal adequate model performs substantively better than the null model (higher explanatory power and better parsimony). We now diagnose the model using the <code>check_model()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">check_model</span>(m2.mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="outlier-detection" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="outlier-detection">Outlier Detection</h3>
<p>In a next step, we now need to look for outliers check whether removing data points disproportionately decreases model fit. To begin with, we generate diagnostic plots.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate plots</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(m2.mlr) <span class="sc">+</span> </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/mlr11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The plots do not show severe problems such as funnel shaped patterns or drastic deviations from the diagonal line in Normal Q-Q plot (have a look at the explanation of what to look for and how to interpret these diagnostic plots in the section on simple linear regression) but data points 52, 64, and 83 are repeatedly indicated as potential outliers.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># determine a cutoff for data points that have D-values higher than 4/(n-k-1)</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>cutoff <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">/</span>((<span class="fu">nrow</span>(mlrdata)<span class="sc">-</span><span class="fu">length</span>(m2.mlr<span class="sc">$</span>coefficients)<span class="sc">-</span><span class="dv">2</span>))</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="co"># start plotting</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))           <span class="co"># display plots in 3 rows/2 columns</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="fu">qqPlot</span>(m2.mlr, <span class="at">main=</span><span class="st">"QQ Plot"</span>) <span class="co"># create qq-plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 52 83</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m2.mlr, <span class="at">which=</span><span class="dv">4</span>, <span class="at">cook.levels =</span> cutoff); <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/mlr12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The graphs indicate that data points 52, 64, and 83 may be problematic. We will therefore statistically evaluate whether these data points need to be removed. In order to find out which data points require removal, we extract the influence measure statistics and add them to out data set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract influence statistics</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>infl <span class="ot">&lt;-</span> <span class="fu">influence.measures</span>(m2.mlr)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="co"># add infl. statistics to data</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>mlrdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(mlrdata, infl[[<span class="dv">1</span>]], infl[[<span class="dv">2</span>]])</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="co"># annotate too influential data points</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>remove <span class="ot">&lt;-</span> <span class="fu">apply</span>(infl<span class="sc">$</span>is.inf, <span class="dv">1</span>, <span class="cf">function</span>(x) {</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(x <span class="sc">==</span> <span class="cn">TRUE</span>, <span class="fu">return</span>(<span class="st">"remove"</span>), <span class="fu">return</span>(<span class="st">"keep"</span>)) } )</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a><span class="co"># add annotation to data</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>mlrdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(mlrdata, remove)</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a><span class="co"># number of rows before removing outliers</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(mlrdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 100</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove outliers</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>mlrdata <span class="ot">&lt;-</span> mlrdata[mlrdata<span class="sc">$</span>remove <span class="sc">==</span> <span class="st">"keep"</span>, ]</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="co"># number of rows after removing outliers</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(mlrdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 98</code></pre>
</div>
</div>
<p>The difference in row in the data set before and after removing data points indicate that two data points which represented outliers have been removed.</p>
<div class="warning" style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
<b>NOTE</b><br><br>In general, outliers should not simply be removed unless there are good reasons for it (this could be that the outliers represent measurement errors). If a data set contains outliers, one should rather switch to methods that are better at handling outliers, e.g.&nbsp;by using weights to account for data points with high leverage. One alternative would be to switch to a robust regression (see <a href="tutorials/regression/regression.html#16_Robust_Regression">here</a>). However, here we show how to proceed by removing outliers as this is a common, though potentially problematic, method of dealing with outliers.
</p>
<p style="margin-left:1em;">
</p>
<p></p>
</span></div>
<p><br></p>
</section>
<section id="rerun-regression" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="rerun-regression">Rerun Regression</h3>
<p>As we have decided to remove the outliers which means that we are now dealing with a different data set, we need to rerun the regression analysis. As the steps are identical to the regression analysis performed above, the steps will not be described in greater detail.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># recreate regression models on new data</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>m0.mlr <span class="ot">=</span> <span class="fu">lm</span>(money <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> mlrdata)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>m0.glm <span class="ot">=</span> <span class="fu">glm</span>(money <span class="sc">~</span> <span class="dv">1</span>, <span class="at">family =</span> gaussian, <span class="at">data =</span> mlrdata)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>m1.mlr <span class="ot">=</span> <span class="fu">lm</span>(money <span class="sc">~</span> (status <span class="sc">+</span> attraction)<span class="sc">^</span><span class="dv">2</span>, <span class="at">data =</span> mlrdata)</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>m1.glm <span class="ot">=</span> <span class="fu">glm</span>(money <span class="sc">~</span> status <span class="sc">*</span> attraction, <span class="at">family =</span> gaussian,</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> mlrdata)</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a><span class="co"># automated AIC based model fitting</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a><span class="fu">step</span>(m1.mlr, <span class="at">direction =</span> <span class="st">"both"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=570.29
money ~ (status + attraction)^2

                    Df   Sum of Sq         RSS         AIC
&lt;none&gt;                             30411.31714 570.2850562
- status:attraction  1 21646.86199 52058.17914 620.9646729</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = money ~ (status + attraction)^2, data = mlrdata)

Coefficients:
                         (Intercept)                          statusSingle  
                          99.1548000                            55.8535333  
             attractionNotInterested  statusSingle:attractionNotInterested  
                         -47.6628000                           -59.4613667  </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create new final models</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>m2.mlr <span class="ot">=</span> <span class="fu">lm</span>(money <span class="sc">~</span> (status <span class="sc">+</span> attraction)<span class="sc">^</span><span class="dv">2</span>, <span class="at">data =</span> mlrdata)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>m2.glm <span class="ot">=</span> <span class="fu">glm</span>(money <span class="sc">~</span> status <span class="sc">*</span> attraction, <span class="at">family =</span> gaussian,</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> mlrdata)</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect final minimal model</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2.mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = money ~ (status + attraction)^2, data = mlrdata)

Residuals:
         Min           1Q       Median           3Q          Max 
-35.76416667 -13.50520000  -0.98948333  10.59887500  38.77166667 

Coefficients:
                                         Estimate   Std. Error  t value
(Intercept)                           99.15480000   3.59735820 27.56323
statusSingle                          55.85353333   5.14015367 10.86612
attractionNotInterested              -47.66280000   5.08743275 -9.36873
statusSingle:attractionNotInterested -59.46136667   7.26927504 -8.17982
                                                   Pr(&gt;|t|)    
(Intercept)                          &lt; 0.000000000000000222 ***
statusSingle                         &lt; 0.000000000000000222 ***
attractionNotInterested               0.0000000000000040429 ***
statusSingle:attractionNotInterested  0.0000000000013375166 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 17.986791 on 94 degrees of freedom
Multiple R-squared:  0.857375902,   Adjusted R-squared:  0.852824069 
F-statistic: 188.358387 on 3 and 94 DF,  p-value: &lt; 0.0000000000000002220446</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract confidence intervals of the coefficients</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(m2.mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                              2.5 %         97.5 %
(Intercept)                           92.0121609656 106.2974390344
statusSingle                          45.6476377202  66.0594289465
attractionNotInterested              -57.7640169936 -37.5615830064
statusSingle:attractionNotInterested -73.8946826590 -45.0280506744</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare baseline with final model</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m0.mlr, m2.mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: money ~ 1
Model 2: money ~ (status + attraction)^2
  Res.Df          RSS Df   Sum of Sq         F                 Pr(&gt;F)    
1     97 213227.06081                                                    
2     94  30411.31714  3 182815.7437 188.35839 &lt; 0.000000000000000222 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare baseline with final model</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(m0.mlr, m2.mlr, <span class="at">type =</span> <span class="st">"III"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type III tests)

Response: money
                 Sum Sq Df    F value                 Pr(&gt;F)    
(Intercept) 760953.2107  1 2352.07181 &lt; 0.000000000000000222 ***
Residuals    30411.3171 94                                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="additional-model-diagnostics" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="additional-model-diagnostics">Additional Model Diagnostics</h3>
<p>After rerunning the regression analysis on the updated data set, we again create diagnostic plots in order to check whether there are potentially problematic data points.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate plots</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(m2.mlr) <span class="sc">+</span> </span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/mlr19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># determine a cutoff for data points that have</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="co"># D-values higher than 4/(n-k-1)</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>cutoff <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">/</span>((<span class="fu">nrow</span>(mlrdata)<span class="sc">-</span><span class="fu">length</span>(m2.mlr<span class="sc">$</span>coefficients)<span class="sc">-</span><span class="dv">2</span>))</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="co"># start plotting</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))           <span class="co"># display plots in 1 row/2 columns</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a><span class="fu">qqPlot</span>(m2.mlr, <span class="at">main=</span><span class="st">"QQ Plot"</span>) <span class="co"># create qq-plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>84 88 
82 86 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m2.mlr, <span class="at">which=</span><span class="dv">4</span>, <span class="at">cook.levels =</span> cutoff); <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/mlr20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Although the diagnostic plots indicate that additional points may be problematic, but these data points deviate substantially less from the trend than was the case with the data points that have already been removed. To make sure that retaining the data points that are deemed potentially problematic by the diagnostic plots, is acceptable, we extract diagnostic statistics and add them to the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add model diagnostics to the data</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>mlrdata <span class="ot">&lt;-</span> mlrdata <span class="sc">%&gt;%</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">residuals =</span> <span class="fu">resid</span>(m2.mlr),</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">standardized.residuals =</span> <span class="fu">rstandard</span>(m2.mlr),</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">studentized.residuals =</span> <span class="fu">rstudent</span>(m2.mlr),</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">cooks.distance =</span> <span class="fu">cooks.distance</span>(m2.mlr),</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">dffit =</span> <span class="fu">dffits</span>(m2.mlr),</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">leverage =</span> <span class="fu">hatvalues</span>(m2.mlr),</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">covariance.ratios =</span> <span class="fu">covratio</span>(m2.mlr),</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">fitted =</span> m2.mlr<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can now use these diagnostic statistics to create more precise diagnostic plots.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot 5</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mlrdata,</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(studentized.residuals)) <span class="sc">+</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span>..density..),</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">binwidth =</span> .<span class="dv">2</span>,</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">colour=</span><span class="st">"black"</span>,</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"gray90"</span>) <span class="sc">+</span></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Studentized Residual"</span>, <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm,</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fu">mean</span>(mlrdata<span class="sc">$</span>studentized.residuals, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>                            <span class="at">sd =</span> <span class="fu">sd</span>(mlrdata<span class="sc">$</span>studentized.residuals, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">8</span>)</span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a><span class="co"># plot 6</span></span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a>p6 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mlrdata, <span class="fu">aes</span>(fitted, studentized.residuals)) <span class="sc">+</span></span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">colour =</span> <span class="st">"Red"</span>)<span class="sc">+</span></span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">8</span>)<span class="sc">+</span></span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Fitted Values"</span>,</span>
<span id="cb86-21"><a href="#cb86-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Studentized Residual"</span>)</span>
<span id="cb86-22"><a href="#cb86-22" aria-hidden="true" tabindex="-1"></a><span class="co"># plot 7</span></span>
<span id="cb86-23"><a href="#cb86-23" aria-hidden="true" tabindex="-1"></a>p7 <span class="ot">&lt;-</span> <span class="fu">qplot</span>(<span class="at">sample =</span> mlrdata<span class="sc">$</span>studentized.residuals) <span class="sc">+</span></span>
<span id="cb86-24"><a href="#cb86-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb86-25"><a href="#cb86-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Theoretical Values"</span>,</span>
<span id="cb86-26"><a href="#cb86-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Observed Values"</span>)</span>
<span id="cb86-27"><a href="#cb86-27" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(p5, p6, p7, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/mlr22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The new diagnostic plots do not indicate outliers that require removal. With respect to such data points the following parameters should be considered:</p>
<ol type="1">
<li><p>Data points with standardized residuals &gt; 3.29 should be removed <span class="citation" data-cites="field2012discovering">(<a href="#ref-field2012discovering" role="doc-biblioref">Field, Miles, and Field, 269</a>)</span></p></li>
<li><p>If more than 1 percent of data points have standardized residuals exceeding values &gt; 2.58, then the error rate of the model is unacceptable <span class="citation" data-cites="field2012discovering">(<a href="#ref-field2012discovering" role="doc-biblioref">Field, Miles, and Field, 269</a>)</span>.</p></li>
<li><p>If more than 5 percent of data points have standardized residuals exceeding values &gt; 1.96, then the error rate of the model is unacceptable <span class="citation" data-cites="field2012discovering">(<a href="#ref-field2012discovering" role="doc-biblioref">Field, Miles, and Field, 269</a>)</span></p></li>
<li><p>In addition, data points with Cook’s D-values &gt; 1 should be removed <span class="citation" data-cites="field2012discovering">(<a href="#ref-field2012discovering" role="doc-biblioref">Field, Miles, and Field, 269</a>)</span></p></li>
<li><p>Also, data points with leverage values higher than <span class="math inline">\(3(k + 1)/N\)</span> or <span class="math inline">\(2(k + 1)/N\)</span> (k = Number of predictors, N = Number of cases in model) should be removed <span class="citation" data-cites="field2012discovering">(<a href="#ref-field2012discovering" role="doc-biblioref">Field, Miles, and Field, 270</a>)</span></p></li>
<li><p>There should not be (any) autocorrelation among predictors. This means that independent variables cannot be correlated with itself (for instance, because data points come from the same subject). If there is autocorrelation among predictors, then a Repeated Measures Design or a (hierarchical) mixed-effects model should be implemented instead.</p></li>
<li><p>Predictors cannot substantially correlate with each other (multicollinearity) (see the <a href="tutorials/regression/regression.html#Multicollinearity">subsection on (multi-)collinearity</a> in the section of multiple binomial logistic regression for more details about (multi-)collinearity). If a model contains predictors that have variance inflation factors (VIF) &gt; 10 the model is unreliable <span class="citation" data-cites="myers1990classical">(<a href="#ref-myers1990classical" role="doc-biblioref">Myers</a>)</span> and predictors causing such VIFs should be removed. Indeed, even VIFs of 2.5 can be problematic <span class="citation" data-cites="szmrecsanyi2006morphosyntactic">(<a href="#ref-szmrecsanyi2006morphosyntactic" role="doc-biblioref">Szmrecsanyi, 215</a>)</span> Indeed, <span class="citation" data-cites="zuur2010protocol">Zuur, Ieno, and Elphick</span> propose that variables with VIFs exceeding 3 should be removed!</p></li>
</ol>
<div class="warning" style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
<b>NOTE</b><br><br>However, (multi-)collinearity is only an issue if one is interested in interpreting regression results! If the interpretation is irrelevant because what is relevant is prediction(!), then it does not matter if the model contains collinear predictors! See <span class="citation" data-cites="gries2021statistics">Gries</span> for a more elaborate explanation.
</p>
<p style="margin-left:1em;">
</p>
<p></p>
</span></div>
<p><br></p>
<ol start="8" type="1">
<li>The mean value of VIFs should be ~ 1 <span class="citation" data-cites="bowerman1990linear">(<a href="#ref-bowerman1990linear" role="doc-biblioref">Bowerman and O’Connell</a>)</span>.</li>
</ol>
<p>The following code chunk evaluates these criteria.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1: optimal = 0</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (listed data points should be removed)</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(mlrdata<span class="sc">$</span>standardized.residuals <span class="sc">&gt;</span> <span class="fl">3.29</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>named integer(0)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2: optimal = 1</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (listed data points should be removed)</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>stdres_258 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">sapply</span>(mlrdata<span class="sc">$</span>standardized.residuals, <span class="cf">function</span>(x) {</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(<span class="fu">sqrt</span>((x<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">&gt;</span> <span class="fl">2.58</span>, <span class="dv">1</span>, <span class="dv">0</span>) } ))</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>(<span class="fu">sum</span>(stdres_258) <span class="sc">/</span> <span class="fu">length</span>(stdres_258)) <span class="sc">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3: optimal = 5</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (listed data points should be removed)</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>stdres_196 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">sapply</span>(mlrdata<span class="sc">$</span>standardized.residuals, <span class="cf">function</span>(x) {</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(<span class="fu">sqrt</span>((x<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">&gt;</span> <span class="fl">1.96</span>, <span class="dv">1</span>, <span class="dv">0</span>) } ))</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>(<span class="fu">sum</span>(stdres_196) <span class="sc">/</span> <span class="fu">length</span>(stdres_196)) <span class="sc">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.12244897959</code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4: optimal = 0</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (listed data points should be removed)</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(mlrdata<span class="sc">$</span>cooks.distance <span class="sc">&gt;</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>named integer(0)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 5: optimal = 0</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (data points should be removed if cooks distance is close to 1)</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(mlrdata<span class="sc">$</span>leverage <span class="sc">&gt;=</span> (<span class="dv">3</span><span class="sc">*</span><span class="fu">mean</span>(mlrdata<span class="sc">$</span>leverage)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>named integer(0)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 6: checking autocorrelation:</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Durbin-Watson test (optimal: high p-value)</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dwt</span>(m2.mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> lag  Autocorrelation D-W Statistic p-value
   1 -0.0143324675649  1.9680423527   0.602
 Alternative hypothesis: rho != 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 7: test multicollinearity 1</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(m2.mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        statusSingle              attractionNotInterested 
                                2.00                                 1.96 
statusSingle:attractionNotInterested 
                                2.96 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 8: test multicollinearity 2</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">/</span><span class="fu">vif</span>(m2.mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        statusSingle              attractionNotInterested 
                      0.500000000000                       0.510204081633 
statusSingle:attractionNotInterested 
                      0.337837837838 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 9: mean vif should not exceed 1</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">vif</span>(m2.mlr))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.30666666667</code></pre>
</div>
</div>
<p>Except for the mean VIF value (2.307) which should not exceed 1, all diagnostics are acceptable. We will now test whether the sample size is sufficient for our model. With respect to the minimal sample size and based on <span class="citation" data-cites="green1991many">Green</span>, <span class="citation" data-cites="field2012discovering">Field, Miles, and Field (<a href="#ref-field2012discovering" role="doc-biblioref">273–74</a>)</span> offer the following rules of thumb for an adequate sample size (k = number of predictors; categorical predictors with more than two levels should be recoded as dummy variables):</p>
<ul>
<li><p>if you are interested in the overall model: 50 + 8k (k = number of predictors)</p></li>
<li><p>if you are interested in individual predictors: 104 + k</p></li>
<li><p>if you are interested in both: take the higher value!</p></li>
</ul>
</section>
<section id="evaluation-of-sample-size" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="evaluation-of-sample-size">Evaluation of Sample Size</h3>
<p>After performing the diagnostics, we will now test whether the sample size is adequate and what the values of R would be based on a random distribution in order to be able to estimate how likely a <span class="math inline">\(\beta\)</span>-error is given the present sample size <span class="citation" data-cites="field2012discovering">(see <a href="#ref-field2012discovering" role="doc-biblioref">Field, Miles, and Field, 274</a>)</span>. Beta errors (or <span class="math inline">\(\beta\)</span>-errors) refer to the erroneous assumption that a predictor is not significant (based on the analysis and given the sample) although it does have an effect in the population. In other words, <span class="math inline">\(\beta\)</span>-error means to overlook a significant effect because of weaknesses of the analysis. The test statistics ranges between 0 and 1 where lower values are better. If the values approximate 1, then there is serious concern as the model is not reliable given the sample size. In such cases, unfortunately, the best option is to increase the sample size.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load functions</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"rscripts/SampleSizeMLR.r"</span>)</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"rscripts/ExpR.r"</span>)</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="co"># check if sample size is sufficient</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="fu">smplesz</span>(m2.mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Sample too small: please increase your sample by  9  data points"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check beta-error likelihood</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="fu">expR</span>(m2.mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Based on the sample size expect a false positive correlation of 0.0309 between the predictors and the predicted"</code></pre>
</div>
</div>
<p>The function <code>smplesz</code> reports that the sample size is insufficient by 9 data points according to <span class="citation" data-cites="green1991many">Green</span>. The likelihood of <span class="math inline">\(\beta\)</span>-errors, however, is very small (0.0309). As a last step, we summarize the results of the regression analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tabulate model results</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(m0.glm, m2.glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">&nbsp;</td>
<td colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">money</td>
<td colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">money</td>
</tr>
<tr class="even">
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Predictors</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">CI</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">p</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">CI</td>
<td style="text-align: center;">p</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">(Intercept)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">88.12</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">78.72&nbsp;–&nbsp;97.52</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">99.15</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">92.10&nbsp;–&nbsp;106.21</td>
<td style="text-align: center;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">status [Single]</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">55.85</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">45.78&nbsp;–&nbsp;65.93</td>
<td style="text-align: center;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">attraction<br>
[NotInterested]</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-47.66</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-57.63&nbsp;–&nbsp;-37.69</td>
<td style="text-align: center;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">status [Single] ×<br>
attraction<br>
[NotInterested]</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-59.46</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-73.71&nbsp;–&nbsp;-45.21</td>
<td style="text-align: center;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">Observations</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">98</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">98</td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">R<sup>2</sup></td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.000</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.857</td>
</tr>
</tbody>
</table>


</div>
</div>
<hr>
<div class="warning" style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
<b>NOTE</b><br><br>The R<sup>2</sup> values in this report is incorrect! As we have seen above, and is also shown in the table below, the correct R<sup>2</sup> values are: multiple R<sup>2</sup> 0.8574, adjusted R<sup>2</sup> 0.8528.<br>
</p>
<p style="margin-left:1em;">
</p>
<p></p>
</span></div>
<p><br></p>
<p>Additionally, we can inspect the summary of the regression model as shown below to extract additional information.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2.mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = money ~ (status + attraction)^2, data = mlrdata)

Residuals:
         Min           1Q       Median           3Q          Max 
-35.76416667 -13.50520000  -0.98948333  10.59887500  38.77166667 

Coefficients:
                                         Estimate   Std. Error  t value
(Intercept)                           99.15480000   3.59735820 27.56323
statusSingle                          55.85353333   5.14015367 10.86612
attractionNotInterested              -47.66280000   5.08743275 -9.36873
statusSingle:attractionNotInterested -59.46136667   7.26927504 -8.17982
                                                   Pr(&gt;|t|)    
(Intercept)                          &lt; 0.000000000000000222 ***
statusSingle                         &lt; 0.000000000000000222 ***
attractionNotInterested               0.0000000000000040429 ***
statusSingle:attractionNotInterested  0.0000000000013375166 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 17.986791 on 94 degrees of freedom
Multiple R-squared:  0.857375902,   Adjusted R-squared:  0.852824069 
F-statistic: 188.358387 on 3 and 94 DF,  p-value: &lt; 0.0000000000000002220446</code></pre>
</div>
</div>
<p>Although <span class="citation" data-cites="field2012discovering">Field, Miles, and Field</span> suggest that the main effects of the predictors involved in the interaction should not be interpreted, they are interpreted here to illustrate how the results of a multiple linear regression can be reported.</p>
<p>We can use the <code>reports</code> package <span class="citation" data-cites="report">(<a href="#ref-report" role="doc-biblioref">Makowski et al. 2021</a>)</span> to summarize the analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(m2.mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear model (estimated using OLS) to predict money with status and
attraction (formula: money ~ (status + attraction)^2). The model explains a
statistically significant and substantial proportion of variance (R2 = 0.86,
F(3, 94) = 188.36, p &lt; .001, adj. R2 = 0.85). The model's intercept,
corresponding to status = Relationship and attraction = Interested, is at 99.15
(95% CI [92.01, 106.30], t(94) = 27.56, p &lt; .001). Within this model:

  - The effect of status [Single] is statistically significant and positive (beta
= 55.85, 95% CI [45.65, 66.06], t(94) = 10.87, p &lt; .001; Std. beta = 1.19, 95%
CI [0.97, 1.41])
  - The effect of attraction [NotInterested] is statistically significant and
negative (beta = -47.66, 95% CI [-57.76, -37.56], t(94) = -9.37, p &lt; .001; Std.
beta = -1.02, 95% CI [-1.23, -0.80])
  - The effect of status [Single] × attraction [NotInterested] is statistically
significant and negative (beta = -59.46, 95% CI [-73.89, -45.03], t(94) =
-8.18, p &lt; .001; Std. beta = -1.27, 95% CI [-1.58, -0.96])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
</div>
<p>We can use this output to write up a final report:</p>
<p>A multiple linear regression was fitted to the data using an automated, step-wise, AIC-based (Akaike’s Information Criterion) procedure. The model fitting arrived at a final minimal model. During the model diagnostics, two outliers were detected and removed. Further diagnostics did not find other issues after the removal.</p>
<p>The final minimal adequate regression model is based on 98 data points and performs highly significantly better than a minimal baseline model (multiple R<sup>2</sup>: .857, adjusted R<sup>2</sup>: .853, F-statistic (3, 94): 154.4, AIC: 850.4, BIC: 863.32, p&lt;.001<sup><span class="math inline">\(***\)</span></sup>). The final minimal adequate regression model reports <em>attraction</em> and <em>status</em> as significant main effects. The relationship status of men correlates highly significantly and positively with the amount of money spend on the women’s presents (SE: 5.14, t-value: 10.87, p&lt;.001<sup><span class="math inline">\(***\)</span></sup>). This shows that men spend 156.8 dollars on presents if they are single while they spend 99,15 dollars if they are in a relationship. Whether men are attracted to women also correlates highly significantly and positively with the money they spend on women (SE: 5.09, t-values: -9.37, p&lt;.001<sup><span class="math inline">\(***\)</span></sup>). If men are not interested in women, they spend 47.66 dollar less on a present for women compared with women the men are interested in.</p>
<p>Furthermore, the final minimal adequate regression model reports a highly significant interaction between relationship <em>status</em> and <em>attraction</em> (SE: 7.27, t-value: -8.18, p&lt;.001<sup><span class="math inline">\(***\)</span></sup>): If men are single but they are not interested in a women, a man would spend only 59.46 dollars on a present compared to all other constellations.</p>
</section>
</section>
<section id="multiple-binomial-logistic-regression" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="multiple-binomial-logistic-regression">Multiple Binomial Logistic Regression</h2>
<p>Logistic regression is a multivariate analysis technique that builds on and is very similar in terms of its implementation to linear regression but logistic regressions take dependent variables that represent nominal rather than numeric scaling <span class="citation" data-cites="harrell2015regression">(<a href="#ref-harrell2015regression" role="doc-biblioref">Harrell Jr</a>)</span>. The difference requires that the linear regression must be modified in certain ways to avoid producing non-sensical outcomes. The most fundamental difference between logistic and linear regressions is that logistic regression work on the probabilities of an outcome (the likelihood), rather than the outcome itself. In addition, the likelihoods on which the logistic regression works must be logged (logarithmized) in order to avoid produce predictions that produce values greater than 1 (instance occurs) and 0 (instance does not occur). You can check this by logging the values from -10 to 10 using the <code>plogis</code> function as shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">plogis</span>(<span class="sc">-</span><span class="dv">10</span><span class="sc">:</span><span class="dv">10</span>), <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.00005 0.00012 0.00034 0.00091 0.00247 0.00669 0.01799 0.04743 0.11920
[10] 0.26894 0.50000 0.73106 0.88080 0.95257 0.98201 0.99331 0.99753 0.99909
[19] 0.99966 0.99988 0.99995</code></pre>
</div>
</div>
<p>If we visualize these logged values, we get an S-shaped curve which reflects the logistic function.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/blm0b-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>To understand what this mean, we will use a very simple example. In this example, we want to see whether the height of men affect their likelihood of being in a relationship. The data we use represents a data set consisting of two variables: height and relationship.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/blm1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The left panel of the Figure above shows that a linear model would predict values for the relationship status, which represents a factor (0 = Single and 1 = In a Relationship), that are nonsensical because values above 1 or below 0 do not make sense. In contrast to a linear regression, which predicts actual values, such as the frequencies of prepositions in a certain text, a logistic regression predicts <em>probabilities</em> of events (for example, being in a relationship) rather than actual values. The center panel shows the predictions of a logistic regression and we see that a logistic regression also has an intercept and a (very steep) slope but that the regression line also predicts values that are above 1 and below 0. However, when we log the predicted values we these predicted values are transformed into probabilities with values between 0 and 1. And the logged regression line has a S-shape which reflects the logistic function. Furthermore, we can then find the optimal line (the line with the lowest residual deviance) by comparing the sum of residuals - just as we did for a simple linear model and that way, we find the regression line for a logistic regression.</p>
<section id="example-1-eh-in-kiwi-english" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="example-1-eh-in-kiwi-english">Example 1: EH in Kiwi English</h3>
<p>To exemplify how to implement a logistic regression in R <span class="citation" data-cites="agresti1996introduction agresti2011categorical">(see <a href="#ref-agresti1996introduction" role="doc-biblioref">Agresti</a>; <a href="#ref-agresti2011categorical" role="doc-biblioref">Agresti and Kateri</a>)</span> for very good and thorough introductions to this topic], we will analyze the use of the discourse particle <em>eh</em> in New Zealand English and test which factors correlate with its occurrence. The data set represents speech units in a corpus that were coded for the speaker who uttered a given speech unit, the gender, ethnicity, and age of that speaker and whether or not the speech unit contained an <em>eh</em>. To begin with, we clean the current work space, set option, install and activate relevant packages, load customized functions, and load the example data set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>blrdata  <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="st">"tutorials/regression/data/bld.rda"</span>, <span class="st">"rb"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-8f11743c{table-layout:auto;width:75%;}.cl-8f0bec74{font-family:'DejaVu Sans';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8f0bec88{font-family:'DejaVu Sans';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8f0e577a{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8f0e5784{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8f0e6f9e{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8f0e6fa8{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8f0e6fa9{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8f0e6faa{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8f0e6fb2{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8f0e6fbc{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8f0e6fbd{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8f0e6fc6{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8f0e6fc7{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8f0e6fd0{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8f0e6fd1{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8f0e6fda{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-8f11743c"><thead><tr style="overflow-wrap:break-word;"><th class="cl-8f0e6f9e"><p class="cl-8f0e577a"><span class="cl-8f0bec74">ID</span></p></th><th class="cl-8f0e6fa8"><p class="cl-8f0e577a"><span class="cl-8f0bec74">Gender</span></p></th><th class="cl-8f0e6fa8"><p class="cl-8f0e577a"><span class="cl-8f0bec74">Age</span></p></th><th class="cl-8f0e6fa8"><p class="cl-8f0e577a"><span class="cl-8f0bec74">Ethnicity</span></p></th><th class="cl-8f0e6fa9"><p class="cl-8f0e5784"><span class="cl-8f0bec74">EH</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-8f0e6faa"><p class="cl-8f0e577a"><span class="cl-8f0bec88">&lt;S1A-001#M&gt;</span></p></td><td class="cl-8f0e6fb2"><p class="cl-8f0e577a"><span class="cl-8f0bec88">Men</span></p></td><td class="cl-8f0e6fb2"><p class="cl-8f0e577a"><span class="cl-8f0bec88">Young</span></p></td><td class="cl-8f0e6fb2"><p class="cl-8f0e577a"><span class="cl-8f0bec88">Pakeha</span></p></td><td class="cl-8f0e6fbc"><p class="cl-8f0e5784"><span class="cl-8f0bec88">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8f0e6fbd"><p class="cl-8f0e577a"><span class="cl-8f0bec88">&lt;S1A-001#M&gt;</span></p></td><td class="cl-8f0e6fc6"><p class="cl-8f0e577a"><span class="cl-8f0bec88">Men</span></p></td><td class="cl-8f0e6fc6"><p class="cl-8f0e577a"><span class="cl-8f0bec88">Young</span></p></td><td class="cl-8f0e6fc6"><p class="cl-8f0e577a"><span class="cl-8f0bec88">Pakeha</span></p></td><td class="cl-8f0e6fc7"><p class="cl-8f0e5784"><span class="cl-8f0bec88">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8f0e6faa"><p class="cl-8f0e577a"><span class="cl-8f0bec88">&lt;S1A-001#M&gt;</span></p></td><td class="cl-8f0e6fb2"><p class="cl-8f0e577a"><span class="cl-8f0bec88">Men</span></p></td><td class="cl-8f0e6fb2"><p class="cl-8f0e577a"><span class="cl-8f0bec88">Young</span></p></td><td class="cl-8f0e6fb2"><p class="cl-8f0e577a"><span class="cl-8f0bec88">Pakeha</span></p></td><td class="cl-8f0e6fbc"><p class="cl-8f0e5784"><span class="cl-8f0bec88">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8f0e6fbd"><p class="cl-8f0e577a"><span class="cl-8f0bec88">&lt;S1A-001#M&gt;</span></p></td><td class="cl-8f0e6fc6"><p class="cl-8f0e577a"><span class="cl-8f0bec88">Men</span></p></td><td class="cl-8f0e6fc6"><p class="cl-8f0e577a"><span class="cl-8f0bec88">Young</span></p></td><td class="cl-8f0e6fc6"><p class="cl-8f0e577a"><span class="cl-8f0bec88">Pakeha</span></p></td><td class="cl-8f0e6fc7"><p class="cl-8f0e5784"><span class="cl-8f0bec88">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8f0e6faa"><p class="cl-8f0e577a"><span class="cl-8f0bec88">&lt;S1A-001#M&gt;</span></p></td><td class="cl-8f0e6fb2"><p class="cl-8f0e577a"><span class="cl-8f0bec88">Men</span></p></td><td class="cl-8f0e6fb2"><p class="cl-8f0e577a"><span class="cl-8f0bec88">Young</span></p></td><td class="cl-8f0e6fb2"><p class="cl-8f0e577a"><span class="cl-8f0bec88">Pakeha</span></p></td><td class="cl-8f0e6fbc"><p class="cl-8f0e5784"><span class="cl-8f0bec88">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8f0e6fbd"><p class="cl-8f0e577a"><span class="cl-8f0bec88">&lt;S1A-001#M&gt;</span></p></td><td class="cl-8f0e6fc6"><p class="cl-8f0e577a"><span class="cl-8f0bec88">Men</span></p></td><td class="cl-8f0e6fc6"><p class="cl-8f0e577a"><span class="cl-8f0bec88">Young</span></p></td><td class="cl-8f0e6fc6"><p class="cl-8f0e577a"><span class="cl-8f0bec88">Pakeha</span></p></td><td class="cl-8f0e6fc7"><p class="cl-8f0e5784"><span class="cl-8f0bec88">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8f0e6faa"><p class="cl-8f0e577a"><span class="cl-8f0bec88">&lt;S1A-001#M&gt;</span></p></td><td class="cl-8f0e6fb2"><p class="cl-8f0e577a"><span class="cl-8f0bec88">Men</span></p></td><td class="cl-8f0e6fb2"><p class="cl-8f0e577a"><span class="cl-8f0bec88">Young</span></p></td><td class="cl-8f0e6fb2"><p class="cl-8f0e577a"><span class="cl-8f0bec88">Pakeha</span></p></td><td class="cl-8f0e6fbc"><p class="cl-8f0e5784"><span class="cl-8f0bec88">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8f0e6fbd"><p class="cl-8f0e577a"><span class="cl-8f0bec88">&lt;S1A-001#M&gt;</span></p></td><td class="cl-8f0e6fc6"><p class="cl-8f0e577a"><span class="cl-8f0bec88">Men</span></p></td><td class="cl-8f0e6fc6"><p class="cl-8f0e577a"><span class="cl-8f0bec88">Young</span></p></td><td class="cl-8f0e6fc6"><p class="cl-8f0e577a"><span class="cl-8f0bec88">Pakeha</span></p></td><td class="cl-8f0e6fc7"><p class="cl-8f0e5784"><span class="cl-8f0bec88">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8f0e6faa"><p class="cl-8f0e577a"><span class="cl-8f0bec88">&lt;S1A-001#M&gt;</span></p></td><td class="cl-8f0e6fb2"><p class="cl-8f0e577a"><span class="cl-8f0bec88">Men</span></p></td><td class="cl-8f0e6fb2"><p class="cl-8f0e577a"><span class="cl-8f0bec88">Young</span></p></td><td class="cl-8f0e6fb2"><p class="cl-8f0e577a"><span class="cl-8f0bec88">Pakeha</span></p></td><td class="cl-8f0e6fbc"><p class="cl-8f0e5784"><span class="cl-8f0bec88">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8f0e6fbd"><p class="cl-8f0e577a"><span class="cl-8f0bec88">&lt;S1A-001#M&gt;</span></p></td><td class="cl-8f0e6fc6"><p class="cl-8f0e577a"><span class="cl-8f0bec88">Men</span></p></td><td class="cl-8f0e6fc6"><p class="cl-8f0e577a"><span class="cl-8f0bec88">Young</span></p></td><td class="cl-8f0e6fc6"><p class="cl-8f0e577a"><span class="cl-8f0bec88">Pakeha</span></p></td><td class="cl-8f0e6fc7"><p class="cl-8f0e5784"><span class="cl-8f0bec88">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8f0e6faa"><p class="cl-8f0e577a"><span class="cl-8f0bec88">&lt;S1A-001#M&gt;</span></p></td><td class="cl-8f0e6fb2"><p class="cl-8f0e577a"><span class="cl-8f0bec88">Men</span></p></td><td class="cl-8f0e6fb2"><p class="cl-8f0e577a"><span class="cl-8f0bec88">Young</span></p></td><td class="cl-8f0e6fb2"><p class="cl-8f0e577a"><span class="cl-8f0bec88">Pakeha</span></p></td><td class="cl-8f0e6fbc"><p class="cl-8f0e5784"><span class="cl-8f0bec88">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8f0e6fbd"><p class="cl-8f0e577a"><span class="cl-8f0bec88">&lt;S1A-001#M&gt;</span></p></td><td class="cl-8f0e6fc6"><p class="cl-8f0e577a"><span class="cl-8f0bec88">Men</span></p></td><td class="cl-8f0e6fc6"><p class="cl-8f0e577a"><span class="cl-8f0bec88">Young</span></p></td><td class="cl-8f0e6fc6"><p class="cl-8f0e577a"><span class="cl-8f0bec88">Pakeha</span></p></td><td class="cl-8f0e6fc7"><p class="cl-8f0e5784"><span class="cl-8f0bec88">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8f0e6faa"><p class="cl-8f0e577a"><span class="cl-8f0bec88">&lt;S1A-001#M&gt;</span></p></td><td class="cl-8f0e6fb2"><p class="cl-8f0e577a"><span class="cl-8f0bec88">Men</span></p></td><td class="cl-8f0e6fb2"><p class="cl-8f0e577a"><span class="cl-8f0bec88">Young</span></p></td><td class="cl-8f0e6fb2"><p class="cl-8f0e577a"><span class="cl-8f0bec88">Pakeha</span></p></td><td class="cl-8f0e6fbc"><p class="cl-8f0e5784"><span class="cl-8f0bec88">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8f0e6fbd"><p class="cl-8f0e577a"><span class="cl-8f0bec88">&lt;S1A-001#M&gt;</span></p></td><td class="cl-8f0e6fc6"><p class="cl-8f0e577a"><span class="cl-8f0bec88">Men</span></p></td><td class="cl-8f0e6fc6"><p class="cl-8f0e577a"><span class="cl-8f0bec88">Young</span></p></td><td class="cl-8f0e6fc6"><p class="cl-8f0e577a"><span class="cl-8f0bec88">Pakeha</span></p></td><td class="cl-8f0e6fc7"><p class="cl-8f0e5784"><span class="cl-8f0bec88">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8f0e6fd0"><p class="cl-8f0e577a"><span class="cl-8f0bec88">&lt;S1A-001#M&gt;</span></p></td><td class="cl-8f0e6fd1"><p class="cl-8f0e577a"><span class="cl-8f0bec88">Men</span></p></td><td class="cl-8f0e6fd1"><p class="cl-8f0e577a"><span class="cl-8f0bec88">Young</span></p></td><td class="cl-8f0e6fd1"><p class="cl-8f0e577a"><span class="cl-8f0bec88">Pakeha</span></p></td><td class="cl-8f0e6fda"><p class="cl-8f0e5784"><span class="cl-8f0bec88">0</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>The summary of the data show that the data set contains 25,821 observations of five variables. The variable <code>ID</code> contains strings that represent a combination file and speaker of a speech unit. The second variable represents the gender, the third the age, and the fourth the ethnicity of speakers. The fifth variable represents whether or not a speech unit contained the discourse particle <em>eh</em>.</p>
<p>Next, we factorize the variables in our data set. In other words, we specify that the strings represent variable levels and define new reference levels because as a default <code>R</code> will use the variable level which first occurs in alphabet ordering as the reference level for each variable, we redefine the variable levels for Age and Ethnicity.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>blrdata <span class="ot">&lt;-</span> blrdata <span class="sc">%&gt;%</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># factorize variables</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Age =</span> <span class="fu">factor</span>(Age),</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">Gender =</span> <span class="fu">factor</span>(Gender),</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">Ethnicity =</span> <span class="fu">factor</span>(Ethnicity),</span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">ID =</span> <span class="fu">factor</span>(ID),</span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">EH =</span> <span class="fu">factor</span>(EH)) <span class="sc">%&gt;%</span></span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># relevel Age (Reference = Young) and Ethnicity (Reference= Pakeha))</span></span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Age =</span> <span class="fu">relevel</span>(Age, <span class="st">"Young"</span>),</span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">Ethnicity =</span> <span class="fu">relevel</span>(Ethnicity, <span class="st">"Pakeha"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>After preparing the data, we will now plot the data to get an overview of potential relationships between variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>blrdata <span class="sc">%&gt;%</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">EH =</span> <span class="fu">ifelse</span>(EH <span class="sc">==</span> <span class="st">"0"</span>, <span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Age, EH, <span class="at">color =</span> Gender)) <span class="sc">+</span></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Ethnicity) <span class="sc">+</span></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>) <span class="sc">+</span></span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_cl_boot, <span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_set</span>(<span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Observed Probabilty of eh"</span>) <span class="sc">+</span></span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray20"</span>, <span class="st">"gray70"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/blm6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>With respect to main effects, the Figure above indicates that men use <em>eh</em> more frequently than women, that young speakers use it more frequently compared with old speakers, and that speakers that are descendants of European settlers (Pakeha) use <em>eh</em> more frequently compared with Maori (the native inhabitants of New Zealand).</p>
<p>The plots in the lower panels do not indicate significant interactions between use of <em>eh</em> and the Age, Gender, and Ethnicity of speakers. In a next step, we will start building the logistic regression model.</p>
</section>
<section id="model-building" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="model-building">Model Building</h3>
<p>As a first step, we need to define contrasts and use the <code>datadist</code> function to store aspects of our variables that can be accessed later when plotting and summarizing the model. Contrasts define what and how variable levels should be compared and therefore influences how the results of the regression analysis are presented. In this case, we use treatment contrasts which are in-built. Treatment contrasts mean that we assess the significance of levels of a predictor against a baseline which is the reference level of a predictor. <span class="citation" data-cites="field2012discovering">Field, Miles, and Field (<a href="#ref-field2012discovering" role="doc-biblioref">414–27</a>)</span> and <span class="citation" data-cites="gries2021statistics">Gries</span> provide very good and accessible explanations of contrasts and how to manually define contrasts if you would like to know more.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set contrasts</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">contrasts  =</span><span class="fu">c</span>(<span class="st">"contr.treatment"</span>, <span class="st">"contr.poly"</span>))</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="co"># extract distribution summaries for all potential variables</span></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>blrdata.dist <span class="ot">&lt;-</span> <span class="fu">datadist</span>(blrdata)</span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="co"># store distribution summaries for all potential variables</span></span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">datadist =</span> <span class="st">"blrdata.dist"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we generate a minimal model that predicts the use of <em>eh</em> solely based on the intercept.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># baseline glm model</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>m0.blr <span class="ot">=</span> <span class="fu">glm</span>(EH <span class="sc">~</span> <span class="dv">1</span>, <span class="at">family =</span> binomial, <span class="at">data =</span> blrdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="model-fitting" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="model-fitting">Model fitting</h3>
<p>We will now start with the model fitting procedure. In the present case, we will use a manual step-wise step-up procedure during which predictors are added to the model if they significantly improve the model fit. In addition, we will perform diagnostics as we fit the model at each step of the model fitting process rather than after the fitting.</p>
<p>We will test two things in particular: whether the data has incomplete information or complete separation and if the model suffers from (multi-)collinearity.</p>
<p>Incomplete information or complete separation means that the data does not contain all combinations of the predictor or the dependent variable. This is important because if the data does not contain cases of all combinations, the model will assume that it has found a perfect predictor. In such cases the model overestimates the effect of that that predictor and the results of that model are no longer reliable. For example, if <em>eh</em> was only used by young speakers in the data, the model would jump on that fact and say <em>Ha! If there is an old speaker, that means that that speaker will never ever and under no circumstances say </em>eh* - I can therefore ignore all other factors!*</p>
<p>Multicollinearity means that predictors correlate and have shared variance. This means that whichever predictor is included first will take all the variance that it can explain and the remaining part of the variable that is shared will not be attributed to the other predictor. This may lead to reporting that a factor is not significant because all of the variance it can explain is already accounted for. However, if the other predictor were included first, then the original predictor would be returned as insignificant. This means that- depending on the order in which predictors are added - the results of the regression can differ dramatically and the model is therefore not reliable. Multicollinearity is actually a very common problem and there are various ways to deal with it but it cannot be ignored (at least in regression analyses).</p>
<p>We will start by adding <em>Age</em> to the minimal adequate model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check incomplete information</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(<span class="fu">min</span>(<span class="fu">ftable</span>(blrdata<span class="sc">$</span>Age, blrdata<span class="sc">$</span>EH)) <span class="sc">==</span> <span class="dv">0</span>, <span class="st">"not possible"</span>, <span class="st">"possible"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "possible"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add age to the model</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>m1.blr <span class="ot">=</span> <span class="fu">glm</span>(EH <span class="sc">~</span> Age, <span class="at">family =</span> binomial, <span class="at">data =</span> blrdata)</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a><span class="co"># check multicollinearity (vifs should have values of 3 or lower for main effects)</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(<span class="fu">max</span>(<span class="fu">vif</span>(m1.blr)) <span class="sc">&lt;=</span> <span class="dv">3</span>,  <span class="st">"vifs ok"</span>, <span class="st">"WARNING: high vifs!"</span>) <span class="co"># VIFs ok</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "vifs ok"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check if adding Age significantly improves model fit</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m1.blr, m0.blr, <span class="at">test =</span> <span class="st">"Chi"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: EH ~ Age
Model 2: EH ~ 1
  Resid. Df  Resid. Dev Df     Deviance               Pr(&gt;Chi)    
1     25819 32376.86081                                           
2     25820 33007.75469 -1 -630.8938871 &lt; 0.000000000000000222 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>As the data does not contain incomplete information, the vif values are below 3, and adding <em>Age</em> has significantly improved the model fit (the p-value of the ANOVA is lower than .05). We therefore proceed with <em>Age</em> included.</p>
<p>We continue by adding <em>Gender</em>. We add a second ANOVA test to see if including Gender affects the significance of other predictors in the model. If this were the case - if adding Gender would cause Age to become insignificant - then we could change the ordering in which we include predictors into our model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(<span class="fu">min</span>(<span class="fu">ftable</span>(blrdata<span class="sc">$</span>Gender, blrdata<span class="sc">$</span>EH)) <span class="sc">==</span> <span class="dv">0</span>, <span class="st">"not possible"</span>, <span class="st">"possible"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "possible"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>m2.blr <span class="ot">&lt;-</span> <span class="fu">update</span>(m1.blr, . <span class="sc">~</span> . <span class="sc">+</span>Gender)</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(<span class="fu">max</span>(<span class="fu">vif</span>(m2.blr)) <span class="sc">&lt;=</span> <span class="dv">3</span>,  <span class="st">"vifs ok"</span>, <span class="st">"WARNING: high vifs!"</span>) <span class="co"># VIFs ok</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "vifs ok"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m2.blr, m1.blr, <span class="at">test =</span> <span class="st">"Chi"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: EH ~ Age + Gender
Model 2: EH ~ Age
  Resid. Df  Resid. Dev Df    Deviance               Pr(&gt;Chi)    
1     25818 32139.54089                                          
2     25819 32376.86081 -1 -237.319914 &lt; 0.000000000000000222 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(m2.blr, <span class="at">test =</span> <span class="st">"LR"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type II tests)

Response: EH
          LR Chisq Df             Pr(&gt;Chisq)    
Age    668.6350712  1 &lt; 0.000000000000000222 ***
Gender 237.3199140  1 &lt; 0.000000000000000222 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Again, including <em>Gender</em> significantly improves model fit and the data does not contain incomplete information or complete separation. Also, including <em>Gender</em> does not affect the significance of <em>Age</em>. Now, we include <em>Ethnicity</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(<span class="fu">min</span>(<span class="fu">ftable</span>(blrdata<span class="sc">$</span>Ethnicity, blrdata<span class="sc">$</span>EH)) <span class="sc">==</span> <span class="dv">0</span>, <span class="st">"not possible"</span>, <span class="st">"possible"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "possible"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>m3.blr <span class="ot">&lt;-</span> <span class="fu">update</span>(m2.blr, . <span class="sc">~</span> . <span class="sc">+</span>Ethnicity)</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(<span class="fu">max</span>(<span class="fu">vif</span>(m3.blr)) <span class="sc">&lt;=</span> <span class="dv">3</span>,  <span class="st">"vifs ok"</span>, <span class="st">"WARNING: high vifs!"</span>) <span class="co"># VIFs ok</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "vifs ok"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m3.blr, m2.blr, <span class="at">test =</span> <span class="st">"Chi"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: EH ~ Age + Gender + Ethnicity
Model 2: EH ~ Age + Gender
  Resid. Df  Resid. Dev Df      Deviance Pr(&gt;Chi)
1     25817 32139.27988                          
2     25818 32139.54089 -1 -0.2610145387  0.60942</code></pre>
</div>
</div>
<p>Since adding <em>Ethnicity</em> does not significantly improve the model fit, we do not need to test if its inclusion affects the significance of other predictors. We continue without <em>Ethnicity</em> and include the interaction between <em>Age</em> and <em>Gender</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(<span class="fu">min</span>(<span class="fu">ftable</span>(blrdata<span class="sc">$</span>Age, blrdata<span class="sc">$</span>Gender, blrdata<span class="sc">$</span>EH)) <span class="sc">==</span> <span class="dv">0</span>, <span class="st">"not possible"</span>, <span class="st">"possible"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "possible"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>m4.blr <span class="ot">&lt;-</span> <span class="fu">update</span>(m2.blr, . <span class="sc">~</span> . <span class="sc">+</span>Age<span class="sc">*</span>Gender)</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(<span class="fu">max</span>(<span class="fu">vif</span>(m4.blr)) <span class="sc">&lt;=</span> <span class="dv">3</span>,  <span class="st">"vifs ok"</span>, <span class="st">"WARNING: high vifs!"</span>) <span class="co"># VIFs ok</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "vifs ok"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m4.blr, m2.blr, <span class="at">test =</span> <span class="st">"Chi"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: EH ~ Age + Gender + Age:Gender
Model 2: EH ~ Age + Gender
  Resid. Df  Resid. Dev Df     Deviance Pr(&gt;Chi)
1     25817 32139.41665                         
2     25818 32139.54089 -1 -0.124239923  0.72448</code></pre>
</div>
</div>
<p>The interaction between <em>Age</em> and <em>Gender</em> is not significant which means that men and women do not behave differently with respect to their use of <code>EH</code> as they age. Also, the data does not contain incomplete information and the model does not suffer from multicollinearity - the predictors are not collinear. We can now include if there is a significant interaction between <em>Age</em> and <em>Ethnicity</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(<span class="fu">min</span>(<span class="fu">ftable</span>(blrdata<span class="sc">$</span>Age, blrdata<span class="sc">$</span>Ethnicity, blrdata<span class="sc">$</span>EH)) <span class="sc">==</span> <span class="dv">0</span>, <span class="st">"not possible"</span>, <span class="st">"possible"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "possible"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>m5.blr <span class="ot">&lt;-</span> <span class="fu">update</span>(m2.blr, . <span class="sc">~</span> . <span class="sc">+</span>Age<span class="sc">*</span>Ethnicity)</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(<span class="fu">max</span>(<span class="fu">vif</span>(m5.blr)) <span class="sc">&lt;=</span> <span class="dv">3</span>,  <span class="st">"vifs ok"</span>, <span class="st">"WARNING: high vifs!"</span>) <span class="co"># VIFs ok</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "vifs ok"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m5.blr, m2.blr, <span class="at">test =</span> <span class="st">"Chi"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: EH ~ Age + Gender + Ethnicity + Age:Ethnicity
Model 2: EH ~ Age + Gender
  Resid. Df  Resid. Dev Df     Deviance Pr(&gt;Chi)
1     25816 32136.47224                         
2     25818 32139.54089 -2 -3.068654514   0.2156</code></pre>
</div>
</div>
<p>Again, no incomplete information or multicollinearity and no significant interaction. Now, we test if there exists a significant interaction between <em>Gender</em> and <em>Ethnicity</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(<span class="fu">min</span>(<span class="fu">ftable</span>(blrdata<span class="sc">$</span>Gender, blrdata<span class="sc">$</span>Ethnicity, blrdata<span class="sc">$</span>EH)) <span class="sc">==</span> <span class="dv">0</span>, <span class="st">"not possible"</span>, <span class="st">"possible"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "possible"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>m6.blr <span class="ot">&lt;-</span> <span class="fu">update</span>(m2.blr, . <span class="sc">~</span> . <span class="sc">+</span>Gender<span class="sc">*</span>Ethnicity)</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(<span class="fu">max</span>(<span class="fu">vif</span>(m6.blr)) <span class="sc">&lt;=</span> <span class="dv">3</span>,  <span class="st">"vifs ok"</span>, <span class="st">"WARNING: high vifs!"</span>) <span class="co"># VIFs ok</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "vifs ok"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m6.blr, m2.blr, <span class="at">test =</span> <span class="st">"Chi"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: EH ~ Age + Gender + Ethnicity + Gender:Ethnicity
Model 2: EH ~ Age + Gender
  Resid. Df  Resid. Dev Df      Deviance Pr(&gt;Chi)
1     25816 32139.26864                          
2     25818 32139.54089 -2 -0.2722521835  0.87273</code></pre>
</div>
</div>
<p>As the interaction between <em>Gender</em> and <em>Ethnicity</em> is not significant, we continue without it. In a final step, we include the three-way interaction between <em>Age</em>, <em>Gender</em>, and <em>Ethnicity</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(<span class="fu">min</span>(<span class="fu">ftable</span>(blrdata<span class="sc">$</span>Age, blrdata<span class="sc">$</span>Gender, blrdata<span class="sc">$</span>Ethnicity, blrdata<span class="sc">$</span>EH)) <span class="sc">==</span> <span class="dv">0</span>, <span class="st">"not possible"</span>, <span class="st">"possible"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "possible"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>m7.blr <span class="ot">&lt;-</span> <span class="fu">update</span>(m2.blr, . <span class="sc">~</span> . <span class="sc">+</span>Gender<span class="sc">*</span>Ethnicity)</span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(<span class="fu">max</span>(<span class="fu">vif</span>(m7.blr)) <span class="sc">&lt;=</span> <span class="dv">3</span>,  <span class="st">"vifs ok"</span>, <span class="st">"WARNING: high vifs!"</span>) <span class="co"># VIFs ok</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "vifs ok"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m7.blr, m2.blr, <span class="at">test =</span> <span class="st">"Chi"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: EH ~ Age + Gender + Ethnicity + Gender:Ethnicity
Model 2: EH ~ Age + Gender
  Resid. Df  Resid. Dev Df      Deviance Pr(&gt;Chi)
1     25816 32139.26864                          
2     25818 32139.54089 -2 -0.2722521835  0.87273</code></pre>
</div>
</div>
<p>We have found our final minimal adequate model because the 3-way interaction is also insignificant. As we have now arrived at the final minimal adequate model (m2.blr), we generate a final minimal model using the lrm function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>m2.lrm <span class="ot">&lt;-</span> <span class="fu">lrm</span>(EH <span class="sc">~</span> Age<span class="sc">+</span>Gender, <span class="at">data =</span> blrdata, <span class="at">x =</span> T, <span class="at">y =</span> T, <span class="at">linear.predictors =</span> T)</span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>m2.lrm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Logistic Regression Model

lrm(formula = EH ~ Age + Gender, data = blrdata, x = T, y = T, 
    linear.predictors = T)

                       Model Likelihood        Discrimination    Rank Discrim.    
                             Ratio Test               Indexes          Indexes    
Obs         25821    LR chi2     868.21        R2       0.046    C       0.602    
 0          17114    d.f.             2      R2(2,25821)0.033    Dxy     0.145    
 1           8707    Pr(&gt; chi2) &lt;0.0001    R2(2,17312.8)0.049    gamma   0.302    
max |deriv| 2e-09                              Brier    0.216    tau-a   0.091    

             Coef    S.E.   Wald Z Pr(&gt;|Z|)
Intercept    -0.2324 0.0223 -10.44 &lt;0.0001 
Age=Old      -0.8305 0.0335 -24.78 &lt;0.0001 
Gender=Women -0.4201 0.0273 -15.42 &lt;0.0001 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m2.lrm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                Wald Statistics          Response: EH 

 Factor     Chi-Square d.f. P     
 Age        614.04     1    &lt;.0001
 Gender     237.65     1    &lt;.0001
 TOTAL      802.65     2    &lt;.0001</code></pre>
</div>
</div>
<p>After fitting the model, we validate the model to avoid arriving at a final minimal model that is overfitted to the data at hand.</p>
</section>
<section id="model-validation" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="model-validation">Model Validation</h3>
<p>To validate a model, you can apply the <code>validate</code> function and apply it to a saturated model. The output of the <code>validate</code> function shows how often predictors are retained if the sample is re-selected with the same size but with placing back drawn data points. The execution of the function requires some patience as it is rather computationally expensive and it is, therefore, commented out below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co"># model validation (remove # to activate: output too long for website)</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>m7.lrm <span class="ot">&lt;-</span> <span class="fu">lrm</span>(EH <span class="sc">~</span> (Age<span class="sc">+</span>Gender<span class="sc">+</span>Ethnicity)<span class="sc">^</span><span class="dv">3</span>, <span class="at">data =</span> blrdata, <span class="at">x =</span> T, <span class="at">y =</span> T, <span class="at">linear.predictors =</span> T)</span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a><span class="co">#validate(m7.lrm, bw = T, B = 200)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>validate</code> function shows that retaining two predictors (Age and Gender) is the best option and thereby confirms our final minimal adequate model as the best minimal model. In addition, we check whether we need to include a penalty for data points because they have too strong of an impact of the model fit. To see whether a penalty is warranted, we apply the <code>pentrace</code> function to the final minimal adequate model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pentrace</span>(m2.lrm, <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">0.8</span>, <span class="at">by =</span> <span class="fl">0.05</span>)) <span class="co"># determine penalty</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Best penalty:

 penalty            df
     0.8 1.99925395138

 penalty            df           aic           bic         aic.c
    0.00 2.00000000000 864.213801106 847.895914320 864.213336314
    0.05 1.99995335085 864.213893817 847.896387638 864.213429043
    0.10 1.99990670452 864.213985334 847.896859740 864.213520579
    0.15 1.99986006100 864.214075643 847.897330611 864.213610906
    0.20 1.99981342030 864.214164765 847.897800272 864.213700045
    0.25 1.99976678241 864.214252703 847.898268725 864.213788001
    0.30 1.99972014734 864.214339446 847.898735961 864.213874762
    0.35 1.99967351509 864.214424993 847.899201978 864.213960327
    0.40 1.99962688564 864.214509361 847.899666793 864.214044713
    0.45 1.99958025902 864.214592526 847.900130382 864.214127896
    0.50 1.99953363520 864.214674491 847.900592748 864.214209880
    0.55 1.99948701420 864.214755276 847.901053911 864.214290683
    0.60 1.99944039601 864.214834875 847.901513866 864.214370300
    0.65 1.99939378063 864.214913275 847.901972598 864.214448717
    0.70 1.99934716807 864.214990480 847.902430112 864.214525941
    0.75 1.99930055832 864.215066505 847.902886423 864.214601983
    0.80 1.99925395138 864.215141352 847.903341534 864.214676849</code></pre>
</div>
</div>
<p>The values are so similar that a penalty is unnecessary. In a next step, we rename the final models.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>lr.glm <span class="ot">&lt;-</span> m2.blr  <span class="co"># rename final minimal adequate glm model</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>lr.lrm <span class="ot">&lt;-</span> m2.lrm  <span class="co"># rename final minimal adequate lrm model</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, we calculate a Model Likelihood Ratio Test to check if the final model performs significantly better than the initial minimal base-line model. The result of this test is provided as a default if we call a summary of the lrm object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>modelChi <span class="ot">&lt;-</span> lr.glm<span class="sc">$</span>null.deviance <span class="sc">-</span> lr.glm<span class="sc">$</span>deviance</span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>chidf <span class="ot">&lt;-</span> lr.glm<span class="sc">$</span>df.null <span class="sc">-</span> lr.glm<span class="sc">$</span>df.residual</span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a>chisq.prob <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pchisq</span>(modelChi, chidf)</span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a>modelChi; chidf; chisq.prob</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 868.21380111</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<p>The code above provides three values: a <span class="math inline">\(\chi\)</span><sup>2</sup>, the degrees of freedom, and a p-value. The p-value is lower than .05 and the results of the Model Likelihood Ratio Test therefore confirm that the final minimal adequate model performs significantly better than the initial minimal base-line model. Another way to extract the model likelihood test statistics is to use an ANOVA to compare the final minimal adequate model to the minimal base-line model.</p>
<p>A handier way to get these statistics is by performing an ANOVA on the final minimal model which, if used this way, is identical to a Model Likelihood Ratio test.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m0.glm, lr.glm, <span class="at">test =</span> <span class="st">"Chi"</span>) <span class="co"># Model Likelihood Ratio Test</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in anova.glmlist(c(list(object), dotargs), dispersion = dispersion, :
models with response '"EH"' removed because response differs from model 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model: gaussian, link: identity

Response: money

Terms added sequentially (first to last)

     Df Deviance Resid. Df  Resid. Dev Pr(&gt;Chi)
NULL                    97 213227.0608         </code></pre>
</div>
</div>
<p>In a next step, we calculate pseudo-R<sup>2</sup> values which represent the amount of residual variance that is explained by the final minimal adequate model. We cannot use the ordinary R<sup>2</sup> because the model works on the logged probabilities rather than the values of the dependent variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate pseudo R^2</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="co"># number of cases</span></span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>ncases <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">fitted</span>(lr.glm))</span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a>R2.hl <span class="ot">&lt;-</span> modelChi<span class="sc">/</span>lr.glm<span class="sc">$</span>null.deviance</span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a>R.cs <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span> ((lr.glm<span class="sc">$</span>deviance <span class="sc">-</span> lr.glm<span class="sc">$</span>null.deviance)<span class="sc">/</span>ncases)</span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true" tabindex="-1"></a>R.n <span class="ot">&lt;-</span> R.cs <span class="sc">/</span>( <span class="dv">1</span><span class="sc">-</span> ( <span class="fu">exp</span> (<span class="sc">-</span>(lr.glm<span class="sc">$</span>null.deviance<span class="sc">/</span> ncases))))</span>
<span id="cb180-7"><a href="#cb180-7" aria-hidden="true" tabindex="-1"></a><span class="co"># function for extracting pseudo-R^2</span></span>
<span id="cb180-8"><a href="#cb180-8" aria-hidden="true" tabindex="-1"></a>logisticPseudoR2s <span class="ot">&lt;-</span> <span class="cf">function</span>(LogModel) {</span>
<span id="cb180-9"><a href="#cb180-9" aria-hidden="true" tabindex="-1"></a>  dev <span class="ot">&lt;-</span> LogModel<span class="sc">$</span>deviance</span>
<span id="cb180-10"><a href="#cb180-10" aria-hidden="true" tabindex="-1"></a>    nullDev <span class="ot">&lt;-</span> LogModel<span class="sc">$</span>null.deviance</span>
<span id="cb180-11"><a href="#cb180-11" aria-hidden="true" tabindex="-1"></a>    modelN <span class="ot">&lt;-</span>  <span class="fu">length</span>(LogModel<span class="sc">$</span>fitted.values)</span>
<span id="cb180-12"><a href="#cb180-12" aria-hidden="true" tabindex="-1"></a>    R.l <span class="ot">&lt;-</span>  <span class="dv">1</span> <span class="sc">-</span>  dev <span class="sc">/</span> nullDev</span>
<span id="cb180-13"><a href="#cb180-13" aria-hidden="true" tabindex="-1"></a>    R.cs <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span> <span class="fu">exp</span> ( <span class="sc">-</span>(nullDev <span class="sc">-</span> dev) <span class="sc">/</span> modelN)</span>
<span id="cb180-14"><a href="#cb180-14" aria-hidden="true" tabindex="-1"></a>    R.n <span class="ot">&lt;-</span> R.cs <span class="sc">/</span> ( <span class="dv">1</span> <span class="sc">-</span> ( <span class="fu">exp</span> (<span class="sc">-</span>(nullDev <span class="sc">/</span> modelN))))</span>
<span id="cb180-15"><a href="#cb180-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Pseudo R^2 for logistic regression</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb180-16"><a href="#cb180-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Hosmer and Lemeshow R^2  "</span>, <span class="fu">round</span>(R.l, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb180-17"><a href="#cb180-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Cox and Snell R^2        "</span>, <span class="fu">round</span>(R.cs, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb180-18"><a href="#cb180-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Nagelkerke R^2           "</span>, <span class="fu">round</span>(R.n, <span class="dv">3</span>),    <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) }</span>
<span id="cb180-19"><a href="#cb180-19" aria-hidden="true" tabindex="-1"></a><span class="fu">logisticPseudoR2s</span>(lr.glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Pseudo R^2 for logistic regression
Hosmer and Lemeshow R^2   0.026 
Cox and Snell R^2         0.033 
Nagelkerke R^2            0.046 </code></pre>
</div>
</div>
<p>The low pseudo-R<sup>2</sup> values show that our model has very low explanatory power. For instance, the value of Hosmer and Lemeshow R<sup>2</sup> (0.026) “is the proportional reduction in the absolute value of the log-likelihood measure and as such it is a measure of how much the badness of fit improves as a result of the inclusion of the predictor variables” <span class="citation" data-cites="field2012discovering">(<a href="#ref-field2012discovering" role="doc-biblioref">Field, Miles, and Field, 317</a>)</span>. In essence, all the pseudo-R<sup>2</sup> values are measures of how substantive the model is (how much better it is compared to a baseline model). Next, we extract the confidence intervals for the coefficients of the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract the confidence intervals for the coefficients</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(lr.glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      2.5 %          97.5 %
(Intercept) -0.276050866670 -0.188778707810
AgeOld      -0.896486392279 -0.765095825382
GenderWomen -0.473530977637 -0.366703827307</code></pre>
</div>
</div>
<p>Despite having low explanatory and predictive power, the age of speakers and their gender are significant as the confidence intervals of the coefficients do not overlap with 0.</p>
</section>
<section id="effect-size" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="effect-size">Effect Size</h3>
<p>In a next step, we compute odds ratios and their confidence intervals. Odds Ratios represent a common measure of effect size and can be used to compare effect sizes across models. Odds ratios rang between 0 and infinity. Values of 1 indicate that there is no effect. The further away the values are from 1, the stronger the effect. If the values are lower than 1, then the variable level correlates negatively with the occurrence of the outcome (the probability decreases) while values above 1 indicate a positive correlation and show that the variable level causes an increase in the probability of the outcome (the occurrence of EH).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(lr.glm<span class="sc">$</span>coefficients) <span class="co"># odds ratios</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   (Intercept)         AgeOld    GenderWomen 
0.792642499264 0.435815384592 0.656972294902 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">confint</span>(lr.glm))     <span class="co"># confidence intervals of the odds ratios</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Waiting for profiling to be done...</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                     2.5 %         97.5 %
(Intercept) 0.758774333456 0.827969709653
AgeOld      0.408000698619 0.465289342309
GenderWomen 0.622799290871 0.693014866732</code></pre>
</div>
</div>
<p>The odds ratios confirm that older speakers use <em>eh</em> significantly less often compared with younger speakers and that women use <em>eh</em> less frequently than men as the confidence intervals of the odds rations do not overlap with 1. In a next step, we calculate the prediction accuracy of the model.</p>
</section>
<section id="prediction-accuracy" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="prediction-accuracy">Prediction Accuracy</h3>
<p>In order to calculate the prediction accuracy of the model, we generate a variable called <em>Prediction</em> that contains the predictions of pour model and which we add to the data. Then, we use the <code>confusionMatrix</code> function from the <code>caret</code> package <span class="citation" data-cites="caret">(<a href="#ref-caret" role="doc-biblioref">Kuhn 2021</a>)</span> to extract the prediction accuracy.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create variable with contains the prediction of the model</span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a>blrdata <span class="ot">&lt;-</span> blrdata <span class="sc">%&gt;%</span></span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Prediction =</span> <span class="fu">predict</span>(lr.glm, <span class="at">type =</span> <span class="st">"response"</span>),</span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">Prediction =</span> <span class="fu">ifelse</span>(Prediction <span class="sc">&gt;</span> .<span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">Prediction =</span> <span class="fu">factor</span>(Prediction, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"1"</span>)),</span>
<span id="cb189-6"><a href="#cb189-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">EH =</span> <span class="fu">factor</span>(EH, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"1"</span>)))</span>
<span id="cb189-7"><a href="#cb189-7" aria-hidden="true" tabindex="-1"></a><span class="co"># create a confusion matrix with compares observed against predicted values</span></span>
<span id="cb189-8"><a href="#cb189-8" aria-hidden="true" tabindex="-1"></a>caret<span class="sc">::</span><span class="fu">confusionMatrix</span>(blrdata<span class="sc">$</span>Prediction, blrdata<span class="sc">$</span>EH)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction     0     1
         0 17114  8707
         1     0     0
                                                    
               Accuracy : 0.66279385                
                 95% CI : (0.656990096, 0.668560948)
    No Information Rate : 0.66279385                
    P-Value [Acc &gt; NIR] : 0.5029107                 
                                                    
                  Kappa : 0                         
                                                    
 Mcnemar's Test P-Value : &lt; 0.00000000000000022     
                                                    
            Sensitivity : 1.00000000                
            Specificity : 0.00000000                
         Pos Pred Value : 0.66279385                
         Neg Pred Value :        NaN                
             Prevalence : 0.66279385                
         Detection Rate : 0.66279385                
   Detection Prevalence : 1.00000000                
      Balanced Accuracy : 0.50000000                
                                                    
       'Positive' Class : 0                         
                                                    </code></pre>
</div>
</div>
<p>We can see that out model has never predicted the use of <em>eh</em> which is common when dealing with rare phenomena. This is expected as the event s so rare that the probability of it not occurring substantively outweighs the probability of it occurring. As such, the prediction accuracy of our model is not significantly better compared to the prediction accuracy of the baseline model which is the no-information rate (NIR)) (p = 0.5029).</p>
<p>We can use the <code>plot_model</code> function from the <code>sjPlot</code> package <span class="citation" data-cites="sjPlot">(<a href="#ref-sjPlot" role="doc-biblioref">Lüdecke</a>)</span> to visualize the effects.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="co"># predicted probability</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>efp1 <span class="ot">&lt;-</span> <span class="fu">plot_model</span>(lr.glm, <span class="at">type =</span> <span class="st">"pred"</span>, <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"Age"</span>), <span class="at">axis.lim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) </span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a><span class="co"># predicted percentage</span></span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a>efp2 <span class="ot">&lt;-</span> <span class="fu">plot_model</span>(lr.glm, <span class="at">type =</span> <span class="st">"pred"</span>, <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"Gender"</span>), <span class="at">axis.lim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) </span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(efp1, efp2, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/blm27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>And we can also combine the visualization of the effects in a single plot as shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">plot_model</span>(lr.glm, <span class="at">type =</span> <span class="st">"pred"</span>, <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"Age"</span>, <span class="st">"Gender"</span>), <span class="at">axis.lim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Predicted Probabilty of eh"</span>, <span class="at">title =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray20"</span>, <span class="st">"gray70"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/blm28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="model-diagnostics-1" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="model-diagnostics-1">Model Diagnostics</h3>
<p>We are now in a position to perform model diagnostics and test if the model violates distributional requirements. In a first step, we test for the existence of multicollinearity.</p>
</section>
<section id="multicollinearity" class="level3 unnumbered">
<h3 class="unnumbered anchored">Multicollinearity</h3>
<p>Multicollinearity means that predictors in a model can be predicted by other predictors in the model (this means that they <em>share</em> variance with other predictors). If this is the case, the model results are unreliable because the presence of absence of one predictor has substantive effects on at least one other predictor.</p>
<p>To check whether the final minimal model contains predictors that correlate with each other, we extract variance inflation factors (VIF). If a model contains predictors that have variance inflation factors (VIF) &gt; 10 the model is unreliable <span class="citation" data-cites="myers1990classical">(<a href="#ref-myers1990classical" role="doc-biblioref">Myers</a>)</span>. <span class="citation" data-cites="gries2021statistics">Gries</span> shows that a VIF of 10 means that that predictor is explainable (predictable) from the other predictors in the model with an R<sup>2</sup> of .9 (a VIF of 5 means that predictor is explainable (predictable) from the other predictors in the model with an R<sup>2</sup> of .8).Indeed, predictors with VIF values greater than 4 are usually already problematic but, for large data sets, even VIFs greater than 2 can lead inflated standard errors (<a href="http://wiki.bcs.rochester.edu/HlpLab/LSA2013Regression?action=AttachFile&amp;do=view&amp;target=LSA13-Lecture6-CommonIssuesAndSolutions.pdf">Jaeger 2013</a>). Also, VIFs of 2.5 can be problematic <span class="citation" data-cites="szmrecsanyi2006morphosyntactic">(<a href="#ref-szmrecsanyi2006morphosyntactic" role="doc-biblioref">Szmrecsanyi, 215</a>)</span> and <span class="citation" data-cites="zuur2010protocol">(<a href="#ref-zuur2010protocol" role="doc-biblioref">Zuur, Ieno, and Elphick</a>)</span> proposes that variables with VIFs exceeding 3 should be removed.</p>
<div class="warning" style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
<b>NOTE</b><br><br>However, (multi-)collinearity is only an issue if one is interested in interpreting regression results! If the interpretation is irrelevant because what is relevant is prediction(!), then it does not matter if the model contains collinear predictors! See <span class="citation" data-cites="gries2021statistics">Gries</span> or the excursion below for a more elaborate explanation.
</p>
<p style="margin-left:1em;">
</p>
<p></p>
</span></div>
<p><br></p>
<hr>
<div class="warning" style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
<b>EXCURSION</b>
</p>
<p style="margin-left:1em;">
</p>
<p></p>
</span></div>
<div class="question">
<p>`</p>
<p>What is multicollinearity?<br></p>
<details>
<summary>
Answer
</summary>
<p><br></p>
<p>During the workshop on mixed-effects modeling, we talked about (multi-)collinearity and someone asked if collinearity reflected shared variance (what I thought) or predictability of variables (what the other person thought). Both answers are correct! We will see below why…</p>
<hr>
<div class="warning" style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
(Multi-)collinearity reflects the predictability of predictors based on the values of other predictors!
</p>
</span>
</div>
<hr>
<p>To test this, I generate a data set with 4 independent variables <code>a</code>, <code>b</code>, <code>c</code>, and <code>d</code> as well as two potential response variables <code>r1</code> (which is random) and <code>r2</code> (where the first 50 data points are the same as in <code>r1</code> but for the second 50 data points I have added a value of 50 to the data points 51 to 100 from <code>r1</code>). This means that the predictors <code>a</code> and <code>d</code> should both strongly correlate with <code>r2</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rms)</span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create data set</span></span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a><span class="co"># responses</span></span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 100 random numbers</span></span>
<span id="cb193-7"><a href="#cb193-7" aria-hidden="true" tabindex="-1"></a>r1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">50</span>, <span class="dv">10</span>)</span>
<span id="cb193-8"><a href="#cb193-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 50 smaller + 50 larger numbers</span></span>
<span id="cb193-9"><a href="#cb193-9" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">c</span>(r1[<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>], r1[<span class="dv">51</span><span class="sc">:</span><span class="dv">100</span>] <span class="sc">+</span> <span class="dv">50</span>)</span>
<span id="cb193-10"><a href="#cb193-10" aria-hidden="true" tabindex="-1"></a><span class="co"># predictors</span></span>
<span id="cb193-11"><a href="#cb193-11" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"1"</span>, <span class="dv">50</span>), <span class="fu">rep</span> (<span class="st">"0"</span>, <span class="dv">50</span>))</span>
<span id="cb193-12"><a href="#cb193-12" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"1"</span>, <span class="dv">25</span>), <span class="fu">rep</span> (<span class="st">"0"</span>, <span class="dv">25</span>)), <span class="dv">2</span>)</span>
<span id="cb193-13"><a href="#cb193-13" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"1"</span>, <span class="dv">10</span>), <span class="fu">rep</span>(<span class="st">"0"</span>, <span class="dv">10</span>)), <span class="dv">5</span>)</span>
<span id="cb193-14"><a href="#cb193-14" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"1"</span>, <span class="dv">47</span>), <span class="fu">rep</span> (<span class="st">"0"</span>, <span class="dv">3</span>), <span class="fu">rep</span> (<span class="st">"0"</span>, <span class="dv">47</span>), <span class="fu">rep</span> (<span class="st">"1"</span>, <span class="dv">3</span>))</span>
<span id="cb193-15"><a href="#cb193-15" aria-hidden="true" tabindex="-1"></a><span class="co"># create data set</span></span>
<span id="cb193-16"><a href="#cb193-16" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(r1, r2, a, b, c, d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>:::</p>
<p>::: {.cell} ::: {.cell-output-display}</p>
<div class="table-responsive">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>First 10 rows of df data.</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">r1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">r2</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">a</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">b</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">c</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">d</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">55.3805120133</td>
<td style="text-align: right;">55.3805120133</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">50.5169933942</td>
<td style="text-align: right;">50.5169933942</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">67.5135734932</td>
<td style="text-align: right;">67.5135734932</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">60.1733973728</td>
<td style="text-align: right;">60.1733973728</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">72.3678161278</td>
<td style="text-align: right;">72.3678161278</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">52.4309002788</td>
<td style="text-align: right;">52.4309002788</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">55.6904236277</td>
<td style="text-align: right;">55.6904236277</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">44.2366484882</td>
<td style="text-align: right;">44.2366484882</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">55.5987335816</td>
<td style="text-align: right;">55.5987335816</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">58.3120761737</td>
<td style="text-align: right;">58.3120761737</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
</tr>
</tbody>
</table>
</div>


<p>::: :::</p>
<p>Here are the visualizations of r1 and r2</p>
<p>::: {.cell} ::: {.cell-output-display} <img src="regression_files/figure-html/data2-1.png" class="img-fluid" width="672"> :::</p>
<p>::: {.cell-output-display} <img src="regression_files/figure-html/data2-2.png" class="img-fluid" width="672"> ::: :::</p>
<p><strong>Fit first model</strong></p>
<p>Now, I fit a first model. As the response is random, we do not expect any of the predictors to have a significant effect and we expect the R<sup>2</sup> to be rather low.</p>
<p>::: {.cell}</p>
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(r1 <span class="sc">~</span> a <span class="sc">+</span> b <span class="sc">+</span> c <span class="sc">+</span> d, <span class="at">data =</span> df)</span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect model</span></span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>::: {.cell-output .cell-output-stdout}</p>
<pre><code>
Call:
lm(formula = r1 ~ a + b + c + d, data = df)

Residuals:
          Min            1Q        Median            3Q           Max 
-25.076373713  -7.774694324   0.933388851   6.630369791  22.021652947 

Coefficients:
                Estimate   Std. Error  t value             Pr(&gt;|t|)    
(Intercept) 46.077236782  2.059313248 22.37505 &lt; 0.0000000000000002 ***
a1           5.957479586  4.593681927  1.29689             0.197812    
b1           5.148440925  2.098541787  2.45334             0.015977 *  
c1          -0.213502165  2.188893729 -0.09754             0.922504    
d1          -5.232737413  4.515342995 -1.15888             0.249410    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 10.4927089 on 95 degrees of freedom
Multiple R-squared:  0.075627922, Adjusted R-squared:  0.0367069924 
F-statistic: 1.94311705 on 4 and 95 DF,  p-value: 0.109586389</code></pre>
<p>::: :::</p>
<p>We now check for (multi-)collinearity using the <code>vif</code> function from the <code>rms</code> package <span class="citation" data-cites="rms">(<a href="#ref-rms" role="doc-biblioref">Harrell Jr 2021</a>)</span>. Variables <code>a</code> and <code>d</code> should have high variance inflation factor values (vif-values) because they overlap very much!</p>
<p>::: {.cell}</p>
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract vifs</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a>rms<span class="sc">::</span><span class="fu">vif</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>::: {.cell-output .cell-output-stdout}</p>
<pre><code>           a1            b1            c1            d1 
4.79166666667 1.00000000000 1.08796296296 4.62962962963 </code></pre>
<p>::: :::</p>
<p>Variables <code>a</code> and <code>d</code> do indeed have high vif-values.</p>
<p><strong>Fit second model</strong></p>
<p>We now fit a second model to the response which has higher values for the latter part of the response. Both <code>a</code> and <code>d</code> strongly correlate with the response. <strong>But</strong> because <code>a</code> and <code>d</code> are collinear, <code>d</code> should not be reported as being significant by the model. The R<sup>2</sup> of the model should be rather high (given the correlation between the response r2 and <code>a</code> and <code>d</code>).</p>
<p>::: {.cell}</p>
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(r2 <span class="sc">~</span> a <span class="sc">+</span> b <span class="sc">+</span> c <span class="sc">+</span> d, <span class="at">data =</span> df)</span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect model</span></span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>::: {.cell-output .cell-output-stdout}</p>
<pre><code>
Call:
lm(formula = r2 ~ a + b + c + d, data = df)

Residuals:
          Min            1Q        Median            3Q           Max 
-25.076373713  -7.774694324   0.933388851   6.630369791  22.021652947 

Coefficients:
                 Estimate    Std. Error  t value               Pr(&gt;|t|)    
(Intercept)  96.077236782   2.059313248 46.65499 &lt; 0.000000000000000222 ***
a1          -44.042520414   4.593681927 -9.58763  0.0000000000000012574 ***
b1            5.148440925   2.098541787  2.45334               0.015977 *  
c1           -0.213502165   2.188893729 -0.09754               0.922504    
d1           -5.232737413   4.515342995 -1.15888               0.249410    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 10.4927089 on 95 degrees of freedom
Multiple R-squared:  0.851726565, Adjusted R-squared:  0.845483473 
F-statistic: 136.427041 on 4 and 95 DF,  p-value: &lt; 0.0000000000000002220446</code></pre>
<p>::: :::</p>
<p>Again, we extract the vif-values.</p>
<p>::: {.cell}</p>
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract vifs</span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>rms<span class="sc">::</span><span class="fu">vif</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>::: {.cell-output .cell-output-stdout}</p>
<pre><code>           a1            b1            c1            d1 
4.79166666667 1.00000000000 1.08796296296 4.62962962963 </code></pre>
<p>::: :::</p>
<p>The vif-values are identical which shows that what matters is if the variables are predictable. To understand how we arrive at vif-values, we inspect the model matrix.</p>
<p>::: {.cell}</p>
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect model matrix</span></span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a>mm <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>:::</p>
<p>::: {.cell} ::: {.cell-output-display}</p>
<div class="table-responsive">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>First 15 rows of the model matrix.</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">(Intercept)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">a1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">b1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">c1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">d1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>


<p>::: :::</p>
<p>We now fit a linear model in which we predict <code>d</code> from the other predictors in the model matrix.</p>
<p>::: {.cell}</p>
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>mt <span class="ot">&lt;-</span> <span class="fu">lm</span>(mm[,<span class="dv">5</span>] <span class="sc">~</span> mm[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mt)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>::: {.cell-output .cell-output-stdout}</p>
<pre><code>[1] 0.784</code></pre>
<p>::: :::</p>
<p>The R<sup>2</sup> shows that the values of <code>d</code> are explained to 78.4 percent by the values of the other predictors in the model.</p>
<p>Now, we can write a function <span class="citation" data-cites="gries2021statistics">(taken from <a href="#ref-gries2021statistics" role="doc-biblioref">Gries</a>)</span> that converts this R<sup>2</sup> value</p>
<p>::: {.cell}</p>
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a>R2.to.VIF <span class="ot">&lt;-</span> <span class="cf">function</span>(some.modelmatrix.r2) {</span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>some.modelmatrix.r2)) } </span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a><span class="fu">R2.to.VIF</span>(<span class="fl">0.784</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>::: {.cell-output .cell-output-stdout}</p>
<pre><code>[1] 4.62962962963</code></pre>
<p>::: :::</p>
<p>The function outputs the vif-value of <code>d</code>. This shows that the vif-value of <code>d</code> represents its predictability from the other predictors in the model matrix which represents the amount of shared variance between <code>d</code> and the other predictors in the model.</p>
</div></details>
</div>
<p>`</p>
<hr>
<p><br></p>
<p>We now extract and check the VIFs of the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(lr.glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       AgeOld   GenderWomen 
1.00481494539 1.00481494539 </code></pre>
</div>
</div>
<p>In addition, predictors with 1/VIF values <span class="math inline">\(&lt;\)</span> .1 must be removed (data points with values above .2 are considered problematic) <span class="citation" data-cites="menard1995applied">(<a href="#ref-menard1995applied" role="doc-biblioref">Menard</a>)</span> and the mean value of VIFs should be <span class="math inline">\(~\)</span> 1 <span class="citation" data-cites="bowerman1990linear">(<a href="#ref-bowerman1990linear" role="doc-biblioref">Bowerman and O’Connell</a>)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">vif</span>(lr.glm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.00481494539</code></pre>
</div>
</div>
<section id="outlier-detection-1" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="outlier-detection-1">Outlier detection</h3>
<p>In order to detect potential outliers, we will calculate diagnostic parameters and add these to our data set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a>infl <span class="ot">&lt;-</span> <span class="fu">influence.measures</span>(lr.glm) <span class="co"># calculate influence statistics</span></span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a>blrdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(blrdata, infl[[<span class="dv">1</span>]], infl[[<span class="dv">2</span>]]) <span class="co"># add influence statistics</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In a next step, we use these diagnostic parameters to check if there are data points which should be removed as they unduly affect the model fit.</p>
</section>
<section id="sample-size" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="sample-size">Sample Size</h3>
<p>We now check whether the sample size is sufficient for our analysis <span class="citation" data-cites="green1991many">(<a href="#ref-green1991many" role="doc-biblioref">Green</a>)</span>.</p>
<ul>
<li><p>if you are interested in the overall model: 50 + 8k (k = number of predictors)</p></li>
<li><p>if you are interested in individual predictors: 104 + k</p></li>
<li><p>if you are interested in both: take the higher value!</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="co"># function to evaluate sample size</span></span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a>smplesz <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>((<span class="fu">length</span>(x<span class="sc">$</span>fitted) <span class="sc">&lt;</span> (<span class="dv">104</span> <span class="sc">+</span> <span class="fu">ncol</span>(<span class="fu">summary</span>(x)<span class="sc">$</span>coefficients)<span class="sc">-</span><span class="dv">1</span>)) <span class="sc">==</span> <span class="cn">TRUE</span>,</span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(</span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste</span>(<span class="st">"Sample too small: please increase your sample by "</span>,</span>
<span id="cb212-6"><a href="#cb212-6" aria-hidden="true" tabindex="-1"></a>      <span class="dv">104</span> <span class="sc">+</span> <span class="fu">ncol</span>(<span class="fu">summary</span>(x)<span class="sc">$</span>coefficients)<span class="sc">-</span><span class="dv">1</span> <span class="sc">-</span> <span class="fu">length</span>(x<span class="sc">$</span>fitted),</span>
<span id="cb212-7"><a href="#cb212-7" aria-hidden="true" tabindex="-1"></a>      <span class="st">" data points"</span>, <span class="at">collapse =</span> <span class="st">""</span>)),</span>
<span id="cb212-8"><a href="#cb212-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Sample size sufficient"</span>)) }</span>
<span id="cb212-9"><a href="#cb212-9" aria-hidden="true" tabindex="-1"></a><span class="co"># apply unction to model</span></span>
<span id="cb212-10"><a href="#cb212-10" aria-hidden="true" tabindex="-1"></a><span class="fu">smplesz</span>(lr.glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Sample size sufficient"</code></pre>
</div>
</div>
<p>According to rule of thumb provided in <span class="citation" data-cites="green1991many">Green</span>, the sample size is sufficient for our analysis.</p>
</section>
<section id="summarizing-results" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="summarizing-results">Summarizing Results</h3>
<p>As a final step, we summarize our findings in tabulated form.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(lr.glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">&nbsp;</td>
<td colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">EH</td>
</tr>
<tr class="even">
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Predictors</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Odds Ratios</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">CI</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">p</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">(Intercept)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.79</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.76&nbsp;–&nbsp;0.83</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">Age [Old]</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.44</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.41&nbsp;–&nbsp;0.47</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">Gender [Women]</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.66</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.62&nbsp;–&nbsp;0.69</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">Observations</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">25821</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">R<sup>2</sup> Tjur</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.032</td>
</tr>
</tbody>
</table>


</div>
</div>
<hr>
<!-- A more detailed summary table can be retrieved as follows: -->
<!-- ```{r blm34, eval = T, warning=F, message=F} -->
<!-- # load function -->
<!-- source("rscripts/blrsummary.r") -->
<!-- # calculate accuracy  -->
<!-- predict.acc <- caret::confusionMatrix(blrdata$Prediction, blrdata$EH) -->
<!-- predict.acc <- predict.acc[3]$overall[[1]] -->
<!-- # create summary table -->
<!-- blrsummarytb <- blrsummary(lr.glm, lr.lrm, predict.acc)  -->
<!-- ``` -->
<!-- ```{r blm35, echo = F, warning=F, message=F} -->
<!-- # inspect data -->
<!-- blrsummarytb %>% -->
<!--   as.data.frame() %>% -->
<!--   tibble::rownames_to_column("Statistics") %>% -->
<!--   flextable() %>% -->
<!--   flextable::set_table_properties(width = .75, layout = "autofit") %>% -->
<!--   flextable::theme_zebra() %>% -->
<!--   flextable::fontsize(size = 12) %>% -->
<!--   flextable::fontsize(size = 12, part = "header") %>% -->
<!--   flextable::align_text_col(align = "center") %>% -->
<!--   flextable::set_caption(caption = "Results of the binomial logistic regression analysis.")  %>% -->
<!--   flextable::border_outer() -->
<!-- ``` -->
<p><strong>R<sup>2</sup> (Hosmer &amp; Lemeshow)</strong></p>
<p>Hosmer and Lemeshow’s R<sup>2</sup> “is the proportional reduction in the absolute value of the log-likelihood measure and as such it is a measure of how much the badness of fit improves as a result of the inclusion of the predictor variables. It can vary between 0 (indicating that the predictors are useless at predicting the outcome variable) and 1 (indicating that the model predicts the outcome variable perfectly)” <span class="citation" data-cites="field2012discovering">(<a href="#ref-field2012discovering" role="doc-biblioref">Field, Miles, and Field, 317</a>)</span>.</p>
<p><strong>R<sup>2</sup> (Cox &amp; Snell)</strong></p>
<p>“Cox and Snell’s R<sup>2</sup> (1989) is based on the deviance of the model (-2LL(new») and the deviance of the baseline model (-2LL(baseline), and the sample size, n […]. However, this statistic never reaches its theoretical maximum of 1.</p>
<p><strong>R2 (Nagelkerke)</strong></p>
<p>Since R<sup>2</sup> (Cox &amp; Snell) never reaches its theoretical maximum of 1, Nagelkerke (1991) suggested Nagelkerke’s R<sup>2</sup> <span class="citation" data-cites="field2012discovering">(<a href="#ref-field2012discovering" role="doc-biblioref">Field, Miles, and Field, 317–18</a>)</span>.</p>
<p><strong>Somers’ D<sub>xy</sub></strong></p>
<p>Somers’ D<sub>xy</sub> is a rank correlation between predicted probabilities and observed responses ranges between 0 (randomness) and 1 (perfect prediction). Somers’ D<sub>xy</sub> should have a value higher than .5 for the model to be meaningful <span class="citation" data-cites="baayen2008analyzing">(<a href="#ref-baayen2008analyzing" role="doc-biblioref">Baayen, 204</a>)</span>.</p>
<p><strong>C</strong></p>
<p>C is an index of concordance between the predicted probability and the observed response. When C takes the value 0.5, the predictions are random, when it is 1, prediction is perfect. A value above 0.8 indicates that the model may have some real predictive capacity <span class="citation" data-cites="baayen2008analyzing">(<a href="#ref-baayen2008analyzing" role="doc-biblioref">Baayen, 204</a>)</span>.</p>
<p><strong>Akaike information criteria (AIC)</strong></p>
<p>Akaike information criteria (AlC = -2LL + 2k) provide a value that reflects a ratio between the number of predictors in the model and the variance that is explained by these predictors. Changes in AIC can serve as a measure of whether the inclusion of a variable leads to a significant increase in the amount of variance that is explained by the model. “You can think of this as the price you pay for something: you get a better value of R<sup>2</sup>, but you pay a higher price, and was that higher price worth it? These information criteria help you to decide. The BIC is the same as the AIC but adjusts the penalty included in the AlC (i.e., 2k) by the number of cases: BlC = -2LL + 2k x log(n) in which n is the number of cases in the model” <span class="citation" data-cites="field2012discovering">(<a href="#ref-field2012discovering" role="doc-biblioref">Field, Miles, and Field, 318</a>)</span>.</p>
<p>We can use the <code>reports</code> package <span class="citation" data-cites="report">(<a href="#ref-report" role="doc-biblioref">Makowski et al. 2021</a>)</span> to summarize the analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(lr.glm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a logistic model (estimated using ML) to predict EH with Age and
Gender (formula: EH ~ Age + Gender). The model's explanatory power is weak
(Tjur's R2 = 0.03). The model's intercept, corresponding to Age = Young and
Gender = Men, is at -0.23 (95% CI [-0.28, -0.19], p &lt; .001). Within this model:

  - The effect of Age [Old] is statistically significant and negative (beta =
-0.83, 95% CI [-0.90, -0.77], p &lt; .001; Std. beta = -0.83, 95% CI [-0.90,
-0.77])
  - The effect of Gender [Women] is statistically significant and negative (beta
= -0.42, 95% CI [-0.47, -0.37], p &lt; .001; Std. beta = -0.42, 95% CI [-0.47,
-0.37])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald z-distribution approximation.</code></pre>
</div>
</div>
<p>We can use this output to write up a final report:</p>
<p>We fitted a logistic model (estimated using ML) to predict the use of the utterance-final discourse particle <em>eh</em> with Age and Gender (formula: EH ~ Age + Gender). The model’s explanatory power is weak (Tjur’s R<sup>2</sup> = 0.03). The model’s intercept, corresponding to Age = Young and Gender = Men, is at -0.23 (95% CI [-0.28, -0.19], p &lt; .001). Within this model:</p>
<ul>
<li><p>The effect of Age [Old] is statistically significant and negative (beta = -0.83, 95% CI [-0.90, -0.77], p &lt; .001; Std. beta = -0.83, 95% CI [-0.90, -0.77])</p></li>
<li><p>The effect of Gender [Women] is statistically significant and negative (beta = -0.42, 95% CI [-0.47, -0.37], p &lt; .001; Std. beta = -0.42, 95% CI [-0.47, -0.37])</p></li>
</ul>
<p>Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using</p>
</section>
<section id="ordinal-regression" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="ordinal-regression">Ordinal Regression</h2>
<p>Ordinal regression is very similar to multiple linear regression but takes an ordinal dependent variable <span class="citation" data-cites="agresti2010analysis">(<a href="#ref-agresti2010analysis" role="doc-biblioref">Agresti</a>)</span>. For this reason, ordinal regression is one of the key methods in analysing Likert data.</p>
<p>To see how an ordinal regression is implemented in R, we load and inspect the ´ordinaldata´ data set. The data set consists of 400 observations of students that were either educated at this school (Internal = 1) or not (Internal = 0). Some of the students have been abroad (Exchange = 1) while other have not (Exchange = 0). In addition, the data set contains the students’ final score of a language test (FinalScore) and the dependent variable which the recommendation of a committee for an additional, very prestigious program. The recommendation has three levels (<em>very likely</em>, <em>somewhat likely</em>, and <em>unlikely</em>) and reflects the committees’ assessment of whether the student is likely to succeed in the program.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a>ordata  <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="st">"tutorials/regression/data/ord.rda"</span>, <span class="st">"rb"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Recommend =</span> <span class="dv">1</span>, </span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">Internal =</span> <span class="dv">2</span>, </span>
<span id="cb217-5"><a href="#cb217-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">Exchange =</span> <span class="dv">3</span>, </span>
<span id="cb217-6"><a href="#cb217-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">FinalScore =</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb217-7"><a href="#cb217-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">FinalScore =</span> <span class="fu">round</span>(FinalScore, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-9721abd8{table-layout:auto;width:75%;}.cl-971cd310{font-family:'DejaVu Sans';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-971cd31a{font-family:'DejaVu Sans';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-971ecb70{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-971ecb7a{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-971ee09c{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-971ee0a6{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-971ee0a7{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-971ee0a8{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-971ee0b0{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-971ee0b1{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-971ee0b2{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-971ee0ba{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-971ee0bb{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-971ee0bc{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-971ee0c4{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-971ee0c5{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-9721abd8"><thead><tr style="overflow-wrap:break-word;"><th class="cl-971ee09c"><p class="cl-971ecb70"><span class="cl-971cd310">Recommend</span></p></th><th class="cl-971ee0a6"><p class="cl-971ecb7a"><span class="cl-971cd310">Internal</span></p></th><th class="cl-971ee0a6"><p class="cl-971ecb7a"><span class="cl-971cd310">Exchange</span></p></th><th class="cl-971ee0a7"><p class="cl-971ecb7a"><span class="cl-971cd310">FinalScore</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-971ee0a8"><p class="cl-971ecb70"><span class="cl-971cd31a">very likely</span></p></td><td class="cl-971ee0b0"><p class="cl-971ecb7a"><span class="cl-971cd31a">0</span></p></td><td class="cl-971ee0b0"><p class="cl-971ecb7a"><span class="cl-971cd31a">0</span></p></td><td class="cl-971ee0b1"><p class="cl-971ecb7a"><span class="cl-971cd31a">3.26</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-971ee0b2"><p class="cl-971ecb70"><span class="cl-971cd31a">somewhat likely</span></p></td><td class="cl-971ee0ba"><p class="cl-971ecb7a"><span class="cl-971cd31a">1</span></p></td><td class="cl-971ee0ba"><p class="cl-971ecb7a"><span class="cl-971cd31a">0</span></p></td><td class="cl-971ee0bb"><p class="cl-971ecb7a"><span class="cl-971cd31a">3.21</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-971ee0a8"><p class="cl-971ecb70"><span class="cl-971cd31a">unlikely</span></p></td><td class="cl-971ee0b0"><p class="cl-971ecb7a"><span class="cl-971cd31a">1</span></p></td><td class="cl-971ee0b0"><p class="cl-971ecb7a"><span class="cl-971cd31a">1</span></p></td><td class="cl-971ee0b1"><p class="cl-971ecb7a"><span class="cl-971cd31a">3.94</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-971ee0b2"><p class="cl-971ecb70"><span class="cl-971cd31a">somewhat likely</span></p></td><td class="cl-971ee0ba"><p class="cl-971ecb7a"><span class="cl-971cd31a">0</span></p></td><td class="cl-971ee0ba"><p class="cl-971ecb7a"><span class="cl-971cd31a">0</span></p></td><td class="cl-971ee0bb"><p class="cl-971ecb7a"><span class="cl-971cd31a">2.81</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-971ee0a8"><p class="cl-971ecb70"><span class="cl-971cd31a">somewhat likely</span></p></td><td class="cl-971ee0b0"><p class="cl-971ecb7a"><span class="cl-971cd31a">0</span></p></td><td class="cl-971ee0b0"><p class="cl-971ecb7a"><span class="cl-971cd31a">0</span></p></td><td class="cl-971ee0b1"><p class="cl-971ecb7a"><span class="cl-971cd31a">2.53</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-971ee0b2"><p class="cl-971ecb70"><span class="cl-971cd31a">unlikely</span></p></td><td class="cl-971ee0ba"><p class="cl-971ecb7a"><span class="cl-971cd31a">0</span></p></td><td class="cl-971ee0ba"><p class="cl-971ecb7a"><span class="cl-971cd31a">1</span></p></td><td class="cl-971ee0bb"><p class="cl-971ecb7a"><span class="cl-971cd31a">2.59</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-971ee0a8"><p class="cl-971ecb70"><span class="cl-971cd31a">somewhat likely</span></p></td><td class="cl-971ee0b0"><p class="cl-971ecb7a"><span class="cl-971cd31a">0</span></p></td><td class="cl-971ee0b0"><p class="cl-971ecb7a"><span class="cl-971cd31a">0</span></p></td><td class="cl-971ee0b1"><p class="cl-971ecb7a"><span class="cl-971cd31a">2.56</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-971ee0b2"><p class="cl-971ecb70"><span class="cl-971cd31a">somewhat likely</span></p></td><td class="cl-971ee0ba"><p class="cl-971ecb7a"><span class="cl-971cd31a">0</span></p></td><td class="cl-971ee0ba"><p class="cl-971ecb7a"><span class="cl-971cd31a">0</span></p></td><td class="cl-971ee0bb"><p class="cl-971ecb7a"><span class="cl-971cd31a">2.73</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-971ee0a8"><p class="cl-971ecb70"><span class="cl-971cd31a">unlikely</span></p></td><td class="cl-971ee0b0"><p class="cl-971ecb7a"><span class="cl-971cd31a">0</span></p></td><td class="cl-971ee0b0"><p class="cl-971ecb7a"><span class="cl-971cd31a">0</span></p></td><td class="cl-971ee0b1"><p class="cl-971ecb7a"><span class="cl-971cd31a">3.00</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-971ee0b2"><p class="cl-971ecb70"><span class="cl-971cd31a">somewhat likely</span></p></td><td class="cl-971ee0ba"><p class="cl-971ecb7a"><span class="cl-971cd31a">1</span></p></td><td class="cl-971ee0ba"><p class="cl-971ecb7a"><span class="cl-971cd31a">0</span></p></td><td class="cl-971ee0bb"><p class="cl-971ecb7a"><span class="cl-971cd31a">3.50</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-971ee0a8"><p class="cl-971ecb70"><span class="cl-971cd31a">unlikely</span></p></td><td class="cl-971ee0b0"><p class="cl-971ecb7a"><span class="cl-971cd31a">1</span></p></td><td class="cl-971ee0b0"><p class="cl-971ecb7a"><span class="cl-971cd31a">1</span></p></td><td class="cl-971ee0b1"><p class="cl-971ecb7a"><span class="cl-971cd31a">3.65</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-971ee0b2"><p class="cl-971ecb70"><span class="cl-971cd31a">somewhat likely</span></p></td><td class="cl-971ee0ba"><p class="cl-971ecb7a"><span class="cl-971cd31a">0</span></p></td><td class="cl-971ee0ba"><p class="cl-971ecb7a"><span class="cl-971cd31a">0</span></p></td><td class="cl-971ee0bb"><p class="cl-971ecb7a"><span class="cl-971cd31a">2.84</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-971ee0a8"><p class="cl-971ecb70"><span class="cl-971cd31a">very likely</span></p></td><td class="cl-971ee0b0"><p class="cl-971ecb7a"><span class="cl-971cd31a">0</span></p></td><td class="cl-971ee0b0"><p class="cl-971ecb7a"><span class="cl-971cd31a">1</span></p></td><td class="cl-971ee0b1"><p class="cl-971ecb7a"><span class="cl-971cd31a">3.90</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-971ee0b2"><p class="cl-971ecb70"><span class="cl-971cd31a">somewhat likely</span></p></td><td class="cl-971ee0ba"><p class="cl-971ecb7a"><span class="cl-971cd31a">0</span></p></td><td class="cl-971ee0ba"><p class="cl-971ecb7a"><span class="cl-971cd31a">0</span></p></td><td class="cl-971ee0bb"><p class="cl-971ecb7a"><span class="cl-971cd31a">2.68</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-971ee0bc"><p class="cl-971ecb70"><span class="cl-971cd31a">unlikely</span></p></td><td class="cl-971ee0c4"><p class="cl-971ecb7a"><span class="cl-971cd31a">1</span></p></td><td class="cl-971ee0c4"><p class="cl-971ecb7a"><span class="cl-971cd31a">0</span></p></td><td class="cl-971ee0c5"><p class="cl-971ecb7a"><span class="cl-971cd31a">3.57</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>In a first step, we need to relevel the ordinal variable to represent an ordinal factor (or a progression from “unlikely” over “somewhat likely” to “very likely”. And we will also factorize Internal and Exchange to make it easier to interpret the output later on.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="co"># relevel data</span></span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a>ordata <span class="ot">&lt;-</span> ordata <span class="sc">%&gt;%</span></span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Recommend =</span> <span class="fu">factor</span>(Recommend, </span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"unlikely"</span>, <span class="st">"somewhat likely"</span>, <span class="st">"very likely"</span>),</span>
<span id="cb218-5"><a href="#cb218-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"unlikely"</span>,  <span class="st">"somewhat likely"</span>,  <span class="st">"very likely"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb218-6"><a href="#cb218-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Exchange =</span> <span class="fu">ifelse</span>(Exchange <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"Exchange"</span>, <span class="st">"NoExchange"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb218-7"><a href="#cb218-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Internal =</span> <span class="fu">ifelse</span>(Internal <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"Internal"</span>, <span class="st">"External"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now that the dependent variable is releveled, we check the distribution of the variable levels by tabulating the data. To get a better understanding of the data we create frequency tables across variables rather than viewing the variables in isolation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="do">## three way cross tabs (xtabs) and flatten the table</span></span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ftable</span>(<span class="fu">xtabs</span>(<span class="sc">~</span> Exchange <span class="sc">+</span> Recommend <span class="sc">+</span> Internal, <span class="at">data =</span> ordata))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                           Internal External Internal
Exchange   Recommend                                 
Exchange   unlikely                       25        6
           somewhat likely                12        4
           very likely                     7        3
NoExchange unlikely                      175       14
           somewhat likely                98       26
           very likely                    20       10</code></pre>
</div>
</div>
<p>We also check the mean and standard deviation of the final score as final score is a numeric variable and cannot be tabulated (unless we convert it to a factor).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ordata<span class="sc">$</span>FinalScore); <span class="fu">sd</span>(ordata<span class="sc">$</span>FinalScore)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
1.900000 2.720000 2.990000 2.998925 3.270000 4.000000 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.397940933861</code></pre>
</div>
</div>
<p>The lowest score is 1.9 and the highest score is a 4.0 with a mean of approximately 3. Finally, we inspect the distributions graphically.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="co"># visualize data</span></span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ordata, <span class="fu">aes</span>(<span class="at">x =</span> Recommend, <span class="at">y =</span> FinalScore)) <span class="sc">+</span></span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">size =</span> .<span class="dv">75</span>) <span class="sc">+</span></span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb224-5"><a href="#cb224-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Exchange <span class="sc">~</span> Internal, <span class="at">margins =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb224-6"><a href="#cb224-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/orr6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We see that we have only few students that have taken part in an exchange program and there are also only few internal students overall. With respect to recommendations, only few students are considered to very likely succeed in the program. We can now start with the modeling by using the <code>polr</code> function. To make things easier for us, we will only consider the main effects here as this tutorial only aims to how to implement an ordinal regression but not how it should be done in a proper study - then, the model fitting and diagnostic procedures would have to be performed accurately, of course.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit ordered logit model and store results 'm'</span></span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a>m.or <span class="ot">&lt;-</span> <span class="fu">polr</span>(Recommend <span class="sc">~</span> Internal <span class="sc">+</span> Exchange <span class="sc">+</span> FinalScore, <span class="at">data =</span> ordata, <span class="at">Hess=</span><span class="cn">TRUE</span>)</span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a><span class="co"># summarize model</span></span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m.or)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
polr(formula = Recommend ~ Internal + Exchange + FinalScore, 
    data = ordata, Hess = TRUE)

Coefficients:
                          Value  Std. Error     t value
InternalInternal   1.0476639460 0.265789134 3.941710973
ExchangeNoExchange 0.0586810767 0.297858822 0.197009698
FinalScore         0.6157435926 0.260631275 2.362508462

Intercepts:
                            Value       Std. Error  t value    
unlikely|somewhat likely    2.261997623 0.882173604 2.564118460
somewhat likely|very likely 4.357441880 0.904467838 4.817685824

Residual Deviance: 717.024871356 
AIC: 727.024871356 </code></pre>
</div>
</div>
<p>The results show that having studied here at this school increases the chances of receiving a positive recommendation but that having been on an exchange has a negative but insignificant effect on the recommendation. The final score also correlates positively with a positive recommendation but not as much as having studied here.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="do">## store table</span></span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a>(ctable <span class="ot">&lt;-</span> <span class="fu">coef</span>(<span class="fu">summary</span>(m.or)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                      Value     Std. Error        t value
InternalInternal            1.0476639460469 0.265789134041 3.941710972596
ExchangeNoExchange          0.0586810766831 0.297858821982 0.197009698396
FinalScore                  0.6157435925546 0.260631274948 2.362508462104
unlikely|somewhat likely    2.2619976233665 0.882173604268 2.564118459704
somewhat likely|very likely 4.3574418799106 0.904467837679 4.817685824069</code></pre>
</div>
</div>
<p>As the regression report does not provide p-values, we have to calculate them separately (after having calculated them, we add them to the coefficient table).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="do">## calculate and store p values</span></span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(ctable[, <span class="st">"t value"</span>]), <span class="at">lower.tail =</span> <span class="cn">FALSE</span>) <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a><span class="do">## combined table</span></span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a>(ctable <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ctable, <span class="st">"p value"</span> <span class="ot">=</span> p))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                      Value     Std. Error        t value
InternalInternal            1.0476639460469 0.265789134041 3.941710972596
ExchangeNoExchange          0.0586810766831 0.297858821982 0.197009698396
FinalScore                  0.6157435925546 0.260631274948 2.362508462104
unlikely|somewhat likely    2.2619976233665 0.882173604268 2.564118459704
somewhat likely|very likely 4.3574418799106 0.904467837679 4.817685824069
                                        p value
InternalInternal            0.00008090242989074
ExchangeNoExchange          0.84381994829785212
FinalScore                  0.01815172703306602
unlikely|somewhat likely    0.01034382345525986
somewhat likely|very likely 0.00000145232812832</code></pre>
</div>
</div>
<p>As predicted, Exchange does not have a significant effect but FinalScore and Internal both correlate significantly with the likelihood of receiving a positive recommendation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract profiled confidence intervals</span></span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">confint</span>(m.or)</span>
<span id="cb231-3"><a href="#cb231-3" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate odds ratios and combine them with profiled CIs</span></span>
<span id="cb231-4"><a href="#cb231-4" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">cbind</span>(<span class="at">OR =</span> <span class="fu">coef</span>(m.or), ci))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                              OR          2.5 %        97.5 %
InternalInternal   2.85098328212 1.695837799597 4.81711408266
ExchangeNoExchange 1.06043698872 0.595033205649 1.91977108408
FinalScore         1.85103250193 1.113625249822 3.09849059342</code></pre>
</div>
</div>
<p>The odds ratios show that internal students are 2.85 times or 285 percent as likely as non-internal students to receive positive evaluations and that a 1-point increase in the test score lead to a 1.85 times or 185 percent increase in the chances of receiving a positive recommendation. The effect of an exchange is slightly negative but, as we have seen above, not significant.</p>
</section>
<section id="poisson-regression" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="poisson-regression">Poisson Regression</h2>
<p>This section is based on <a href="https://stats.idre.ucla.edu/r/dae/poisson-regression/">this tutorials</a> on how to perform a Poisson regression in R.</p>
<div class="warning" style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
<b>NOTE</b><br><br>Poisson regressions are used to analyze data where the dependent variable represents counts.
</p>
<p style="margin-left:1em;">
</p>
<p></p>
</span></div>
<p><br></p>
<p>This applied particularly to counts that are based on observations of something that is measured in set intervals. For instances the number of pauses in two-minute-long conversations. Poisson regressions are particularly appealing when dealing with rare events, i.e.&nbsp;when something only occurs very infrequently. In such cases, normal linear regressions do not work because the instances that do occur are automatically considered outliers. Therefore, it is useful to check if the data conform to a Poisson distribution.</p>
<p>However, the tricky thing about Poisson regressions is that the data has to conform to the Poisson distribution which is, according to my experience, rarely the case, unfortunately. The Gaussian Normal Distribution is very flexible because it is defined by two parameters, the mean (mu, i.e.&nbsp;<span class="math inline">\(\mu\)</span>) and the standard deviation (sigma, i.e.&nbsp;<span class="math inline">\(\sigma\)</span>). This allows the normal distribution to take very different shapes (for example, very high and slim (compressed) or very wide and flat). In contrast, the Poisson is defined by only one parameter (lambda, i.e.&nbsp;<span class="math inline">\(\lambda\)</span>) which mean that if we have a mean of 2, then the standard deviation is also 2 (actually we would have to say that the mean is <span class="math inline">\(\lambda\)</span> and the standard deviation is also <span class="math inline">\(\lambda\)</span> or <span class="math inline">\(\lambda\)</span> = <span class="math inline">\(\mu\)</span> = <span class="math inline">\(\sigma\)</span>). This is much trickier for natural data as this means that the Poisson distribution is very rigid.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/pr0-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>As we can see, as <span class="math inline">\(\lambda\)</span> takes on higher values, the distribution becomes wider and flatter - a compressed distribution with a high mean can therefore not be Poisson-distributed. We will now start by loading the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a>poissondata  <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="st">"tutorials/regression/data/prd.rda"</span>, <span class="st">"rb"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-97fc2aba{table-layout:auto;width:75%;}.cl-97f53ebc{font-family:'DejaVu Sans';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-97f53ed0{font-family:'DejaVu Sans';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-97f8ea80{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-97f8ea8a{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-97f9027c{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-97f90286{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-97f90287{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-97f90290{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-97f90291{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-97f9029a{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-97f9029b{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-97f9029c{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-97f902a4{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-97f902a5{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-97f902ae{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-97f902af{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-97f902b8{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-97f902b9{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-97f902c2{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-97f902c3{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-97fc2aba"><thead><tr style="overflow-wrap:break-word;"><th class="cl-97f9027c"><p class="cl-97f8ea80"><span class="cl-97f53ebc">Id</span></p></th><th class="cl-97f90286"><p class="cl-97f8ea80"><span class="cl-97f53ebc">Pauses</span></p></th><th class="cl-97f90287"><p class="cl-97f8ea8a"><span class="cl-97f53ebc">Language</span></p></th><th class="cl-97f90290"><p class="cl-97f8ea80"><span class="cl-97f53ebc">Alcohol</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-97f90291"><p class="cl-97f8ea80"><span class="cl-97f53ed0">45</span></p></td><td class="cl-97f9029a"><p class="cl-97f8ea80"><span class="cl-97f53ed0">0</span></p></td><td class="cl-97f9029b"><p class="cl-97f8ea8a"><span class="cl-97f53ed0">German</span></p></td><td class="cl-97f9029c"><p class="cl-97f8ea80"><span class="cl-97f53ed0">41</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-97f902a4"><p class="cl-97f8ea80"><span class="cl-97f53ed0">108</span></p></td><td class="cl-97f902a5"><p class="cl-97f8ea80"><span class="cl-97f53ed0">0</span></p></td><td class="cl-97f902ae"><p class="cl-97f8ea8a"><span class="cl-97f53ed0">Russian</span></p></td><td class="cl-97f902af"><p class="cl-97f8ea80"><span class="cl-97f53ed0">41</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-97f90291"><p class="cl-97f8ea80"><span class="cl-97f53ed0">15</span></p></td><td class="cl-97f9029a"><p class="cl-97f8ea80"><span class="cl-97f53ed0">0</span></p></td><td class="cl-97f9029b"><p class="cl-97f8ea8a"><span class="cl-97f53ed0">German</span></p></td><td class="cl-97f9029c"><p class="cl-97f8ea80"><span class="cl-97f53ed0">44</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-97f902a4"><p class="cl-97f8ea80"><span class="cl-97f53ed0">67</span></p></td><td class="cl-97f902a5"><p class="cl-97f8ea80"><span class="cl-97f53ed0">0</span></p></td><td class="cl-97f902ae"><p class="cl-97f8ea8a"><span class="cl-97f53ed0">German</span></p></td><td class="cl-97f902af"><p class="cl-97f8ea80"><span class="cl-97f53ed0">42</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-97f90291"><p class="cl-97f8ea80"><span class="cl-97f53ed0">153</span></p></td><td class="cl-97f9029a"><p class="cl-97f8ea80"><span class="cl-97f53ed0">0</span></p></td><td class="cl-97f9029b"><p class="cl-97f8ea8a"><span class="cl-97f53ed0">German</span></p></td><td class="cl-97f9029c"><p class="cl-97f8ea80"><span class="cl-97f53ed0">40</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-97f902a4"><p class="cl-97f8ea80"><span class="cl-97f53ed0">51</span></p></td><td class="cl-97f902a5"><p class="cl-97f8ea80"><span class="cl-97f53ed0">0</span></p></td><td class="cl-97f902ae"><p class="cl-97f8ea8a"><span class="cl-97f53ed0">Russian</span></p></td><td class="cl-97f902af"><p class="cl-97f8ea80"><span class="cl-97f53ed0">42</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-97f90291"><p class="cl-97f8ea80"><span class="cl-97f53ed0">164</span></p></td><td class="cl-97f9029a"><p class="cl-97f8ea80"><span class="cl-97f53ed0">0</span></p></td><td class="cl-97f9029b"><p class="cl-97f8ea8a"><span class="cl-97f53ed0">German</span></p></td><td class="cl-97f9029c"><p class="cl-97f8ea80"><span class="cl-97f53ed0">46</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-97f902a4"><p class="cl-97f8ea80"><span class="cl-97f53ed0">133</span></p></td><td class="cl-97f902a5"><p class="cl-97f8ea80"><span class="cl-97f53ed0">0</span></p></td><td class="cl-97f902ae"><p class="cl-97f8ea8a"><span class="cl-97f53ed0">German</span></p></td><td class="cl-97f902af"><p class="cl-97f8ea80"><span class="cl-97f53ed0">40</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-97f90291"><p class="cl-97f8ea80"><span class="cl-97f53ed0">2</span></p></td><td class="cl-97f9029a"><p class="cl-97f8ea80"><span class="cl-97f53ed0">0</span></p></td><td class="cl-97f9029b"><p class="cl-97f8ea8a"><span class="cl-97f53ed0">German</span></p></td><td class="cl-97f9029c"><p class="cl-97f8ea80"><span class="cl-97f53ed0">33</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-97f902a4"><p class="cl-97f8ea80"><span class="cl-97f53ed0">53</span></p></td><td class="cl-97f902a5"><p class="cl-97f8ea80"><span class="cl-97f53ed0">0</span></p></td><td class="cl-97f902ae"><p class="cl-97f8ea8a"><span class="cl-97f53ed0">German</span></p></td><td class="cl-97f902af"><p class="cl-97f8ea80"><span class="cl-97f53ed0">46</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-97f90291"><p class="cl-97f8ea80"><span class="cl-97f53ed0">1</span></p></td><td class="cl-97f9029a"><p class="cl-97f8ea80"><span class="cl-97f53ed0">0</span></p></td><td class="cl-97f9029b"><p class="cl-97f8ea8a"><span class="cl-97f53ed0">German</span></p></td><td class="cl-97f9029c"><p class="cl-97f8ea80"><span class="cl-97f53ed0">40</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-97f902a4"><p class="cl-97f8ea80"><span class="cl-97f53ed0">128</span></p></td><td class="cl-97f902a5"><p class="cl-97f8ea80"><span class="cl-97f53ed0">0</span></p></td><td class="cl-97f902ae"><p class="cl-97f8ea8a"><span class="cl-97f53ed0">English</span></p></td><td class="cl-97f902af"><p class="cl-97f8ea80"><span class="cl-97f53ed0">38</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-97f90291"><p class="cl-97f8ea80"><span class="cl-97f53ed0">16</span></p></td><td class="cl-97f9029a"><p class="cl-97f8ea80"><span class="cl-97f53ed0">0</span></p></td><td class="cl-97f9029b"><p class="cl-97f8ea8a"><span class="cl-97f53ed0">German</span></p></td><td class="cl-97f9029c"><p class="cl-97f8ea80"><span class="cl-97f53ed0">44</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-97f902a4"><p class="cl-97f8ea80"><span class="cl-97f53ed0">106</span></p></td><td class="cl-97f902a5"><p class="cl-97f8ea80"><span class="cl-97f53ed0">0</span></p></td><td class="cl-97f902ae"><p class="cl-97f8ea8a"><span class="cl-97f53ed0">German</span></p></td><td class="cl-97f902af"><p class="cl-97f8ea80"><span class="cl-97f53ed0">37</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-97f902b8"><p class="cl-97f8ea80"><span class="cl-97f53ed0">89</span></p></td><td class="cl-97f902b9"><p class="cl-97f8ea80"><span class="cl-97f53ed0">0</span></p></td><td class="cl-97f902c2"><p class="cl-97f8ea8a"><span class="cl-97f53ed0">German</span></p></td><td class="cl-97f902c3"><p class="cl-97f8ea80"><span class="cl-97f53ed0">40</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>We will clean the data by factorizing Id which is currently considered a numeric variable rather than a factor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="co"># process data</span></span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a>poissondata <span class="ot">&lt;-</span> poissondata <span class="sc">%&gt;%</span></span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Id =</span> <span class="fu">factor</span>(Id, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>, <span class="at">labels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>))</span>
<span id="cb234-4"><a href="#cb234-4" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect data</span></span>
<span id="cb234-5"><a href="#cb234-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(poissondata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   200 obs. of  4 variables:
 $ Id      : Factor w/ 200 levels "1","2","3","4",..: 45 108 15 67 153 51 164 133 2 53 ...
 $ Pauses  : int  0 0 0 0 0 0 0 0 0 0 ...
 $ Language: chr  "German" "Russian" "German" "German" ...
 $ Alcohol : int  41 41 44 42 40 42 46 40 33 46 ...</code></pre>
</div>
</div>
<p>First, we check if the conditions for a Poisson regression are met.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="co"># output the results</span></span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a>gf <span class="ot">=</span> vcd<span class="sc">::</span><span class="fu">goodfit</span>(poissondata<span class="sc">$</span>Pauses, </span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">type=</span> <span class="st">"poisson"</span>, </span>
<span id="cb236-4"><a href="#cb236-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method=</span> <span class="st">"ML"</span>)</span>
<span id="cb236-5"><a href="#cb236-5" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect results</span></span>
<span id="cb236-6"><a href="#cb236-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Goodness-of-fit test for poisson distribution

                           X^2 df            P(&gt; X^2)
Likelihood Ratio 33.0122916717  5 0.00000374234139957</code></pre>
</div>
</div>
<p>If the p-values is smaller than .05, then data is not Poisson distributed which means that it differs significantly from a Poisson distribution and is very likely over-dispersed. We will check the divergence from a Poisson distribution visually by plotting the observed counts against the expected counts if the data were Poisson distributed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gf,<span class="at">main=</span><span class="st">"Count data vs Poisson distribution"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/pr5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Although the goodfit function reported that the data differs significantly from the Poisson distribution, the fit is rather good. We can use an additional Levene’s test to check if variance homogeneity is given.</p>
<div class="warning" style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
<b>NOTE</b><br><br>The use of Levene’s test to check if the model is heteroscedastic is generally not recommended as it is too lax when dealing with few observations (because in such cases it does not have the power to identify heteroscedasticity) while it is too harsh when dealing with many observations (when heteroscedasticity typically is not a severe problem).
</p>
<p style="margin-left:1em;">
</p>
<p></p>
</span></div>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check homogeneity</span></span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(poissondata<span class="sc">$</span>Pauses, poissondata<span class="sc">$</span>Language, <span class="at">center =</span> mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = mean)
       Df  F value        Pr(&gt;F)    
group   2 17.15274 0.00000013571 ***
      197                           
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>The Levene’s test indicates that variance homogeneity is also violated. Since both the approximation to a Poisson distribution and variance homogeneity are violated, we should switch either to a quasi-Poisson model or a negative binomial model. However, as we are only interested in how to implement a Poisson model here, we continue despite the fact that this could not be recommended if we were actually interested in accurate results based on a reliable model.</p>
<p>In a next step, we summarize Progression by inspecting the means and standard deviations of the individual variable levels.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract mean and standard deviation</span></span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(poissondata, <span class="fu">tapply</span>(Pauses, Language, <span class="cf">function</span>(x) {</span>
<span id="cb241-3"><a href="#cb241-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sprintf</span>(<span class="st">"M (SD) = %1.2f (%1.2f)"</span>, <span class="fu">mean</span>(x), <span class="fu">sd</span>(x))</span>
<span id="cb241-4"><a href="#cb241-4" aria-hidden="true" tabindex="-1"></a>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               English                 German                Russian 
"M (SD) = 1.00 (1.28)" "M (SD) = 0.24 (0.52)" "M (SD) = 0.20 (0.40)" </code></pre>
</div>
</div>
<p>Now, we visualize the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot data</span></span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(poissondata, <span class="fu">aes</span>(Pauses, <span class="at">fill =</span> Language)) <span class="sc">+</span></span>
<span id="cb243-3"><a href="#cb243-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span>.<span class="dv">5</span>, <span class="at">position=</span><span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb243-4"><a href="#cb243-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"gray30"</span>, <span class="st">"gray50"</span>, <span class="st">"gray70"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/pr8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate Poisson regression</span></span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a>m1.poisson <span class="ot">&lt;-</span> <span class="fu">glm</span>(Pauses <span class="sc">~</span> Language <span class="sc">+</span> Alcohol, <span class="at">family=</span><span class="st">"poisson"</span>, <span class="at">data=</span>poissondata)</span>
<span id="cb244-3"><a href="#cb244-3" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect model</span></span>
<span id="cb244-4"><a href="#cb244-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1.poisson)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Pauses ~ Language + Alcohol, family = "poisson", 
    data = poissondata)

Coefficients:
                     Estimate    Std. Error  z value         Pr(&gt;|z|)    
(Intercept)     -4.1632652529  0.6628774832 -6.28060 0.00000000033728 ***
LanguageGerman  -0.7140499158  0.3200148750 -2.23130         0.025661 *  
LanguageRussian -1.0838591456  0.3582529824 -3.02540         0.002483 ** 
Alcohol          0.0701523975  0.0105992050  6.61865 0.00000000003625 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 287.6722345  on 199  degrees of freedom
Residual deviance: 189.4496199  on 196  degrees of freedom
AIC: 373.5045031

Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
<p>In addition to the Estimates for the coefficients, we could also calculate the confidence intervals for the coefficients (LL stands for lower limit and UL for upper limit in the table below).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate model</span></span>
<span id="cb246-2"><a href="#cb246-2" aria-hidden="true" tabindex="-1"></a>cov.m1 <span class="ot">&lt;-</span> sandwich<span class="sc">::</span><span class="fu">vcovHC</span>(m1.poisson, <span class="at">type=</span><span class="st">"HC0"</span>)</span>
<span id="cb246-3"><a href="#cb246-3" aria-hidden="true" tabindex="-1"></a><span class="co"># extract standard error</span></span>
<span id="cb246-4"><a href="#cb246-4" aria-hidden="true" tabindex="-1"></a>std.err <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(cov.m1))</span>
<span id="cb246-5"><a href="#cb246-5" aria-hidden="true" tabindex="-1"></a><span class="co"># extract robust estimates</span></span>
<span id="cb246-6"><a href="#cb246-6" aria-hidden="true" tabindex="-1"></a>r.est <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">Estimate=</span> <span class="fu">coef</span>(m1.poisson), </span>
<span id="cb246-7"><a href="#cb246-7" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Robust SE"</span> <span class="ot">=</span> std.err,</span>
<span id="cb246-8"><a href="#cb246-8" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Pr(&gt;|z|)"</span> <span class="ot">=</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(<span class="fu">coef</span>(m1.poisson)<span class="sc">/</span>std.err),</span>
<span id="cb246-9"><a href="#cb246-9" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">lower.tail=</span><span class="cn">FALSE</span>),</span>
<span id="cb246-10"><a href="#cb246-10" aria-hidden="true" tabindex="-1"></a><span class="at">LL =</span> <span class="fu">coef</span>(m1.poisson) <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> std.err,</span>
<span id="cb246-11"><a href="#cb246-11" aria-hidden="true" tabindex="-1"></a><span class="at">UL =</span> <span class="fu">coef</span>(m1.poisson) <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> std.err)</span>
<span id="cb246-12"><a href="#cb246-12" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect data</span></span>
<span id="cb246-13"><a href="#cb246-13" aria-hidden="true" tabindex="-1"></a>r.est</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        Estimate       Robust SE                 Pr(&gt;|z|)
(Intercept)     -4.1632652529178 0.6480942940026 0.0000000001328637743948
LanguageGerman  -0.7140499157783 0.2986422497410 0.0168031204011183932234
LanguageRussian -1.0838591456208 0.3210481575684 0.0007354744824167306532
Alcohol          0.0701523974937 0.0104351647012 0.0000000000178397516955
                              LL               UL
(Intercept)     -5.4335300691629 -2.8930004366727
LanguageGerman  -1.2993887252708 -0.1287111062859
LanguageRussian -1.7131135344549 -0.4546047567867
Alcohol          0.0496994746793  0.0906053203082</code></pre>
</div>
</div>
<p>We can now calculate the p-value of the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(m1.poisson, <span class="fu">cbind</span>(<span class="at">res.deviance =</span> deviance, <span class="at">df =</span> df.residual,</span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">p =</span> <span class="fu">pchisq</span>(deviance, df.residual, <span class="at">lower.tail=</span><span class="cn">FALSE</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     res.deviance  df              p
[1,] 189.44961991 196 0.618227445717</code></pre>
</div>
</div>
<p>Now, we check, if removing Language leads to a significant decrease in model fit.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove Language from the model</span></span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a>m2.poisson <span class="ot">&lt;-</span> <span class="fu">update</span>(m1.poisson, . <span class="sc">~</span> . <span class="sc">-</span>Language)</span>
<span id="cb250-3"><a href="#cb250-3" aria-hidden="true" tabindex="-1"></a><span class="co"># check if dropping Language causes a significant decrease in model fit</span></span>
<span id="cb250-4"><a href="#cb250-4" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m2.poisson, m1.poisson, <span class="at">test=</span><span class="st">"Chisq"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: Pauses ~ Alcohol
Model 2: Pauses ~ Language + Alcohol
  Resid. Df  Resid. Dev Df   Deviance   Pr(&gt;Chi)    
1       198 204.0213018                             
2       196 189.4496199  2 14.5716819 0.00068517 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>We now calculate robust coefficients using the <code>msm</code> package <span class="citation" data-cites="msm">(<a href="#ref-msm" role="doc-biblioref">Jackson 2011</a>)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get estimates</span></span>
<span id="cb252-2"><a href="#cb252-2" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> msm<span class="sc">::</span><span class="fu">deltamethod</span>(<span class="fu">list</span>(<span class="sc">~</span> <span class="fu">exp</span>(x1), <span class="sc">~</span> <span class="fu">exp</span>(x2), <span class="sc">~</span> <span class="fu">exp</span>(x3), <span class="sc">~</span> <span class="fu">exp</span>(x4)), </span>
<span id="cb252-3"><a href="#cb252-3" aria-hidden="true" tabindex="-1"></a>                                                <span class="fu">coef</span>(m1.poisson), cov.m1)</span>
<span id="cb252-4"><a href="#cb252-4" aria-hidden="true" tabindex="-1"></a><span class="co"># exponentiate old estimates dropping the p values</span></span>
<span id="cb252-5"><a href="#cb252-5" aria-hidden="true" tabindex="-1"></a>rexp.est <span class="ot">&lt;-</span> <span class="fu">exp</span>(r.est[, <span class="sc">-</span><span class="dv">3</span>])</span>
<span id="cb252-6"><a href="#cb252-6" aria-hidden="true" tabindex="-1"></a><span class="co"># replace SEs with estimates for exponentiated coefficients</span></span>
<span id="cb252-7"><a href="#cb252-7" aria-hidden="true" tabindex="-1"></a>rexp.est[, <span class="st">"Robust SE"</span>] <span class="ot">&lt;-</span> s</span>
<span id="cb252-8"><a href="#cb252-8" aria-hidden="true" tabindex="-1"></a><span class="co"># display results</span></span>
<span id="cb252-9"><a href="#cb252-9" aria-hidden="true" tabindex="-1"></a>rexp.est</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       Estimate       Robust SE               LL
(Intercept)     0.0155566784084 0.0100821945101 0.00436765044896
LanguageGerman  0.4896571063601 0.1462322998451 0.27269843575906
LanguageRussian 0.3382875026084 0.1086065794408 0.18030353649622
Alcohol         1.0726716412682 0.0111935052470 1.05095521026088
                             UL
(Intercept)     0.0554097096208
LanguageGerman  0.8792279322820
LanguageRussian 0.6346987787641
Alcohol         1.0948368101199</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract predicted values</span></span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a>(s1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Alcohol =</span> <span class="fu">mean</span>(poissondata<span class="sc">$</span>Alcohol),</span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Language =</span> <span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">labels =</span> <span class="fu">names</span>(<span class="fu">table</span>(poissondata<span class="sc">$</span>Language)))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Alcohol Language
1  52.645  English
2  52.645   German
3  52.645  Russian</code></pre>
</div>
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show results</span></span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(m1.poisson, s1, <span class="at">type=</span><span class="st">"response"</span>, <span class="at">se.fit=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$fit
             1              2              3 
0.624944591447 0.306008560283 0.211410945109 

$se.fit
              1               2               3 
0.0862811728183 0.0883370633684 0.0705010813453 

$residual.scale
[1] 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="do">## calculate and store predicted values</span></span>
<span id="cb258-2"><a href="#cb258-2" aria-hidden="true" tabindex="-1"></a>poissondata<span class="sc">$</span>Predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(m1.poisson, <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb258-3"><a href="#cb258-3" aria-hidden="true" tabindex="-1"></a><span class="do">## order by program and then by math</span></span>
<span id="cb258-4"><a href="#cb258-4" aria-hidden="true" tabindex="-1"></a>poissondata <span class="ot">&lt;-</span> poissondata[<span class="fu">with</span>(poissondata, <span class="fu">order</span>(Language, Alcohol)), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb259"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="do">## create the plot</span></span>
<span id="cb259-2"><a href="#cb259-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(poissondata, <span class="fu">aes</span>(<span class="at">x =</span> Alcohol, <span class="at">y =</span> Predicted, <span class="at">colour =</span> Language)) <span class="sc">+</span></span>
<span id="cb259-3"><a href="#cb259-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Pauses), <span class="at">alpha=</span>.<span class="dv">5</span>, </span>
<span id="cb259-4"><a href="#cb259-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">position=</span><span class="fu">position_jitter</span>(<span class="at">h=</span>.<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb259-5"><a href="#cb259-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb259-6"><a href="#cb259-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Alcohol (ml)"</span>, <span class="at">y =</span> <span class="st">"Expected number of pauses"</span>) <span class="sc">+</span></span>
<span id="cb259-7"><a href="#cb259-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"gray30"</span>, <span class="st">"gray50"</span>, <span class="st">"gray70"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/pr16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="robust-regression" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="robust-regression">Robust Regression</h2>
<p>Robust regression represent an alternative to simple linear models which can handle overly influential data points (outliers). Robust regressions allow us to retain outliers in the data rather than having to remove them from the data by adding weights <span class="citation" data-cites="rousseeuw2005robust">(<a href="#ref-rousseeuw2005robust" role="doc-biblioref">Rousseeuw and Leroy</a>)</span>. Thus, robust regressions are used when there are outliers present in the data and we can thus not use traditional models but we have no good argument to remove these data points.</p>
<div class="warning" style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
<b>NOTE</b><br><br>Robust regressions allow us to handle overly influential data points (outliers) by using weights. Thus, robust regressions enable us to retain all data points.
</p>
<p style="margin-left:1em;">
</p>
<p></p>
</span></div>
<p><br></p>
<p>We begin by loading a data set (the mlrdata set which have used for multiple linear regression).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb260"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a>robustdata  <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="st">"tutorials/regression/data/mld.rda"</span>, <span class="st">"rb"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-98aba24c{table-layout:auto;width:75%;}.cl-98a5dda8{font-family:'DejaVu Sans';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-98a5ddbc{font-family:'DejaVu Sans';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-98a84e26{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-98a84e30{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-98a8665e{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-98a86668{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-98a86669{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-98a86672{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-98a86673{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-98a86674{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-98a8667c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-98a86686{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-98a86687{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-98a86688{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-98a86690{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-98a86691{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-98aba24c"><thead><tr style="overflow-wrap:break-word;"><th class="cl-98a8665e"><p class="cl-98a84e26"><span class="cl-98a5dda8">status</span></p></th><th class="cl-98a86668"><p class="cl-98a84e26"><span class="cl-98a5dda8">attraction</span></p></th><th class="cl-98a86669"><p class="cl-98a84e30"><span class="cl-98a5dda8">money</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-98a86672"><p class="cl-98a84e26"><span class="cl-98a5ddbc">Relationship</span></p></td><td class="cl-98a86673"><p class="cl-98a84e26"><span class="cl-98a5ddbc">NotInterested</span></p></td><td class="cl-98a86674"><p class="cl-98a84e30"><span class="cl-98a5ddbc">86.33</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-98a8667c"><p class="cl-98a84e26"><span class="cl-98a5ddbc">Relationship</span></p></td><td class="cl-98a86686"><p class="cl-98a84e26"><span class="cl-98a5ddbc">NotInterested</span></p></td><td class="cl-98a86687"><p class="cl-98a84e30"><span class="cl-98a5ddbc">45.58</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-98a86672"><p class="cl-98a84e26"><span class="cl-98a5ddbc">Relationship</span></p></td><td class="cl-98a86673"><p class="cl-98a84e26"><span class="cl-98a5ddbc">NotInterested</span></p></td><td class="cl-98a86674"><p class="cl-98a84e30"><span class="cl-98a5ddbc">68.43</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-98a8667c"><p class="cl-98a84e26"><span class="cl-98a5ddbc">Relationship</span></p></td><td class="cl-98a86686"><p class="cl-98a84e26"><span class="cl-98a5ddbc">NotInterested</span></p></td><td class="cl-98a86687"><p class="cl-98a84e30"><span class="cl-98a5ddbc">52.93</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-98a86672"><p class="cl-98a84e26"><span class="cl-98a5ddbc">Relationship</span></p></td><td class="cl-98a86673"><p class="cl-98a84e26"><span class="cl-98a5ddbc">NotInterested</span></p></td><td class="cl-98a86674"><p class="cl-98a84e30"><span class="cl-98a5ddbc">61.86</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-98a8667c"><p class="cl-98a84e26"><span class="cl-98a5ddbc">Relationship</span></p></td><td class="cl-98a86686"><p class="cl-98a84e26"><span class="cl-98a5ddbc">NotInterested</span></p></td><td class="cl-98a86687"><p class="cl-98a84e30"><span class="cl-98a5ddbc">48.47</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-98a86672"><p class="cl-98a84e26"><span class="cl-98a5ddbc">Relationship</span></p></td><td class="cl-98a86673"><p class="cl-98a84e26"><span class="cl-98a5ddbc">NotInterested</span></p></td><td class="cl-98a86674"><p class="cl-98a84e30"><span class="cl-98a5ddbc">32.79</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-98a8667c"><p class="cl-98a84e26"><span class="cl-98a5ddbc">Relationship</span></p></td><td class="cl-98a86686"><p class="cl-98a84e26"><span class="cl-98a5ddbc">NotInterested</span></p></td><td class="cl-98a86687"><p class="cl-98a84e30"><span class="cl-98a5ddbc">35.91</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-98a86672"><p class="cl-98a84e26"><span class="cl-98a5ddbc">Relationship</span></p></td><td class="cl-98a86673"><p class="cl-98a84e26"><span class="cl-98a5ddbc">NotInterested</span></p></td><td class="cl-98a86674"><p class="cl-98a84e30"><span class="cl-98a5ddbc">30.98</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-98a8667c"><p class="cl-98a84e26"><span class="cl-98a5ddbc">Relationship</span></p></td><td class="cl-98a86686"><p class="cl-98a84e26"><span class="cl-98a5ddbc">NotInterested</span></p></td><td class="cl-98a86687"><p class="cl-98a84e30"><span class="cl-98a5ddbc">44.82</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-98a86672"><p class="cl-98a84e26"><span class="cl-98a5ddbc">Relationship</span></p></td><td class="cl-98a86673"><p class="cl-98a84e26"><span class="cl-98a5ddbc">NotInterested</span></p></td><td class="cl-98a86674"><p class="cl-98a84e30"><span class="cl-98a5ddbc">35.05</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-98a8667c"><p class="cl-98a84e26"><span class="cl-98a5ddbc">Relationship</span></p></td><td class="cl-98a86686"><p class="cl-98a84e26"><span class="cl-98a5ddbc">NotInterested</span></p></td><td class="cl-98a86687"><p class="cl-98a84e30"><span class="cl-98a5ddbc">64.49</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-98a86672"><p class="cl-98a84e26"><span class="cl-98a5ddbc">Relationship</span></p></td><td class="cl-98a86673"><p class="cl-98a84e26"><span class="cl-98a5ddbc">NotInterested</span></p></td><td class="cl-98a86674"><p class="cl-98a84e30"><span class="cl-98a5ddbc">54.50</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-98a8667c"><p class="cl-98a84e26"><span class="cl-98a5ddbc">Relationship</span></p></td><td class="cl-98a86686"><p class="cl-98a84e26"><span class="cl-98a5ddbc">NotInterested</span></p></td><td class="cl-98a86687"><p class="cl-98a84e30"><span class="cl-98a5ddbc">61.48</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-98a86688"><p class="cl-98a84e26"><span class="cl-98a5ddbc">Relationship</span></p></td><td class="cl-98a86690"><p class="cl-98a84e26"><span class="cl-98a5ddbc">NotInterested</span></p></td><td class="cl-98a86691"><p class="cl-98a84e30"><span class="cl-98a5ddbc">55.51</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>We first fit an ordinary linear model (and although we know from the section on multiple regression that the interaction between status and attraction is significant, we will disregard this for now as this will help to explain the weighing procedure which is the focus of this section).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create model</span></span>
<span id="cb261-2"><a href="#cb261-2" aria-hidden="true" tabindex="-1"></a>slm <span class="ot">&lt;-</span> <span class="fu">lm</span>(money <span class="sc">~</span> status<span class="sc">+</span>attraction, <span class="at">data =</span> robustdata)</span>
<span id="cb261-3"><a href="#cb261-3" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect model</span></span>
<span id="cb261-4"><a href="#cb261-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(slm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = money ~ status + attraction, data = robustdata)

Residuals:
      Min        1Q    Median        3Q       Max 
-60.87070 -15.78645  -2.61010  13.88770  59.93710 

Coefficients:
                            Estimate   Std. Error   t value
(Intercept)             114.94950000   4.28993616  26.79515
statusSingle             26.10340000   4.95359160   5.26959
attractionNotInterested -79.25220000   4.95359160 -15.99894
                                      Pr(&gt;|t|)    
(Intercept)             &lt; 0.000000000000000222 ***
statusSingle                     0.00000082576 ***
attractionNotInterested &lt; 0.000000000000000222 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 24.767958 on 97 degrees of freedom
Multiple R-squared:  0.745229335,   Adjusted R-squared:  0.739976331 
F-statistic: 141.867286 on 2 and 97 DF,  p-value: &lt; 0.0000000000000002220446</code></pre>
</div>
</div>
<p>We now check whether the model is well fitted using diagnostic plots.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate plots</span></span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(slm) <span class="sc">+</span> </span>
<span id="cb263-3"><a href="#cb263-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/rr4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The diagnostic plots indicate that there are three outliers in the data (data points 52, 83 and possibly 64). Therefore, we need to evaluate if the outliers severely affect the fit of the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb264"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a>robustdata[<span class="fu">c</span>(<span class="dv">52</span>, <span class="dv">64</span>, <span class="dv">83</span>),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   status    attraction  money
52 Single NotInterested   0.93
64 Single NotInterested  84.28
83 Single    Interested 200.99</code></pre>
</div>
</div>
<p>We can now calculate Cook’s distance and standardized residuals check if the values of the potentially problematic points have unacceptably high values (-2 &lt; ok &lt; 2).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb266"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a>CooksDistance <span class="ot">&lt;-</span> <span class="fu">cooks.distance</span>(slm)</span>
<span id="cb266-2"><a href="#cb266-2" aria-hidden="true" tabindex="-1"></a>StandardizedResiduals <span class="ot">&lt;-</span> <span class="fu">stdres</span>(slm)</span>
<span id="cb266-3"><a href="#cb266-3" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">cbind</span>(robustdata, CooksDistance, StandardizedResiduals)</span>
<span id="cb266-4"><a href="#cb266-4" aria-hidden="true" tabindex="-1"></a>a[CooksDistance <span class="sc">&gt;</span> <span class="dv">4</span><span class="sc">/</span><span class="dv">100</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         status    attraction  money   CooksDistance StandardizedResiduals
1  Relationship NotInterested  86.33 0.0444158829857         2.07565427025
52       Single NotInterested   0.93 0.0641937458854        -2.49535435377
65       Single NotInterested  12.12 0.0427613629698        -2.03662765573
67       Single NotInterested  13.28 0.0407877963315        -1.98907421786
83       Single    Interested 200.99 0.0622397126545         2.45708203516
84       Single    Interested 193.69 0.0480020776213         2.15782333134
88       Single    Interested 193.78 0.0481663678409         2.16151282221</code></pre>
</div>
</div>
<p>We will calculate the absolute value and reorder the table so that it is easier to check the values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb268"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a>AbsoluteStandardizedResiduals <span class="ot">&lt;-</span> <span class="fu">abs</span>(StandardizedResiduals)</span>
<span id="cb268-2"><a href="#cb268-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">cbind</span>(robustdata, CooksDistance, StandardizedResiduals, AbsoluteStandardizedResiduals)</span>
<span id="cb268-3"><a href="#cb268-3" aria-hidden="true" tabindex="-1"></a>asorted <span class="ot">&lt;-</span> a[<span class="fu">order</span>(<span class="sc">-</span>AbsoluteStandardizedResiduals), ]</span>
<span id="cb268-4"><a href="#cb268-4" aria-hidden="true" tabindex="-1"></a>asorted[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         status    attraction  money   CooksDistance StandardizedResiduals
52       Single NotInterested   0.93 0.0641937458854        -2.49535435377
83       Single    Interested 200.99 0.0622397126545         2.45708203516
88       Single    Interested 193.78 0.0481663678409         2.16151282221
84       Single    Interested 193.69 0.0480020776213         2.15782333134
1  Relationship NotInterested  86.33 0.0444158829857         2.07565427025
65       Single NotInterested  12.12 0.0427613629698        -2.03662765573
67       Single NotInterested  13.28 0.0407877963315        -1.98907421786
78       Single    Interested 188.76 0.0394313968241         1.95572122040
21 Relationship NotInterested  81.90 0.0369837409025         1.89404933081
24 Relationship NotInterested  81.56 0.0364414260634         1.88011125419
   AbsoluteStandardizedResiduals
52                 2.49535435377
83                 2.45708203516
88                 2.16151282221
84                 2.15782333134
1                  2.07565427025
65                 2.03662765573
67                 1.98907421786
78                 1.95572122040
21                 1.89404933081
24                 1.88011125419</code></pre>
</div>
</div>
<p>As Cook’s distance and the standardized residuals do have unacceptable values, we re-calculate the linear model as a robust regression and inspect the results</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb270"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create robust regression model</span></span>
<span id="cb270-2"><a href="#cb270-2" aria-hidden="true" tabindex="-1"></a>rmodel <span class="ot">&lt;-</span> robustbase<span class="sc">::</span><span class="fu">lmrob</span>(money <span class="sc">~</span> status <span class="sc">+</span> attraction, <span class="at">data =</span> robustdata)</span>
<span id="cb270-3"><a href="#cb270-3" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect model</span></span>
<span id="cb270-4"><a href="#cb270-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
robustbase::lmrob(formula = money ~ status + attraction, data = robustdata)
 \--&gt; method = "MM"
Residuals:
         Min           1Q       Median           3Q          Max 
-61.14269796 -15.20405781  -1.48712081  14.43502508  62.42342804 

Coefficients:
                            Estimate   Std. Error   t value
(Intercept)             113.18405781   3.89777692  29.03811
statusSingle             25.38251415   5.08841106   4.98830
attractionNotInterested -76.49387400   5.06626449 -15.09867
                                      Pr(&gt;|t|)    
(Intercept)             &lt; 0.000000000000000222 ***
statusSingle                      0.0000026725 ***
attractionNotInterested &lt; 0.000000000000000222 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Robust residual standard error: 22.3497532 
Multiple R-squared:  0.740716949,   Adjusted R-squared:  0.735370907 
Convergence in 11 IRWLS iterations

Robustness weights: 
 10 weights are ~= 1. The remaining 90 ones are summarized as
       Min.     1st Qu.      Median        Mean     3rd Qu.        Max. 
0.415507215 0.856134403 0.947485769 0.889078657 0.986192099 0.998890516 
Algorithmic parameters: 
           tuning.chi                    bb            tuning.psi 
1.5476399999999999046 0.5000000000000000000 4.6850610000000001421 
           refine.tol               rel.tol             scale.tol 
0.0000001000000000000 0.0000001000000000000 0.0000000001000000000 
            solve.tol              zero.tol           eps.outlier 
0.0000001000000000000 0.0000000001000000000 0.0010000000000000000 
                eps.x     warn.limit.reject     warn.limit.meanrw 
0.0000000000018189894 0.5000000000000000000 0.5000000000000000000 
     nResample         max.it       best.r.s       k.fast.s          k.max 
           500             50              2              1            200 
   maxit.scale      trace.lev            mts     compute.rd fast.s.large.n 
           200              0           1000              0           2000 
                  psi           subsampling                   cov 
           "bisquare"         "nonsingular"         ".vcov.avar1" 
compute.outlier.stats 
                 "SM" 
seed : int(0) </code></pre>
</div>
</div>
<p>The output shows that both status and attraction are significant but, as we have seen above, the effect that really matters is the interaction between status and attraction.</p>
<p>We will briefly check the weights to understand the process of weighing better. The idea of weighing is to downgrade data points that are too influential while not punishing data points that have a good fit and are thus less influential. This means that the problematic data points should have lower weights than other data points (the maximum is 1 - so points can only be made “lighter”).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb272"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a>hweights <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">status =</span> robustdata<span class="sc">$</span>status, <span class="at">resid =</span> rmodel<span class="sc">$</span>resid, <span class="at">weight =</span> rmodel<span class="sc">$</span>rweights)</span>
<span id="cb272-2"><a href="#cb272-2" aria-hidden="true" tabindex="-1"></a>hweights2 <span class="ot">&lt;-</span> hweights[<span class="fu">order</span>(rmodel<span class="sc">$</span>rweights), ]</span>
<span id="cb272-3"><a href="#cb272-3" aria-hidden="true" tabindex="-1"></a>hweights2[<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         status          resid         weight
83       Single  62.4234280426 0.415507214894
52       Single -61.1426979566 0.434323578289
88       Single  55.2134280426 0.521220526760
84       Single  55.1234280426 0.522529106622
78       Single  50.1934280426 0.593234343069
65       Single -49.9526979566 0.596626306571
1  Relationship  49.6398161925 0.601024865582
67       Single -48.7926979566 0.612874578464
21 Relationship  45.2098161925 0.661914499988
24 Relationship  44.8698161925 0.666467581490
39 Relationship -43.8940578083 0.679427975993
79       Single  40.8234280426 0.719104361372
58       Single -40.5226979566 0.722893449575
89       Single  39.9734280426 0.729766992775
95       Single  39.8234280426 0.731633375015</code></pre>
</div>
</div>
<p>The values of the weights support our assumption that those data points that were deemed too influential are made <em>lighter</em> as they now only have weights of 0.4155072 and 0.4343236 respectively. This was, however, not the focus of this sections as this section merely served to introduce the concept of weights and how they can be used in the context of a robust linear regression.</p>
</section>
<section id="mixed-effects-regression" class="level1">
<h1>Mixed-Effects Regression</h1>
<p>In contrast to fixed-effects regression models, mixed-effects models assume a hierarchical data structure in which data points are grouped or nested in higher order categories (e.g.&nbsp;students within classes). Mixed-effects models are rapidly increasing in use in data analysis because they allow us to incorporate hierarchical or nested data structures. Mixed-effects models are, of course, an extension of fixed-effects regression models and also multivariate and come in different types.</p>
<p>In the following, we will go over the most relevant and frequently used types of mixed-effect regression models, mixed-effects linear regression models and mixed-effects binomial logistic regression models.</p>
<p>The major difference between these types of models is that they take different types of dependent variables. While linear models take numeric dependent variables, logistic models take nominal variables.</p>
<section id="linear-mixed-effects-regression" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="linear-mixed-effects-regression">Linear Mixed-Effects Regression</h2>
<p>The following focuses on an extension of ordinary multiple linear regressions: mixed-effects regression linear regression. Mixed-effects models have the following advantages over simpler statistical tests:</p>
<ul>
<li><p>Mixed-effects models are multivariate, i.e.&nbsp;they test the effect of several predictors simultaneously while controlling for the effect of all other predictors.</p></li>
<li><p>Mixed models allow to statistically incorporate within-speaker variability and are thus fit to model hierarchical or nested data structures. This applies if several observations are produced by an individual speaker, for instance.</p></li>
<li><p>Mixed-models provide a wealth of diagnostic statistics which enables us to control e.g.&nbsp;(multi-)collinearity, i.e.&nbsp;correlations between predictors, and to test whether conditions or requirements are violated (e.g.&nbsp;homogeneity of variance, etc.).</p></li>
</ul>
<p>Major disadvantages of mixed-effects regression modeling are that they are prone to producing high <span class="math inline">\(\beta\)</span>-errors <span class="citation" data-cites="johnson2009getting">(see <a href="#ref-johnson2009getting" role="doc-biblioref">Johnson</a>)</span> and that they require rather large data sets.</p>
<section id="introduction-1" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="introduction-1">Introduction</h3>
<p>So far, the regression models that we have used only had fixed-effects. Having only fixed-effects means that all data points are treated as if they are completely independent and thus on the same hierarchical level. However, it is very common that the data is nested in the sense that data points are not independent because they are, for instance produced by the same speaker or are grouped by some other characteristic. In such cases, the data is considered hierarchical and statistical models should incorporate such structural features of the data they work upon. Fortunately, modeling hierarchical or nested data structures is very easy thanks to the <code>lme4</code> package <span class="citation" data-cites="lme4">(<a href="#ref-lme4" role="doc-biblioref">Bates et al. 2015</a>)</span>.</p>
<p>With respect to regression modeling, hierarchical structures are incorporated by what is called <em>random effects</em>. When models only have a fixed-effects structure, then they make use of only a single intercept and/or slope (as in the left panel in the figure below), while mixed effects models have intercepts for each level of a random effect. If the random effect structure represents speakers then this would mean that a mixed-model would have a separate intercept and/or slope for each speaker (in addition to the overall intercept that is shown as an orange line in the figure below).</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/lmm1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The idea behind regression analysis is expressed formally in the equation below where<span class="math inline">\(f_{(x)}\)</span> is the y-value we want to predict, <span class="math inline">\(\alpha\)</span> is the intercept (the point where the regression line crosses the y-axis at x = 0), <span class="math inline">\(\beta\)</span> is the coefficient (the slope of the regression line), and x is the value of a predictor (e.g.&nbsp;180cm - if we would like to predict the weight of a person based on their height). The <span class="math inline">\(\epsilon\)</span> is an error term that reflects the difference between the predicted value and the (actually) observed value (<span class="math inline">\(\epsilon\)</span> is thus a residual that is important as regressions assume that residuals are, e.g., normally distributed).</p>
<p><span class="math display">\[\begin{equation}
f_{(x)} = \alpha + \beta x + \epsilon
\end{equation}\]</span></p>
<p>In other words, to estimate how much some weights who is 180cm tall, we would multiply the coefficient (slope of the line) with 180 (<span class="math inline">\(x\)</span>) and add the value of the intercept (point where line crosses the y-axis at x = 0).</p>
<p>The equation below represents a formal representation of a mixed-effects regression with varying intercepts <span class="citation" data-cites="winter2019statistics">(see <a href="#ref-winter2019statistics" role="doc-biblioref">Winter, 235</a>)</span>.</p>
<p><span class="math display">\[\begin{equation}
f_{(x)} = \alpha_{i} + \beta x + \epsilon
\end{equation}\]</span></p>
<p>In this random intercept model, each level of a random variable has a different intercept. To predict the value of a data point, we would thus take the appropriate intercept value (the model intercept + the intercept of the random effect) and add the product of the predictor coefficient and the value of x.</p>
<p>Finally, the equation below represents a formal representation of a mixed-effects regression with varying intercepts and varying slopes <span class="citation" data-cites="winter2019statistics">(see <a href="#ref-winter2019statistics" role="doc-biblioref">Winter, 235</a>)</span>.</p>
<p><span class="math display">\[\begin{equation}
f_{(x)} = \alpha_{i} + \beta_{i}x + \epsilon
\end{equation}\]</span></p>
<p>In this last model, each level of a random variable has a different intercept and a different slope. To predict the value of a data point, we would thus take the appropriate intercept value (the model intercept + the intercept of the random effect) and add the coefficient of that random effect level multiplied by the value of x.</p>
</section>
<section id="random-effects" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="random-effects">Random Effects</h3>
<p><em>Random Effects</em> can be visualized using two parameters: the intercept (the point where the regression line crosses the y-axis at x = 0) and the slope (the acclivity of the regression line). In contrast to fixed-effects models, that have only 1 intercept and one slope (left panel in the figure above), mixed-effects models can therefore have various <em>random intercepts</em> (center panel) or various <em>random slopes</em>, or both, various <em>random intercepts</em> and various <em>random slopes</em> (right panel).</p>
<p>What features do distinguish random and fixed effects?</p>
<ol type="1">
<li><p>Random effects represent a higher level variable under which data points are grouped. This implies that random effects must be categorical (or nominal but <em>they a´cannot be continuous</em>!) <span class="citation" data-cites="winter2019statistics">(see <a href="#ref-winter2019statistics" role="doc-biblioref">Winter, 236</a>)</span>.</p></li>
<li><p>Random effects represent a sample of an infinite number of possible levels. For instance, speakers, trials, items, subjects, or words represent a potentially infinite pool of elements from which many different samples can be drawn. Thus, random effects represent a random sample sample. Fixed effects, on the other hand, typically do not represent a random sample but a fixed set of variable levels (e.g.&nbsp;Age groups, or parts-of-speech).</p></li>
<li><p>Random effects typically represent many different levels while fixed effects typically have only a few. <span class="citation" data-cites="zuur2013beginner">Zuur, Hilbe, and Ieno</span> propose that a variable may be used as a fixed effect if it has less than 5 levels while it should be treated as a random effect if it has more than 10 levels. Variables with 5 to 10 levels can be used as both. However, this is a rule of thumb and ignores the theoretical reasons (random sample and nestedness) for considering something as a random effect and it also is at odds with the way that repeated measures are models (namely as mixed effects) although they typically only have very few levels.</p></li>
<li><p>Fixed effects represent an effect that if we draw many samples, the effect would be consistent across samples <span class="citation" data-cites="winter2019statistics">(<a href="#ref-winter2019statistics" role="doc-biblioref">Winter</a>)</span> while random effects should vary for each new sample that is drawn.</p></li>
</ol>
<p>In the following, we will only focus on models with random intercepts because this is the more common method and because including both random intercepts and random slopes requires larger data sets (but have a better fit because intercepts are not forced to be parallel and the lines therefore have a better fit). You should, however, always think about what random effects structure is appropriate for your model - a very recommendable explanation of how to chose which random effects structure is best (and about what the determining factors for this decision are) is give in <span class="citation" data-cites="winter2019statistics">Winter (<a href="#ref-winter2019statistics" role="doc-biblioref">241–44</a>)</span>. Also, consider the center and the right plots above to understand what is meant by <em>random intercepts</em> and <em>random slopes</em>.</p>
<p>After adding random intercepts, predictors (or fixed effects) are added to the model (just like with multiple regression). So mixed-effects are called mixed-effects because they contain both random and fixed effects.</p>
<p>In terms of general procedure, random effects are added first, and only after we have ascertained that including random effects is warranted, we test whether including fixed-effects is warranted <span class="citation" data-cites="field2012discovering">(<a href="#ref-field2012discovering" role="doc-biblioref">Field, Miles, and Field</a>)</span>. We test whether including random effects is warranted by comparing a model, that bases its estimates of the depended variable solely on the base intercept (the mean), with a model, that bases its estimates of the dependent variable solely on the intercepts of the random effect. If the random-effect model explains significantly more variance than the simple model without random effect structure, then we continue with the mixed-effects model. In other words, including random effects is justified if they reduce residual deviance.</p>
</section>
<section id="example-preposition-use-across-time-by-genre" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="example-preposition-use-across-time-by-genre">Example: Preposition Use across Time by Genre</h3>
<p>To explore how to implement a mixed-effects model in R we revisit the preposition data that contains relative frequencies of prepositions in English texts written between 1150 and 1913. As a first step, and to prepare our analysis, we load necessary R packages, specify options, and load as well as provide an overview of the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb274"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true" tabindex="-1"></a>lmmdata  <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="st">"tutorials/regression/data/lmd.rda"</span>, <span class="st">"rb"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb274-3"><a href="#cb274-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># convert date into a numeric variable</span></span>
<span id="cb274-4"><a href="#cb274-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.numeric</span>(Date))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-99db3cea{table-layout:auto;width:75%;}.cl-99d5aa1e{font-family:'DejaVu Sans';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-99d5aa28{font-family:'DejaVu Sans';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-99d7e5a4{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-99d7e5ae{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-99d7fe0e{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-99d7fe18{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-99d7fe22{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-99d7fe23{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-99d7fe2c{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-99d7fe36{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-99d7fe37{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-99d7fe38{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-99d7fe40{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-99d7fe41{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-99d7fe4a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-99d7fe4b{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-99d7fe54{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-99d7fe5e{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-99d7fe5f{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-99d7fe60{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-99db3cea"><thead><tr style="overflow-wrap:break-word;"><th class="cl-99d7fe0e"><p class="cl-99d7e5a4"><span class="cl-99d5aa1e">Date</span></p></th><th class="cl-99d7fe18"><p class="cl-99d7e5ae"><span class="cl-99d5aa1e">Genre</span></p></th><th class="cl-99d7fe18"><p class="cl-99d7e5ae"><span class="cl-99d5aa1e">Text</span></p></th><th class="cl-99d7fe22"><p class="cl-99d7e5a4"><span class="cl-99d5aa1e">Prepositions</span></p></th><th class="cl-99d7fe23"><p class="cl-99d7e5ae"><span class="cl-99d5aa1e">Region</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-99d7fe2c"><p class="cl-99d7e5a4"><span class="cl-99d5aa28">1,736</span></p></td><td class="cl-99d7fe36"><p class="cl-99d7e5ae"><span class="cl-99d5aa28">Science</span></p></td><td class="cl-99d7fe36"><p class="cl-99d7e5ae"><span class="cl-99d5aa28">albin</span></p></td><td class="cl-99d7fe37"><p class="cl-99d7e5a4"><span class="cl-99d5aa28">166.01</span></p></td><td class="cl-99d7fe38"><p class="cl-99d7e5ae"><span class="cl-99d5aa28">North</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-99d7fe40"><p class="cl-99d7e5a4"><span class="cl-99d5aa28">1,711</span></p></td><td class="cl-99d7fe41"><p class="cl-99d7e5ae"><span class="cl-99d5aa28">Education</span></p></td><td class="cl-99d7fe41"><p class="cl-99d7e5ae"><span class="cl-99d5aa28">anon</span></p></td><td class="cl-99d7fe4a"><p class="cl-99d7e5a4"><span class="cl-99d5aa28">139.86</span></p></td><td class="cl-99d7fe4b"><p class="cl-99d7e5ae"><span class="cl-99d5aa28">North</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-99d7fe2c"><p class="cl-99d7e5a4"><span class="cl-99d5aa28">1,808</span></p></td><td class="cl-99d7fe36"><p class="cl-99d7e5ae"><span class="cl-99d5aa28">PrivateLetter</span></p></td><td class="cl-99d7fe36"><p class="cl-99d7e5ae"><span class="cl-99d5aa28">austen</span></p></td><td class="cl-99d7fe37"><p class="cl-99d7e5a4"><span class="cl-99d5aa28">130.78</span></p></td><td class="cl-99d7fe38"><p class="cl-99d7e5ae"><span class="cl-99d5aa28">North</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-99d7fe40"><p class="cl-99d7e5a4"><span class="cl-99d5aa28">1,878</span></p></td><td class="cl-99d7fe41"><p class="cl-99d7e5ae"><span class="cl-99d5aa28">Education</span></p></td><td class="cl-99d7fe41"><p class="cl-99d7e5ae"><span class="cl-99d5aa28">bain</span></p></td><td class="cl-99d7fe4a"><p class="cl-99d7e5a4"><span class="cl-99d5aa28">151.29</span></p></td><td class="cl-99d7fe4b"><p class="cl-99d7e5ae"><span class="cl-99d5aa28">North</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-99d7fe2c"><p class="cl-99d7e5a4"><span class="cl-99d5aa28">1,743</span></p></td><td class="cl-99d7fe36"><p class="cl-99d7e5ae"><span class="cl-99d5aa28">Education</span></p></td><td class="cl-99d7fe36"><p class="cl-99d7e5ae"><span class="cl-99d5aa28">barclay</span></p></td><td class="cl-99d7fe37"><p class="cl-99d7e5a4"><span class="cl-99d5aa28">145.72</span></p></td><td class="cl-99d7fe38"><p class="cl-99d7e5ae"><span class="cl-99d5aa28">North</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-99d7fe40"><p class="cl-99d7e5a4"><span class="cl-99d5aa28">1,908</span></p></td><td class="cl-99d7fe41"><p class="cl-99d7e5ae"><span class="cl-99d5aa28">Education</span></p></td><td class="cl-99d7fe41"><p class="cl-99d7e5ae"><span class="cl-99d5aa28">benson</span></p></td><td class="cl-99d7fe4a"><p class="cl-99d7e5a4"><span class="cl-99d5aa28">120.77</span></p></td><td class="cl-99d7fe4b"><p class="cl-99d7e5ae"><span class="cl-99d5aa28">North</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-99d7fe2c"><p class="cl-99d7e5a4"><span class="cl-99d5aa28">1,906</span></p></td><td class="cl-99d7fe36"><p class="cl-99d7e5ae"><span class="cl-99d5aa28">Diary</span></p></td><td class="cl-99d7fe36"><p class="cl-99d7e5ae"><span class="cl-99d5aa28">benson</span></p></td><td class="cl-99d7fe37"><p class="cl-99d7e5a4"><span class="cl-99d5aa28">119.17</span></p></td><td class="cl-99d7fe38"><p class="cl-99d7e5ae"><span class="cl-99d5aa28">North</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-99d7fe40"><p class="cl-99d7e5a4"><span class="cl-99d5aa28">1,897</span></p></td><td class="cl-99d7fe41"><p class="cl-99d7e5ae"><span class="cl-99d5aa28">Philosophy</span></p></td><td class="cl-99d7fe41"><p class="cl-99d7e5ae"><span class="cl-99d5aa28">boethja</span></p></td><td class="cl-99d7fe4a"><p class="cl-99d7e5a4"><span class="cl-99d5aa28">132.96</span></p></td><td class="cl-99d7fe4b"><p class="cl-99d7e5ae"><span class="cl-99d5aa28">North</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-99d7fe2c"><p class="cl-99d7e5a4"><span class="cl-99d5aa28">1,785</span></p></td><td class="cl-99d7fe36"><p class="cl-99d7e5ae"><span class="cl-99d5aa28">Philosophy</span></p></td><td class="cl-99d7fe36"><p class="cl-99d7e5ae"><span class="cl-99d5aa28">boethri</span></p></td><td class="cl-99d7fe37"><p class="cl-99d7e5a4"><span class="cl-99d5aa28">130.49</span></p></td><td class="cl-99d7fe38"><p class="cl-99d7e5ae"><span class="cl-99d5aa28">North</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-99d7fe40"><p class="cl-99d7e5a4"><span class="cl-99d5aa28">1,776</span></p></td><td class="cl-99d7fe41"><p class="cl-99d7e5ae"><span class="cl-99d5aa28">Diary</span></p></td><td class="cl-99d7fe41"><p class="cl-99d7e5ae"><span class="cl-99d5aa28">boswell</span></p></td><td class="cl-99d7fe4a"><p class="cl-99d7e5a4"><span class="cl-99d5aa28">135.94</span></p></td><td class="cl-99d7fe4b"><p class="cl-99d7e5ae"><span class="cl-99d5aa28">North</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-99d7fe2c"><p class="cl-99d7e5a4"><span class="cl-99d5aa28">1,905</span></p></td><td class="cl-99d7fe36"><p class="cl-99d7e5ae"><span class="cl-99d5aa28">Travel</span></p></td><td class="cl-99d7fe36"><p class="cl-99d7e5ae"><span class="cl-99d5aa28">bradley</span></p></td><td class="cl-99d7fe37"><p class="cl-99d7e5a4"><span class="cl-99d5aa28">154.20</span></p></td><td class="cl-99d7fe38"><p class="cl-99d7e5ae"><span class="cl-99d5aa28">North</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-99d7fe40"><p class="cl-99d7e5a4"><span class="cl-99d5aa28">1,711</span></p></td><td class="cl-99d7fe41"><p class="cl-99d7e5ae"><span class="cl-99d5aa28">Education</span></p></td><td class="cl-99d7fe41"><p class="cl-99d7e5ae"><span class="cl-99d5aa28">brightland</span></p></td><td class="cl-99d7fe4a"><p class="cl-99d7e5a4"><span class="cl-99d5aa28">149.14</span></p></td><td class="cl-99d7fe4b"><p class="cl-99d7e5ae"><span class="cl-99d5aa28">North</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-99d7fe2c"><p class="cl-99d7e5a4"><span class="cl-99d5aa28">1,762</span></p></td><td class="cl-99d7fe36"><p class="cl-99d7e5ae"><span class="cl-99d5aa28">Sermon</span></p></td><td class="cl-99d7fe36"><p class="cl-99d7e5ae"><span class="cl-99d5aa28">burton</span></p></td><td class="cl-99d7fe37"><p class="cl-99d7e5a4"><span class="cl-99d5aa28">159.71</span></p></td><td class="cl-99d7fe38"><p class="cl-99d7e5ae"><span class="cl-99d5aa28">North</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-99d7fe40"><p class="cl-99d7e5a4"><span class="cl-99d5aa28">1,726</span></p></td><td class="cl-99d7fe41"><p class="cl-99d7e5ae"><span class="cl-99d5aa28">Sermon</span></p></td><td class="cl-99d7fe41"><p class="cl-99d7e5ae"><span class="cl-99d5aa28">butler</span></p></td><td class="cl-99d7fe4a"><p class="cl-99d7e5a4"><span class="cl-99d5aa28">157.49</span></p></td><td class="cl-99d7fe4b"><p class="cl-99d7e5ae"><span class="cl-99d5aa28">North</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-99d7fe54"><p class="cl-99d7e5a4"><span class="cl-99d5aa28">1,835</span></p></td><td class="cl-99d7fe5e"><p class="cl-99d7e5ae"><span class="cl-99d5aa28">PrivateLetter</span></p></td><td class="cl-99d7fe5e"><p class="cl-99d7e5ae"><span class="cl-99d5aa28">carlyle</span></p></td><td class="cl-99d7fe5f"><p class="cl-99d7e5a4"><span class="cl-99d5aa28">124.16</span></p></td><td class="cl-99d7fe60"><p class="cl-99d7e5ae"><span class="cl-99d5aa28">North</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>The data set contains the date when the text was written (<em>Date</em>), the genre of the text (<em>Genre</em>), the name of the text (<em>Text</em>), the relative frequency of prepositions in the text (<em>Prepositions</em>), and the region in which the text was written (<em>Region</em>). We now plot the data to get a first impression of its structure.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb275"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(lmmdata, <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> Prepositions)) <span class="sc">+</span></span>
<span id="cb275-2"><a href="#cb275-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb275-3"><a href="#cb275-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> F, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb275-4"><a href="#cb275-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb275-5"><a href="#cb275-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Frequency</span><span class="sc">\n</span><span class="st">(Prepositions)"</span>)</span>
<span id="cb275-6"><a href="#cb275-6" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(lmmdata, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Genre, <span class="sc">-</span>Prepositions), <span class="at">y =</span> Prepositions)) <span class="sc">+</span></span>
<span id="cb275-7"><a href="#cb275-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb275-8"><a href="#cb275-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb275-9"><a href="#cb275-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>)) <span class="sc">+</span></span>
<span id="cb275-10"><a href="#cb275-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Genre"</span>, <span class="at">y =</span> <span class="st">"Frequency</span><span class="sc">\n</span><span class="st">(Prepositions)"</span>)</span>
<span id="cb275-11"><a href="#cb275-11" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(lmmdata, <span class="fu">aes</span>(Prepositions)) <span class="sc">+</span></span>
<span id="cb275-12"><a href="#cb275-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span></span>
<span id="cb275-13"><a href="#cb275-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb275-14"><a href="#cb275-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Count"</span>, <span class="at">x =</span> <span class="st">"Frequency (Prepositions)"</span>)</span>
<span id="cb275-15"><a href="#cb275-15" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(<span class="at">grobs =</span> <span class="fu">list</span>(p1, p2, p3), <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">layout_matrix =</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/lmm4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The scatter plot in the upper panel indicates that the use of prepositions has moderately increased over time while the boxplots in the lower left panel show that the genres differ quite substantially with respect to their median frequencies of prepositions per text. Finally, the histogram in the lower right panel show that preposition use is distributed normally with a mean of 132.2 prepositions per text.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb276"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(lmmdata, <span class="fu">aes</span>(Date, Prepositions)) <span class="sc">+</span></span>
<span id="cb276-2"><a href="#cb276-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb276-3"><a href="#cb276-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Prepositions per 1,000 words"</span>) <span class="sc">+</span></span>
<span id="cb276-4"><a href="#cb276-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)  <span class="sc">+</span> </span>
<span id="cb276-5"><a href="#cb276-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb276-6"><a href="#cb276-6" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(lmmdata, <span class="fu">aes</span>(Region, Prepositions)) <span class="sc">+</span></span>
<span id="cb276-7"><a href="#cb276-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb276-8"><a href="#cb276-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Region"</span>, <span class="at">y =</span> <span class="st">"Prepositions per 1,000 words"</span>) <span class="sc">+</span></span>
<span id="cb276-9"><a href="#cb276-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)  <span class="sc">+</span> </span>
<span id="cb276-10"><a href="#cb276-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb276-11"><a href="#cb276-11" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(p4, p5, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/lmm5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb277"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(lmmdata, <span class="fu">aes</span>(Date, Prepositions)) <span class="sc">+</span></span>
<span id="cb277-2"><a href="#cb277-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb277-3"><a href="#cb277-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Genre, <span class="at">nrow =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb277-4"><a href="#cb277-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb277-5"><a href="#cb277-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb277-6"><a href="#cb277-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Date of composition"</span>, <span class="at">y =</span> <span class="st">"Prepositions per 1,000 words"</span>) <span class="sc">+</span></span>
<span id="cb277-7"><a href="#cb277-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">220</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/lmm6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Centering or even scaling numeric variables is useful for later interpretation of regression models: if the date variable were not centered, the regression would show the effects of variables at year 0(!). If numeric variables are centered, other variables are variables are considered relative not to 0 but to the mean of that variable (in this case the mean of years in our data). Centering simply means that the mean of the numeric variable is subtracted from each value.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb278"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a>lmmdata<span class="sc">$</span>DateUnscaled <span class="ot">&lt;-</span> lmmdata<span class="sc">$</span>Date</span>
<span id="cb278-2"><a href="#cb278-2" aria-hidden="true" tabindex="-1"></a>lmmdata<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">scale</span>(lmmdata<span class="sc">$</span>Date, <span class="at">scale =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-9b49e130{table-layout:auto;width:75%;}.cl-9b447baa{font-family:'DejaVu Sans';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-9b447bb4{font-family:'DejaVu Sans';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-9b46af9c{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-9b46afb0{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-9b46c61c{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9b46c626{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9b46c630{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9b46c631{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9b46c632{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9b46c63a{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9b46c644{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9b46c645{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9b46c646{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9b46c64e{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9b46c64f{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9b46c658{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9b46c659{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9b46c662{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9b46c663{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9b46c66c{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-9b49e130"><thead><tr style="overflow-wrap:break-word;"><th class="cl-9b46c61c"><p class="cl-9b46af9c"><span class="cl-9b447baa">Date</span></p></th><th class="cl-9b46c626"><p class="cl-9b46afb0"><span class="cl-9b447baa">Genre</span></p></th><th class="cl-9b46c626"><p class="cl-9b46afb0"><span class="cl-9b447baa">Text</span></p></th><th class="cl-9b46c630"><p class="cl-9b46af9c"><span class="cl-9b447baa">Prepositions</span></p></th><th class="cl-9b46c626"><p class="cl-9b46afb0"><span class="cl-9b447baa">Region</span></p></th><th class="cl-9b46c631"><p class="cl-9b46af9c"><span class="cl-9b447baa">DateUnscaled</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-9b46c632"><p class="cl-9b46af9c"><span class="cl-9b447bb4">109.8696461825</span></p></td><td class="cl-9b46c63a"><p class="cl-9b46afb0"><span class="cl-9b447bb4">Science</span></p></td><td class="cl-9b46c63a"><p class="cl-9b46afb0"><span class="cl-9b447bb4">albin</span></p></td><td class="cl-9b46c644"><p class="cl-9b46af9c"><span class="cl-9b447bb4">166.01</span></p></td><td class="cl-9b46c63a"><p class="cl-9b46afb0"><span class="cl-9b447bb4">North</span></p></td><td class="cl-9b46c645"><p class="cl-9b46af9c"><span class="cl-9b447bb4">1,736</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9b46c646"><p class="cl-9b46af9c"><span class="cl-9b447bb4">84.8696461825</span></p></td><td class="cl-9b46c64e"><p class="cl-9b46afb0"><span class="cl-9b447bb4">Education</span></p></td><td class="cl-9b46c64e"><p class="cl-9b46afb0"><span class="cl-9b447bb4">anon</span></p></td><td class="cl-9b46c64f"><p class="cl-9b46af9c"><span class="cl-9b447bb4">139.86</span></p></td><td class="cl-9b46c64e"><p class="cl-9b46afb0"><span class="cl-9b447bb4">North</span></p></td><td class="cl-9b46c658"><p class="cl-9b46af9c"><span class="cl-9b447bb4">1,711</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9b46c632"><p class="cl-9b46af9c"><span class="cl-9b447bb4">181.8696461825</span></p></td><td class="cl-9b46c63a"><p class="cl-9b46afb0"><span class="cl-9b447bb4">PrivateLetter</span></p></td><td class="cl-9b46c63a"><p class="cl-9b46afb0"><span class="cl-9b447bb4">austen</span></p></td><td class="cl-9b46c644"><p class="cl-9b46af9c"><span class="cl-9b447bb4">130.78</span></p></td><td class="cl-9b46c63a"><p class="cl-9b46afb0"><span class="cl-9b447bb4">North</span></p></td><td class="cl-9b46c645"><p class="cl-9b46af9c"><span class="cl-9b447bb4">1,808</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9b46c646"><p class="cl-9b46af9c"><span class="cl-9b447bb4">251.8696461825</span></p></td><td class="cl-9b46c64e"><p class="cl-9b46afb0"><span class="cl-9b447bb4">Education</span></p></td><td class="cl-9b46c64e"><p class="cl-9b46afb0"><span class="cl-9b447bb4">bain</span></p></td><td class="cl-9b46c64f"><p class="cl-9b46af9c"><span class="cl-9b447bb4">151.29</span></p></td><td class="cl-9b46c64e"><p class="cl-9b46afb0"><span class="cl-9b447bb4">North</span></p></td><td class="cl-9b46c658"><p class="cl-9b46af9c"><span class="cl-9b447bb4">1,878</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9b46c632"><p class="cl-9b46af9c"><span class="cl-9b447bb4">116.8696461825</span></p></td><td class="cl-9b46c63a"><p class="cl-9b46afb0"><span class="cl-9b447bb4">Education</span></p></td><td class="cl-9b46c63a"><p class="cl-9b46afb0"><span class="cl-9b447bb4">barclay</span></p></td><td class="cl-9b46c644"><p class="cl-9b46af9c"><span class="cl-9b447bb4">145.72</span></p></td><td class="cl-9b46c63a"><p class="cl-9b46afb0"><span class="cl-9b447bb4">North</span></p></td><td class="cl-9b46c645"><p class="cl-9b46af9c"><span class="cl-9b447bb4">1,743</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9b46c646"><p class="cl-9b46af9c"><span class="cl-9b447bb4">281.8696461825</span></p></td><td class="cl-9b46c64e"><p class="cl-9b46afb0"><span class="cl-9b447bb4">Education</span></p></td><td class="cl-9b46c64e"><p class="cl-9b46afb0"><span class="cl-9b447bb4">benson</span></p></td><td class="cl-9b46c64f"><p class="cl-9b46af9c"><span class="cl-9b447bb4">120.77</span></p></td><td class="cl-9b46c64e"><p class="cl-9b46afb0"><span class="cl-9b447bb4">North</span></p></td><td class="cl-9b46c658"><p class="cl-9b46af9c"><span class="cl-9b447bb4">1,908</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9b46c632"><p class="cl-9b46af9c"><span class="cl-9b447bb4">279.8696461825</span></p></td><td class="cl-9b46c63a"><p class="cl-9b46afb0"><span class="cl-9b447bb4">Diary</span></p></td><td class="cl-9b46c63a"><p class="cl-9b46afb0"><span class="cl-9b447bb4">benson</span></p></td><td class="cl-9b46c644"><p class="cl-9b46af9c"><span class="cl-9b447bb4">119.17</span></p></td><td class="cl-9b46c63a"><p class="cl-9b46afb0"><span class="cl-9b447bb4">North</span></p></td><td class="cl-9b46c645"><p class="cl-9b46af9c"><span class="cl-9b447bb4">1,906</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9b46c646"><p class="cl-9b46af9c"><span class="cl-9b447bb4">270.8696461825</span></p></td><td class="cl-9b46c64e"><p class="cl-9b46afb0"><span class="cl-9b447bb4">Philosophy</span></p></td><td class="cl-9b46c64e"><p class="cl-9b46afb0"><span class="cl-9b447bb4">boethja</span></p></td><td class="cl-9b46c64f"><p class="cl-9b46af9c"><span class="cl-9b447bb4">132.96</span></p></td><td class="cl-9b46c64e"><p class="cl-9b46afb0"><span class="cl-9b447bb4">North</span></p></td><td class="cl-9b46c658"><p class="cl-9b46af9c"><span class="cl-9b447bb4">1,897</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9b46c632"><p class="cl-9b46af9c"><span class="cl-9b447bb4">158.8696461825</span></p></td><td class="cl-9b46c63a"><p class="cl-9b46afb0"><span class="cl-9b447bb4">Philosophy</span></p></td><td class="cl-9b46c63a"><p class="cl-9b46afb0"><span class="cl-9b447bb4">boethri</span></p></td><td class="cl-9b46c644"><p class="cl-9b46af9c"><span class="cl-9b447bb4">130.49</span></p></td><td class="cl-9b46c63a"><p class="cl-9b46afb0"><span class="cl-9b447bb4">North</span></p></td><td class="cl-9b46c645"><p class="cl-9b46af9c"><span class="cl-9b447bb4">1,785</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9b46c646"><p class="cl-9b46af9c"><span class="cl-9b447bb4">149.8696461825</span></p></td><td class="cl-9b46c64e"><p class="cl-9b46afb0"><span class="cl-9b447bb4">Diary</span></p></td><td class="cl-9b46c64e"><p class="cl-9b46afb0"><span class="cl-9b447bb4">boswell</span></p></td><td class="cl-9b46c64f"><p class="cl-9b46af9c"><span class="cl-9b447bb4">135.94</span></p></td><td class="cl-9b46c64e"><p class="cl-9b46afb0"><span class="cl-9b447bb4">North</span></p></td><td class="cl-9b46c658"><p class="cl-9b46af9c"><span class="cl-9b447bb4">1,776</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9b46c632"><p class="cl-9b46af9c"><span class="cl-9b447bb4">278.8696461825</span></p></td><td class="cl-9b46c63a"><p class="cl-9b46afb0"><span class="cl-9b447bb4">Travel</span></p></td><td class="cl-9b46c63a"><p class="cl-9b46afb0"><span class="cl-9b447bb4">bradley</span></p></td><td class="cl-9b46c644"><p class="cl-9b46af9c"><span class="cl-9b447bb4">154.20</span></p></td><td class="cl-9b46c63a"><p class="cl-9b46afb0"><span class="cl-9b447bb4">North</span></p></td><td class="cl-9b46c645"><p class="cl-9b46af9c"><span class="cl-9b447bb4">1,905</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9b46c646"><p class="cl-9b46af9c"><span class="cl-9b447bb4">84.8696461825</span></p></td><td class="cl-9b46c64e"><p class="cl-9b46afb0"><span class="cl-9b447bb4">Education</span></p></td><td class="cl-9b46c64e"><p class="cl-9b46afb0"><span class="cl-9b447bb4">brightland</span></p></td><td class="cl-9b46c64f"><p class="cl-9b46af9c"><span class="cl-9b447bb4">149.14</span></p></td><td class="cl-9b46c64e"><p class="cl-9b46afb0"><span class="cl-9b447bb4">North</span></p></td><td class="cl-9b46c658"><p class="cl-9b46af9c"><span class="cl-9b447bb4">1,711</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9b46c632"><p class="cl-9b46af9c"><span class="cl-9b447bb4">135.8696461825</span></p></td><td class="cl-9b46c63a"><p class="cl-9b46afb0"><span class="cl-9b447bb4">Sermon</span></p></td><td class="cl-9b46c63a"><p class="cl-9b46afb0"><span class="cl-9b447bb4">burton</span></p></td><td class="cl-9b46c644"><p class="cl-9b46af9c"><span class="cl-9b447bb4">159.71</span></p></td><td class="cl-9b46c63a"><p class="cl-9b46afb0"><span class="cl-9b447bb4">North</span></p></td><td class="cl-9b46c645"><p class="cl-9b46af9c"><span class="cl-9b447bb4">1,762</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9b46c646"><p class="cl-9b46af9c"><span class="cl-9b447bb4">99.8696461825</span></p></td><td class="cl-9b46c64e"><p class="cl-9b46afb0"><span class="cl-9b447bb4">Sermon</span></p></td><td class="cl-9b46c64e"><p class="cl-9b46afb0"><span class="cl-9b447bb4">butler</span></p></td><td class="cl-9b46c64f"><p class="cl-9b46af9c"><span class="cl-9b447bb4">157.49</span></p></td><td class="cl-9b46c64e"><p class="cl-9b46afb0"><span class="cl-9b447bb4">North</span></p></td><td class="cl-9b46c658"><p class="cl-9b46af9c"><span class="cl-9b447bb4">1,726</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9b46c659"><p class="cl-9b46af9c"><span class="cl-9b447bb4">208.8696461825</span></p></td><td class="cl-9b46c662"><p class="cl-9b46afb0"><span class="cl-9b447bb4">PrivateLetter</span></p></td><td class="cl-9b46c662"><p class="cl-9b46afb0"><span class="cl-9b447bb4">carlyle</span></p></td><td class="cl-9b46c663"><p class="cl-9b46af9c"><span class="cl-9b447bb4">124.16</span></p></td><td class="cl-9b46c662"><p class="cl-9b46afb0"><span class="cl-9b447bb4">North</span></p></td><td class="cl-9b46c66c"><p class="cl-9b46af9c"><span class="cl-9b447bb4">1,835</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>We now set up a fixed-effects model with the <code>glm</code> function and a mixed-effects model using the <code>glmer</code> function from the <code>lme4</code> package <span class="citation" data-cites="lme4">(<a href="#ref-lme4" role="doc-biblioref">Bates et al. 2015</a>)</span> with Genre as a random effect.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb279"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate models</span></span>
<span id="cb279-2"><a href="#cb279-2" aria-hidden="true" tabindex="-1"></a>m0.glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(Prepositions <span class="sc">~</span> <span class="dv">1</span>, <span class="at">family =</span> gaussian, <span class="at">data =</span> lmmdata)</span>
<span id="cb279-3"><a href="#cb279-3" aria-hidden="true" tabindex="-1"></a>m0.lmer <span class="ot">=</span> <span class="fu">lmer</span>(Prepositions <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Genre), <span class="at">REML =</span> T, <span class="at">data =</span> lmmdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now that we have created the base-line models, we will test whether including a random effect structure is mathematically justified. It is important to note here that we are not going to test if including a random effect structure is theoretically motivated but simply if it causes a decrease in variance.</p>
</section>
<section id="testing-random-effects" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="testing-random-effects">Testing Random Effects</h3>
<p>As a first step in the modeling process, we now need to determine whether or not including a random effect structure is justified. We do so by comparing the AIC of the base-line model without random intercepts to the AIC of the model with random intercepts.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb280"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(<span class="fu">logLik</span>(m0.glm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4718.19031114</code></pre>
</div>
<div class="sourceCode cell-code" id="cb282"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(<span class="fu">logLik</span>(m0.lmer))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4497.77554693</code></pre>
</div>
</div>
<p>The inclusion of a random effect structure with random intercepts is justified as the AIC of the model with random intercepts is substantially lower than the AIC of the model without random intercepts.</p>
<p>While I do not how how to <em>test</em> if including a random effect is justified, there are often situations, which require to test exactly which random effect structure is best. When doing this, it is important to use <em>restricted maximum likelihood</em> (<code>REML = TRUE</code> or <code>method = REML</code>) rather than maximum likelihood <span class="citation" data-cites="pinheiro2000mixedmodels winter2019statistics">(see <a href="#ref-pinheiro2000mixedmodels" role="doc-biblioref">Pinheiro and Bates</a>; <a href="#ref-winter2019statistics" role="doc-biblioref">Winter, 226</a>)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb284"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate models with 2 different random effect structures</span></span>
<span id="cb284-2"><a href="#cb284-2" aria-hidden="true" tabindex="-1"></a>ma.lmer <span class="ot">=</span> <span class="fu">lmer</span>(Prepositions <span class="sc">~</span> Date <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Genre), <span class="at">REML =</span> T, <span class="at">data =</span> lmmdata)</span>
<span id="cb284-3"><a href="#cb284-3" aria-hidden="true" tabindex="-1"></a>mb.lmer <span class="ot">=</span> <span class="fu">lmer</span>(Prepositions <span class="sc">~</span> Date <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> Date <span class="sc">|</span> Genre), <span class="at">REML =</span> T, <span class="at">data =</span> lmmdata)</span>
<span id="cb284-4"><a href="#cb284-4" aria-hidden="true" tabindex="-1"></a><span class="co"># compare models</span></span>
<span id="cb284-5"><a href="#cb284-5" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ma.lmer, mb.lmer, <span class="at">test =</span> <span class="st">"Chisq"</span>, <span class="at">refit =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: lmmdata
Models:
ma.lmer: Prepositions ~ Date + (1 | Genre)
mb.lmer: Prepositions ~ Date + (1 + Date | Genre)
        npar         AIC         BIC       logLik    deviance    Chisq Df
ma.lmer    4 4499.148092 4516.292084 -2245.574046 4491.148092            
mb.lmer    6 4486.699509 4512.415498 -2237.349755 4474.699509 16.44858  2
        Pr(&gt;Chisq)    
ma.lmer               
mb.lmer 0.00026806 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>The model comparison shows that the model with the more complex random effect structure has a significantly better fit to the data compared with the model with the simpler random effect structure. However, we will continue with the model with the simpler structure because this is just an example.</p>
<div class="warning" style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
<b>NOTE</b><br><br>In a real analysis, we would switch to a model with random intercepts and random slopes for Genre because it has a significantly better fit to the data.
</p>
<p style="margin-left:1em;">
</p>
<p></p>
</span></div>
<p><br></p>
</section>
<section id="model-fitting-1" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="model-fitting-1">Model Fitting</h3>
<p>After having determined that including a random effect structure is justified, we can continue by fitting the model and including diagnostics as we go. Including diagnostics in the model fitting process can save time and prevent relying on models which only turn out to be unstable if we would perform the diagnostics after the fact.</p>
<p>We begin fitting our model by adding <em>Date</em> as a fixed effect and compare this model to our mixed-effects base-line model to see if <em>Date</em> improved the model fit by explaining variance and if <em>Date</em> significantly correlates with our dependent variable (this means that the difference between the models is the effect (size) of <em>Date</em>!)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb286"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a>m1.lmer <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Prepositions <span class="sc">~</span> (<span class="dv">1</span><span class="sc">|</span>Genre) <span class="sc">+</span> Date, <span class="at">REML =</span> T, <span class="at">data =</span> lmmdata)</span>
<span id="cb286-2"><a href="#cb286-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m1.lmer, m0.lmer, <span class="at">test =</span> <span class="st">"Chi"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>refitting model(s) with ML (instead of REML)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: lmmdata
Models:
m0.lmer: Prepositions ~ 1 + (1 | Genre)
m1.lmer: Prepositions ~ (1 | Genre) + Date
        npar         AIC         BIC       logLik    deviance  Chisq Df
m0.lmer    3 4501.947337 4514.805331 -2247.973668 4495.947337          
m1.lmer    4 4495.017736 4512.161728 -2243.508868 4487.017736 8.9296  1
        Pr(&gt;Chisq)   
m0.lmer              
m1.lmer  0.0028059 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>refitting model(s) with ML (instead of REML)</code></pre>
</div>
</div>
<p>The model with <em>Date</em> is the better model (significant p-value and lower AIC). The significant p-value shows that <em>Date</em> correlates significantly with <em>Prepositions</em> (<span class="math inline">\(\chi\)</span><sup>2</sup>(1): 8.9296009, p = 0.00281) . The <span class="math inline">\(\chi\)</span><sup>2</sup> value here is labeled <em>Chisq</em> and the degrees of freedom are calculated by subtracting the smaller number of DFs from the larger number of DFs.</p>
<p>We now test whether <em>Region</em> should also be part of the final minimal adequate model. The easiest way to add predictors is by using the <code>update</code> function (it saves time and typing).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb290"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate model</span></span>
<span id="cb290-2"><a href="#cb290-2" aria-hidden="true" tabindex="-1"></a>m2.lmer <span class="ot">&lt;-</span> <span class="fu">update</span>(m1.lmer, .<span class="sc">~</span>.<span class="sc">+</span> Region)</span>
<span id="cb290-3"><a href="#cb290-3" aria-hidden="true" tabindex="-1"></a><span class="co"># test vifs</span></span>
<span id="cb290-4"><a href="#cb290-4" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">vif</span>(m2.lmer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Date        Region 
1.20287667936 1.20287667936 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb292"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare models                </span></span>
<span id="cb292-2"><a href="#cb292-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m2.lmer, m1.lmer, <span class="at">test =</span> <span class="st">"Chi"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>refitting model(s) with ML (instead of REML)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: lmmdata
Models:
m1.lmer: Prepositions ~ (1 | Genre) + Date
m2.lmer: Prepositions ~ (1 | Genre) + Date + Region
        npar         AIC         BIC       logLik    deviance   Chisq Df
m1.lmer    4 4495.017736 4512.161728 -2243.508868 4487.017736           
m2.lmer    5 4494.624343 4516.054333 -2242.312171 4484.624343 2.39339  1
        Pr(&gt;Chisq)
m1.lmer           
m2.lmer    0.12185</code></pre>
</div>
</div>
<p>Three things tell us that <em>Region</em> should not be included:</p>
<ol type="1">
<li><p>the AIC does not decrease,</p></li>
<li><p>the BIC increases(!), and</p></li>
<li><p>the p-value is higher than .05.</p></li>
</ol>
<p>This means, that we will continue fitting the model without having <em>Region</em> included. Well… not quite - just as a note on including variables: while <em>Region</em> is not significant as a main effect, it must still be included in a model if it were part of a significant interaction. To test if this is indeed the case, we fit another model with the interaction between <em>Date</em> and <em>Region</em> as predictor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb295"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate model</span></span>
<span id="cb295-2"><a href="#cb295-2" aria-hidden="true" tabindex="-1"></a>m3.lmer <span class="ot">&lt;-</span> <span class="fu">update</span>(m1.lmer, .<span class="sc">~</span>.<span class="sc">+</span> Region<span class="sc">*</span>Date)</span>
<span id="cb295-3"><a href="#cb295-3" aria-hidden="true" tabindex="-1"></a><span class="co"># extract vifs</span></span>
<span id="cb295-4"><a href="#cb295-4" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">vif</span>(m3.lmer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Date        Region   Date:Region 
1.96923042276 1.20324697637 1.78000887977 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb297"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare models                </span></span>
<span id="cb297-2"><a href="#cb297-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m3.lmer, m1.lmer, <span class="at">test =</span> <span class="st">"Chi"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>refitting model(s) with ML (instead of REML)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: lmmdata
Models:
m1.lmer: Prepositions ~ (1 | Genre) + Date
m3.lmer: Prepositions ~ (1 | Genre) + Date + Region + Date:Region
        npar         AIC         BIC       logLik    deviance   Chisq Df
m1.lmer    4 4495.017736 4512.161728 -2243.508868 4487.017736           
m3.lmer    6 4496.124872 4521.840861 -2242.062436 4484.124872 2.89286  2
        Pr(&gt;Chisq)
m1.lmer           
m3.lmer    0.23541</code></pre>
</div>
</div>
<p>Again, the high p-value and the increase in AIC and BIC show that we have found our minimal adequate model with only contains <em>Date</em> as a main effect. In a next step, we can inspect the final minimal adequate model, i.e.&nbsp;the most parsimonious (the model that explains a maximum of variance with a minimum of predictors).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb300"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb300-1"><a href="#cb300-1" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect results</span></span>
<span id="cb300-2"><a href="#cb300-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1.lmer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: Prepositions ~ (1 | Genre) + Date
   Data: lmmdata

REML criterion at convergence: 4491.1

Scaled residuals: 
         Min           1Q       Median           3Q          Max 
-3.734915441 -0.657038004  0.005865025  0.661298615  3.596659863 

Random effects:
 Groups   Name        Variance   Std.Dev.  
 Genre    (Intercept) 159.021120 12.6103576
 Residual             228.764179 15.1249522
Number of obs: 537, groups:  Genre, 16

Fixed effects:
                   Estimate      Std. Error  t value
(Intercept) 133.88516211469   3.24749296248 41.22724
Date          0.01894493515   0.00632363682  2.99589

Correlation of Fixed Effects:
     (Intr)
Date 0.005 </code></pre>
</div>
</div>
</section>
<section id="model-diagnostics-2" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="model-diagnostics-2">Model Diagnostics</h3>
<p>We can now evaluate the goodness of fit of the model and check if mathematical requirements and assumptions have been violated. In a first step, we generate diagnostic plots that focus on the random effect structure.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb302"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m1.lmer, Genre <span class="sc">~</span> <span class="fu">resid</span>(.), <span class="at">abline =</span> <span class="dv">0</span> ) <span class="co"># generate diagnostic plots</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/lmm14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The plot shows that there are some outliers (points outside the boxes) and that the variability within letters is greater than in other genres we therefore examine the genres in isolation standardized residuals versus fitted values <span class="citation" data-cites="pinheiro2000mixedmodels">(<a href="#ref-pinheiro2000mixedmodels" role="doc-biblioref">Pinheiro and Bates, 175</a>)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb303"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m1.lmer, <span class="fu">resid</span>(., <span class="at">type =</span> <span class="st">"pearson"</span>) <span class="sc">~</span> <span class="fu">fitted</span>(.) <span class="sc">|</span> Genre, <span class="at">id =</span> <span class="fl">0.05</span>, </span>
<span id="cb303-2"><a href="#cb303-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">adj =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">"gray40"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/lmm15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The plot shows the standardized residuals (or Pearson’s residuals) versus fitted values and suggests that there are outliers in the data (the names elements in the plots). To check if these outliers are a cause for concern, we will now use a Levene’s test to check if the variance is distributed homogeneously (homoscedasticity) or whether the assumption of variance homogeneity is violated (due to the outliers).</p>
<div class="warning" style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
<b>NOTE</b><br><br>The use of Levene’s test to check if the model is heteroscedastic is generally not recommended as it is too lax when dealing with few observations (because in such cases it does not have the power to identify heteroscedasticity) while it is too harsh when dealing with many observations (when heteroscedasticity typically is not a severe problem).
</p>
<p style="margin-left:1em;">
</p>
<p></p>
</span></div>
<p><br></p>
<p>We use Levene’s test here merely to check if it substantiates the impressions we got from the visual inspection.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb304"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb304-1"><a href="#cb304-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check homogeneity</span></span>
<span id="cb304-2"><a href="#cb304-2" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(lmmdata<span class="sc">$</span>Prepositions, lmmdata<span class="sc">$</span>Genre, <span class="at">center =</span> mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in leveneTest.default(lmmdata$Prepositions, lmmdata$Genre, center =
mean): lmmdata$Genre coerced to factor.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = mean)
       Df F value   Pr(&gt;F)  
group  15 1.74289 0.039906 *
      521                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>The Levene’s test shows that the variance is distributed unevenly across genres which means that we do not simply continue but should either remove problematic data points (outliers) or use a weighing method.</p>
<p>In this case, we create a new model which uses weights to compensate for heterogeneity of variance and thus the influence of outliers - which is an alternative to removing the data points and rerunning the analysis <span class="citation" data-cites="pinheiro2000mixedmodels">(<a href="#ref-pinheiro2000mixedmodels" role="doc-biblioref">Pinheiro and Bates, 177</a>)</span>. However, to do so, we need to use a different function (the <code>lme</code> function) which means that we have to create two models: the <em>old</em> minimal adequate model and the <em>new</em> minimal adequate model with added weights. After we have created these models, we will compare them to see if including weights has improved the fit.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb307"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate models</span></span>
<span id="cb307-2"><a href="#cb307-2" aria-hidden="true" tabindex="-1"></a>m4.lme <span class="ot">=</span> <span class="fu">lme</span>(Prepositions <span class="sc">~</span> Date, <span class="at">random =</span> <span class="sc">~</span><span class="dv">1</span><span class="sc">|</span>Genre, <span class="at">data =</span> lmmdata, <span class="at">method =</span> <span class="st">"ML"</span>)</span>
<span id="cb307-3"><a href="#cb307-3" aria-hidden="true" tabindex="-1"></a>m5.lme <span class="ot">&lt;-</span> <span class="fu">update</span>(m4.lme, <span class="at">weights =</span> <span class="fu">varIdent</span>(<span class="at">form =</span> <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Genre))</span>
<span id="cb307-4"><a href="#cb307-4" aria-hidden="true" tabindex="-1"></a><span class="co"># compare models</span></span>
<span id="cb307-5"><a href="#cb307-5" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m5.lme, m4.lme)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Model df           AIC           BIC         logLik   Test       L.Ratio
m5.lme     1 19 4485.84955689 4567.28352069 -2223.92477845                     
m4.lme     2  4 4495.01773596 4512.16172834 -2243.50886798 1 vs 2 39.1681790667
       p-value
m5.lme        
m4.lme  0.0006</code></pre>
</div>
</div>
<p>The weight model (m5.lme) that uses weights to account for unequal variance is performing significantly better than the model without weights (m4.lme) and we therefore switch to the weight model and inspect its parameters.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb309"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect results</span></span>
<span id="cb309-2"><a href="#cb309-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m5.lme)        </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed-effects model fit by maximum likelihood
  Data: lmmdata 
            AIC           BIC         logLik
  4485.84955689 4567.28352069 -2223.92477845

Random effects:
 Formula: ~1 | Genre
          (Intercept)      Residual
StdDev: 12.2631808124 14.3420265787

Variance function:
 Structure: Different standard deviations per stratum
 Formula: ~1 | Genre 
 Parameter estimates:
          Bible       Biography           Diary       Education         Fiction 
 1.000000000000  0.340719922131  0.869529591941  0.788861415446  0.911718858006 
       Handbook         History             Law      Philosophy   PrivateLetter 
 1.096586432734  0.978750069335  0.784977716011  0.736988751895  1.190652740883 
   PublicLetter        Religion         Science          Sermon          Travel 
 1.218929184394  0.974646323962  0.848611735175  0.970873365315  1.086235097365 
TrialProceeding 
 1.260207123026 
Fixed effects:  Prepositions ~ Date 
                     Value      Std.Error  DF       t-value p-value
(Intercept) 133.9640139919 3.144348306618 520 42.6046992663  0.0000
Date          0.0217418124 0.005454714153 520  3.9858756695  0.0001
 Correlation: 
     (Intr)
Date 0.004 

Standardized Within-Group Residuals:
             Min               Q1              Med               Q3 
-3.3190657058362 -0.6797224358638  0.0146860053179  0.6987149873619 
             Max 
 3.1039114834876 

Number of Observations: 537
Number of Groups: 16 </code></pre>
</div>
</div>
<p>We can also use an ANOVA display which is more to the point.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb311"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m5.lme)          </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            numDF denDF        F-value p-value
(Intercept)     1   520 1813.907203146  &lt;.0001
Date            1   520   15.887204853  0.0001</code></pre>
</div>
</div>
<p>As we did before, we now check, whether the final minimal model (with weights) outperforms an intercept-only base-line model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb313"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate base-line model</span></span>
<span id="cb313-2"><a href="#cb313-2" aria-hidden="true" tabindex="-1"></a>m0.lme <span class="ot">=</span> <span class="fu">lme</span>(Prepositions <span class="sc">~</span> <span class="dv">1</span>, <span class="at">random =</span> <span class="sc">~</span><span class="dv">1</span><span class="sc">|</span>Genre, <span class="at">data =</span> lmmdata, <span class="at">method =</span> <span class="st">"ML"</span>, <span class="at">weights =</span> <span class="fu">varIdent</span>(<span class="at">form =</span> <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Genre))</span>
<span id="cb313-3"><a href="#cb313-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m0.lme, m5.lme)  <span class="co"># test if date is significant</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Model df           AIC           BIC         logLik   Test       L.Ratio
m0.lme     1 18 4496.28563020 4573.43359590 -2230.14281510                     
m5.lme     2 19 4485.84955689 4567.28352069 -2223.92477845 1 vs 2 12.4360733078
       p-value
m0.lme        
m5.lme  0.0004</code></pre>
</div>
</div>
<p>Our final minimal adequate model with weights performs significantly better than an intercept only base-line model. Before doing the final diagnostics, we well inspect the estimates for the random effect structure to check if there are values which require further inspection (e.g.&nbsp;because they are drastically different from all other values).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb315"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract estimates and sd for fixed and random effects</span></span>
<span id="cb315-2"><a href="#cb315-2" aria-hidden="true" tabindex="-1"></a><span class="fu">intervals</span>(m5.lme, <span class="at">which=</span><span class="st">"fixed"</span>)      </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Approximate 95% confidence intervals

 Fixed effects:
                        lower              est.             upper
(Intercept) 127.7983408437279 133.9640139919199 140.1296871401120
Date          0.0110458012653   0.0217418124276   0.0324378235899</code></pre>
</div>
</div>
<p>The random effect estimates do not show any outliers or drastically increased or decreased values which means that the random effect structure is fine.</p>
</section>
<section id="effect-sizes" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="effect-sizes">Effect Sizes</h3>
<p>We will now extract effect sizes (in the example: the effect size of <em>Date</em>) and calculate normalized effect size measures (this effect size measure works for all fixed effects). When you have factorial design, you can take the square root of the squared t-value divided by the t-value squared plus the degrees of freedom to calculate the effect size:</p>
<p><span class="math display">\[\begin{equation}

r = \sqrt{ \frac{ t^2}{(t^2 + df) } } = \sqrt{ \frac{ 3.99^2}{(3.99^2 + 520) } } = 0.172

\end{equation}\]</span></p>
<p><br></p>
<div class="warning" style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
<b>NOTE</b><br><br>Two words of warning though: <br>br&gt;1. In our case, the effect we are interested in is not factorial but continuous which means that we should not use this effect size measure. We only show this here as an example for how you can calculate the effect size measure r.<br><br>2. Only apply this function to main effects that are not involved in interactions as they are meaningless because the amount of variance explained by main effects involved in interactions is unclear <span class="citation" data-cites="field2012discovering">(<a href="#ref-field2012discovering" role="doc-biblioref">Field, Miles, and Field, 641</a>)</span>.
</p>
<p style="margin-left:1em;">
</p>
<p></p>
</span></div>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb317"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(m5.lme)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">Prepositions</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">133.96</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">127.80&nbsp;–&nbsp;140.13</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Date</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.02</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.01&nbsp;–&nbsp;0.03</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">205.69</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>Genre</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">150.39</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.42</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>Genre</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">16</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">537</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.017 / 0.432</td>
</tr>

</tbody></table>

</div>
</div>
<hr>
<p><br></p>
<div class="warning" style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
<b>NOTE</b><br><br>The R<sup>2</sup> values of the summary table are incorrect (as indicated by the missing conditional R<sup>2</sup> value). The more appropriate conditional and marginal coefficient of determination for generalized mixed-effect models can be extracted using the <code>r.squaredGLMM</code> function from the <code>MuMIn</code> package <span class="citation" data-cites="MuMIn">(<a href="#ref-MuMIn" role="doc-biblioref">Barton 2020</a>)</span>.
</p>
<p style="margin-left:1em;">
</p>
<p></p>
</span></div>
<p><br></p>
<p>The <em>marginal R<sup>2</sup></em> (marginal coefficient of determination) represents the variance explained by the fixed effects while the <em>conditional R<sup>2</sup></em> is interpreted as a variance explained by the entire model, including both fixed and random effects <span class="citation" data-cites="barton2020mumin">(<a href="#ref-barton2020mumin" role="doc-biblioref">Bartoń</a>)</span>.</p>
<p>The respective call for the model is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb318"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb318-1"><a href="#cb318-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract R2s</span></span>
<span id="cb318-2"><a href="#cb318-2" aria-hidden="true" tabindex="-1"></a><span class="fu">r.squaredGLMM</span>(m1.lmer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 R2m            R2c
[1,] 0.0121971160211 0.417270545308</code></pre>
</div>
</div>
<p>The effects can be visualized using the <code>plot_model</code> function from the <code>sjPlot</code> package <span class="citation" data-cites="sjPlot">(<a href="#ref-sjPlot" role="doc-biblioref">Lüdecke</a>)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb320"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb320-1"><a href="#cb320-1" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">plot_model</span>(m5.lme, <span class="at">type =</span> <span class="st">"pred"</span>, <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"Date"</span>)) <span class="sc">+</span></span>
<span id="cb320-2"><a href="#cb320-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># show uncentered date rather than centered date</span></span>
<span id="cb320-3"><a href="#cb320-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">"Date"</span>, </span>
<span id="cb320-4"><a href="#cb320-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">500</span>, <span class="dv">300</span>, <span class="dv">100</span>), </span>
<span id="cb320-5"><a href="#cb320-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">seq</span>(<span class="dv">1150</span>, <span class="dv">1950</span>, <span class="dv">100</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/lmm21d-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>While we have already shown that the effect of <em>Date</em> is significant, it is small which means that the number of prepositions per text does not correlate very strongly with time. This suggests that other factors that are not included in the model also impact the frequency of prepositions (and probably more meaningfully, too).</p>
<p>Before turning to the diagnostics, we will use the fitted (or predicted) and the observed values with a regression line for the predicted values. This will not only show how good the model fit the data but also the direction and magnitude of the effect.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb321"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract predicted values</span></span>
<span id="cb321-2"><a href="#cb321-2" aria-hidden="true" tabindex="-1"></a>lmmdata<span class="sc">$</span>Predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(m5.lme, lmmdata)</span>
<span id="cb321-3"><a href="#cb321-3" aria-hidden="true" tabindex="-1"></a><span class="co"># plot predicted values</span></span>
<span id="cb321-4"><a href="#cb321-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(lmmdata, <span class="fu">aes</span>(DateUnscaled, Predicted)) <span class="sc">+</span></span>
<span id="cb321-5"><a href="#cb321-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Genre) <span class="sc">+</span></span>
<span id="cb321-6"><a href="#cb321-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> DateUnscaled, <span class="at">y =</span> Prepositions), <span class="at">color =</span> <span class="st">"gray80"</span>, <span class="at">size =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb321-7"><a href="#cb321-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">y =</span> Predicted), <span class="at">color =</span> <span class="st">"gray20"</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>, </span>
<span id="cb321-8"><a href="#cb321-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> T, <span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb321-9"><a href="#cb321-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color=</span><span class="fu">guide_legend</span>(<span class="at">override.aes=</span><span class="fu">list</span>(<span class="at">fill=</span><span class="cn">NA</span>))) <span class="sc">+</span>  </span>
<span id="cb321-10"><a href="#cb321-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_set</span>(<span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb321-11"><a href="#cb321-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"top"</span>, <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb321-12"><a href="#cb321-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb321-13"><a href="#cb321-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span> </span>
<span id="cb321-14"><a href="#cb321-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Date of composition"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/lmm21b-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="model-diagnostics-3" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="model-diagnostics-3">Model Diagnostics</h3>
<p>In addition, we generate diagnostic plots. What we wish to see in the diagnostic plots is a cloud of dots in the middle of the window without any structure. What we do not want to see is a funnel-shaped cloud because this indicates an increase of the errors/residuals with an increase of the predictor(s) (because this would indicate heteroscedasticity) <span class="citation" data-cites="pinheiro2000mixedmodels">(<a href="#ref-pinheiro2000mixedmodels" role="doc-biblioref">Pinheiro and Bates, 182</a>)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb322"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb322-1"><a href="#cb322-1" aria-hidden="true" tabindex="-1"></a><span class="co"># start plotting</span></span>
<span id="cb322-2"><a href="#cb322-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))           <span class="co"># display plots in 2 rows and 2 columns</span></span>
<span id="cb322-3"><a href="#cb322-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m5.lme, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lty =</span> <span class="st">"dotted"</span>); <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/lmm22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>What a wonderful unstructured cloud - the lack of structure tells us that the model is “healthy” and does not suffer from heteroscedasticity. We will now create more diagnostic plots to find potential problems <span class="citation" data-cites="pinheiro2000mixedmodels">(<a href="#ref-pinheiro2000mixedmodels" role="doc-biblioref">Pinheiro and Bates, 21</a>)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb323"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fitted values by Genre</span></span>
<span id="cb323-2"><a href="#cb323-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m5.lme, <span class="at">form =</span> <span class="fu">resid</span>(., <span class="at">type =</span> <span class="st">"p"</span>) <span class="sc">~</span> <span class="fu">fitted</span>(.) <span class="sc">|</span> Genre, <span class="at">abline =</span> <span class="dv">0</span>, </span>
<span id="cb323-3"><a href="#cb323-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> .<span class="dv">5</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/lmm23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In contrast to the unweight model, no data points are named which indicates that the outliers do no longer have unwarranted influence on the model. Now, we check the residuals of fitted values against observed values <span class="citation" data-cites="pinheiro2000mixedmodels">(<a href="#ref-pinheiro2000mixedmodels" role="doc-biblioref">Pinheiro and Bates, 179</a>)</span>. What we would like to see is a straight, upwards going line.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb324"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb324-1"><a href="#cb324-1" aria-hidden="true" tabindex="-1"></a><span class="co"># residuals of fitted values against observed</span></span>
<span id="cb324-2"><a href="#cb324-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(m5.lme, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/lmm24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>A beautiful, straight line! The qqplot does not indicate any problems. It is, unfortunately, rather common that the dots deviate from the straight line at the very bottom or the very top which means that the model is good at estimating values around the middle of the dependent variable but rather bad at estimating lower or higher values. Next, we check the residuals by “Genre” <span class="citation" data-cites="pinheiro2000mixedmodels">(<a href="#ref-pinheiro2000mixedmodels" role="doc-biblioref">Pinheiro and Bates, 179</a>)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb325"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb325-1"><a href="#cb325-1" aria-hidden="true" tabindex="-1"></a><span class="co"># residuals by genre</span></span>
<span id="cb325-2"><a href="#cb325-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(m5.lme, <span class="sc">~</span><span class="fu">resid</span>(.) <span class="sc">|</span> Genre, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">"black"</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/lmm25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Beautiful straight lines - perfection! Now, we inspect the observed responses versus the within-group fitted values <span class="citation" data-cites="pinheiro2000mixedmodels">(<a href="#ref-pinheiro2000mixedmodels" role="doc-biblioref">Pinheiro and Bates, 178</a>)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb326"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb326-1"><a href="#cb326-1" aria-hidden="true" tabindex="-1"></a><span class="co"># observed responses versus the within-group fitted values</span></span>
<span id="cb326-2"><a href="#cb326-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m5.lme, Prepositions <span class="sc">~</span> <span class="fu">fitted</span>(.), <span class="at">id =</span> <span class="fl">0.05</span>, <span class="at">adj =</span> <span class="sc">-</span><span class="fl">0.3</span>, </span>
<span id="cb326-3"><a href="#cb326-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">220</span>), <span class="at">cex =</span> .<span class="dv">8</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/lmm26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Although some data points are named, the plot does not show any structure, like a funnel, which would have been problematic.</p>
</section>
<section id="reporting-results" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="reporting-results">Reporting Results</h3>
<p>Before we do the write-up, we have a look at the model summary as this will provide us with at least some of the parameters that we want to report.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb327"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb327-1"><a href="#cb327-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m5.lme)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed-effects model fit by maximum likelihood
  Data: lmmdata 
            AIC           BIC         logLik
  4485.84955689 4567.28352069 -2223.92477845

Random effects:
 Formula: ~1 | Genre
          (Intercept)      Residual
StdDev: 12.2631808124 14.3420265787

Variance function:
 Structure: Different standard deviations per stratum
 Formula: ~1 | Genre 
 Parameter estimates:
          Bible       Biography           Diary       Education         Fiction 
 1.000000000000  0.340719922131  0.869529591941  0.788861415446  0.911718858006 
       Handbook         History             Law      Philosophy   PrivateLetter 
 1.096586432734  0.978750069335  0.784977716011  0.736988751895  1.190652740883 
   PublicLetter        Religion         Science          Sermon          Travel 
 1.218929184394  0.974646323962  0.848611735175  0.970873365315  1.086235097365 
TrialProceeding 
 1.260207123026 
Fixed effects:  Prepositions ~ Date 
                     Value      Std.Error  DF       t-value p-value
(Intercept) 133.9640139919 3.144348306618 520 42.6046992663  0.0000
Date          0.0217418124 0.005454714153 520  3.9858756695  0.0001
 Correlation: 
     (Intr)
Date 0.004 

Standardized Within-Group Residuals:
             Min               Q1              Med               Q3 
-3.3190657058362 -0.6797224358638  0.0146860053179  0.6987149873619 
             Max 
 3.1039114834876 

Number of Observations: 537
Number of Groups: 16 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb329"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb329-1"><a href="#cb329-1" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(m5.lme)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">Prepositions</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">133.96</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">127.80&nbsp;–&nbsp;140.13</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Date</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.02</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.01&nbsp;–&nbsp;0.03</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">205.69</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>Genre</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">150.39</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.42</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>Genre</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">16</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">537</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.017 / 0.432</td>
</tr>

</tbody></table>

</div>
</div>
<p>We can now use the information extracted above to write up a final report:</p>
<p>A mixed-effect linear regression model which contained the genre of texts as random effect was fit to the data in a step-wise-step up procedure. Due to the presence of outliers in the data, weights were included into the model which led to a significantly improved model fit compared to an un-weight model (<span class="math inline">\(\chi\)</span><sup>2</sup>(2): 39.17, p: 0.0006). The final minimal adequate model performed significantly better than an intercept-only base-line model (<span class="math inline">\(\chi\)</span><sup>2</sup>(1): 12.44, p =.0004) and showed that the frequency of prepositions increases significantly but only marginally with the date of composition (Estimate: 0.02, CI: 0.01-0.03, p &lt; .001, marginal R<sup>2</sup> = 0.0174, conditional R<sup>2</sup> = 0.4324). Neither the region where the text was composed nor a higher order interaction between genre and region significantly correlated with the use of prepositions in the data.</p>
</section>
<section id="remarks-on-prediction" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="remarks-on-prediction">Remarks on Prediction</h3>
<p>While the number of intercepts, the model reports, and the way how mixed- and fixed-effects arrive at predictions differ, their predictions are extremely similar and almost identical (at least when dealing with a simple random effect structure). Consider the following example where we create analogous fixed and mixed effect models and plot their predicted frequencies of prepositions per genre across the un-centered date of composition. The predictions of the mixed-effects model are plotted as a solid red line, while the predictions of the fixed-effects model are plotted as dashed blue lines.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb330"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb330-1"><a href="#cb330-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create lm model</span></span>
<span id="cb330-2"><a href="#cb330-2" aria-hidden="true" tabindex="-1"></a>m5.lmeunweight <span class="ot">&lt;-</span> <span class="fu">lm</span>(Prepositions <span class="sc">~</span> DateUnscaled <span class="sc">+</span> Genre, <span class="at">data =</span> lmmdata)</span>
<span id="cb330-3"><a href="#cb330-3" aria-hidden="true" tabindex="-1"></a>lmmdata<span class="sc">$</span>lmePredictions <span class="ot">&lt;-</span> <span class="fu">fitted</span>(m5.lmeunweight, lmmdata)</span>
<span id="cb330-4"><a href="#cb330-4" aria-hidden="true" tabindex="-1"></a>m5.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Prepositions <span class="sc">~</span> DateUnscaled <span class="sc">+</span> Genre, <span class="at">data =</span> lmmdata)</span>
<span id="cb330-5"><a href="#cb330-5" aria-hidden="true" tabindex="-1"></a>lmmdata<span class="sc">$</span>lmPredictions <span class="ot">&lt;-</span> <span class="fu">fitted</span>(m5.lm, lmmdata)</span>
<span id="cb330-6"><a href="#cb330-6" aria-hidden="true" tabindex="-1"></a><span class="co"># plot predictions</span></span>
<span id="cb330-7"><a href="#cb330-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(lmmdata, <span class="fu">aes</span>(<span class="at">x =</span> DateUnscaled, <span class="at">y =</span> lmePredictions, <span class="at">group =</span> Genre)) <span class="sc">+</span></span>
<span id="cb330-8"><a href="#cb330-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> lmmdata<span class="sc">$</span>lmePredictions), <span class="at">linetype =</span> <span class="st">"solid"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb330-9"><a href="#cb330-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> lmmdata<span class="sc">$</span>lmPredictions), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb330-10"><a href="#cb330-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Genre, <span class="at">nrow =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb330-11"><a href="#cb330-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb330-12"><a href="#cb330-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Date of composition"</span>) <span class="sc">+</span></span>
<span id="cb330-13"><a href="#cb330-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Prepositions per 1,000 words"</span>) <span class="sc">+</span></span>
<span id="cb330-14"><a href="#cb330-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">220</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/lmm29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The predictions overlap almost perfectly which means that the predictions of both are almost identical - irrespective of whether genre is part of the mixed or the fixed effects structure.</p>
</section>
</section>
<section id="mixed-effects-binomial-logistic-regression" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="mixed-effects-binomial-logistic-regression">Mixed-Effects Binomial Logistic Regression</h2>
<p>We now turn to an extension of binomial logistic regression: mixed-effects binomial logistic regression. As is the case with linear mixed-effects models logistic mixed effects models have the following advantages over simpler statistical tests:</p>
<ul>
<li><p>Mixed-effects models are multivariate, i.e.&nbsp;they test the effect of several predictors simultaneously while controlling for the effect of all other predictors.</p></li>
<li><p>Mixed models allow to statistically incorporate within-speaker variability and are thus fit to model hierarchical or nested data structures. This applies if several observations are produced by an individual speaker, for instance.</p></li>
<li><p>Mixed-models provide a wealth of diagnostic statistics which enables us to control e.g.&nbsp;multicollinearity, i.e.&nbsp;correlations between predictors, and to test whether conditions or requirements are violated (e.g.&nbsp;homogeneity of variance, etc.).</p></li>
</ul>
<p>Major disadvantages of regression modeling are that they are prone to producing high <span class="math inline">\(\beta\)</span>-errors <span class="citation" data-cites="johnson2009getting">(see <a href="#ref-johnson2009getting" role="doc-biblioref">Johnson</a>)</span> and that they require rather large data sets.</p>
<section id="introduction-2" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="introduction-2">Introduction</h3>
<p>As is the case with linear mixed-effects models, binomial logistic mixed-effect models are multivariate analyses that treat data points as hierarchical or grouped in some way. In other words, they take into account that the data is nested in the sense that data points are produced by the same speaker or are grouped by some other characteristics. In mixed-models, hierarchical structures are modelled as <em>random effects</em>. If the random effect structure represents speakers then this means that a mixed-model would have a separate intercept and/or slope for each speaker.</p>
<p>Random Effects in linear models can be visualized using two parameters: the intercept (the point where the regression line crosses the y-axis at x = 0) and the slope (the acclivity of the regression line). In contrast to linear mixed-effects models, random effects differ in the position and the slope of the logistic function that is applied to the likelihood of the dependent variable. Random intercepts (upper right panel) or various random slopes (lower left panel), or both, various random intercepts and various random slopes (lower right panel). In the following, we will only focus on models with random intercepts because this is the by far more common method and because including both random intercepts and random slopes requires huge amounts of data. Consider the Figure below to understand what is meant by <em>random intercepts</em>.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/blmm1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The upper left panel merely shows the logistic curve representing the predictions of a fixed-effects logistic regression with a single intercept and slope. The upper right panel shows the logistic curves representing the predictions of a of a mixed-effects logistic regression with random intercepts for each level of a grouping variable. The lower left panel shows the logistic curves representing the predictions of a mixed-effects logistic regression with one intercept but random slopes for each level of a grouping variable. The lower right panel shows the logistic curves representing the predictions of a mixed-effects logistic regression with random intercepts and random slopes for each level of a grouping variable.</p>
<p>After adding random intercepts, predictors (or fixed effects) are added to the model (just like with multiple regression). So mixed-effects are called mixed-effects because they contain both random and fixed effects.</p>
<p>In terms of general procedure, random effects are added first, and only after we have ascertained that including random effects is warranted, we test whether including fixed-effects is warranted <span class="citation" data-cites="field2012discovering">(<a href="#ref-field2012discovering" role="doc-biblioref">Field, Miles, and Field</a>)</span>. We test whether including random effects is warranted by comparing a model, that bases its estimates of the dependent variable solely on the base intercept, with a model that bases its estimates of the dependent variable solely on the intercepts of the random effect. If the mixed-effects model explains significantly more variance than the fixed-effects model without random effect structure, then we continue with the mixed-effects model. In other words, including random effects is justified.</p>
</section>
<section id="example-discourse-like-in-irish-english" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="example-discourse-like-in-irish-english">Example: Discourse LIKE in Irish English</h3>
<p>In this example we will investigate which factors correlate with the use of <em>final discourse like</em> (e.g.&nbsp;“<em>The weather is shite, like!</em>”) in Irish English. The data set represents speech units in a corpus that were coded for the speaker who uttered a given speech unit, the gender (Gender: Men versus Women) and age of that speaker (Age: Old versus Young), whether the interlocutors were of the same or a different gender (ConversationType: SameGender versus MixedGender), and whether another <em>final discourse like</em> had been used up to three speech units before (Priming: NoPrime versus Prime), whether or not the speech unit contained an <em>final discourse like</em> (SUFLike: 1 = yes, 0 = no. To begin with, we load the data and inspect the structure of the data set,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb331"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb331-1"><a href="#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb331-2"><a href="#cb331-2" aria-hidden="true" tabindex="-1"></a>mblrdata  <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="st">"tutorials/regression/data/mbd.rda"</span>, <span class="st">"rb"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-9fb48d1a{table-layout:auto;width:75%;}.cl-9fae8604{font-family:'DejaVu Sans';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-9fae8618{font-family:'DejaVu Sans';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-9fb137fa{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-9fb1380e{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-9fb15078{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9fb15082{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9fb15083{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9fb1508c{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9fb1508d{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9fb15096{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9fb15097{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9fb150a0{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9fb150a1{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9fb150a2{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9fb150aa{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9fb150ab{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-9fb48d1a"><thead><tr style="overflow-wrap:break-word;"><th class="cl-9fb15078"><p class="cl-9fb137fa"><span class="cl-9fae8604">ID</span></p></th><th class="cl-9fb15082"><p class="cl-9fb137fa"><span class="cl-9fae8604">Gender</span></p></th><th class="cl-9fb15082"><p class="cl-9fb137fa"><span class="cl-9fae8604">Age</span></p></th><th class="cl-9fb15082"><p class="cl-9fb137fa"><span class="cl-9fae8604">ConversationType</span></p></th><th class="cl-9fb15082"><p class="cl-9fb137fa"><span class="cl-9fae8604">Priming</span></p></th><th class="cl-9fb15083"><p class="cl-9fb1380e"><span class="cl-9fae8604">SUFlike</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-9fb1508c"><p class="cl-9fb137fa"><span class="cl-9fae8618">S1A-061$C</span></p></td><td class="cl-9fb1508d"><p class="cl-9fb137fa"><span class="cl-9fae8618">Women</span></p></td><td class="cl-9fb1508d"><p class="cl-9fb137fa"><span class="cl-9fae8618">Young</span></p></td><td class="cl-9fb1508d"><p class="cl-9fb137fa"><span class="cl-9fae8618">MixedGender</span></p></td><td class="cl-9fb1508d"><p class="cl-9fb137fa"><span class="cl-9fae8618">NoPrime</span></p></td><td class="cl-9fb15096"><p class="cl-9fb1380e"><span class="cl-9fae8618">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9fb15097"><p class="cl-9fb137fa"><span class="cl-9fae8618">S1A-023$B</span></p></td><td class="cl-9fb150a0"><p class="cl-9fb137fa"><span class="cl-9fae8618">Women</span></p></td><td class="cl-9fb150a0"><p class="cl-9fb137fa"><span class="cl-9fae8618">Young</span></p></td><td class="cl-9fb150a0"><p class="cl-9fb137fa"><span class="cl-9fae8618">MixedGender</span></p></td><td class="cl-9fb150a0"><p class="cl-9fb137fa"><span class="cl-9fae8618">NoPrime</span></p></td><td class="cl-9fb150a1"><p class="cl-9fb1380e"><span class="cl-9fae8618">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9fb1508c"><p class="cl-9fb137fa"><span class="cl-9fae8618">S1A-054$A</span></p></td><td class="cl-9fb1508d"><p class="cl-9fb137fa"><span class="cl-9fae8618">Women</span></p></td><td class="cl-9fb1508d"><p class="cl-9fb137fa"><span class="cl-9fae8618">Young</span></p></td><td class="cl-9fb1508d"><p class="cl-9fb137fa"><span class="cl-9fae8618">SameGender</span></p></td><td class="cl-9fb1508d"><p class="cl-9fb137fa"><span class="cl-9fae8618">NoPrime</span></p></td><td class="cl-9fb15096"><p class="cl-9fb1380e"><span class="cl-9fae8618">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9fb15097"><p class="cl-9fb137fa"><span class="cl-9fae8618">S1A-090$B</span></p></td><td class="cl-9fb150a0"><p class="cl-9fb137fa"><span class="cl-9fae8618">Women</span></p></td><td class="cl-9fb150a0"><p class="cl-9fb137fa"><span class="cl-9fae8618">Young</span></p></td><td class="cl-9fb150a0"><p class="cl-9fb137fa"><span class="cl-9fae8618">MixedGender</span></p></td><td class="cl-9fb150a0"><p class="cl-9fb137fa"><span class="cl-9fae8618">NoPrime</span></p></td><td class="cl-9fb150a1"><p class="cl-9fb1380e"><span class="cl-9fae8618">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9fb1508c"><p class="cl-9fb137fa"><span class="cl-9fae8618">S1A-009$B</span></p></td><td class="cl-9fb1508d"><p class="cl-9fb137fa"><span class="cl-9fae8618">Women</span></p></td><td class="cl-9fb1508d"><p class="cl-9fb137fa"><span class="cl-9fae8618">Old</span></p></td><td class="cl-9fb1508d"><p class="cl-9fb137fa"><span class="cl-9fae8618">SameGender</span></p></td><td class="cl-9fb1508d"><p class="cl-9fb137fa"><span class="cl-9fae8618">Prime</span></p></td><td class="cl-9fb15096"><p class="cl-9fb1380e"><span class="cl-9fae8618">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9fb15097"><p class="cl-9fb137fa"><span class="cl-9fae8618">S1A-085$E</span></p></td><td class="cl-9fb150a0"><p class="cl-9fb137fa"><span class="cl-9fae8618">Men</span></p></td><td class="cl-9fb150a0"><p class="cl-9fb137fa"><span class="cl-9fae8618">Young</span></p></td><td class="cl-9fb150a0"><p class="cl-9fb137fa"><span class="cl-9fae8618">MixedGender</span></p></td><td class="cl-9fb150a0"><p class="cl-9fb137fa"><span class="cl-9fae8618">Prime</span></p></td><td class="cl-9fb150a1"><p class="cl-9fb1380e"><span class="cl-9fae8618">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9fb1508c"><p class="cl-9fb137fa"><span class="cl-9fae8618">S1A-003$C</span></p></td><td class="cl-9fb1508d"><p class="cl-9fb137fa"><span class="cl-9fae8618">Women</span></p></td><td class="cl-9fb1508d"><p class="cl-9fb137fa"><span class="cl-9fae8618">Young</span></p></td><td class="cl-9fb1508d"><p class="cl-9fb137fa"><span class="cl-9fae8618">MixedGender</span></p></td><td class="cl-9fb1508d"><p class="cl-9fb137fa"><span class="cl-9fae8618">NoPrime</span></p></td><td class="cl-9fb15096"><p class="cl-9fb1380e"><span class="cl-9fae8618">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9fb15097"><p class="cl-9fb137fa"><span class="cl-9fae8618">S1A-084$C</span></p></td><td class="cl-9fb150a0"><p class="cl-9fb137fa"><span class="cl-9fae8618">Women</span></p></td><td class="cl-9fb150a0"><p class="cl-9fb137fa"><span class="cl-9fae8618">Young</span></p></td><td class="cl-9fb150a0"><p class="cl-9fb137fa"><span class="cl-9fae8618">SameGender</span></p></td><td class="cl-9fb150a0"><p class="cl-9fb137fa"><span class="cl-9fae8618">NoPrime</span></p></td><td class="cl-9fb150a1"><p class="cl-9fb1380e"><span class="cl-9fae8618">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9fb1508c"><p class="cl-9fb137fa"><span class="cl-9fae8618">S1A-076$A</span></p></td><td class="cl-9fb1508d"><p class="cl-9fb137fa"><span class="cl-9fae8618">Women</span></p></td><td class="cl-9fb1508d"><p class="cl-9fb137fa"><span class="cl-9fae8618">Young</span></p></td><td class="cl-9fb1508d"><p class="cl-9fb137fa"><span class="cl-9fae8618">SameGender</span></p></td><td class="cl-9fb1508d"><p class="cl-9fb137fa"><span class="cl-9fae8618">NoPrime</span></p></td><td class="cl-9fb15096"><p class="cl-9fb1380e"><span class="cl-9fae8618">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9fb15097"><p class="cl-9fb137fa"><span class="cl-9fae8618">S1A-083$D</span></p></td><td class="cl-9fb150a0"><p class="cl-9fb137fa"><span class="cl-9fae8618">Men</span></p></td><td class="cl-9fb150a0"><p class="cl-9fb137fa"><span class="cl-9fae8618">Old</span></p></td><td class="cl-9fb150a0"><p class="cl-9fb137fa"><span class="cl-9fae8618">MixedGender</span></p></td><td class="cl-9fb150a0"><p class="cl-9fb137fa"><span class="cl-9fae8618">NoPrime</span></p></td><td class="cl-9fb150a1"><p class="cl-9fb1380e"><span class="cl-9fae8618">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9fb1508c"><p class="cl-9fb137fa"><span class="cl-9fae8618">S1A-068$A</span></p></td><td class="cl-9fb1508d"><p class="cl-9fb137fa"><span class="cl-9fae8618">Women</span></p></td><td class="cl-9fb1508d"><p class="cl-9fb137fa"><span class="cl-9fae8618">Young</span></p></td><td class="cl-9fb1508d"><p class="cl-9fb137fa"><span class="cl-9fae8618">SameGender</span></p></td><td class="cl-9fb1508d"><p class="cl-9fb137fa"><span class="cl-9fae8618">NoPrime</span></p></td><td class="cl-9fb15096"><p class="cl-9fb1380e"><span class="cl-9fae8618">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9fb15097"><p class="cl-9fb137fa"><span class="cl-9fae8618">S1A-066$B</span></p></td><td class="cl-9fb150a0"><p class="cl-9fb137fa"><span class="cl-9fae8618">Women</span></p></td><td class="cl-9fb150a0"><p class="cl-9fb137fa"><span class="cl-9fae8618">Young</span></p></td><td class="cl-9fb150a0"><p class="cl-9fb137fa"><span class="cl-9fae8618">SameGender</span></p></td><td class="cl-9fb150a0"><p class="cl-9fb137fa"><span class="cl-9fae8618">NoPrime</span></p></td><td class="cl-9fb150a1"><p class="cl-9fb1380e"><span class="cl-9fae8618">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9fb1508c"><p class="cl-9fb137fa"><span class="cl-9fae8618">S1A-061$A</span></p></td><td class="cl-9fb1508d"><p class="cl-9fb137fa"><span class="cl-9fae8618">Men</span></p></td><td class="cl-9fb1508d"><p class="cl-9fb137fa"><span class="cl-9fae8618">Old</span></p></td><td class="cl-9fb1508d"><p class="cl-9fb137fa"><span class="cl-9fae8618">MixedGender</span></p></td><td class="cl-9fb1508d"><p class="cl-9fb137fa"><span class="cl-9fae8618">NoPrime</span></p></td><td class="cl-9fb15096"><p class="cl-9fb1380e"><span class="cl-9fae8618">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9fb15097"><p class="cl-9fb137fa"><span class="cl-9fae8618">S1A-049$A</span></p></td><td class="cl-9fb150a0"><p class="cl-9fb137fa"><span class="cl-9fae8618">Women</span></p></td><td class="cl-9fb150a0"><p class="cl-9fb137fa"><span class="cl-9fae8618">Young</span></p></td><td class="cl-9fb150a0"><p class="cl-9fb137fa"><span class="cl-9fae8618">SameGender</span></p></td><td class="cl-9fb150a0"><p class="cl-9fb137fa"><span class="cl-9fae8618">NoPrime</span></p></td><td class="cl-9fb150a1"><p class="cl-9fb1380e"><span class="cl-9fae8618">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9fb150a2"><p class="cl-9fb137fa"><span class="cl-9fae8618">S1A-022$B</span></p></td><td class="cl-9fb150aa"><p class="cl-9fb137fa"><span class="cl-9fae8618">Women</span></p></td><td class="cl-9fb150aa"><p class="cl-9fb137fa"><span class="cl-9fae8618">Young</span></p></td><td class="cl-9fb150aa"><p class="cl-9fb137fa"><span class="cl-9fae8618">MixedGender</span></p></td><td class="cl-9fb150aa"><p class="cl-9fb137fa"><span class="cl-9fae8618">NoPrime</span></p></td><td class="cl-9fb150ab"><p class="cl-9fb1380e"><span class="cl-9fae8618">0</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>As all variables except for the dependent variable (<code>SUFlike</code>) are character strings, we factorize the independent variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb332"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a><span class="co"># def. variables to be factorized</span></span>
<span id="cb332-2"><a href="#cb332-2" aria-hidden="true" tabindex="-1"></a>vrs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ID"</span>, <span class="st">"Age"</span>, <span class="st">"Gender"</span>, <span class="st">"ConversationType"</span>, <span class="st">"Priming"</span>)</span>
<span id="cb332-3"><a href="#cb332-3" aria-hidden="true" tabindex="-1"></a><span class="co"># def. vector with variables</span></span>
<span id="cb332-4"><a href="#cb332-4" aria-hidden="true" tabindex="-1"></a>fctr <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">colnames</span>(mblrdata) <span class="sc">%in%</span> vrs)     </span>
<span id="cb332-5"><a href="#cb332-5" aria-hidden="true" tabindex="-1"></a><span class="co"># factorize variables</span></span>
<span id="cb332-6"><a href="#cb332-6" aria-hidden="true" tabindex="-1"></a>mblrdata[,fctr] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(mblrdata[,fctr], factor)</span>
<span id="cb332-7"><a href="#cb332-7" aria-hidden="true" tabindex="-1"></a><span class="co"># relevel Age (Young = Reference)</span></span>
<span id="cb332-8"><a href="#cb332-8" aria-hidden="true" tabindex="-1"></a>mblrdata<span class="sc">$</span>Age <span class="ot">&lt;-</span> <span class="fu">relevel</span>(mblrdata<span class="sc">$</span>Age, <span class="st">"Young"</span>)</span>
<span id="cb332-9"><a href="#cb332-9" aria-hidden="true" tabindex="-1"></a><span class="co"># order data by ID</span></span>
<span id="cb332-10"><a href="#cb332-10" aria-hidden="true" tabindex="-1"></a>mblrdata <span class="ot">&lt;-</span> mblrdata <span class="sc">%&gt;%</span></span>
<span id="cb332-11"><a href="#cb332-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(ID)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-9fd105d0{table-layout:auto;width:75%;}.cl-9fcb46ae{font-family:'DejaVu Sans';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-9fcb46b8{font-family:'DejaVu Sans';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-9fcd976a{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-9fcd977e{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-9fcdaf20{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9fcdaf2a{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9fcdaf34{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9fcdaf35{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9fcdaf3e{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9fcdaf3f{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9fcdaf40{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9fcdaf48{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9fcdaf49{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9fcdaf52{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9fcdaf53{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9fcdaf5c{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-9fd105d0"><thead><tr style="overflow-wrap:break-word;"><th class="cl-9fcdaf20"><p class="cl-9fcd976a"><span class="cl-9fcb46ae">ID</span></p></th><th class="cl-9fcdaf2a"><p class="cl-9fcd976a"><span class="cl-9fcb46ae">Gender</span></p></th><th class="cl-9fcdaf2a"><p class="cl-9fcd976a"><span class="cl-9fcb46ae">Age</span></p></th><th class="cl-9fcdaf2a"><p class="cl-9fcd976a"><span class="cl-9fcb46ae">ConversationType</span></p></th><th class="cl-9fcdaf2a"><p class="cl-9fcd976a"><span class="cl-9fcb46ae">Priming</span></p></th><th class="cl-9fcdaf34"><p class="cl-9fcd977e"><span class="cl-9fcb46ae">SUFlike</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-9fcdaf35"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">S1A-001$A</span></p></td><td class="cl-9fcdaf3e"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">Men</span></p></td><td class="cl-9fcdaf3e"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">Old</span></p></td><td class="cl-9fcdaf3e"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">SameGender</span></p></td><td class="cl-9fcdaf3e"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">NoPrime</span></p></td><td class="cl-9fcdaf3f"><p class="cl-9fcd977e"><span class="cl-9fcb46b8">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9fcdaf40"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">S1A-001$A</span></p></td><td class="cl-9fcdaf48"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">Men</span></p></td><td class="cl-9fcdaf48"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">Old</span></p></td><td class="cl-9fcdaf48"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">SameGender</span></p></td><td class="cl-9fcdaf48"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">NoPrime</span></p></td><td class="cl-9fcdaf49"><p class="cl-9fcd977e"><span class="cl-9fcb46b8">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9fcdaf35"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">S1A-001$A</span></p></td><td class="cl-9fcdaf3e"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">Men</span></p></td><td class="cl-9fcdaf3e"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">Old</span></p></td><td class="cl-9fcdaf3e"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">SameGender</span></p></td><td class="cl-9fcdaf3e"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">NoPrime</span></p></td><td class="cl-9fcdaf3f"><p class="cl-9fcd977e"><span class="cl-9fcb46b8">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9fcdaf40"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">S1A-001$A</span></p></td><td class="cl-9fcdaf48"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">Men</span></p></td><td class="cl-9fcdaf48"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">Old</span></p></td><td class="cl-9fcdaf48"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">SameGender</span></p></td><td class="cl-9fcdaf48"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">NoPrime</span></p></td><td class="cl-9fcdaf49"><p class="cl-9fcd977e"><span class="cl-9fcb46b8">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9fcdaf35"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">S1A-001$A</span></p></td><td class="cl-9fcdaf3e"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">Men</span></p></td><td class="cl-9fcdaf3e"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">Old</span></p></td><td class="cl-9fcdaf3e"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">SameGender</span></p></td><td class="cl-9fcdaf3e"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">NoPrime</span></p></td><td class="cl-9fcdaf3f"><p class="cl-9fcd977e"><span class="cl-9fcb46b8">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9fcdaf40"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">S1A-001$A</span></p></td><td class="cl-9fcdaf48"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">Men</span></p></td><td class="cl-9fcdaf48"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">Old</span></p></td><td class="cl-9fcdaf48"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">SameGender</span></p></td><td class="cl-9fcdaf48"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">NoPrime</span></p></td><td class="cl-9fcdaf49"><p class="cl-9fcd977e"><span class="cl-9fcb46b8">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9fcdaf35"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">S1A-001$A</span></p></td><td class="cl-9fcdaf3e"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">Men</span></p></td><td class="cl-9fcdaf3e"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">Old</span></p></td><td class="cl-9fcdaf3e"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">SameGender</span></p></td><td class="cl-9fcdaf3e"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">NoPrime</span></p></td><td class="cl-9fcdaf3f"><p class="cl-9fcd977e"><span class="cl-9fcb46b8">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9fcdaf40"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">S1A-001$A</span></p></td><td class="cl-9fcdaf48"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">Men</span></p></td><td class="cl-9fcdaf48"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">Old</span></p></td><td class="cl-9fcdaf48"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">SameGender</span></p></td><td class="cl-9fcdaf48"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">NoPrime</span></p></td><td class="cl-9fcdaf49"><p class="cl-9fcd977e"><span class="cl-9fcb46b8">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9fcdaf35"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">S1A-001$B</span></p></td><td class="cl-9fcdaf3e"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">Women</span></p></td><td class="cl-9fcdaf3e"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">Old</span></p></td><td class="cl-9fcdaf3e"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">MixedGender</span></p></td><td class="cl-9fcdaf3e"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">NoPrime</span></p></td><td class="cl-9fcdaf3f"><p class="cl-9fcd977e"><span class="cl-9fcb46b8">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9fcdaf40"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">S1A-001$B</span></p></td><td class="cl-9fcdaf48"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">Women</span></p></td><td class="cl-9fcdaf48"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">Old</span></p></td><td class="cl-9fcdaf48"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">MixedGender</span></p></td><td class="cl-9fcdaf48"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">NoPrime</span></p></td><td class="cl-9fcdaf49"><p class="cl-9fcd977e"><span class="cl-9fcb46b8">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9fcdaf35"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">S1A-001$B</span></p></td><td class="cl-9fcdaf3e"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">Women</span></p></td><td class="cl-9fcdaf3e"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">Old</span></p></td><td class="cl-9fcdaf3e"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">MixedGender</span></p></td><td class="cl-9fcdaf3e"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">NoPrime</span></p></td><td class="cl-9fcdaf3f"><p class="cl-9fcd977e"><span class="cl-9fcb46b8">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9fcdaf40"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">S1A-001$B</span></p></td><td class="cl-9fcdaf48"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">Women</span></p></td><td class="cl-9fcdaf48"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">Old</span></p></td><td class="cl-9fcdaf48"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">MixedGender</span></p></td><td class="cl-9fcdaf48"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">Prime</span></p></td><td class="cl-9fcdaf49"><p class="cl-9fcd977e"><span class="cl-9fcb46b8">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9fcdaf35"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">S1A-001$B</span></p></td><td class="cl-9fcdaf3e"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">Women</span></p></td><td class="cl-9fcdaf3e"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">Old</span></p></td><td class="cl-9fcdaf3e"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">MixedGender</span></p></td><td class="cl-9fcdaf3e"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">NoPrime</span></p></td><td class="cl-9fcdaf3f"><p class="cl-9fcd977e"><span class="cl-9fcb46b8">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9fcdaf40"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">S1A-001$B</span></p></td><td class="cl-9fcdaf48"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">Women</span></p></td><td class="cl-9fcdaf48"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">Old</span></p></td><td class="cl-9fcdaf48"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">MixedGender</span></p></td><td class="cl-9fcdaf48"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">NoPrime</span></p></td><td class="cl-9fcdaf49"><p class="cl-9fcd977e"><span class="cl-9fcb46b8">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9fcdaf52"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">S1A-001$B</span></p></td><td class="cl-9fcdaf53"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">Women</span></p></td><td class="cl-9fcdaf53"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">Old</span></p></td><td class="cl-9fcdaf53"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">MixedGender</span></p></td><td class="cl-9fcdaf53"><p class="cl-9fcd976a"><span class="cl-9fcb46b8">NoPrime</span></p></td><td class="cl-9fcdaf5c"><p class="cl-9fcd977e"><span class="cl-9fcb46b8">0</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>Before continuing, a few words about the minimum number of random effect levels and the minimum number of observations per random effect level are in order.</p>
<p>While many data points per random variable level increases statistical power and thus to more robust estimates of the random effects <span class="citation" data-cites="austin2018multilevel">(<a href="#ref-austin2018multilevel" role="doc-biblioref">Austin and Leckie</a>)</span>, it has been shown that small numbers of observations per random effect variable level do not cause serious bias and it does not negatively affect the estimates of the fixed-effects coefficients <span class="citation" data-cites="bell2008multilevel clarke2008can clarke2007addressing maas2005sufficient">(<a href="#ref-bell2008multilevel" role="doc-biblioref">Bell, Ferron, and Kromrey</a>; <a href="#ref-clarke2008can" role="doc-biblioref">Clarke</a>; <a href="#ref-clarke2007addressing" role="doc-biblioref">Clarke and Wheaton</a>; <a href="#ref-maas2005sufficient" role="doc-biblioref">Maas and Hox</a>)</span>. The minimum number of observations per random effect variable level is therefore 1.</p>
<p>In simulation study, <span class="citation" data-cites="bell2008multilevel">(<a href="#ref-bell2008multilevel" role="doc-biblioref">Bell, Ferron, and Kromrey</a>)</span> tested the impact of random variable levels with only a single observation ranging from 0 to 70 percent. As long as there was a relatively high number of random effect variable levels (500 or more), small numbers of observations had almost no impact on bias and Type 1 error control.</p>
<p>We now plot the data to inspect the relationships within the data set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb333"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb333-1"><a href="#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mblrdata, <span class="fu">aes</span>(Gender, SUFlike, <span class="at">color =</span> Priming)) <span class="sc">+</span></span>
<span id="cb333-2"><a href="#cb333-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(Age<span class="sc">~</span>ConversationType) <span class="sc">+</span></span>
<span id="cb333-3"><a href="#cb333-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>) <span class="sc">+</span></span>
<span id="cb333-4"><a href="#cb333-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_cl_boot, <span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb333-5"><a href="#cb333-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_set</span>(<span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb333-6"><a href="#cb333-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb333-7"><a href="#cb333-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Observed Probabilty of discourse like"</span>) <span class="sc">+</span></span>
<span id="cb333-8"><a href="#cb333-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray20"</span>, <span class="st">"gray70"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/blmm8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The upper left panel in the Figure above indicates that men use discourse <em>like</em> more frequently than women. The center right panel suggests that priming significantly increases the likelihood of discourse like being used. The center left panel suggests that speakers use discourse like more frequently in mixed-gender conversations. However, the lower right panel indicates an interaction between gender and conversation type as women appear to use discourse like less frequently in same gender conversations while the conversation type does not seem to have an effect on men. After visualizing the data, we will now turn to the model building process.</p>
</section>
<section id="model-building-1" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="model-building-1">Model Building</h3>
<p>As a first step, we need to define contrasts and use the <code>datadist</code> function to store aspects of our variables that can be accessed later when plotting and summarizing the model. Contrasts define what and how variable levels should be compared and therefore influences how the results of the regression analysis are presented. In this case, we use treatment contrasts which are in-built. Treatment contrasts mean that we assess the significance of levels of a predictor against a baseline which is the reference level of a predictor. <span class="citation" data-cites="field2012discovering">Field, Miles, and Field (<a href="#ref-field2012discovering" role="doc-biblioref">414–27</a>)</span> and <span class="citation" data-cites="gries2021statistics">Gries</span> provide very good and accessible explanations of contrasts and how to manually define contrasts if you would like to know more.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb334"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb334-1"><a href="#cb334-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set options</span></span>
<span id="cb334-2"><a href="#cb334-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">contrasts  =</span><span class="fu">c</span>(<span class="st">"contr.treatment"</span>, <span class="st">"contr.poly"</span>))</span>
<span id="cb334-3"><a href="#cb334-3" aria-hidden="true" tabindex="-1"></a>mblrdata.dist <span class="ot">&lt;-</span> <span class="fu">datadist</span>(mblrdata)</span>
<span id="cb334-4"><a href="#cb334-4" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">datadist =</span> <span class="st">"mblrdata.dist"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In a next step, we generate fixed-effects minimal base-line models and a base-line mixed-model using the <code>glmer</code> function with a random intercept for ID (a lmer-object of the final minimal adequate model will be created later).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb335"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb335-1"><a href="#cb335-1" aria-hidden="true" tabindex="-1"></a><span class="co"># baseline model glm</span></span>
<span id="cb335-2"><a href="#cb335-2" aria-hidden="true" tabindex="-1"></a>m0.glm <span class="ot">=</span> <span class="fu">glm</span>(SUFlike <span class="sc">~</span> <span class="dv">1</span>, <span class="at">family =</span> binomial, <span class="at">data =</span> mblrdata) </span>
<span id="cb335-3"><a href="#cb335-3" aria-hidden="true" tabindex="-1"></a><span class="co"># base-line mixed-model</span></span>
<span id="cb335-4"><a href="#cb335-4" aria-hidden="true" tabindex="-1"></a>m0.glmer <span class="ot">=</span> <span class="fu">glmer</span>(SUFlike <span class="sc">~</span> (<span class="dv">1</span><span class="sc">|</span>ID), <span class="at">data =</span> mblrdata, <span class="at">family =</span> binomial) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="testing-the-random-effect" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="testing-the-random-effect">Testing the Random Effect</h3>
<p>Now, we check if including the random effect is permitted by comparing the AICs from the glm to AIC from the glmer model. If the AIC of the glmer object is smaller than the AIC of the glm object, then this indicates that including random intercepts is justified.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb336"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb336-1"><a href="#cb336-1" aria-hidden="true" tabindex="-1"></a>aic.glmer <span class="ot">&lt;-</span> <span class="fu">AIC</span>(<span class="fu">logLik</span>(m0.glmer))</span>
<span id="cb336-2"><a href="#cb336-2" aria-hidden="true" tabindex="-1"></a>aic.glm <span class="ot">&lt;-</span> <span class="fu">AIC</span>(<span class="fu">logLik</span>(m0.glm))</span>
<span id="cb336-3"><a href="#cb336-3" aria-hidden="true" tabindex="-1"></a>aic.glmer; aic.glm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1828.49227105</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1838.17334856</code></pre>
</div>
</div>
<p>The AIC of the glmer object is smaller which shows that including the random intercepts is justified. To confirm whether the AIC reduction is sufficient for justifying the inclusion of a random-effect structure, we also test whether the mixed-effects minimal base-line model explains significantly more variance by applying a Model Likelihood Ratio Test to the fixed- and the mixed effects minimal base-line models.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb339"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb339-1"><a href="#cb339-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test random effects</span></span>
<span id="cb339-2"><a href="#cb339-2" aria-hidden="true" tabindex="-1"></a>null.id <span class="ot">=</span> <span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">logLik</span>(m0.glm) <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">logLik</span>(m0.glmer)</span>
<span id="cb339-3"><a href="#cb339-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(<span class="fu">as.numeric</span>(null.id), <span class="at">df=</span><span class="dv">1</span>, <span class="at">lower.tail=</span>F) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.000631389565877</code></pre>
</div>
<div class="sourceCode cell-code" id="cb341"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb341-1"><a href="#cb341-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sig m0.glmer better than m0.glm</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The p-value of the Model Likelihood Ratio Test is lower than .05 which shows that the inclusion of the random-effects structure is warranted. We can now continue with the model fitting process.</p>
</section>
<section id="model-fitting-2" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="model-fitting-2">Model Fitting</h3>
<p>The next step is to fit the model which means that we aim to find the <em>best</em> model, i.e.&nbsp;the minimal adequate model. In this case, we will use the <code>glmulti</code> package to find the model with the lowest Bayesian Information Criterion (BIC) of all possible models. We add ´control = glmerControl(optimizer = “bobyqa”)´ to avoid unnecessary failures to converge.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb342"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb342-1"><a href="#cb342-1" aria-hidden="true" tabindex="-1"></a><span class="co"># wrapper function for linear mixed-models</span></span>
<span id="cb342-2"><a href="#cb342-2" aria-hidden="true" tabindex="-1"></a>glmer.glmulti <span class="ot">&lt;-</span> <span class="cf">function</span>(formula,data, <span class="at">random=</span><span class="st">""</span>,...){</span>
<span id="cb342-3"><a href="#cb342-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glmer</span>(<span class="fu">paste</span>(<span class="fu">deparse</span>(formula),random), </span>
<span id="cb342-4"><a href="#cb342-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">family =</span> binomial, </span>
<span id="cb342-5"><a href="#cb342-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">data=</span>data, </span>
<span id="cb342-6"><a href="#cb342-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">control=</span><span class="fu">glmerControl</span>(<span class="at">optimizer=</span><span class="st">"bobyqa"</span>), ...)</span>
<span id="cb342-7"><a href="#cb342-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb342-8"><a href="#cb342-8" aria-hidden="true" tabindex="-1"></a><span class="co"># define formula</span></span>
<span id="cb342-9"><a href="#cb342-9" aria-hidden="true" tabindex="-1"></a>form_glmulti <span class="ot">=</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(<span class="st">"SUFlike ~ Gender + Age + ConversationType + Priming"</span>))</span>
<span id="cb342-10"><a href="#cb342-10" aria-hidden="true" tabindex="-1"></a><span class="co"># multi selection for glmer</span></span>
<span id="cb342-11"><a href="#cb342-11" aria-hidden="true" tabindex="-1"></a>mfit <span class="ot">&lt;-</span> <span class="fu">glmulti</span>(form_glmulti,<span class="at">random=</span><span class="st">"+(1 | ID)"</span>, </span>
<span id="cb342-12"><a href="#cb342-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> mblrdata, <span class="at">method =</span> <span class="st">"h"</span>, <span class="at">fitfunc =</span> glmer.glmulti,</span>
<span id="cb342-13"><a href="#cb342-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">crit =</span> <span class="st">"bic"</span>, <span class="at">intercept =</span> <span class="cn">TRUE</span>, <span class="at">marginality =</span> <span class="cn">FALSE</span>, <span class="at">level =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Initialization...
TASK: Exhaustive screening of candidate set.
Fitting...</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
After 50 models:
Best model: SUFlike~1+Gender+ConversationType+Priming
Crit= 1696.58773399606
Mean crit= 1753.96253323389</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/blmm13a-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
After 100 models:
Best model: SUFlike~1+Gender+ConversationType+Priming
Crit= 1696.58773399606
Mean crit= 1731.89001011587</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/blmm13a-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Completed.</code></pre>
</div>
</div>
<p>We extract the best 5 models (best is here defined as the models with the lowest BIC).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb347"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb347-1"><a href="#cb347-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract best models</span></span>
<span id="cb347-2"><a href="#cb347-2" aria-hidden="true" tabindex="-1"></a>top <span class="ot">&lt;-</span> <span class="fu">weightable</span>(mfit)</span>
<span id="cb347-3"><a href="#cb347-3" aria-hidden="true" tabindex="-1"></a>top <span class="ot">&lt;-</span> top[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,]</span>
<span id="cb347-4"><a href="#cb347-4" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect top 5 models</span></span>
<span id="cb347-5"><a href="#cb347-5" aria-hidden="true" tabindex="-1"></a>top</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                                          model
1                                             SUFlike ~ 1 + Gender + ConversationType + Priming
2                            SUFlike ~ 1 + Gender + ConversationType + Priming + Priming:Gender
3 SUFlike ~ 1 + Gender + ConversationType + Priming + Priming:Gender + Priming:ConversationType
4                                               SUFlike ~ 1 + Gender + Priming + Priming:Gender
5                  SUFlike ~ 1 + Gender + ConversationType + Priming + Priming:ConversationType
            bic         weights
1 1696.58773400 0.2567900972828
2 1696.76989551 0.2344349734701
3 1696.76989551 0.2344349734701
4 1699.62465884 0.0562494681439
5 1699.83927868 0.0505259299761</code></pre>
</div>
</div>
<p>The best model is has the formula <code>SUFlike ~ 1 + Gender + ConversationType + Priming</code> and we take this to be our final minimal adequate model, i.e.&nbsp;the most parsimonious model (the model which explains the relatively most variance with lowest number of predictors). Hence, we define our final minimal model and check its output.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb349"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb349-1"><a href="#cb349-1" aria-hidden="true" tabindex="-1"></a>mlr.glmer <span class="ot">&lt;-</span> <span class="fu">glmer</span>(SUFlike <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> ID) <span class="sc">+</span> Gender <span class="sc">+</span> ConversationType <span class="sc">+</span> Priming, </span>
<span id="cb349-2"><a href="#cb349-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> binomial,</span>
<span id="cb349-3"><a href="#cb349-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">control=</span><span class="fu">glmerControl</span>(<span class="at">optimizer=</span><span class="st">"bobyqa"</span>),</span>
<span id="cb349-4"><a href="#cb349-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> mblrdata)</span>
<span id="cb349-5"><a href="#cb349-5" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect final minimal adequate model</span></span>
<span id="cb349-6"><a href="#cb349-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mlr.glmer, <span class="at">corr =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: SUFlike ~ (1 | ID) + Gender + ConversationType + Priming
   Data: mblrdata
Control: glmerControl(optimizer = "bobyqa")

     AIC      BIC   logLik deviance df.resid 
  1668.6   1696.6   -829.3   1658.6     1995 

Scaled residuals: 
         Min           1Q       Median           3Q          Max 
-1.579360482 -0.415523789 -0.330409032 -0.312054147  3.247885670 

Random effects:
 Groups Name        Variance     Std.Dev.   
 ID     (Intercept) 0.0837516227 0.289398726
Number of obs: 2000, groups:  ID, 208

Fixed effects:
                               Estimate   Std. Error  z value
(Intercept)                -1.067430756  0.149186799 -7.15499
GenderWomen                -0.642887587  0.175330451 -3.66672
ConversationTypeSameGender -0.536428978  0.148820181 -3.60454
PrimingPrime                1.866249152  0.163250273 11.43183
                                         Pr(&gt;|z|)    
(Intercept)                   0.00000000000083676 ***
GenderWomen                            0.00024568 ***
ConversationTypeSameGender             0.00031270 ***
PrimingPrime               &lt; 0.000000000000000222 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>We now test whether the final minimal model performs significantly better than the minimal base-line model, and print the regression summary.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb351"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb351-1"><a href="#cb351-1" aria-hidden="true" tabindex="-1"></a><span class="co"># final model better than base-line model</span></span>
<span id="cb351-2"><a href="#cb351-2" aria-hidden="true" tabindex="-1"></a>sigfit <span class="ot">&lt;-</span> <span class="fu">anova</span>(mlr.glmer, m0.glmer, <span class="at">test =</span> <span class="st">"Chi"</span>) </span>
<span id="cb351-3"><a href="#cb351-3" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb351-4"><a href="#cb351-4" aria-hidden="true" tabindex="-1"></a>sigfit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: mblrdata
Models:
m0.glmer: SUFlike ~ (1 | ID)
mlr.glmer: SUFlike ~ (1 | ID) + Gender + ConversationType + Priming
          npar         AIC         BIC       logLik    deviance     Chisq Df
m0.glmer     2 1828.492271 1839.694076 -912.2461355 1824.492271             
mlr.glmer    5 1668.583222 1696.587734 -829.2916108 1658.583222 165.90905  3
                      Pr(&gt;Chisq)    
m0.glmer                            
mlr.glmer &lt; 0.000000000000000222 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb353"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb353-1"><a href="#cb353-1" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect final minimal adequate model</span></span>
<span id="cb353-2"><a href="#cb353-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mlr.glmer, <span class="at">corr =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: SUFlike ~ (1 | ID) + Gender + ConversationType + Priming
   Data: mblrdata
      AIC       BIC    logLik  deviance  df.resid 
1668.5832 1696.5877 -829.2916 1658.5832      1995 
Random effects:
 Groups Name        Std.Dev.   
 ID     (Intercept) 0.289398726
Number of obs: 2000, groups:  ID, 208
Fixed Effects:
               (Intercept)                 GenderWomen  
              -1.067430756                -0.642887587  
ConversationTypeSameGender                PrimingPrime  
              -0.536428978                 1.866249152  </code></pre>
</div>
</div>
</section>
<section id="visualizing-effects" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="visualizing-effects">Visualizing Effects</h3>
<p>We visualize the effects here by showing the probability of discourse <em>like</em> based on the predicted values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb355"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb355-1"><a href="#cb355-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(mlr.glmer, <span class="at">type =</span> <span class="st">"pred"</span>, <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"Gender"</span>, <span class="st">"Priming"</span>, <span class="st">"ConversationType"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>You are calculating adjusted predictions on the population-level (i.e.
  `type = "fixed"`) for a *generalized* linear mixed model.
  This may produce biased estimates due to Jensen's inequality. Consider
  setting `bias_correction = TRUE` to correct for this bias.
  See also the documentation of the `bias_correction` argument.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/blmm33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can see that discourse <em>like</em> is more likely to surface in primed contexts and among males. In conversations with both men and women, speakers use discourse <em>like</em> slightly less than in mixed conversations.</p>
</section>
<section id="extracting-model-fit-parameters" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="extracting-model-fit-parameters">Extracting Model Fit Parameters</h3>
<p>We now extract model fit parameters <span class="citation" data-cites="baayen2008analyzing">(<a href="#ref-baayen2008analyzing" role="doc-biblioref">Baayen, 281</a>)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb357"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb357-1"><a href="#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Hmisc) <span class="co"># Ensure the package is loaded</span></span>
<span id="cb357-2"><a href="#cb357-2" aria-hidden="true" tabindex="-1"></a>probs <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fu">fitted</span>(mlr.glmer)))</span>
<span id="cb357-3"><a href="#cb357-3" aria-hidden="true" tabindex="-1"></a>probs <span class="ot">=</span> <span class="fu">binomial</span>()<span class="sc">$</span><span class="fu">linkinv</span>(<span class="fu">fitted</span>(mlr.glmer))</span>
<span id="cb357-4"><a href="#cb357-4" aria-hidden="true" tabindex="-1"></a><span class="fu">somers2</span>(probs, <span class="fu">as.numeric</span>(mblrdata<span class="sc">$</span>SUFlike))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The two lines that start with <code>probs</code> are simply two different ways to do the same thing (you only need one of these).</p>
<p>The model fit parameters indicate a suboptimal fit. Both the C-value and Somers’s D<sub>xy</sub> show poor fit between predicted and observed occurrences of discourse <em>like</em>. If the C-value is 0.5, the predictions are random, while the predictions are perfect if the C-value is 1. C-values above 0.8 indicate real predictive capacity <span class="citation" data-cites="baayen2008analyzing">(<a href="#ref-baayen2008analyzing" role="doc-biblioref">Baayen, 204</a>)</span>. Somers’ D<sub>xy</sub> is a value that represents a rank correlation between predicted probabilities and observed responses. Somers’ D<sub>xy</sub> values range between 0, which indicates complete randomness, and 1, which indicates perfect prediction <span class="citation" data-cites="baayen2008analyzing">(<a href="#ref-baayen2008analyzing" role="doc-biblioref">Baayen, 204</a>)</span>. The C.value output of the <code>somers2</code> function suggests that the model has some predictive and explanatory power, but not at an optimal level. We will now perform the model diagnostics.</p>
</section>
<section id="model-diagnostics-4" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="model-diagnostics-4">Model Diagnostics</h3>
<p>We begin the model diagnostics by generating a diagnostic that plots the fitted or predicted values against the residuals.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb358"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb358-1"><a href="#cb358-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mlr.glmer, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lty =</span> <span class="st">"dotted"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/blmm38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>As a final step, we summarize our findings in tabulated form.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb359"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb359-1"><a href="#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summarize final model</span></span>
<span id="cb359-2"><a href="#cb359-2" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(mlr.glmer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">SUFlike</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Odds Ratios</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.34</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.26&nbsp;–&nbsp;0.46</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Gender [Women]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.53</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.37&nbsp;–&nbsp;0.74</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">ConversationType<br>[SameGender]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.58</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.44&nbsp;–&nbsp;0.78</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Priming [Prime]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">6.46</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">4.69&nbsp;–&nbsp;8.90</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">3.29</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>ID</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.08</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">ICC</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.02</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>ID</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">208</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">2000</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.131 / 0.152</td>
</tr>

</tbody></table>

</div>
</div>
<hr>
<p>We can use the <code>reports</code> package <span class="citation" data-cites="report">(<a href="#ref-report" role="doc-biblioref">Makowski et al. 2021</a>)</span> to summarize the analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb360"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb360-1"><a href="#cb360-1" aria-hidden="true" tabindex="-1"></a>report<span class="sc">::</span><span class="fu">report</span>(mlr.glmer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a logistic mixed model (estimated using ML and BOBYQA optimizer) to
predict SUFlike with Gender, ConversationType and Priming (formula: SUFlike ~
Gender + ConversationType + Priming). The model included ID as random effect
(formula: ~1 | ID). The model's total explanatory power is moderate
(conditional R2 = 0.15) and the part related to the fixed effects alone
(marginal R2) is of 0.13. The model's intercept, corresponding to Gender = Men,
ConversationType = MixedGender and Priming = NoPrime, is at -1.07 (95% CI
[-1.36, -0.78], p &lt; .001). Within this model:

  - The effect of Gender [Women] is statistically significant and negative (beta
= -0.64, 95% CI [-0.99, -0.30], p &lt; .001; Std. beta = -0.64, 95% CI [-0.99,
-0.30])
  - The effect of ConversationType [SameGender] is statistically significant and
negative (beta = -0.54, 95% CI [-0.83, -0.24], p &lt; .001; Std. beta = -0.54, 95%
CI [-0.83, -0.24])
  - The effect of Priming [Prime] is statistically significant and positive (beta
= 1.87, 95% CI [1.55, 2.19], p &lt; .001; Std. beta = 1.87, 95% CI [1.55, 2.19])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald z-distribution approximation.</code></pre>
</div>
</div>
<p>We can use this output to write up a final report:</p>
<p>We can use this output to write up a final report:</p>
<p>We fitted a logistic mixed model to predict the use of discourse like. The model included speakers as random effect (formula: ~1 | ID). The model’s total explanatory power is moderate (conditional R2 = 0.15) and the part related to the fixed effects alone (marginal R2) is of 0.13.</p>
<p>Regarding fixed effects, the model reported that * women use discourse like statistically less compared to men (beta = -0.64 [-0.99, -0.30], p &lt; .001; Std. beta = -0.64 [-0.99, -0.30]) * speakers in conversations with other speakers of the same gender use discourse like significantly less compared to thier use in mixed-gender conversations (beta = -0.54 [-0.83, -0.24], p &lt; .001; Std. beta = -0.54 [-0.83, -0.24]) * Priming is significantly positively correlated with the use of discourse like (beta = 1.87 [1.55, 2.19], p &lt; .001; Std. beta = 1.87 [1.55, 2.19])</p>
</section>
</section>
<section id="mixed-effects-quasi-poisson-and-negative-binomial-regression" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="mixed-effects-quasi-poisson-and-negative-binomial-regression">Mixed-Effects (Quasi-)Poisson and Negative-Binomial Regression</h2>
<p>Like fixed-effects Poisson models, mixed-effects Poisson models take counts as dependent variables. The data for this analysis was collected on three separate evenings (Trial). The number of the filler <em>uhm</em> (UHM) was counted in two-minute conversations that were either in English, German, Russian, or Mandarin (Language). In addition, the number of shots that speakers drank before they talked was recorded (Shots).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb362"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb362-1"><a href="#cb362-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb362-2"><a href="#cb362-2" aria-hidden="true" tabindex="-1"></a>countdata  <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="st">"tutorials/regression/data/cld.rda"</span>, <span class="st">"rb"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb363"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb363-1"><a href="#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect data</span></span>
<span id="cb363-2"><a href="#cb363-2" aria-hidden="true" tabindex="-1"></a>countdata <span class="sc">%&gt;%</span></span>
<span id="cb363-3"><a href="#cb363-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb363-4"><a href="#cb363-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">15</span>) <span class="sc">%&gt;%</span></span>
<span id="cb363-5"><a href="#cb363-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb363-6"><a href="#cb363-6" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">set_table_properties</span>(<span class="at">width =</span> .<span class="dv">75</span>, <span class="at">layout =</span> <span class="st">"autofit"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb363-7"><a href="#cb363-7" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">theme_zebra</span>() <span class="sc">%&gt;%</span></span>
<span id="cb363-8"><a href="#cb363-8" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">fontsize</span>(<span class="at">size =</span> <span class="dv">12</span>) <span class="sc">%&gt;%</span></span>
<span id="cb363-9"><a href="#cb363-9" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">fontsize</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">part =</span> <span class="st">"header"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb363-10"><a href="#cb363-10" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">align_text_col</span>(<span class="at">align =</span> <span class="st">"center"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb363-11"><a href="#cb363-11" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">set_caption</span>(<span class="at">caption =</span> <span class="st">"First 15 rows of the countdata data."</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb363-12"><a href="#cb363-12" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">border_outer</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-b3f98a00{table-layout:auto;width:75%;}.cl-b3f43bae{font-family:'DejaVu Sans';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b3f43bc2{font-family:'DejaVu Sans';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b3f67df6{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b3f67e00{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b3f6975a{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b3f69764{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b3f69765{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b3f6976e{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b3f6976f{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b3f69778{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b3f69779{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b3f69782{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b3f69783{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b3f6978c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b3f6978d{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b3f69796{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b3f69797{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b3f697a0{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b3f697a1{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b3f697aa{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-b3f98a00"><thead><tr style="overflow-wrap:break-word;"><th class="cl-b3f6975a"><p class="cl-b3f67df6"><span class="cl-b3f43bae">ID</span></p></th><th class="cl-b3f69764"><p class="cl-b3f67df6"><span class="cl-b3f43bae">Trial</span></p></th><th class="cl-b3f69765"><p class="cl-b3f67e00"><span class="cl-b3f43bae">Language</span></p></th><th class="cl-b3f69765"><p class="cl-b3f67e00"><span class="cl-b3f43bae">Gender</span></p></th><th class="cl-b3f69764"><p class="cl-b3f67df6"><span class="cl-b3f43bae">UHM</span></p></th><th class="cl-b3f6976e"><p class="cl-b3f67df6"><span class="cl-b3f43bae">Shots</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-b3f6976f"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">1</span></p></td><td class="cl-b3f69778"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">3</span></p></td><td class="cl-b3f69779"><p class="cl-b3f67e00"><span class="cl-b3f43bc2">Russian</span></p></td><td class="cl-b3f69779"><p class="cl-b3f67e00"><span class="cl-b3f43bc2">Man</span></p></td><td class="cl-b3f69778"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">0</span></p></td><td class="cl-b3f69782"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b3f69783"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">2</span></p></td><td class="cl-b3f6978c"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">3</span></p></td><td class="cl-b3f6978d"><p class="cl-b3f67e00"><span class="cl-b3f43bc2">Russian</span></p></td><td class="cl-b3f6978d"><p class="cl-b3f67e00"><span class="cl-b3f43bc2">Man</span></p></td><td class="cl-b3f6978c"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">0</span></p></td><td class="cl-b3f69796"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b3f6976f"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">3</span></p></td><td class="cl-b3f69778"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">3</span></p></td><td class="cl-b3f69779"><p class="cl-b3f67e00"><span class="cl-b3f43bc2">German</span></p></td><td class="cl-b3f69779"><p class="cl-b3f67e00"><span class="cl-b3f43bc2">Man</span></p></td><td class="cl-b3f69778"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">0</span></p></td><td class="cl-b3f69782"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">5</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b3f69783"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">4</span></p></td><td class="cl-b3f6978c"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">1</span></p></td><td class="cl-b3f6978d"><p class="cl-b3f67e00"><span class="cl-b3f43bc2">German</span></p></td><td class="cl-b3f6978d"><p class="cl-b3f67e00"><span class="cl-b3f43bc2">Man</span></p></td><td class="cl-b3f6978c"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">0</span></p></td><td class="cl-b3f69796"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">3</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b3f6976f"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">5</span></p></td><td class="cl-b3f69778"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">1</span></p></td><td class="cl-b3f69779"><p class="cl-b3f67e00"><span class="cl-b3f43bc2">German</span></p></td><td class="cl-b3f69779"><p class="cl-b3f67e00"><span class="cl-b3f43bc2">Woman</span></p></td><td class="cl-b3f69778"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">2</span></p></td><td class="cl-b3f69782"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">6</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b3f69783"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">6</span></p></td><td class="cl-b3f6978c"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">3</span></p></td><td class="cl-b3f6978d"><p class="cl-b3f67e00"><span class="cl-b3f43bc2">German</span></p></td><td class="cl-b3f6978d"><p class="cl-b3f67e00"><span class="cl-b3f43bc2">Man</span></p></td><td class="cl-b3f6978c"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">1</span></p></td><td class="cl-b3f69796"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">5</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b3f6976f"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">7</span></p></td><td class="cl-b3f69778"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">1</span></p></td><td class="cl-b3f69779"><p class="cl-b3f67e00"><span class="cl-b3f43bc2">Mandarin</span></p></td><td class="cl-b3f69779"><p class="cl-b3f67e00"><span class="cl-b3f43bc2">Man</span></p></td><td class="cl-b3f69778"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">1</span></p></td><td class="cl-b3f69782"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b3f69783"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">8</span></p></td><td class="cl-b3f6978c"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">3</span></p></td><td class="cl-b3f6978d"><p class="cl-b3f67e00"><span class="cl-b3f43bc2">German</span></p></td><td class="cl-b3f6978d"><p class="cl-b3f67e00"><span class="cl-b3f43bc2">Woman</span></p></td><td class="cl-b3f6978c"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">0</span></p></td><td class="cl-b3f69796"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">4</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b3f6976f"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">9</span></p></td><td class="cl-b3f69778"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">3</span></p></td><td class="cl-b3f69779"><p class="cl-b3f67e00"><span class="cl-b3f43bc2">Russian</span></p></td><td class="cl-b3f69779"><p class="cl-b3f67e00"><span class="cl-b3f43bc2">Woman</span></p></td><td class="cl-b3f69778"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">0</span></p></td><td class="cl-b3f69782"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b3f69783"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">10</span></p></td><td class="cl-b3f6978c"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">2</span></p></td><td class="cl-b3f6978d"><p class="cl-b3f67e00"><span class="cl-b3f43bc2">German</span></p></td><td class="cl-b3f6978d"><p class="cl-b3f67e00"><span class="cl-b3f43bc2">Man</span></p></td><td class="cl-b3f6978c"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">0</span></p></td><td class="cl-b3f69796"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">2</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b3f6976f"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">11</span></p></td><td class="cl-b3f69778"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">3</span></p></td><td class="cl-b3f69779"><p class="cl-b3f67e00"><span class="cl-b3f43bc2">Russian</span></p></td><td class="cl-b3f69779"><p class="cl-b3f67e00"><span class="cl-b3f43bc2">Man</span></p></td><td class="cl-b3f69778"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">0</span></p></td><td class="cl-b3f69782"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b3f69783"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">12</span></p></td><td class="cl-b3f6978c"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">2</span></p></td><td class="cl-b3f6978d"><p class="cl-b3f67e00"><span class="cl-b3f43bc2">German</span></p></td><td class="cl-b3f6978d"><p class="cl-b3f67e00"><span class="cl-b3f43bc2">Man</span></p></td><td class="cl-b3f6978c"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">0</span></p></td><td class="cl-b3f69796"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b3f6976f"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">13</span></p></td><td class="cl-b3f69778"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">3</span></p></td><td class="cl-b3f69779"><p class="cl-b3f67e00"><span class="cl-b3f43bc2">Russian</span></p></td><td class="cl-b3f69779"><p class="cl-b3f67e00"><span class="cl-b3f43bc2">Woman</span></p></td><td class="cl-b3f69778"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">0</span></p></td><td class="cl-b3f69782"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b3f69783"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">14</span></p></td><td class="cl-b3f6978c"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">2</span></p></td><td class="cl-b3f6978d"><p class="cl-b3f67e00"><span class="cl-b3f43bc2">Russian</span></p></td><td class="cl-b3f6978d"><p class="cl-b3f67e00"><span class="cl-b3f43bc2">Woman</span></p></td><td class="cl-b3f6978c"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">4</span></p></td><td class="cl-b3f69796"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">4</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b3f69797"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">15</span></p></td><td class="cl-b3f697a0"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">2</span></p></td><td class="cl-b3f697a1"><p class="cl-b3f67e00"><span class="cl-b3f43bc2">English</span></p></td><td class="cl-b3f697a1"><p class="cl-b3f67e00"><span class="cl-b3f43bc2">Man</span></p></td><td class="cl-b3f697a0"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">0</span></p></td><td class="cl-b3f697aa"><p class="cl-b3f67df6"><span class="cl-b3f43bc2">4</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>Since the data contains character variables, we need to factorize the data before we can analyse it further and we also remove the ID column.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb364"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb364-1"><a href="#cb364-1" aria-hidden="true" tabindex="-1"></a><span class="co"># factorize variables</span></span>
<span id="cb364-2"><a href="#cb364-2" aria-hidden="true" tabindex="-1"></a>countdata <span class="ot">&lt;-</span> countdata <span class="sc">%&gt;%</span></span>
<span id="cb364-3"><a href="#cb364-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>ID) <span class="sc">%&gt;%</span></span>
<span id="cb364-4"><a href="#cb364-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_if</span>(is.character, factor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb365"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb365-1"><a href="#cb365-1" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect data</span></span>
<span id="cb365-2"><a href="#cb365-2" aria-hidden="true" tabindex="-1"></a>countdata <span class="sc">%&gt;%</span></span>
<span id="cb365-3"><a href="#cb365-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb365-4"><a href="#cb365-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">15</span>) <span class="sc">%&gt;%</span></span>
<span id="cb365-5"><a href="#cb365-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">flextable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb365-6"><a href="#cb365-6" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">set_table_properties</span>(<span class="at">width =</span> .<span class="dv">75</span>, <span class="at">layout =</span> <span class="st">"autofit"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb365-7"><a href="#cb365-7" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">theme_zebra</span>() <span class="sc">%&gt;%</span></span>
<span id="cb365-8"><a href="#cb365-8" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">fontsize</span>(<span class="at">size =</span> <span class="dv">12</span>) <span class="sc">%&gt;%</span></span>
<span id="cb365-9"><a href="#cb365-9" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">fontsize</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">part =</span> <span class="st">"header"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb365-10"><a href="#cb365-10" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">align_text_col</span>(<span class="at">align =</span> <span class="st">"center"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb365-11"><a href="#cb365-11" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">set_caption</span>(<span class="at">caption =</span> <span class="st">"First 15 rows of the countdata data."</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb365-12"><a href="#cb365-12" aria-hidden="true" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">border_outer</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="tabwid"><style>.cl-b411bdb4{table-layout:auto;width:75%;}.cl-b40c5784{font-family:'DejaVu Sans';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b40c5798{font-family:'DejaVu Sans';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b40e91ac{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b40e91c0{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b40ea8b8{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b40ea8b9{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b40ea8c2{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b40ea8c3{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b40ea8c4{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b40ea8cc{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b40ea8cd{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b40ea8d6{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b40ea8d7{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b40ea8e0{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b40ea8e1{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b40ea8ea{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b40ea8eb{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b40ea8ec{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b40ea8f4{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b40ea8f5{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-b411bdb4"><thead><tr style="overflow-wrap:break-word;"><th class="cl-b40ea8b8"><p class="cl-b40e91ac"><span class="cl-b40c5784">Trial</span></p></th><th class="cl-b40ea8b9"><p class="cl-b40e91c0"><span class="cl-b40c5784">Language</span></p></th><th class="cl-b40ea8b9"><p class="cl-b40e91c0"><span class="cl-b40c5784">Gender</span></p></th><th class="cl-b40ea8c2"><p class="cl-b40e91ac"><span class="cl-b40c5784">UHM</span></p></th><th class="cl-b40ea8c3"><p class="cl-b40e91ac"><span class="cl-b40c5784">Shots</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-b40ea8c4"><p class="cl-b40e91ac"><span class="cl-b40c5798">3</span></p></td><td class="cl-b40ea8cc"><p class="cl-b40e91c0"><span class="cl-b40c5798">Russian</span></p></td><td class="cl-b40ea8cc"><p class="cl-b40e91c0"><span class="cl-b40c5798">Man</span></p></td><td class="cl-b40ea8cd"><p class="cl-b40e91ac"><span class="cl-b40c5798">0</span></p></td><td class="cl-b40ea8d6"><p class="cl-b40e91ac"><span class="cl-b40c5798">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b40ea8d7"><p class="cl-b40e91ac"><span class="cl-b40c5798">3</span></p></td><td class="cl-b40ea8e0"><p class="cl-b40e91c0"><span class="cl-b40c5798">Russian</span></p></td><td class="cl-b40ea8e0"><p class="cl-b40e91c0"><span class="cl-b40c5798">Man</span></p></td><td class="cl-b40ea8e1"><p class="cl-b40e91ac"><span class="cl-b40c5798">0</span></p></td><td class="cl-b40ea8ea"><p class="cl-b40e91ac"><span class="cl-b40c5798">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b40ea8c4"><p class="cl-b40e91ac"><span class="cl-b40c5798">3</span></p></td><td class="cl-b40ea8cc"><p class="cl-b40e91c0"><span class="cl-b40c5798">German</span></p></td><td class="cl-b40ea8cc"><p class="cl-b40e91c0"><span class="cl-b40c5798">Man</span></p></td><td class="cl-b40ea8cd"><p class="cl-b40e91ac"><span class="cl-b40c5798">0</span></p></td><td class="cl-b40ea8d6"><p class="cl-b40e91ac"><span class="cl-b40c5798">5</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b40ea8d7"><p class="cl-b40e91ac"><span class="cl-b40c5798">1</span></p></td><td class="cl-b40ea8e0"><p class="cl-b40e91c0"><span class="cl-b40c5798">German</span></p></td><td class="cl-b40ea8e0"><p class="cl-b40e91c0"><span class="cl-b40c5798">Man</span></p></td><td class="cl-b40ea8e1"><p class="cl-b40e91ac"><span class="cl-b40c5798">0</span></p></td><td class="cl-b40ea8ea"><p class="cl-b40e91ac"><span class="cl-b40c5798">3</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b40ea8c4"><p class="cl-b40e91ac"><span class="cl-b40c5798">1</span></p></td><td class="cl-b40ea8cc"><p class="cl-b40e91c0"><span class="cl-b40c5798">German</span></p></td><td class="cl-b40ea8cc"><p class="cl-b40e91c0"><span class="cl-b40c5798">Woman</span></p></td><td class="cl-b40ea8cd"><p class="cl-b40e91ac"><span class="cl-b40c5798">2</span></p></td><td class="cl-b40ea8d6"><p class="cl-b40e91ac"><span class="cl-b40c5798">6</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b40ea8d7"><p class="cl-b40e91ac"><span class="cl-b40c5798">3</span></p></td><td class="cl-b40ea8e0"><p class="cl-b40e91c0"><span class="cl-b40c5798">German</span></p></td><td class="cl-b40ea8e0"><p class="cl-b40e91c0"><span class="cl-b40c5798">Man</span></p></td><td class="cl-b40ea8e1"><p class="cl-b40e91ac"><span class="cl-b40c5798">1</span></p></td><td class="cl-b40ea8ea"><p class="cl-b40e91ac"><span class="cl-b40c5798">5</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b40ea8c4"><p class="cl-b40e91ac"><span class="cl-b40c5798">1</span></p></td><td class="cl-b40ea8cc"><p class="cl-b40e91c0"><span class="cl-b40c5798">Mandarin</span></p></td><td class="cl-b40ea8cc"><p class="cl-b40e91c0"><span class="cl-b40c5798">Man</span></p></td><td class="cl-b40ea8cd"><p class="cl-b40e91ac"><span class="cl-b40c5798">1</span></p></td><td class="cl-b40ea8d6"><p class="cl-b40e91ac"><span class="cl-b40c5798">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b40ea8d7"><p class="cl-b40e91ac"><span class="cl-b40c5798">3</span></p></td><td class="cl-b40ea8e0"><p class="cl-b40e91c0"><span class="cl-b40c5798">German</span></p></td><td class="cl-b40ea8e0"><p class="cl-b40e91c0"><span class="cl-b40c5798">Woman</span></p></td><td class="cl-b40ea8e1"><p class="cl-b40e91ac"><span class="cl-b40c5798">0</span></p></td><td class="cl-b40ea8ea"><p class="cl-b40e91ac"><span class="cl-b40c5798">4</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b40ea8c4"><p class="cl-b40e91ac"><span class="cl-b40c5798">3</span></p></td><td class="cl-b40ea8cc"><p class="cl-b40e91c0"><span class="cl-b40c5798">Russian</span></p></td><td class="cl-b40ea8cc"><p class="cl-b40e91c0"><span class="cl-b40c5798">Woman</span></p></td><td class="cl-b40ea8cd"><p class="cl-b40e91ac"><span class="cl-b40c5798">0</span></p></td><td class="cl-b40ea8d6"><p class="cl-b40e91ac"><span class="cl-b40c5798">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b40ea8d7"><p class="cl-b40e91ac"><span class="cl-b40c5798">2</span></p></td><td class="cl-b40ea8e0"><p class="cl-b40e91c0"><span class="cl-b40c5798">German</span></p></td><td class="cl-b40ea8e0"><p class="cl-b40e91c0"><span class="cl-b40c5798">Man</span></p></td><td class="cl-b40ea8e1"><p class="cl-b40e91ac"><span class="cl-b40c5798">0</span></p></td><td class="cl-b40ea8ea"><p class="cl-b40e91ac"><span class="cl-b40c5798">2</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b40ea8c4"><p class="cl-b40e91ac"><span class="cl-b40c5798">3</span></p></td><td class="cl-b40ea8cc"><p class="cl-b40e91c0"><span class="cl-b40c5798">Russian</span></p></td><td class="cl-b40ea8cc"><p class="cl-b40e91c0"><span class="cl-b40c5798">Man</span></p></td><td class="cl-b40ea8cd"><p class="cl-b40e91ac"><span class="cl-b40c5798">0</span></p></td><td class="cl-b40ea8d6"><p class="cl-b40e91ac"><span class="cl-b40c5798">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b40ea8d7"><p class="cl-b40e91ac"><span class="cl-b40c5798">2</span></p></td><td class="cl-b40ea8e0"><p class="cl-b40e91c0"><span class="cl-b40c5798">German</span></p></td><td class="cl-b40ea8e0"><p class="cl-b40e91c0"><span class="cl-b40c5798">Man</span></p></td><td class="cl-b40ea8e1"><p class="cl-b40e91ac"><span class="cl-b40c5798">0</span></p></td><td class="cl-b40ea8ea"><p class="cl-b40e91ac"><span class="cl-b40c5798">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b40ea8c4"><p class="cl-b40e91ac"><span class="cl-b40c5798">3</span></p></td><td class="cl-b40ea8cc"><p class="cl-b40e91c0"><span class="cl-b40c5798">Russian</span></p></td><td class="cl-b40ea8cc"><p class="cl-b40e91c0"><span class="cl-b40c5798">Woman</span></p></td><td class="cl-b40ea8cd"><p class="cl-b40e91ac"><span class="cl-b40c5798">0</span></p></td><td class="cl-b40ea8d6"><p class="cl-b40e91ac"><span class="cl-b40c5798">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b40ea8d7"><p class="cl-b40e91ac"><span class="cl-b40c5798">2</span></p></td><td class="cl-b40ea8e0"><p class="cl-b40e91c0"><span class="cl-b40c5798">Russian</span></p></td><td class="cl-b40ea8e0"><p class="cl-b40e91c0"><span class="cl-b40c5798">Woman</span></p></td><td class="cl-b40ea8e1"><p class="cl-b40e91ac"><span class="cl-b40c5798">4</span></p></td><td class="cl-b40ea8ea"><p class="cl-b40e91ac"><span class="cl-b40c5798">4</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-b40ea8eb"><p class="cl-b40e91ac"><span class="cl-b40c5798">2</span></p></td><td class="cl-b40ea8ec"><p class="cl-b40e91c0"><span class="cl-b40c5798">English</span></p></td><td class="cl-b40ea8ec"><p class="cl-b40e91c0"><span class="cl-b40c5798">Man</span></p></td><td class="cl-b40ea8f4"><p class="cl-b40e91ac"><span class="cl-b40c5798">0</span></p></td><td class="cl-b40ea8f5"><p class="cl-b40e91ac"><span class="cl-b40c5798">4</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>After the data is factorized, we can visualize the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb366"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb366-1"><a href="#cb366-1" aria-hidden="true" tabindex="-1"></a>countdata <span class="sc">%&gt;%</span></span>
<span id="cb366-2"><a href="#cb366-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># prepare data</span></span>
<span id="cb366-3"><a href="#cb366-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Language, Shots) <span class="sc">%&gt;%</span></span>
<span id="cb366-4"><a href="#cb366-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(Language) <span class="sc">%&gt;%</span></span>
<span id="cb366-5"><a href="#cb366-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Mean =</span> <span class="fu">round</span>(<span class="fu">mean</span>(Shots), <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb366-6"><a href="#cb366-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">SD =</span> <span class="fu">round</span>(<span class="fu">sd</span>(Shots), <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb366-7"><a href="#cb366-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># start plot</span></span>
<span id="cb366-8"><a href="#cb366-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Language, Shots, <span class="at">color =</span> Language, <span class="at">fill =</span> Language)) <span class="sc">+</span></span>
<span id="cb366-9"><a href="#cb366-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">trim=</span><span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"gray20"</span>)<span class="sc">+</span> </span>
<span id="cb366-10"><a href="#cb366-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width=</span><span class="fl">0.1</span>, <span class="at">fill=</span><span class="st">"white"</span>, <span class="at">color =</span> <span class="st">"gray20"</span>) <span class="sc">+</span></span>
<span id="cb366-11"><a href="#cb366-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y=</span><span class="sc">-</span><span class="dv">4</span>,<span class="at">label=</span><span class="fu">paste</span>(<span class="st">"mean: "</span>, Mean, <span class="at">sep =</span> <span class="st">""</span>)), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb366-12"><a href="#cb366-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y=</span><span class="sc">-</span><span class="dv">5</span>,<span class="at">label=</span><span class="fu">paste</span>(<span class="st">"SD: "</span>, SD, <span class="at">sep =</span> <span class="st">""</span>)), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb366-13"><a href="#cb366-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">rep</span>(<span class="st">"grey90"</span>,<span class="dv">4</span>)) <span class="sc">+</span> </span>
<span id="cb366-14"><a href="#cb366-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_set</span>(<span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb366-15"><a href="#cb366-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>, <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb366-16"><a href="#cb366-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb366-17"><a href="#cb366-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span> </span>
<span id="cb366-18"><a href="#cb366-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb366-19"><a href="#cb366-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Language"</span>, <span class="at">y =</span> <span class="st">"Shots"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/pmm3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The violin plots show that the English speakers drank more shots than speakers of other languages with Mandarin speakers drinking the fewest shots.</p>
<p>In the present case, we will a Boruta variable selection procedure to streamline the model fitting process. Thus, before fitting the model, we will test which variables have any kind of relationship with the dependent variable and therefore deserve to be evaluated in the regression modeling. As this is just an example, we will only consider variables which are deemed important and disregard both unimportant and tentative variables. We start the Boruta analysis by setting a seed and running an initial Boruta analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb367"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb367-1"><a href="#cb367-1" aria-hidden="true" tabindex="-1"></a><span class="co"># perform variable selection</span></span>
<span id="cb367-2"><a href="#cb367-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20191220</span>)</span>
<span id="cb367-3"><a href="#cb367-3" aria-hidden="true" tabindex="-1"></a>boruta <span class="ot">&lt;-</span> <span class="fu">Boruta</span>(UHM <span class="sc">~</span>.,<span class="at">data=</span>countdata)</span>
<span id="cb367-4"><a href="#cb367-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(boruta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Boruta performed 99 iterations in 13.2781467438 secs.
 1 attributes confirmed important: Shots;
 1 attributes confirmed unimportant: Gender;
 2 tentative attributes left: Language, Trial;</code></pre>
</div>
</div>
<p>As only Shots is confirmed as important, we will only check for the effect of Shots and include Language as a random effect in the regression modeling. Including Language as a random effect is probably not justified statistically (given that the Boruta analysis showed that it only has a tentative effect) but for theoretical reasons as the speakers are nested into Languages. Before we start with the modeling, however, we proceed by checking if the data does indeed approximate a Poisson distribution.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb369"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb369-1"><a href="#cb369-1" aria-hidden="true" tabindex="-1"></a><span class="co"># output the results</span></span>
<span id="cb369-2"><a href="#cb369-2" aria-hidden="true" tabindex="-1"></a>gf <span class="ot">=</span> <span class="fu">goodfit</span>(countdata<span class="sc">$</span>UHM,<span class="at">type=</span> <span class="st">"poisson"</span>, <span class="at">method=</span> <span class="st">"ML"</span>)</span>
<span id="cb369-3"><a href="#cb369-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gf, <span class="at">main=</span><span class="st">"Count data vs Poisson distribution"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/pmm5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The data does not perfectly match a distribution that would be expected if the data approximated a Poisson distribution. We will use a goodness-of-fit test to check if the data does indeed diverge significantly from being Poisson distributed. If the p-values of the goodness-of-fit test is smaller than .05, then the distribution of the data differs significantly from a Poisson distribution and, given the visualization is likely over-dispersed.</p>
<p>In case of overdispersion, we may have to use a quasi-Poisson or, even better, a negative binomial model but we will, for now continue with the Poisson model and perform diagnostics later to check if we have to switch to a more robust method. One effect of overdispersion is that the standard errors of a model are biased and quasi-Poisson models scale the standard errors to compensate bias. However, <span class="citation" data-cites="zuur2013beginner">Zuur, Hilbe, and Ieno</span> suggest to use negative-binomial model instead. This is so because the scaling of the standard errors performed by quasi-Poisson models only affects the significance of coefficients (the p-values) but it does not affect the coefficients which, however, may be affected themselves by overdispersion. Thus, the coefficients of Poisson as well as quasi-Poisson models (which are identical) may be unreliable when dealing with overdispersion. Negative binomial models, in contrast, include an additional dispersion or heterogeneity parameter which accommodates overdispersion better than merely scaling the standard errors <span class="citation" data-cites="zuur2013beginner">(see <a href="#ref-zuur2013beginner" role="doc-biblioref">Zuur, Hilbe, and Ieno, 21</a>)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb370"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb370-1"><a href="#cb370-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Goodness-of-fit test for poisson distribution

                           X^2 df                                     P(&gt; X^2)
Likelihood Ratio 153.422771085  5 0.000000000000000000000000000000249336691328</code></pre>
</div>
</div>
<p>The p-value is indeed smaller than .05 which means that we should indeed use a negative-binomial model rather than a Poisson model. We will ignore this, for now, and proceed to fit a Poisson mixed-effects model and check what happens if a Poisson model is fit to over-dispersed data.</p>
<section id="mixed-effects-poisson-regression" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="mixed-effects-poisson-regression">Mixed-Effects Poisson Regression</h3>
<p>In a first step, we create mixed-effect intercept-only baseline models and then test if including “Shots” significantly improves model fit and, thus, has a significant impact on the number of <em>uhms</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb372"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb372-1"><a href="#cb372-1" aria-hidden="true" tabindex="-1"></a><span class="co"># base-line mixed-model</span></span>
<span id="cb372-2"><a href="#cb372-2" aria-hidden="true" tabindex="-1"></a>m0.glmer <span class="ot">=</span> <span class="fu">glmer</span>(UHM <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Language), <span class="at">data =</span> countdata, <span class="at">family =</span> poisson,</span>
<span id="cb372-3"><a href="#cb372-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">control=</span><span class="fu">glmerControl</span>(<span class="at">optimizer=</span><span class="st">"bobyqa"</span>))</span>
<span id="cb372-4"><a href="#cb372-4" aria-hidden="true" tabindex="-1"></a><span class="co"># add Shots</span></span>
<span id="cb372-5"><a href="#cb372-5" aria-hidden="true" tabindex="-1"></a>m1.glmer <span class="ot">&lt;-</span> <span class="fu">update</span>(m0.glmer, .<span class="sc">~</span>.<span class="sc">+</span> Shots)</span>
<span id="cb372-6"><a href="#cb372-6" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(m1.glmer, <span class="at">test =</span> <span class="st">"Chi"</span>)           </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type II Wald chisquare tests)

Response: UHM
          Chisq Df             Pr(&gt;Chisq)    
Shots 321.24968  1 &lt; 0.000000000000000222 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>The ANOVA confirms that Shots have a significant impact on the number of instances of <em>uhm</em>. However, we get the warning that the fitted mixed model is (almost / near) singular. In such cases, the model should not be reported. As this is only an example, we will continue by having a look at the model summary.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb374"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb374-1"><a href="#cb374-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1.glmer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: poisson  ( log )
Formula: UHM ~ (1 | Language) + Shots
   Data: countdata
Control: glmerControl(optimizer = "bobyqa")

     AIC      BIC   logLik deviance df.resid 
  1041.8   1054.5   -517.9   1035.8      497 

Scaled residuals: 
         Min           1Q       Median           3Q          Max 
-1.509633852 -0.666423093 -0.592950422  0.586114082  4.338639382 

Random effects:
 Groups   Name        Variance Std.Dev.
 Language (Intercept) 0        0       
Number of obs: 500, groups:  Language, 4

Fixed effects:
                 Estimate    Std. Error   z value               Pr(&gt;|z|)    
(Intercept) -1.2789168850  0.0893313713 -14.31655 &lt; 0.000000000000000222 ***
Shots        0.2336279071  0.0130347699  17.92344 &lt; 0.000000000000000222 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
      (Intr)
Shots -0.806
optimizer (bobyqa) convergence code: 0 (OK)
boundary (singular) fit: see help('isSingular')</code></pre>
</div>
</div>
<p>The model summary confirms that the number of shots does have a significantly positive effect on the number of occurrences of <em>uhm</em>. Furthermore, the scaled residuals are distributed very unevenly which suggests overdispersion. Including Language as a random effect is not justified given that they have 0 variance and a standard deviation of 0 (which means that Language does not account for or explain any additional variance).</p>
<p>We now check if the model suffers from overdispersion following <span class="citation" data-cites="zuur2013beginner">Zuur, Hilbe, and Ieno (<a href="#ref-zuur2013beginner" role="doc-biblioref">138</a>)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb376"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb376-1"><a href="#cb376-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract pearson residuals</span></span>
<span id="cb376-2"><a href="#cb376-2" aria-hidden="true" tabindex="-1"></a>PearsonResiduals <span class="ot">&lt;-</span> <span class="fu">resid</span>(m1.glmer, <span class="at">type =</span> <span class="st">"pearson"</span>)</span>
<span id="cb376-3"><a href="#cb376-3" aria-hidden="true" tabindex="-1"></a><span class="co"># extract number of cases in model</span></span>
<span id="cb376-4"><a href="#cb376-4" aria-hidden="true" tabindex="-1"></a>Cases <span class="ot">&lt;-</span> <span class="fu">nrow</span>(countdata)</span>
<span id="cb376-5"><a href="#cb376-5" aria-hidden="true" tabindex="-1"></a><span class="co"># extract number of predictors (plus intercept)</span></span>
<span id="cb376-6"><a href="#cb376-6" aria-hidden="true" tabindex="-1"></a>NumberOfPredictors <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">fixef</span>(m1.glmer)) <span class="sc">+</span><span class="dv">1</span></span>
<span id="cb376-7"><a href="#cb376-7" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate overdispersion</span></span>
<span id="cb376-8"><a href="#cb376-8" aria-hidden="true" tabindex="-1"></a>Overdispersion <span class="ot">&lt;-</span> <span class="fu">sum</span>(PearsonResiduals<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (Cases<span class="sc">-</span>NumberOfPredictors)</span>
<span id="cb376-9"><a href="#cb376-9" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect overdispersion</span></span>
<span id="cb376-10"><a href="#cb376-10" aria-hidden="true" tabindex="-1"></a>Overdispersion</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.16901460967</code></pre>
</div>
</div>
<p>The data is slightly over-dispersed. It would also be advisable to plot the Cook’s distance (which should not show data points with values &gt; 1). If there are data points with high Cook’s D values, we could exclude them which would, very likely reduce the overdispersion <span class="citation" data-cites="zuur2013beginner">(see <a href="#ref-zuur2013beginner" role="doc-biblioref">Zuur, Hilbe, and Ieno, 22</a>)</span>. We ignore this, for now, and use diagnostic plots to check if the plots indicate problems.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb378"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb378-1"><a href="#cb378-1" aria-hidden="true" tabindex="-1"></a>diag_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(PearsonResiduals, <span class="fu">fitted</span>(m1.glmer)) <span class="sc">%&gt;%</span></span>
<span id="cb378-2"><a href="#cb378-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Pearson =</span> <span class="dv">1</span>,</span>
<span id="cb378-3"><a href="#cb378-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">Fitted =</span> <span class="dv">2</span>)</span>
<span id="cb378-4"><a href="#cb378-4" aria-hidden="true" tabindex="-1"></a>p9 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(diag_data, <span class="fu">aes</span>(<span class="at">x =</span> Fitted, <span class="at">y =</span> Pearson)) <span class="sc">+</span></span>
<span id="cb378-5"><a href="#cb378-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb378-6"><a href="#cb378-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>)</span>
<span id="cb378-7"><a href="#cb378-7" aria-hidden="true" tabindex="-1"></a>p10 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(countdata, <span class="fu">aes</span>(<span class="at">x =</span> Shots, <span class="at">y =</span> diag_data<span class="sc">$</span>Pearson)) <span class="sc">+</span></span>
<span id="cb378-8"><a href="#cb378-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()  <span class="sc">+</span></span>
<span id="cb378-9"><a href="#cb378-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb378-10"><a href="#cb378-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Pearson"</span>)</span>
<span id="cb378-11"><a href="#cb378-11" aria-hidden="true" tabindex="-1"></a>p11 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(countdata, <span class="fu">aes</span>(<span class="at">x =</span> Language, <span class="at">y =</span> diag_data<span class="sc">$</span>Pearson)) <span class="sc">+</span></span>
<span id="cb378-12"><a href="#cb378-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb378-13"><a href="#cb378-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Pearson"</span>) <span class="sc">+</span> </span>
<span id="cb378-14"><a href="#cb378-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>))</span>
<span id="cb378-15"><a href="#cb378-15" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(p9, p10, p11, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/pmm10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The diagnostic plots show problems as the dots in the first two plots are not random but show a pattern in the lower left corner. In addition, the variance of English (left boxplot) is notable larger than the variance of Russian (right boxplot). As a final step, we plot the predicted vales of the model to check if the predictions make sense.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb379"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb379-1"><a href="#cb379-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m1.glmer, <span class="at">type =</span> <span class="st">"pred"</span>, <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"Shots"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/pmm11b-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The model predicts that the instances of <em>uhm</em> increase with the number of shots. Note that the increase is not homogeneous as the y-axis labels indicate! We now compare the predicted number of <em>uhm</em> with the actually observed instances of <em>uhm</em> to check if the results of the model make sense.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb380"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb380-1"><a href="#cb380-1" aria-hidden="true" tabindex="-1"></a>countdata <span class="sc">%&gt;%</span></span>
<span id="cb380-2"><a href="#cb380-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Predicted =</span> <span class="fu">predict</span>(m1.glmer, <span class="at">type =</span> <span class="st">"response"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb380-3"><a href="#cb380-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Observed =</span> UHM) <span class="sc">%&gt;%</span></span>
<span id="cb380-4"><a href="#cb380-4" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">gather</span>(Type, Frequency, <span class="fu">c</span>(Observed, Predicted)) <span class="sc">%&gt;%</span></span>
<span id="cb380-5"><a href="#cb380-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Shots =</span> <span class="fu">factor</span>(Shots),</span>
<span id="cb380-6"><a href="#cb380-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">Type =</span> <span class="fu">factor</span>(Type)) <span class="sc">%&gt;%</span></span>
<span id="cb380-7"><a href="#cb380-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(Shots, Type) <span class="sc">%&gt;%</span></span>
<span id="cb380-8"><a href="#cb380-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">Frequency =</span> <span class="fu">mean</span>(Frequency)) <span class="sc">%&gt;%</span></span>
<span id="cb380-9"><a href="#cb380-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Shots, Frequency, <span class="at">group =</span> Type, <span class="at">color =</span> Type, <span class="at">linetype =</span> Type)) <span class="sc">+</span></span>
<span id="cb380-10"><a href="#cb380-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb380-11"><a href="#cb380-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"orange"</span>, <span class="st">"lightblue"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/pmm11f-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The comparison between the observed and the predicted uses of <em>uhm</em> becomes somewhat volatile and shows fluctuations after eight shots. We will now summarize the results as if the violations (overdispersion measure &gt; 1 and excessive multicollinearity (singular fit)) had NOT occurred(!) - again: this is only because we are practicing here - this would be absolutely unacceptable in a proper write-up of an analysis!</p>
<p>The summary of the model can be extracted using the tab_model function from the <code>sjPlot</code> package <span class="citation" data-cites="sjPlot">(<a href="#ref-sjPlot" role="doc-biblioref">Lüdecke</a>)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb381"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb381-1"><a href="#cb381-1" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(m1.glmer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">UHM</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Incidence Rate Ratios</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.28</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.23&nbsp;–&nbsp;0.33</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Shots</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.26</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.23&nbsp;–&nbsp;1.30</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>Language</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.00</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>Language</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">4</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">500</td>
</tr>

</tbody></table>

</div>
</div>
<hr>
<p><br></p>
<div class="warning" style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
<b>NOTE</b><br><br>The R<sup>2</sup> values of the summary table are incorrect (as indicated by the missing conditional R<sup>2</sup> value). The more appropriate conditional and marginal coefficient of determination for generalized mixed-effect models can be extracted using the <code>r.squaredGLMM</code> function from the <code>MuMIn</code> package <span class="citation" data-cites="MuMIn">(<a href="#ref-MuMIn" role="doc-biblioref">Barton 2020</a>)</span>.
</p>
<p style="margin-left:1em;">
</p>
<p></p>
</span></div>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb382"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb382-1"><a href="#cb382-1" aria-hidden="true" tabindex="-1"></a><span class="fu">r.squaredGLMM</span>(m1.glmer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     R2m            R2c
delta     0.208910674745 0.208910674745
lognormal 0.294971460548 0.294971460548
trigamma  0.120419614835 0.120419614835</code></pre>
</div>
</div>
<p>Also note that our model suffers from a serious problem (near singular fit). If this were not just an example, you should not(!) report this model!</p>
</section>
<section id="mixed-effects-quasi-possion-regression" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="mixed-effects-quasi-possion-regression">Mixed-Effects Quasi-Possion Regression</h3>
<p>The Quasi-Poisson Regression is a generalization of the Poisson regression and is used when modeling an overdispersed count variable. Poisson models are based on the Poisson distribution which is defined as a distribution where the variance is equal to the mean (which is very restrictive and not often the case). Quasi-Poisson models scale the standard errors which has a positive effect when dealing with overdispersed data.</p>
<p>Therefore, when the variance is greater than the mean, a Quasi-Poisson model, which assumes that the variance is a linear function of the mean, is more appropriate as it handles over-dispersed data better than normal Poisson-models.</p>
<p>We begin the model fitting process by creating a mixed- and a fixed-effects intercept-only base-line model. Unfortunately, there is not yet a procedure in place for quasi-Poisson models to test if the inclusion of random effects is justified. However, here the Boruta also provides valuable information: Language was only considered tentative but not important which suggests that it will not explain variance which means that including Language as a random effect may not be justified. This would require further inspection. Because we are only dealing with an example here, we ignore this fact (which you should not do in proper analyses) and continue right away with adding shots.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb384"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb384-1"><a href="#cb384-1" aria-hidden="true" tabindex="-1"></a><span class="co"># base-line mixed-model</span></span>
<span id="cb384-2"><a href="#cb384-2" aria-hidden="true" tabindex="-1"></a>m0.qp <span class="ot">=</span> <span class="fu">glmmPQL</span>(UHM <span class="sc">~</span> <span class="dv">1</span>, <span class="at">random =</span> <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Language, <span class="at">data =</span> countdata, </span>
<span id="cb384-3"><a href="#cb384-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">quasipoisson</span>(<span class="at">link=</span><span class="st">'log'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>iteration 1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>iteration 2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>iteration 3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>iteration 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb389"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb389-1"><a href="#cb389-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add Shots</span></span>
<span id="cb389-2"><a href="#cb389-2" aria-hidden="true" tabindex="-1"></a>m1.qp <span class="ot">&lt;-</span> <span class="fu">update</span>(m0.qp, .<span class="sc">~</span>.<span class="sc">+</span> Shots)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>iteration 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb391"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb391-1"><a href="#cb391-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(m1.qp, <span class="at">test =</span> <span class="st">"Chi"</span>)           <span class="co"># SIG! (p&lt;0.0000000000000002 ***)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type II tests)

Response: zz
         Chisq Df             Pr(&gt;Chisq)    
Shots 276.4523  1 &lt; 0.000000000000000222 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>The ANOVA confirms that Shots have a significant impact on the number of instances of <em>uhm</em>. We will now have a look at the model summary.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb393"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb393-1"><a href="#cb393-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1.qp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed-effects model fit by maximum likelihood
  Data: countdata 
  AIC BIC logLik
   NA  NA     NA

Random effects:
 Formula: ~1 | Language
               (Intercept)      Residual
StdDev: 0.0000407595004855 1.07801257915

Variance function:
 Structure: fixed weights
 Formula: ~invwt 
Fixed effects:  UHM ~ Shots 
                      Value       Std.Error  DF        t-value p-value
(Intercept) -1.278929721022 0.0964886326643 495 -13.2547190867       0
Shots        0.233630231741 0.0140795660799 495  16.5935676153       0
 Correlation: 
      (Intr)
Shots -0.806

Standardized Within-Group Residuals:
            Min              Q1             Med              Q3             Max 
-1.400417640404 -0.618228066949 -0.550071160973  0.543731905024  4.024828853746 

Number of Observations: 500
Number of Groups: 4 </code></pre>
</div>
</div>
<p>The model summary does not provide much information such as,e.g.&nbsp;AIC or BIC values. The coefficient for <em>Shots</em> is highly significant (p &lt;.001) and the data is notably over-dispersed (the Standardized Within-Group Residuals deviate substantially from a normal distribution with higher values having a thick tail). Also, in contrast to the Poisson model, Language does explain at least a minimal share of the variance now as the mean and standard deviation are no longer 0. Note also, that the coefficients are identical to the Poisson coefficients but the standard errors and p-values differ (the model provides t- rather than z-values).</p>
<p>In a next step, we will calculate the odds ratios of the coefficient (as we only have one). We will use the coefficients from the fixed-effects model as the coefficients for mixed- and fixed-effects models are identical (the random effect structure only affects the standard error and p-values but not the coefficients; you can check by uncommenting the summary command).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb395"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb395-1"><a href="#cb395-1" aria-hidden="true" tabindex="-1"></a>m1.glm <span class="ot">=</span> <span class="fu">glm</span>(UHM <span class="sc">~</span> Shots, <span class="at">data =</span> countdata, <span class="at">family =</span> <span class="fu">quasipoisson</span>(<span class="at">link=</span><span class="st">'log'</span>))</span>
<span id="cb395-2"><a href="#cb395-2" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(m1.glm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   (Intercept)          Shots 
0.278338612235 1.263174385573 </code></pre>
</div>
</div>
<p>The standardized or <span class="math inline">\(\beta\)</span>-coefficient tells us that the likelihood of <em>uhm</em> increases by 1.26 (or 26.32 percent) with each additional shot.</p>
<p>Before inspecting the relationship between Shots and <em>uhm</em>, we will check if the overdispersion was reduced.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb397"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb397-1"><a href="#cb397-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract pearson residuals</span></span>
<span id="cb397-2"><a href="#cb397-2" aria-hidden="true" tabindex="-1"></a>PearsonResiduals <span class="ot">&lt;-</span> <span class="fu">resid</span>(m1.qp, <span class="at">type =</span> <span class="st">"pearson"</span>)</span>
<span id="cb397-3"><a href="#cb397-3" aria-hidden="true" tabindex="-1"></a><span class="co"># extract number of cases in model</span></span>
<span id="cb397-4"><a href="#cb397-4" aria-hidden="true" tabindex="-1"></a>Cases <span class="ot">&lt;-</span> <span class="fu">nrow</span>(countdata)</span>
<span id="cb397-5"><a href="#cb397-5" aria-hidden="true" tabindex="-1"></a><span class="co"># extract number of predictors (plus intercept)</span></span>
<span id="cb397-6"><a href="#cb397-6" aria-hidden="true" tabindex="-1"></a>NumberOfPredictors <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">fixef</span>(m1.qp)) <span class="sc">+</span><span class="dv">1</span></span>
<span id="cb397-7"><a href="#cb397-7" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate overdispersion</span></span>
<span id="cb397-8"><a href="#cb397-8" aria-hidden="true" tabindex="-1"></a>Overdispersion <span class="ot">&lt;-</span> <span class="fu">sum</span>(PearsonResiduals<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (Cases<span class="sc">-</span>NumberOfPredictors)</span>
<span id="cb397-9"><a href="#cb397-9" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect overdispersion</span></span>
<span id="cb397-10"><a href="#cb397-10" aria-hidden="true" tabindex="-1"></a>Overdispersion</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.00603621722</code></pre>
</div>
</div>
<p>The overdispersion has indeed decreased and is not so close to 1 that overdispersion is no longer an issue.</p>
<p>We continue to diagnose the model by plotting the Pearson’s residuals against fitted values. This diagnostic plot should not show a funnel-like structure or patterning as we observed in the case of the Poisson model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb399"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb399-1"><a href="#cb399-1" aria-hidden="true" tabindex="-1"></a><span class="co"># diagnostic plot</span></span>
<span id="cb399-2"><a href="#cb399-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m1.qp, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lty=</span> <span class="st">"dotted"</span>, <span class="at">ylab =</span> <span class="st">"Pearson's residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/qpmm5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Indeed, the plot exhibits a (slight) funnel shape (but not drastically so) and thus indicates heteroscedasticity. However, the patterning that we observed with the Poisson model has disappeared. We continue by plotting the random effect adjustments.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb400"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb400-1"><a href="#cb400-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate diagnostic plots</span></span>
<span id="cb400-2"><a href="#cb400-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m1.qp, Language <span class="sc">~</span> <span class="fu">resid</span>(.), <span class="at">abline =</span> <span class="dv">0</span>, <span class="at">fill =</span> <span class="st">"gray70"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/qpmm10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The adjustments by “Language” are marginal (which was somewhat expected given that Language was only deemed tentative), which shows that there is very little variation between the languages and that we have no statistical reason to include Language as a random effect.</p>
<p>In a final step, we plot the fixed-effect of <em>Shots</em> using the <code>predictorEffects</code> function from the <code>effects</code> package <span class="citation" data-cites="effects">(<a href="#ref-effects" role="doc-biblioref">Fox and Weisberg 2019</a>)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb401"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb401-1"><a href="#cb401-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m1.qp, <span class="at">type =</span> <span class="st">"pred"</span>, <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"Shots"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/qpmm11b-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The effects plot shows that the number of <em>uhms</em> increases exponentially with the number of shots a speaker has had. We now compare the predicted number of <em>uhm</em> with the actually observed instances of <em>uhm</em> to check if the results of the model make sense.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb402"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb402-1"><a href="#cb402-1" aria-hidden="true" tabindex="-1"></a>countdata <span class="sc">%&gt;%</span></span>
<span id="cb402-2"><a href="#cb402-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Predicted =</span> <span class="fu">predict</span>(m1.qp, <span class="at">type =</span> <span class="st">"response"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb402-3"><a href="#cb402-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Observed =</span> UHM) <span class="sc">%&gt;%</span></span>
<span id="cb402-4"><a href="#cb402-4" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">gather</span>(Type, Frequency, <span class="fu">c</span>(Observed, Predicted)) <span class="sc">%&gt;%</span></span>
<span id="cb402-5"><a href="#cb402-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Shots =</span> <span class="fu">factor</span>(Shots),</span>
<span id="cb402-6"><a href="#cb402-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">Type =</span> <span class="fu">factor</span>(Type)) <span class="sc">%&gt;%</span></span>
<span id="cb402-7"><a href="#cb402-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(Shots, Type) <span class="sc">%&gt;%</span></span>
<span id="cb402-8"><a href="#cb402-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">Frequency =</span> <span class="fu">mean</span>(Frequency)) <span class="sc">%&gt;%</span></span>
<span id="cb402-9"><a href="#cb402-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Shots, Frequency, <span class="at">group =</span> Type, <span class="at">color =</span> Type, <span class="at">linetype =</span> Type)) <span class="sc">+</span></span>
<span id="cb402-10"><a href="#cb402-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb402-11"><a href="#cb402-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"orange"</span>, <span class="st">"lightblue"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/qpmm11f-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Given that the overdispersion measure of this Quasi-Poisson model is close to 1, that the model did not suffer from excessive multicollinearity (singular fit), and because this model shows improvements compared to the Poisson model with respect to the model diagnostics (some adjustments by Language and less patterning in the diagnostic plots), we would choose this quasi-Poisson model over the Poisson model.</p>
<p>Finally, we extract the summary table of this model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb403"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb403-1"><a href="#cb403-1" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(m1.qp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">UHM</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Incidence Rate Ratios</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.28</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.23&nbsp;–&nbsp;0.34</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Shots</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.26</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.23&nbsp;–&nbsp;1.30</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.00</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>Language</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.00</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>Language</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">4</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">500</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">1.000 / NA</td>
</tr>

</tbody></table>

</div>
</div>
<hr>
<p><br></p>
<div class="warning" style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
<b>NOTE</b><br><br>The R<sup>2</sup> values of the summary table are incorrect (as indicated by the missing conditional R<sup>2</sup> value). The more appropriate conditional and marginal coefficient of determination for generalized mixed-effect models can be extracted using the <code>r.squaredGLMM</code> function from the <code>MuMIn</code> package <span class="citation" data-cites="MuMIn">(<a href="#ref-MuMIn" role="doc-biblioref">Barton 2020</a>)</span>.
</p>
<p style="margin-left:1em;">
</p>
<p></p>
</span></div>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb404"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb404-1"><a href="#cb404-1" aria-hidden="true" tabindex="-1"></a><span class="fu">r.squaredGLMM</span>(m1.qp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      R2m             R2c
delta     0.1856941878845 0.1856941887428
lognormal 0.2752763979322 0.2752763992045
trigamma  0.0977040663474 0.0977040667989</code></pre>
</div>
</div>
</section>
<section id="mixed-effects-negative-binomial-regression" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="mixed-effects-negative-binomial-regression">Mixed-Effects Negative Binomial Regression</h3>
<p>Negative binomial regression models are a generalization of Poisson regression which loosens the restrictive assumption that the variance is equal to the mean made by the Poisson model. This is a major advantage as the most common issue that one faces with Poisson regressions is that the data deviate too substantially from the assumed Poisson distribution.</p>
<p>To implement a Negative-Binomial Mixed-Effects Regression, we first create a mixed-effects intercept-only baseline model and then test if including <code>Shots</code> significantly improves model fit and, thus, has a significant impact on the number of <em>uhms</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb406"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb406-1"><a href="#cb406-1" aria-hidden="true" tabindex="-1"></a><span class="co"># base-line mixed-model</span></span>
<span id="cb406-2"><a href="#cb406-2" aria-hidden="true" tabindex="-1"></a>m0.nb <span class="ot">=</span> <span class="fu">glmer.nb</span>(UHM <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Language), <span class="at">data =</span> countdata)</span>
<span id="cb406-3"><a href="#cb406-3" aria-hidden="true" tabindex="-1"></a><span class="co"># add Shots</span></span>
<span id="cb406-4"><a href="#cb406-4" aria-hidden="true" tabindex="-1"></a>m1.nb <span class="ot">&lt;-</span> <span class="fu">update</span>(m0.nb, .<span class="sc">~</span>.<span class="sc">+</span> Shots)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb408"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb408-1"><a href="#cb408-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m1.nb, m0.nb)           </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: countdata
Models:
m0.nb: UHM ~ 1 + (1 | Language)
m1.nb: UHM ~ (1 | Language) + Shots
      npar         AIC         BIC       logLik    deviance     Chisq Df
m0.nb    3 1159.000894 1171.644718 -576.5004470 1153.000894             
m1.nb    4 1051.593288 1068.451721 -521.7966442 1043.593288 109.40761  1
                  Pr(&gt;Chisq)    
m0.nb                           
m1.nb &lt; 0.000000000000000222 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>The negative-binomial model also reports a significant impact of shots on the number of <em>uhms</em>. In a next step, we calculate the overdispersion.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb410"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb410-1"><a href="#cb410-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract pearson residuals</span></span>
<span id="cb410-2"><a href="#cb410-2" aria-hidden="true" tabindex="-1"></a>PearsonResiduals <span class="ot">&lt;-</span> <span class="fu">resid</span>(m1.nb, <span class="at">type =</span> <span class="st">"pearson"</span>)</span>
<span id="cb410-3"><a href="#cb410-3" aria-hidden="true" tabindex="-1"></a><span class="co"># extract number of betas + predictors + sigma</span></span>
<span id="cb410-4"><a href="#cb410-4" aria-hidden="true" tabindex="-1"></a>NumberOfPredictors <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">+</span><span class="dv">1</span><span class="sc">+</span><span class="dv">1</span></span>
<span id="cb410-5"><a href="#cb410-5" aria-hidden="true" tabindex="-1"></a><span class="co"># extract number of cases in model</span></span>
<span id="cb410-6"><a href="#cb410-6" aria-hidden="true" tabindex="-1"></a>Cases <span class="ot">&lt;-</span> <span class="fu">nrow</span>(countdata)</span>
<span id="cb410-7"><a href="#cb410-7" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate overdispersion parameter</span></span>
<span id="cb410-8"><a href="#cb410-8" aria-hidden="true" tabindex="-1"></a>Overdispersion <span class="ot">&lt;-</span> <span class="fu">sum</span>(PearsonResiduals<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (Cases <span class="sc">/</span> NumberOfPredictors)<span class="co"># show overdispersion parameter</span></span>
<span id="cb410-9"><a href="#cb410-9" aria-hidden="true" tabindex="-1"></a>Overdispersion</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.46949245808</code></pre>
</div>
</div>
<p>The overdispersion has increased which is rather suboptimal. In this case, we would report the Quasi-Poisson Regression rather than the Negative Binomial Model (which is rather rare as Negative Binomial Models typically perform better than (Quasi-)Poisson models. However, this tutorial focuses merely on how to implement a Negative Binomial Mixed-Effects Regression and we thus continue with generating diagnostic plots to check for problems.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb412"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb412-1"><a href="#cb412-1" aria-hidden="true" tabindex="-1"></a>diag_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(PearsonResiduals, <span class="fu">fitted</span>(m1.nb)) <span class="sc">%&gt;%</span></span>
<span id="cb412-2"><a href="#cb412-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Pearson =</span> <span class="dv">1</span>,</span>
<span id="cb412-3"><a href="#cb412-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">Fitted =</span> <span class="dv">2</span>)</span>
<span id="cb412-4"><a href="#cb412-4" aria-hidden="true" tabindex="-1"></a>p9 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(diag_data, <span class="fu">aes</span>(<span class="at">x =</span> Fitted, <span class="at">y =</span> Pearson)) <span class="sc">+</span></span>
<span id="cb412-5"><a href="#cb412-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb412-6"><a href="#cb412-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>)</span>
<span id="cb412-7"><a href="#cb412-7" aria-hidden="true" tabindex="-1"></a>p10 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(countdata, <span class="fu">aes</span>(<span class="at">x =</span> Shots, <span class="at">y =</span> diag_data<span class="sc">$</span>Pearson)) <span class="sc">+</span></span>
<span id="cb412-8"><a href="#cb412-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()  <span class="sc">+</span></span>
<span id="cb412-9"><a href="#cb412-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb412-10"><a href="#cb412-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Pearson"</span>)</span>
<span id="cb412-11"><a href="#cb412-11" aria-hidden="true" tabindex="-1"></a>p11 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(countdata, <span class="fu">aes</span>(<span class="at">x =</span> Language, <span class="at">y =</span> diag_data<span class="sc">$</span>Pearson)) <span class="sc">+</span></span>
<span id="cb412-12"><a href="#cb412-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb412-13"><a href="#cb412-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Pearson"</span>) <span class="sc">+</span> </span>
<span id="cb412-14"><a href="#cb412-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">90</span>))</span>
<span id="cb412-15"><a href="#cb412-15" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(p9, p10, p11, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/nbmm4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The diagnostics show patterning similar to the one we saw with the Poisson model which suggest that the negative binomial model is also not an optimal model for our data. We continue by plotting the predicted values and, subsequently, summarize the analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb413"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb413-1"><a href="#cb413-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m1.nb, <span class="at">type =</span> <span class="st">"pred"</span>, <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"Shots"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/nbmm6b-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The effect plot shows that the predicted number of shots increases exponentially with each shot. We now compare the predicted number of <em>uhm</em> with the actually observed instances of <em>uhm</em> to check if the results of the model make sense.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb414"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb414-1"><a href="#cb414-1" aria-hidden="true" tabindex="-1"></a>countdata <span class="sc">%&gt;%</span></span>
<span id="cb414-2"><a href="#cb414-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Predicted =</span> <span class="fu">predict</span>(m1.nb, <span class="at">type =</span> <span class="st">"response"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb414-3"><a href="#cb414-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Observed =</span> UHM) <span class="sc">%&gt;%</span></span>
<span id="cb414-4"><a href="#cb414-4" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">gather</span>(Type, Frequency, <span class="fu">c</span>(Observed, Predicted)) <span class="sc">%&gt;%</span></span>
<span id="cb414-5"><a href="#cb414-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Shots =</span> <span class="fu">factor</span>(Shots),</span>
<span id="cb414-6"><a href="#cb414-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">Type =</span> <span class="fu">factor</span>(Type)) <span class="sc">%&gt;%</span></span>
<span id="cb414-7"><a href="#cb414-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(Shots, Type) <span class="sc">%&gt;%</span></span>
<span id="cb414-8"><a href="#cb414-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">Frequency =</span> <span class="fu">mean</span>(Frequency)) <span class="sc">%&gt;%</span></span>
<span id="cb414-9"><a href="#cb414-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Shots, Frequency, <span class="at">group =</span> Type, <span class="at">color =</span> Type, <span class="at">linetype =</span> Type)) <span class="sc">+</span></span>
<span id="cb414-10"><a href="#cb414-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb414-11"><a href="#cb414-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"orange"</span>, <span class="st">"lightblue"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/nbmm6f-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The comparison between the observed and the predicted uses of <em>uhm</em> becomes somewhat volatile and shows fluctuations after eight shots. We will now summarize the results as if the violations had NOT occurred(!) - again: this is only because we are practicing here - this would be absolutely unacceptable in a proper write-up of an analysis!</p>
<p>A mixed-effect negative binomial regression model which contained the language in which the conversation took place as random effect was fit to the data. Prior to the regression modeling, a Boruta analysis was applied to determine whether any of the predictors had a meaningful relationship with the dependent variable (instances of <em>uhm</em>). Since the Boruta analysis indicated that only the number of shots a speaker had was important, only “Shots” was tested during model fitting. The final minimal adequate model showed that the number of <em>uhm</em> as fillers increases significantly, and near-linearly with the number of shots speakers had (<span class="math inline">\(\chi\)</span><sup>2</sup>(1):83.0, p &lt;.0001, <span class="math inline">\(\beta\)</span>: 0.2782). An inspection of the random effect structure conveyed that there was almost no variability between languages and language did not contribute meaningfully to the model fit.</p>
</section>
</section>
<section id="mixed-effects-multinomial-regression" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="mixed-effects-multinomial-regression">Mixed-Effects Multinomial Regression</h2>
<p>In this section, we will focus on how to implement a mixed-effects multinomial regression model using the <code>mblogit</code> function from the <code>mclogit</code> package <span class="citation" data-cites="mclogit">(see <a href="#ref-mclogit" role="doc-biblioref">Elff 2021</a>)</span>. As we have already gone though model fitting and model validation procedures above, we will strictly see how to implement this type of model here - we will not go through all the other steps that a proper regression analysis would require.</p>
<p>We begin the analysis by loading the example data set. The data represents observations gathered during an experiment where speakers had to report what they saw. The responses are categorized into four groups:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb415"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb415-1"><a href="#cb415-1" aria-hidden="true" tabindex="-1"></a><span class="co"># description data</span></span>
<span id="cb415-2"><a href="#cb415-2" aria-hidden="true" tabindex="-1"></a>pict  <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="st">"tutorials/regression/data/pict.rda"</span>, <span class="st">"rb"</span>)</span>
<span id="cb415-3"><a href="#cb415-3" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb415-4"><a href="#cb415-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Id Participant       Group Item     Response Gender Age
1  1        G001 German_Mono    1  NumeralNoun   Male  18
2  2        G002 German_Mono    3  NumeralNoun   Male  18
3  3        G003 German_Mono    4  NumeralNoun   Male  18
4  4        G004 German_Mono    6 QuantAdjNoun   Male  18
5  5        G005 German_Mono    8  NumeralNoun   Male  18
6  6        G006 German_Mono    9 QuantAdjNoun   Male  18</code></pre>
</div>
</div>
<p>In a first step, we generate a baseline model that we call <code>m0</code>. This model only contains the random effect structure and the intercept as the sole predictor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb417"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb417-1"><a href="#cb417-1" aria-hidden="true" tabindex="-1"></a>m0.mn <span class="ot">&lt;-</span> <span class="fu">mblogit</span>(<span class="at">formula =</span> Response <span class="sc">~</span> <span class="dv">1</span>, </span>
<span id="cb417-2"><a href="#cb417-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">random =</span> <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Participant, </span>
<span id="cb417-3"><a href="#cb417-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> pict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Iteration 1 - deviance = 2452.1657181 - criterion = 0.840346812538</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Iteration 2 - deviance = 2412.75547123 - criterion = 0.064601361276</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Iteration 3 - deviance = 2411.26894466 - criterion = 0.00534731178399</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Iteration 4 - deviance = 2411.2582473 - criterion = 0.0000446387422433</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Iteration 5 - deviance = 2411.25823534 - criterion = 0.00000000314059538387
converged</code></pre>
</div>
</div>
<p>In this case, the algorithm did not converge properly - if this were a real analysis, we could not simply continue but would have to inspect possible causes for this. However, as this is just a showcase, we will ignore this and move on. Next, we add the fixed effects (Gender and Group).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb423"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb423-1"><a href="#cb423-1" aria-hidden="true" tabindex="-1"></a>m1.mn <span class="ot">&lt;-</span> <span class="fu">mblogit</span>(<span class="at">formula =</span> Response <span class="sc">~</span> Gender <span class="sc">+</span> Group, </span>
<span id="cb423-2"><a href="#cb423-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">random =</span> <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> Item, </span>
<span id="cb423-3"><a href="#cb423-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> pict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Iteration 1 - deviance = 1652.54499424 - criterion = 0.800708039017</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Iteration 2 - deviance = 1571.22116522 - criterion = 0.0814899820197</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Iteration 3 - deviance = 1551.91023391 - criterion = 0.0274469746195</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Iteration 4 - deviance = 1547.29823345 - criterion = 0.00512667078353</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Iteration 5 - deviance = 1546.02170442 - criterion = 0.000173543402508</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Iteration 6 - deviance = 1545.8333116 - criterion = 0.00000024492639907</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Iteration 7 - deviance = 1545.82769259 - criterion = 0.000000000000785571393367
converged</code></pre>
</div>
</div>
<p>Now, we can compare the models to see if including the fixed-effects into the model has significantly improved the model fit.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb431"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb431-1"><a href="#cb431-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m0.mn, m1.mn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: Response ~ 1
Model 2: Response ~ Gender + Group
  Resid. Df  Resid. Dev Df    Deviance
1      3261 2411.258235               
2      3249 1545.827693 12 865.4305427</code></pre>
</div>
</div>
<p>As the second model is significantly better, we are justified to believe that our fixed effects have explanatory power. We can now use the <code>getSummary.mmblogit</code> function to get a summary of the model with the fixed effects.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb433"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb433-1"><a href="#cb433-1" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb433-2"><a href="#cb433-2" aria-hidden="true" tabindex="-1"></a>mclogit<span class="sc">::</span><span class="fu">getSummary.mmblogit</span>(m1.mn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$coef
, , NumeralNoun/BareNoun

                                  est             se             stat
(Intercept)           1.0940536961564 0.795348462844   1.375565236204
GenderMale            0.0691676134596 0.196851703842   0.351369137831
GroupGerman_Mono     -3.2909055852651 0.304213383696 -10.817754121424
GroupL2_Advanced     -0.4575232522173 0.307505930002  -1.487851802451
GroupL2_Intermediate -1.1689603301920 0.320486374900  -3.647457183029
                                                            p             lwr
(Intercept)          0.16895627570243004766936678606725763530 -0.464800646177
GenderMale           0.72531143261153097068216766274417750537 -0.316654636366
GroupGerman_Mono     0.00000000000000000000000000283642762742 -3.887152860923
GroupL2_Advanced     0.13678998075540799161942118189472239465 -1.060223800053
GroupL2_Intermediate 0.00026484842866201461228717328744153292 -1.797102082532
                                 upr
(Intercept)           2.652908038490
GenderMale            0.454989863285
GroupGerman_Mono     -2.694658309607
GroupL2_Advanced      0.145177295618
GroupL2_Intermediate -0.540818577852

, , QuantAdjNoun/BareNoun

                                 est             se            stat
(Intercept)           0.595495714821 0.498285332572   1.19508979273
GenderMale            0.299894756057 0.248324126894   1.20767466218
GroupGerman_Mono     -3.856907426420 0.376376472714 -10.24747216162
GroupL2_Advanced     -2.194953767746 0.347242020174  -6.32110643362
GroupL2_Intermediate -3.016728204954 0.398140344234  -7.57704726147
                                                         p             lwr
(Intercept)          0.23205194957954869416916210411727661 -0.381125591044
GenderMale           0.22717242789437372407768123139248928 -0.186811589148
GroupGerman_Mono     0.00000000000000000000000121478955845 -4.594591757567
GroupL2_Advanced     0.00000000025969706981651734977550494 -2.875535621206
GroupL2_Intermediate 0.00000000000003535080320639464797459 -3.797068940444
                                 upr
(Intercept)           1.572117020686
GenderMale            0.786601101263
GroupGerman_Mono     -3.119223095273
GroupL2_Advanced     -1.514371914285
GroupL2_Intermediate -2.236387469464

, , QuantNoun/BareNoun

                                 est             se            stat
(Intercept)          -2.163121210124 0.753539267056 -2.870615115488
GenderMale           -0.371289871061 0.430045391059 -0.863373678176
GroupGerman_Mono     -2.420925019711 0.813762214780 -2.974978409834
GroupL2_Advanced      0.789609605270 0.683753160717  1.154816753523
GroupL2_Intermediate -0.148789198303 0.739325816560 -0.201249834606
                                   p             lwr             upr
(Intercept)          0.0040967400034 -3.640031034490 -0.686211385758
GenderMale           0.3879320467104 -1.214163349254  0.471583607132
GroupGerman_Mono     0.0029300916939 -4.015869652660 -0.825980386762
GroupL2_Advanced     0.2481654749305 -0.550521964051  2.129741174590
GroupL2_Intermediate 0.8405032261517 -1.597841171602  1.300262774996


$Item
, , 1

                                              est            se stat  p lwr upr
NumeralNoun/BareNoun: VCov(~1,~1)   5.46019439098 26.1766792859   NA NA  NA  NA
QuantAdjNoun/BareNoun: VCov(~1,~1) -1.63804668956           NaN   NA NA  NA  NA
QuantNoun/BareNoun: VCov(~1,~1)     1.63405993827 11.5842291797   NA NA  NA  NA

, , 2

                                               est            se stat  p lwr
NumeralNoun/BareNoun: VCov(~1,~1)  -1.638046689561           NaN   NA NA  NA
QuantAdjNoun/BareNoun: VCov(~1,~1)  1.606289571482           NaN   NA NA  NA
QuantNoun/BareNoun: VCov(~1,~1)     0.499032543298 2.36453656546   NA NA  NA
                                   upr
NumeralNoun/BareNoun: VCov(~1,~1)   NA
QuantAdjNoun/BareNoun: VCov(~1,~1)  NA
QuantNoun/BareNoun: VCov(~1,~1)     NA

, , 3

                                              est             se stat  p lwr
NumeralNoun/BareNoun: VCov(~1,~1)  1.634059938273 11.58422917973   NA NA  NA
QuantAdjNoun/BareNoun: VCov(~1,~1) 0.499032543298  2.36453656546   NA NA  NA
QuantNoun/BareNoun: VCov(~1,~1)    1.512377431737            NaN   NA NA  NA
                                   upr
NumeralNoun/BareNoun: VCov(~1,~1)   NA
QuantAdjNoun/BareNoun: VCov(~1,~1)  NA
QuantNoun/BareNoun: VCov(~1,~1)     NA


$Groups
Groups by Item 
            10 

$sumstat
               LR                df          deviance          McFadden 
1476.294014647939   21.000000000000 1545.827692593422    0.488495883905 
        Cox.Snell        Nagelkerke               AIC               BIC 
   0.741897420618    0.791357248659 1587.827692593422 1692.700285073109 
                N 
1090.000000000000 

$call
mblogit(formula = Response ~ Gender + Group, data = pict, random = ~1 | 
    Item)

$contrasts
$contrasts$Gender
[1] "contr.treatment"

$contrasts$Group
[1] "contr.treatment"


$xlevels
$xlevels$Gender
[1] "Female" "Male"  

$xlevels$Group
[1] "English_Mono"    "German_Mono"     "L2_Advanced"     "L2_Intermediate"</code></pre>
</div>
</div>
<p>The NAs (not available information) is a result of the model having a bad fit to the data and, optimally, we would need to inspect why the model has a bad fit. Again, we ignore this and move on. Next, we check the VIFs to see if the model does not violate multicollinearity assumptions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb435"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb435-1"><a href="#cb435-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">vif</span>(m1.mn) <span class="co"># maybe use cut-off of 5 (maybe 10)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                GVIF Df GVIF^(1/(2*Df))
Gender 3.59671433193  1   1.89650054889
Group  9.94593851491  3   1.46647375521</code></pre>
</div>
</div>
<p>The VIFs are a bit high - especially the GVIF for Group would be a cause for concern if this was not just a demo analysis! However, as we only want to implement a multinomial mixed-effects model here and not provide a proper, clean analysis, we will ignore this issue here.</p>
<p>In a next step, we visualize effects to get a better understanding of how the predictors that are part of the fixed-effect structure of the mode affect the outcome (the response variable).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb437"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb437-1"><a href="#cb437-1" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">plot_model</span>(m1.mn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/mult08-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Finally, we can extract an alternative summary table produced by the <code>tab_model</code> function from the <code>sjPlot</code> package <span class="citation" data-cites="sjPlot">(see <a href="#ref-sjPlot" role="doc-biblioref">Lüdecke</a>)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb438"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb438-1"><a href="#cb438-1" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(m1.mn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">Response: NumeralNoun</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">Response: QuantAdjNoun</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">Response: QuantNoun</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Odds Ratios</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Odds Ratios</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7">p</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col8">Odds Ratios</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col9">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  0">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">2.99</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.63&nbsp;–&nbsp;14.20</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.169</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.81</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.68&nbsp;–&nbsp;4.82</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">0.232</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">0.11</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">0.03&nbsp;–&nbsp;0.50</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0"><strong>0.004</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">GenderMale</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.07</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.73&nbsp;–&nbsp;1.58</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.725</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.35</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.83&nbsp;–&nbsp;2.20</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">0.227</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">0.69</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">0.30&nbsp;–&nbsp;1.60</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">0.388</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">GroupGerman_Mono</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.04</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.02&nbsp;–&nbsp;0.07</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.02</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.01&nbsp;–&nbsp;0.04</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">0.09</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">0.02&nbsp;–&nbsp;0.44</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0"><strong>0.003</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">GroupL2_Advanced</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.63</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.35&nbsp;–&nbsp;1.16</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.137</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.11</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.06&nbsp;–&nbsp;0.22</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">2.20</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">0.58&nbsp;–&nbsp;8.42</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">0.248</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">GroupL2_Intermediate</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.31</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.17&nbsp;–&nbsp;0.58</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.05</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.02&nbsp;–&nbsp;0.11</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">0.86</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">0.20&nbsp;–&nbsp;3.67</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">0.841</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>Item</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="9">10</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="9">1090</td>
</tr>

</tbody></table>

</div>
</div>
<hr>
<p>This is the final step in implementing a a mixed-effects multinomial regression model using the <code>mblogit</code> function from the <code>mclogit</code> package <span class="citation" data-cites="mclogit">(see <a href="#ref-mclogit" role="doc-biblioref">Elff 2021</a>)</span>. We are aware that the analysis shown here is supervifial(!) - but please keep in mind that we just wanted to showcase the implementation here rather than providing a properly and carefully done analysis.</p>
</section>
<section id="mixed-effects-ordinal-regression" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="mixed-effects-ordinal-regression">Mixed-Effects Ordinal Regression</h2>
<p>In this section, we will strictly focus on how to implement a mixed-effects ordinal regression model using the <code>clmm</code> function from the <code>ordinal</code> package <span class="citation" data-cites="ordinal">(see <a href="#ref-ordinal" role="doc-biblioref">Christensen 2019</a>)</span>. This type of regression model is extremely useful when dealing with Likert data or other types of questionnaire and survey data where the responses have some kind of hierarchical structure (i.e.&nbsp;responses are not truly independent because they come from different points in time or from different regions). load data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb439"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb439-1"><a href="#cb439-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rating experiment data</span></span>
<span id="cb439-2"><a href="#cb439-2" aria-hidden="true" tabindex="-1"></a>ratex  <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="st">"tutorials/regression/data/ratex.rda"</span>, <span class="st">"rb"</span>)</span>
<span id="cb439-3"><a href="#cb439-3" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect data</span></span>
<span id="cb439-4"><a href="#cb439-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ratex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Rater Child Group       Accent AccentNumeric       Family
1    R1  C001 Child StrongAccent             2 DomBilingual
2    R2  C001 Child StrongAccent             2 DomBilingual
3    R3  C001 Child StrongAccent             2 DomBilingual
4    R4  C001 Child StrongAccent             2 DomBilingual
5    R5  C001 Child StrongAccent             2 DomBilingual
6    R6  C001 Child StrongAccent             2 DomBilingual</code></pre>
</div>
</div>
<p>We now tabulate the data to get a better understanding of the data structure.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb441"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb441-1"><a href="#cb441-1" aria-hidden="true" tabindex="-1"></a>ratex <span class="sc">%&gt;%</span></span>
<span id="cb441-2"><a href="#cb441-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(Family, Accent) <span class="sc">%&gt;%</span></span>
<span id="cb441-3"><a href="#cb441-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">Frequency =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb441-4"><a href="#cb441-4" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">spread</span>(Accent, Frequency)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Family'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
# Groups:   Family [3]
  Family         NoAccent StrongAccent WeakAccent
  &lt;fct&gt;             &lt;int&gt;        &lt;int&gt;      &lt;int&gt;
1 DomBilingual         80          145        174
2 EqualBilingual       20           22         63
3 Monolingual         209            1         41</code></pre>
</div>
</div>
<p>Next, we visualize the data to inspect its properties.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb444"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb444-1"><a href="#cb444-1" aria-hidden="true" tabindex="-1"></a>ratex <span class="sc">%&gt;%</span></span>
<span id="cb444-2"><a href="#cb444-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Family, AccentNumeric, <span class="at">color =</span> Group)) <span class="sc">+</span> </span>
<span id="cb444-3"><a href="#cb444-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>) <span class="sc">+</span>          </span>
<span id="cb444-4"><a href="#cb444-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_cl_boot, <span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb444-5"><a href="#cb444-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb444-6"><a href="#cb444-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb444-7"><a href="#cb444-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray20"</span>, <span class="st">"gray70"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>An alternative plot shows other properties of the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb445"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb445-1"><a href="#cb445-1" aria-hidden="true" tabindex="-1"></a>ratex <span class="sc">%&gt;%</span></span>
<span id="cb445-2"><a href="#cb445-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(Family, Rater, Group) <span class="sc">%&gt;%</span></span>
<span id="cb445-3"><a href="#cb445-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">AccentMean =</span> <span class="fu">mean</span>(AccentNumeric)) <span class="sc">%&gt;%</span></span>
<span id="cb445-4"><a href="#cb445-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Family, AccentMean, <span class="at">fill =</span> Group)) <span class="sc">+</span> </span>
<span id="cb445-5"><a href="#cb445-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb445-6"><a href="#cb445-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb445-7"><a href="#cb445-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb445-8"><a href="#cb445-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray50"</span>, <span class="st">"gray85"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Family', 'Rater'. You can override using
the `.groups` argument.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We now start the modeling by generating a model with Family as the sole predictor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb447"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb447-1"><a href="#cb447-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit baseline model</span></span>
<span id="cb447-2"><a href="#cb447-2" aria-hidden="true" tabindex="-1"></a>m1.or <span class="ot">&lt;-</span> <span class="fu">clmm</span>(Accent <span class="sc">~</span> (<span class="dv">1</span><span class="sc">|</span>Rater) <span class="sc">+</span> Family, <span class="at">link=</span><span class="st">"logit"</span>, <span class="at">data =</span> ratex)</span>
<span id="cb447-3"><a href="#cb447-3" aria-hidden="true" tabindex="-1"></a><span class="co"># test for incomplete information</span></span>
<span id="cb447-4"><a href="#cb447-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(<span class="fu">min</span>(<span class="fu">ftable</span>(ratex<span class="sc">$</span>Accent, ratex<span class="sc">$</span>Family)) <span class="sc">==</span> <span class="dv">0</span>, <span class="st">"incomplete information"</span>, <span class="st">"okay"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "okay"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb449"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb449-1"><a href="#cb449-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract aic</span></span>
<span id="cb449-2"><a href="#cb449-2" aria-hidden="true" tabindex="-1"></a>aic.glmer <span class="ot">&lt;-</span> <span class="fu">AIC</span>(<span class="fu">logLik</span>(m1.or))</span>
<span id="cb449-3"><a href="#cb449-3" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect aic</span></span>
<span id="cb449-4"><a href="#cb449-4" aria-hidden="true" tabindex="-1"></a>aic.glmer</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1380.25888675</code></pre>
</div>
<div class="sourceCode cell-code" id="cb451"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb451-1"><a href="#cb451-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summarize model</span></span>
<span id="cb451-2"><a href="#cb451-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1.or)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cumulative Link Mixed Model fitted with the Laplace approximation

formula: Accent ~ (1 | Rater) + Family
data:    ratex

 link  threshold nobs logLik  AIC     niter    max.grad cond.H 
 logit flexible  755  -685.13 1380.26 371(435) 3.04e-07 2.9e+05

Random effects:
 Groups Name        Variance            Std.Dev.       
 Rater  (Intercept) 0.00000000353434196 0.0000594503318
Number of groups:  Rater 21 

Coefficients:
                         Estimate   Std. Error   z value             Pr(&gt;|z|)
FamilyEqualBilingual  0.477744668  0.214314867   2.22917             0.025802
FamilyMonolingual    -2.550224082  0.198852092 -12.82473 &lt; 0.0000000000000002
                        
FamilyEqualBilingual *  
FamilyMonolingual    ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Threshold coefficients:
                             Estimate    Std. Error   z value
NoAccent|StrongAccent   -1.0798112480  0.1058010986 -10.20605
StrongAccent|WeakAccent  0.1060945025  0.0951357711   1.11519</code></pre>
</div>
</div>
<p>We can now perform Post-Hoc tests to see which comparisons are significant.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb453"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb453-1"><a href="#cb453-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lsmeans</span>(m1.or, pairwise<span class="sc">~</span>Family, <span class="at">adjust=</span><span class="st">"tukey"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$lsmeans
 Family         lsmean     SE  df asymp.LCL asymp.UCL
 DomBilingual    0.487 0.0914 Inf     0.308     0.666
 EqualBilingual  0.965 0.1950 Inf     0.582     1.347
 Monolingual    -2.063 0.1740 Inf    -2.404    -1.722

Confidence level used: 0.95 

$contrasts
 contrast                      estimate    SE  df z.ratio p.value
 DomBilingual - EqualBilingual   -0.478 0.214 Inf  -2.229  0.0664
 DomBilingual - Monolingual       2.550 0.199 Inf  12.825  &lt;.0001
 EqualBilingual - Monolingual     3.028 0.265 Inf  11.438  &lt;.0001

P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
</div>
</div>
<p>Finally, we can summarize the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb455"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb455-1"><a href="#cb455-1" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(m1.or)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table style="border-collapse:collapse; border:none;">
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="3" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">Accent</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Odds Ratios</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">CI</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">NoAccent|StrongAccent</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.34</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.28&nbsp;–&nbsp;0.42</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">StrongAccent|WeakAccent</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.11</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.92&nbsp;–&nbsp;1.34</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.265</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Family [EqualBilingual]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.61</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">1.06&nbsp;–&nbsp;2.45</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>0.026</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Family [Monolingual]</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.08</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.05&nbsp;–&nbsp;0.12</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td colspan="4" style="font-weight:bold; text-align:left; padding-top:.8em;">Random Effects</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">σ<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">3.29</td>
</tr>

<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">τ<sub>00</sub> <sub>Rater</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.00</td>

</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">N <sub>Rater</sub></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">21</td>
</tr><tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="3">755</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">Marginal R<sup>2</sup> / Conditional R<sup>2</sup></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="3">0.325 / NA</td>
</tr>

</tbody></table>

</div>
</div>
<hr>
<p>And we can visualize the effects.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb456"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb456-1"><a href="#cb456-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(m1.or, <span class="at">type =</span> <span class="st">"pred"</span>, <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"Family"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="regression_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>That’s it for this tutorial. We hope that you have enjoyed this tutorial and learned how to perform regression analysis including model fitting and model diagnostics as well as reporting regression results.</p>
</section>
</section>
<section id="citation-session-info" class="level1 unnumbered">
<h1 class="unnumbered">Citation &amp; Session Info</h1>
<p>Schweinberger, Martin. 2025. <em>Fixed- and Mixed-Effects Regression Models in R</em>. Brisbane: The University of Queensland. url: https://ladal.edu.au/tutorials/regression.html (Version 2025.01.30).</p>
<pre><code>@manual{schweinberger2025regression,
  author = {Schweinberger, Martin},
  title = {Fixed- and Mixed-Effects Regression Models in R},
  note = {tutorials/regression/regression.html},
  year = {2025},
  organization = "The University of Queensland, Australia. School of Languages and Cultures},
  address = {Brisbane},
  edition = {2025.01.30}
}</code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb458"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb458-1"><a href="#cb458-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.4.2 (2024-10-31)
Platform: x86_64-pc-linux-gnu
Running under: Ubuntu 24.04.1 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.12.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.12.0

locale:
 [1] LC_CTYPE=en_US.UTF-8          LC_NUMERIC=C                 
 [3] LC_TIME=en_US.UTF-8           LC_COLLATE=en_US.UTF-8       
 [5] LC_MONETARY=en_US.UTF-8       LC_MESSAGES=en_US.UTF-8      
 [7] LC_PAPER=en_US.UTF-8          LC_NAME=en_US.UTF-8          
 [9] LC_ADDRESS=en_US.UTF-8        LC_TELEPHONE=en_US.UTF-8     
[11] LC_MEASUREMENT=en_US.UTF-8    LC_IDENTIFICATION=en_US.UTF-8

time zone: Australia/Brisbane
tzcode source: system (glibc)

attached base packages:
[1] grid      stats     graphics  grDevices datasets  utils     methods  
[8] base     

other attached packages:
 [1] see_0.9.0           performance_0.12.4  gridExtra_2.3      
 [4] vcd_1.4-13          tibble_3.2.1        stringr_1.5.1      
 [7] sjPlot_2.8.17       robustbase_0.99-4-1 rms_6.9-0          
[10] ordinal_2023.12-4.1 nlme_3.1-166        MuMIn_1.48.4       
[13] mclogit_0.9.6       MASS_7.3-64         lme4_1.1-35.5      
[16] Matrix_1.7-2        knitr_1.49          Hmisc_5.2-1        
[19] ggfortify_0.4.17    glmulti_1.0.8       leaps_3.2          
[22] rJava_1.0-11        emmeans_1.10.6      effects_4.2-2      
[25] car_3.1-3           carData_3.0-5       Boruta_8.0.0       
[28] vip_0.4.1           ggpubr_0.6.0        ggplot2_3.5.1      
[31] flextable_0.9.7     dplyr_1.1.4        

loaded via a namespace (and not attached):
  [1] splines_4.4.2           klippy_0.0.0.9500       polspline_1.1.25       
  [4] datawizard_0.13.0       hardhat_1.4.0           pROC_1.18.5            
  [7] rpart_4.1.24            lifecycle_1.0.4         rstatix_0.7.2          
 [10] globals_0.16.3          lattice_0.22-6          insight_1.0.0          
 [13] backports_1.5.0         survey_4.4-2            magrittr_2.0.3         
 [16] rmarkdown_2.29          yaml_2.3.10             zip_2.3.1              
 [19] askpass_1.2.1           RColorBrewer_1.1-3      cowplot_1.1.3          
 [22] DBI_1.2.3               minqa_1.2.8             lubridate_1.9.4        
 [25] multcomp_1.4-26         abind_1.4-8             expm_1.0-0             
 [28] purrr_1.0.2             nnet_7.3-20             TH.data_1.1-2          
 [31] sandwich_3.1-1          ipred_0.9-15            gdtools_0.4.1          
 [34] lava_1.8.0              ggrepel_0.9.6           memisc_0.99.31.8.1     
 [37] listenv_0.9.1           MatrixModels_0.5-3      parallelly_1.41.0      
 [40] svglite_2.1.3           codetools_0.2-20        xml2_1.3.6             
 [43] tidyselect_1.2.1        ggeffects_2.0.0         farver_2.1.2           
 [46] effectsize_1.0.0        stats4_4.4.2            base64enc_0.1-3        
 [49] jsonlite_1.8.9          caret_7.0-1             e1071_1.7-16           
 [52] Formula_1.2-5           survival_3.8-3          iterators_1.0.14       
 [55] systemfonts_1.1.0       foreach_1.5.2           tools_4.4.2            
 [58] ragg_1.3.3              Rcpp_1.0.13-1           glue_1.8.0             
 [61] prodlim_2024.06.25      ranger_0.17.0           xfun_0.49              
 [64] mgcv_1.9-1              msm_1.8.2               withr_3.0.2            
 [67] numDeriv_2016.8-1.1     fastmap_1.2.0           mitools_2.4            
 [70] boot_1.3-31             SparseM_1.84-2          openssl_2.3.0          
 [73] digest_0.6.37           timechange_0.3.0        R6_2.5.1               
 [76] estimability_1.5.1      textshaping_0.4.1       colorspace_2.1-1       
 [79] utf8_1.2.4              tidyr_1.3.1             generics_0.1.3         
 [82] fontLiberation_0.1.0    renv_1.0.11             data.table_1.16.4      
 [85] recipes_1.1.0           class_7.3-23            report_0.5.9           
 [88] htmlwidgets_1.6.4       parameters_0.24.0       ModelMetrics_1.2.2.2   
 [91] pkgconfig_2.0.3         gtable_0.3.6            timeDate_4041.110      
 [94] lmtest_0.9-40           htmltools_0.5.8.1       fontBitstreamVera_0.1.1
 [97] kableExtra_1.4.0        scales_1.3.0            gower_1.0.2            
[100] rstudioapi_0.17.1       reshape2_1.4.4          uuid_1.2-1             
[103] coda_0.19-4.1           checkmate_2.3.2         nloptr_2.1.1           
[106] proxy_0.4-27            zoo_1.8-12              sjlabelled_1.2.0       
[109] parallel_4.4.2          foreign_0.8-88          pillar_1.10.1          
[112] vctrs_0.6.5             ucminf_1.2.2            xtable_1.8-4           
[115] cluster_2.1.8           htmlTable_2.4.3         evaluate_1.0.3         
[118] mvtnorm_1.3-2           cli_3.6.3               compiler_4.4.2         
[121] rlang_1.1.5             future.apply_1.11.3     ggsignif_0.6.4         
[124] labeling_0.4.3          forcats_1.0.0           plyr_1.8.9             
[127] sjmisc_2.8.10           stringi_1.8.4           viridisLite_0.4.2      
[130] assertthat_0.2.1        munsell_0.5.1           bayestestR_0.15.0      
[133] quantreg_5.99.1         fontquiver_0.2.1        sjstats_0.19.0         
[136] hms_1.1.3               patchwork_1.3.0         future_1.34.0          
[139] haven_2.5.4             broom_1.0.7             DEoptimR_1.1-3-1       
[142] officer_0.6.7          </code></pre>
</div>
</div>
<hr>
<p><a href="#introduction">Back to top</a></p>
<p><a href="../../index.html">Back to HOME</a></p>
<hr>
</section>
<section id="references" class="level1 unnumbered">
<h1 class="unnumbered">References</h1>


</section>
</section></section></section><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-achen1982interpreting" class="csl-entry" role="listitem">
Achen, Christopher H. <em>Interpreting and Using Regression</em>. Sage.
</div>
<div id="ref-agresti1996introduction" class="csl-entry" role="listitem">
Agresti, Alan. <em>An Introduction to Categorical Data Analysis</em>. Hoboken, NJ: JohnWiley &amp; Sons.
</div>
<div id="ref-agresti2010analysis" class="csl-entry" role="listitem">
———. <em>Analysis of Ordinal Categorical Data</em>. John Wiley &amp; Sons.
</div>
<div id="ref-agresti2011categorical" class="csl-entry" role="listitem">
Agresti, Alan, and Maria Kateri. <em>Categorical Data Analysis</em>. Springer.
</div>
<div id="ref-austin2018multilevel" class="csl-entry" role="listitem">
Austin, Peter C., and George Leckie. <span>“The Effect of Number of Clusters and Cluster Size on Statistical Power and Type i Error Rates When Testing Random Effects Variance Components in Multilevel Linear and Logistic Regression Models.”</span> <em>Journal of Statistical Computation and Simulation</em>, 3151–63.
</div>
<div id="ref-baayen2008analyzing" class="csl-entry" role="listitem">
Baayen, R Harald. <em>Analyzing Linguistic Data. A Practical Introduction to Statistics Using r</em>. Cambridge: Cambridge University press.
</div>
<div id="ref-MuMIn" class="csl-entry" role="listitem">
Barton, Kamil. 2020. <em>MuMIn: Multi-Model Inference</em>. <a href="https://CRAN.R-project.org/package = MuMIn">https://CRAN.R-project.org/package = MuMIn</a>.
</div>
<div id="ref-barton2020mumin" class="csl-entry" role="listitem">
Bartoń, Kamil. <span>“Package MuMIn - Multi-Model Inference.”</span> The Comprehensive R Archive Network. <a href="https://cran.r-project.org/web/packages/MuMIn/MuMIn.pdf">https://cran.r-project.org/web/packages/MuMIn/MuMIn.pdf</a>.
</div>
<div id="ref-lme4" class="csl-entry" role="listitem">
Bates, Douglas, Martin Mächler, Ben Bolker, and Steve Walker. 2015. <span>“Fitting Linear Mixed-Effects Models Using <span class="nocase">lme4</span>.”</span> <em>Journal of Statistical Software</em> 67 (1): 1–48. <a href="https://doi.org/10.18637/jss.v067.i01">https://doi.org/10.18637/jss.v067.i01</a>.
</div>
<div id="ref-bell2008multilevel" class="csl-entry" role="listitem">
Bell, Bethany A., John M. Ferron, and Jeffrey D. Kromrey. <span>“Cluster Size in Multilevel Models: The Impact of Sparse Data Structures on Point and Interval Estimates in Two-Level Models.”</span> In <em>JSM Proceedings. Section on Survey Research Methods</em>, 1122–29. American Statistical Association Alexandria, VA.
</div>
<div id="ref-bortz2006statistik" class="csl-entry" role="listitem">
Bortz, Jürgen. <em>Statistik: F<span>ü</span>r Human-Und Sozialwissenschaftler</em>. Springer-Verlag.
</div>
<div id="ref-bowerman1990linear" class="csl-entry" role="listitem">
Bowerman, Bruce L, and Richard T O’Connell. <em>Linear Statistical Models: An Applied Approach</em>. Boston: PWS-Kent.
</div>
<div id="ref-ordinal" class="csl-entry" role="listitem">
Christensen, R. H. B. 2019. <span>“Ordinal—Regression Models for Ordinal Data.”</span>
</div>
<div id="ref-clarke2008can" class="csl-entry" role="listitem">
Clarke, Philippa. <span>“When Can Group Level Clustering Be Ignored? Multilevel Models Versus Single-Level Models with Sparse Data.”</span> <em>Journal of Epidemiology &amp; Community Health</em>, 752–58.
</div>
<div id="ref-clarke2007addressing" class="csl-entry" role="listitem">
Clarke, Philippa, and Blair Wheaton. <span>“Addressing Data Sparseness in Contextual Population Research: Using Cluster Analysis to Create Synthetic Neighborhoods.”</span> <em>Sociological Methods &amp; Research</em>, 311–51.
</div>
<div id="ref-crawley2005statistics" class="csl-entry" role="listitem">
Crawley, Michael J. <em>Statistics: An Introduction Using r. 2005</em>. Chichester, West Sussex: John Wiley &amp; Sons.
</div>
<div id="ref-crawley2012r" class="csl-entry" role="listitem">
———. <em>The r Book</em>. John Wiley &amp; Sons.
</div>
<div id="ref-mclogit" class="csl-entry" role="listitem">
Elff, Martin. 2021. <a href="https://CRAN.R-project.org/package = mclogit">https://CRAN.R-project.org/package = mclogit</a>.
</div>
<div id="ref-faraway2002practical" class="csl-entry" role="listitem">
Faraway, Julian J. <em>Practical Regression and ANOVA Using r.</em> University of Bath.
</div>
<div id="ref-field2012discovering" class="csl-entry" role="listitem">
Field, Andy, Jeremy Miles, and Zoe Field. <em>Discovering Statistics Using r</em>. Sage.
</div>
<div id="ref-effects" class="csl-entry" role="listitem">
Fox, John, and Sanford Weisberg. 2019. <em>An r Companion to Applied Regression, 3rd Edition</em>. Thousand Oaks, CA. <a href="https://socialsciences.mcmaster.ca/jfox/Books/Companion/index.html">https://socialsciences.mcmaster.ca/jfox/Books/Companion/index.html</a>.
</div>
<div id="ref-green1991many" class="csl-entry" role="listitem">
Green, Samuel B. <span>“How Many Subjects Does It Take to Do a Regression Analysis.”</span> <em>Multivariate Behavioral Research</em>, 499–510.
</div>
<div id="ref-gries2021statistics" class="csl-entry" role="listitem">
Gries, Stefan Th. <em>Statistics for Linguistics Using r: A Practical Introduction</em>. Berlin &amp; New York: Mouton de Gruyter.
</div>
<div id="ref-harrell2015regression" class="csl-entry" role="listitem">
Harrell Jr, Frank E. <em>Regression Modeling Strategies: With Applications to Linear Models, Logistic and Ordinal Regression, and Survival Analysis</em>. Springer.
</div>
<div id="ref-rms" class="csl-entry" role="listitem">
———. 2021. <em>Rms: Regression Modeling Strategies</em>. <a href="https://CRAN.R-project.org/package = rms">https://CRAN.R-project.org/package = rms</a>.
</div>
<div id="ref-msm" class="csl-entry" role="listitem">
Jackson, Christopher H. 2011. <span>“Multi-State Models for Panel Data: The <span class="nocase">msm</span> Package for <span>R</span>.”</span> <em>Journal of Statistical Software</em> 38 (8): 1–29. <a href="https://www.jstatsoft.org/v38/i08/">https://www.jstatsoft.org/v38/i08/</a>.
</div>
<div id="ref-johnson2009getting" class="csl-entry" role="listitem">
Johnson, Daniel Ezra. <span>“Getting Off the GoldVarb Standard: Introducing Rbrul for Mixed-Effects Variable Rule Analysis.”</span> <em>Language and Linguistics Compass</em>, 359–83.
</div>
<div id="ref-caret" class="csl-entry" role="listitem">
Kuhn, Max. 2021. <em>Caret: Classification and Regression Training</em>. <a href="https://CRAN.R-project.org/package = caret">https://CRAN.R-project.org/package = caret</a>.
</div>
<div id="ref-levshina2015linguistics" class="csl-entry" role="listitem">
Levshina, Natalia. <em>How to Do Linguistics with r: Data Exploration and Statistical Analysis</em>. Amsterdam: John Benjamins Publishing Company.
</div>
<div id="ref-sjPlot" class="csl-entry" role="listitem">
Lüdecke, Daniel. <em>sjPlot: Data Visualization for Statistics in Social Science</em>. <a href="https://CRAN.R-project.org/package = sjPlot">https://CRAN.R-project.org/package = sjPlot</a>.
</div>
<div id="ref-maas2005sufficient" class="csl-entry" role="listitem">
Maas, Cora JM, and Joop J Hox. <span>“Sufficient Sample Sizes for Multilevel Modeling.”</span> <em>Methodology</em>, 86–92.
</div>
<div id="ref-report" class="csl-entry" role="listitem">
Makowski, Dominique, Mattan S. Ben-Shachar, Indrajeet Patil, and Daniel Lüdecke. 2021. <span>“Automated Results Reporting as a Practical Tool to Improve Reproducibility and Methodological Best Practices Adoption.”</span> <em>CRAN</em>. <a href="https://github.com/easystats/report">https://github.com/easystats/report</a>.
</div>
<div id="ref-menard1995applied" class="csl-entry" role="listitem">
Menard, Scott. <em>Applied Logistic Regression Analysis: Sage University Series on Quantitative Applications in the Social Sciences</em>. Thousand Oaks, CA: Sage.
</div>
<div id="ref-myers1990classical" class="csl-entry" role="listitem">
Myers, Raymond H. <em>Classical and Modern Regression with Applications</em>. Duxbury Press Belmont, CA.
</div>
<div id="ref-pinheiro2000mixedmodels" class="csl-entry" role="listitem">
Pinheiro, J. C., and D. M. Bates. <em>Mixed-Effects Models in s and s-PLUS. Statistics and Computing</em>. New York: Springer.
</div>
<div id="ref-rousseeuw2005robust" class="csl-entry" role="listitem">
Rousseeuw, Peter J, and Annick M Leroy. <em>Robust Regression and Outlier Detection</em>. John wiley &amp; sons.
</div>
<div id="ref-szmrecsanyi2006morphosyntactic" class="csl-entry" role="listitem">
Szmrecsanyi, Benedikt. <em>Morphosyntactic Persistence in Spoken English: A Corpus Study at the Intersection of Variationist Sociolinguistics, Psycholinguistics, and Discourse Analysis</em>. Berlin &amp; New York: Walter de Gruyter.
</div>
<div id="ref-wilcox2009basic" class="csl-entry" role="listitem">
Wilcox, Rand R. <em>Basic Statistics: Understanding Conventional Methods and Modern Insights</em>. Oxford University Press.
</div>
<div id="ref-winter2019statistics" class="csl-entry" role="listitem">
Winter, Bodo. <em>Statistics for Linguists: An Introduction Using r</em>. Routledge.
</div>
<div id="ref-zuur2013beginner" class="csl-entry" role="listitem">
Zuur, Alain F., Joseph M. Hilbe, and Elena N. Ieno. <em>A Beginner’s Guide to GLM and GLMM with. R. Beginner’s Guide Series</em>. Newburgh, United Kingdom: Highland Statistics Ltd.
</div>
<div id="ref-zuur2010protocol" class="csl-entry" role="listitem">
Zuur, Alain F., Elena N. Ieno, and Chris S. Elphick. <span>“A Protocol for Data Exploration to Avoid Common Statistical Problems.”</span> <em>Methods in Ecology and Evolution</em>, 3–14.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>I’m extremely grateful to Stefan Thomas Gries who provided very helpful feedback and pointed out many errors in previous versions of this tutorial. All remaining errors are, of course, my own.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>I’m very grateful to Antonio Dello Iacono who pointed out that the plots require additional discussion.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>I’m very grateful to Antonio Dello Iacono who pointed out that a previous version of this tutorial misinterpreted the results as I erroneously reversed the group results.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main></div>







 <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
 <!-- /content -->




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>