<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.41">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Martin Schweinberger">

<title>Cluster and Correspondence Analysis in R – Language Technology and Data Analysis Laboratory (LADAL)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-48ffa3e5b9d089919c6712c39e5b00f2.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-d4be639c637f3db3c684c66cefad7e0c.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-VSGK4KYDQZ"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-VSGK4KYDQZ', { 'anonymize_ip': true});
</script>
<style>html{ scroll-behavior: smooth; }</style>
<script>

    // Wait for the document to be fully loaded

    document.addEventListener("DOMContentLoaded", function () {

        // Create a new div element to hold the dynamic content

        var newContainer = document.createElement("div");

        newContainer.classList.add("custom-banner");  // You can assign a class to the new container for styling



        // You can also add content inside the new container

        newContainer.innerHTML = `

          <div class="banner">

              <img src="/images/ladal_icon_white.png" alt="Icon" class="banner-icon">

              <span class="banner-text">Language Technology and Data Analysis Laboratory</span>

          </div>

      `



        // Select the header element

        var header = document.getElementById("quarto-header");



        // Select the nav element inside the header to place the new container just above it

        var navbar = header.querySelector("nav");



        // Insert the new container before the navbar element

        header.insertBefore(newContainer, navbar);

    });

</script>
<script src="../../site_libs/clipboard-1.7.1/clipboard.min.js"></script>

<link href="../../site_libs/primer-tooltips-1.4.0/build.css" rel="stylesheet">

<link href="../../site_libs/klippy-0.0.0.9500/css/klippy.min.css" rel="stylesheet">

<script src="../../site_libs/klippy-0.0.0.9500/js/klippy.min.js"></script>

<link href="../../site_libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">

<script src="../../site_libs/tabwid-1.1.3/tabwid.js"></script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../css/styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Language Technology and Data Analysis Laboratory (LADAL)</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">HOME</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">ABOUT</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../events.html"> 
<span class="menu-text">EVENTS</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials.html"> 
<span class="menu-text">TUTORIALS</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../tools.html"> 
<span class="menu-text">TOOLS</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../resources.html"> 
<span class="menu-text">RESOURCES</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../contact.html"> 
<span class="menu-text">CONTACT</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul class="collapse">
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#cluster-analysis" id="toc-cluster-analysis" class="nav-link" data-scroll-target="#cluster-analysis">Cluster Analysis</a>
  <ul class="collapse">
  <li><a href="#underlying-concepts" id="toc-underlying-concepts" class="nav-link" data-scroll-target="#underlying-concepts">Underlying Concepts</a></li>
  <li><a href="#cluster-analysis-on-numeric-data" id="toc-cluster-analysis-on-numeric-data" class="nav-link" data-scroll-target="#cluster-analysis-on-numeric-data">Cluster Analysis on Numeric Data</a></li>
  <li><a href="#distance-and-similarity-measures" id="toc-distance-and-similarity-measures" class="nav-link" data-scroll-target="#distance-and-similarity-measures">Distance and Similarity Measures</a></li>
  <li><a href="#cluster-analysis-on-nominal-data" id="toc-cluster-analysis-on-nominal-data" class="nav-link" data-scroll-target="#cluster-analysis-on-nominal-data">Cluster Analysis on Nominal Data</a></li>
  </ul></li>
  <li><a href="#correspondence-analysis" id="toc-correspondence-analysis" class="nav-link" data-scroll-target="#correspondence-analysis">Correspondence Analysis</a></li>
  <li><a href="#citation-session-info" id="toc-citation-session-info" class="nav-link" data-scroll-target="#citation-session-info">Citation &amp; Session Info</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Cluster and Correspondence Analysis in R</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Martin Schweinberger </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<p><img src="../..\images/uq1.jpg" class="img-fluid" style="width:100.0%"></p>
<section id="introduction" class="level1 unnumbered">
<h1 class="unnumbered">Introduction</h1>
<p>This tutorial introduces classification and clustering using R. Cluster analyses fall within the domain of classification methods which are used to find groups or patterns in data or to predict group membership. As such, they are widely used and applied in machine learning. For linguists, classification is not only common when it comes to phylogenetics but also in annotation-based procedures such as part-of-speech tagging and syntactic parsing.</p>
<p>This tutorial is aimed at intermediate users of R with the aim of showcasing how to performing and visualizing the results of cluster and correspondence analyses in R. The aim is not to provide a fully-fledged analysis but rather to show and exemplify selected useful methods associated with cluster and correspondence analyses.</p>
<div class="warning" style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
To be able to follow this tutorial, we suggest you check out and familiarize yourself with the content of the following <strong>R Basics</strong> and <strong>Data Science Basics</strong> tutorials:<br>
</p>
<p style="margin-top:1em; text-align:left">
</p><ul>
<li>
<a href="tutorials/intror.html">Getting started with R</a>
</li>
<li>
<a href="tutorials/basicquant.html">Basic Concepts in Quantitative Research</a>
</li>
<li>
<a href="tutorials/load.html">Loading, saving, and generating data in R</a>
</li>
<li>
<a href="tutorials/table.html">Handling tables in R</a>
</li>
</ul>
<p></p>
<p style="margin-top:1em; text-align:center">
Click <a href="tutorials/clust/clust.qmd">here</a><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> to download the <strong>entire R Notebook</strong> for this tutorial.
</p>
</span></div>
<p><br></p>
<p>A more elaborate and highly recommendable introduction to cluster analysis is <span class="citation" data-cites="kassambara2017practical">Kassambara</span>. Other very useful resources are, e.g., <span class="citation" data-cites="king2015cluster">King</span>; <span class="citation" data-cites="kettenring2006practice">Kettenring</span>; <span class="citation" data-cites="romesburg2004cluster">Romesburg</span>; and <span class="citation" data-cites="blashfield1988methods">Blashfield and Aldenderfer</span>.</p>
<p><strong>Preparation and session set up</strong></p>
<p>This tutorial is based on R. If you have not installed R or are new to it, you will find an introduction to and more information how to use R <a href="tutorials/intror/intror.html">here</a>. For this tutorials, we need to install certain <em>packages</em> from an R <em>library</em> so that the scripts shown below are executed without errors. Before turning to the code below, please install the packages by running the code below this paragraph. If you have already installed the packages mentioned below, then you can skip ahead and ignore this section. To install the necessary packages, simply run the following code - it may take some time (between 1 and 5 minutes to install all of the libraries so you do not need to worry if it takes some time).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set options</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">stringsAsFactors =</span> F) <span class="co"># no automatic data transformation</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">"scipen"</span> <span class="ot">=</span> <span class="dv">100</span>, <span class="st">"digits"</span> <span class="ot">=</span> <span class="dv">4</span>) <span class="co"># suppress math annotation</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># install packages</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"cluster"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"factoextra"</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"seriation"</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"pvclust"</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"ape"</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"vcd"</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"exact2x2"</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"flextable"</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"tibble"</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"gplots"</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># install klippy for copy-to-clipboard button in code chunks</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"remotes"</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"rlesur/klippy"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In a next step, we load the packages.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cluster)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(seriation)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pvclust)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ape)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vcd)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(exact2x2)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gplots)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># activate klippy for copy-to-clipboard button</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>klippy<span class="sc">::</span><span class="fu">klippy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<script>
  addClassKlippyTo("pre.r, pre.markdown");
  addKlippy('left', 'top', 'auto', '1', 'Copy code', 'Copied!');
</script>
</div>
</div>
<p>Once you have installed R and RStudio and initiated the session by executing the code shown above, you are good to go.</p>
</section>
<section id="cluster-analysis" class="level1">
<h1>Cluster Analysis</h1>
<p>The most common method in linguistics that is sued to detect groups in data are cluster analyses. Cluster analyses are common in linguistics because they not only detect commonalities based on the frequency or occurrence of features but they also allow to visualize when splits between groups have occurred and are thus the method of choice in historical linguistics to determine and show genealogical relationships.</p>
<section id="underlying-concepts" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="underlying-concepts">Underlying Concepts</h2>
<p>The next section focuses on the basic idea that underlies all cluster analyses. WE will have a look at some very basic examples to highlight and discuss the principles that cluster analyses rely on.</p>
<p>The underlying idea of cluster analysis is very simple and rather intuitive as we ourselves perform cluster analyses every day in our lives. This is so because we group things together under certain labels and into concepts. The first example used to show this, deals with types of trees and how we group these types of trees based on their outward appearance.</p>
<p>Imagine you see six trees representing different types of trees: a pine tree, a fir tree, an oak tree, a beech tree, a phoenix palm tree, and a nikau palm tree. Now, you were asked to group these trees according to similarity. Have a look at the plot below and see whether you would have come up with a similar type of grouping.</p>
<p><img src="clust_files/figure-html/cl1-1.png" class="img-fluid" width="672"></p>
<p>An alternative way to group the trees would be the following.</p>
<p><img src="clust_files/figure-html/cl2-1.png" class="img-fluid" width="672"></p>
<p>In this display, conifers and broad-leaf trees are grouped together because there are more similar to each other compared to palm trees. This poses the question of what is meant by similarity. Consider the display below.</p>
<p><img src="clust_files/figure-html/cl3-1.png" class="img-fluid" width="672"></p>
<p>Are the red and the blue line more similar because they have the same shape or are the red and the black line more similar because they are closer together? There is no single correct answer here. Rather the plot intends to raise awareness about the fact that how cluster analyses group data depends on how similarity is defined in the respective algorithm.</p>
<p>Let’s consider another example to better understand how cluster analyses determine which data points should be merged when. Imagine you have five students and want to group them together based on their overall performance in school. The data that you rely on are their grades in math, music, and biology (with 1 being the best grade and 6 being the worst).</p>
<div class="tabwid"><style>.cl-f90a7ed2{table-layout:auto;width:50%;}.cl-f8ff197a{font-family:'Arial';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f8ff198e{font-family:'Arial';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f902d68c{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-f902d6a0{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-f902f2de{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f902f392{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f902f39c{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f902f39d{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f902f3a6{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f902f3a7{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f902f3b0{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f902f3b1{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f902f3ba{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f902f3bb{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f902f3c4{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f902f3c5{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-f90a7ed2"><thead><tr style="overflow-wrap:break-word;"><th class="cl-f902f2de"><p class="cl-f902d68c"><span class="cl-f8ff197a">Student</span></p></th><th class="cl-f902f392"><p class="cl-f902d6a0"><span class="cl-f8ff197a">Math</span></p></th><th class="cl-f902f392"><p class="cl-f902d6a0"><span class="cl-f8ff197a">Music</span></p></th><th class="cl-f902f39c"><p class="cl-f902d6a0"><span class="cl-f8ff197a">Biology</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-f902f39d"><p class="cl-f902d68c"><span class="cl-f8ff198e">StudentA</span></p></td><td class="cl-f902f3a6"><p class="cl-f902d6a0"><span class="cl-f8ff198e">2</span></p></td><td class="cl-f902f3a6"><p class="cl-f902d6a0"><span class="cl-f8ff198e">3</span></p></td><td class="cl-f902f3a7"><p class="cl-f902d6a0"><span class="cl-f8ff198e">2</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f902f3b0"><p class="cl-f902d68c"><span class="cl-f8ff198e">StudentB</span></p></td><td class="cl-f902f3b1"><p class="cl-f902d6a0"><span class="cl-f8ff198e">1</span></p></td><td class="cl-f902f3b1"><p class="cl-f902d6a0"><span class="cl-f8ff198e">3</span></p></td><td class="cl-f902f3ba"><p class="cl-f902d6a0"><span class="cl-f8ff198e">2</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f902f39d"><p class="cl-f902d68c"><span class="cl-f8ff198e">StudentC</span></p></td><td class="cl-f902f3a6"><p class="cl-f902d6a0"><span class="cl-f8ff198e">1</span></p></td><td class="cl-f902f3a6"><p class="cl-f902d6a0"><span class="cl-f8ff198e">2</span></p></td><td class="cl-f902f3a7"><p class="cl-f902d6a0"><span class="cl-f8ff198e">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f902f3b0"><p class="cl-f902d68c"><span class="cl-f8ff198e">StudentD</span></p></td><td class="cl-f902f3b1"><p class="cl-f902d6a0"><span class="cl-f8ff198e">2</span></p></td><td class="cl-f902f3b1"><p class="cl-f902d6a0"><span class="cl-f8ff198e">4</span></p></td><td class="cl-f902f3ba"><p class="cl-f902d6a0"><span class="cl-f8ff198e">4</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f902f3bb"><p class="cl-f902d68c"><span class="cl-f8ff198e">StudentE</span></p></td><td class="cl-f902f3c4"><p class="cl-f902d6a0"><span class="cl-f8ff198e">3</span></p></td><td class="cl-f902f3c4"><p class="cl-f902d6a0"><span class="cl-f8ff198e">4</span></p></td><td class="cl-f902f3c5"><p class="cl-f902d6a0"><span class="cl-f8ff198e">3</span></p></td></tr></tbody></table></div>
<p>The first step in determining the similarity among students is to create a distance matrix.</p>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>diststudents <span class="ot">&lt;-</span> <span class="fu">dist</span>(students, <span class="at">method =</span> <span class="st">"manhattan"</span>) <span class="co"># create a distance matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The distance matrix below shows that Student A and Student B only differ by one grade. Student B and Student C differ by 2 grades. Student A and Student C differ by 3 grades and so on.</p>
<div class="tabwid"><style>.cl-f9361efc{table-layout:auto;width:50%;}.cl-f92b1e6c{font-family:'Arial';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f92b1e80{font-family:'Arial';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f9301f66{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-f9306098{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f93060a2{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f93060a3{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f93060ac{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f93060ad{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f93060b6{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f93060c0{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f93060c1{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f93060ca{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f93060cb{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f93060d4{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f93060d5{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-f9361efc"><thead><tr style="overflow-wrap:break-word;"><th class="cl-f9306098"><p class="cl-f9301f66"><span class="cl-f92b1e6c">Student</span></p></th><th class="cl-f93060a2"><p class="cl-f9301f66"><span class="cl-f92b1e6c">StudentA</span></p></th><th class="cl-f93060a2"><p class="cl-f9301f66"><span class="cl-f92b1e6c">StudentB</span></p></th><th class="cl-f93060a2"><p class="cl-f9301f66"><span class="cl-f92b1e6c">StudentC</span></p></th><th class="cl-f93060a3"><p class="cl-f9301f66"><span class="cl-f92b1e6c">StudentD</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-f93060ac"><p class="cl-f9301f66"><span class="cl-f92b1e80">StudentB</span></p></td><td class="cl-f93060ad"><p class="cl-f9301f66"><span class="cl-f92b1e80">1</span></p></td><td class="cl-f93060ad"><p class="cl-f9301f66"><span class="cl-f92b1e80"></span></p></td><td class="cl-f93060ad"><p class="cl-f9301f66"><span class="cl-f92b1e80"></span></p></td><td class="cl-f93060b6"><p class="cl-f9301f66"><span class="cl-f92b1e80"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f93060c0"><p class="cl-f9301f66"><span class="cl-f92b1e80">StudentC</span></p></td><td class="cl-f93060c1"><p class="cl-f9301f66"><span class="cl-f92b1e80">3</span></p></td><td class="cl-f93060c1"><p class="cl-f9301f66"><span class="cl-f92b1e80">2</span></p></td><td class="cl-f93060c1"><p class="cl-f9301f66"><span class="cl-f92b1e80"></span></p></td><td class="cl-f93060ca"><p class="cl-f9301f66"><span class="cl-f92b1e80"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f93060ac"><p class="cl-f9301f66"><span class="cl-f92b1e80">StudentD</span></p></td><td class="cl-f93060ad"><p class="cl-f9301f66"><span class="cl-f92b1e80">3</span></p></td><td class="cl-f93060ad"><p class="cl-f9301f66"><span class="cl-f92b1e80">4</span></p></td><td class="cl-f93060ad"><p class="cl-f9301f66"><span class="cl-f92b1e80">6</span></p></td><td class="cl-f93060b6"><p class="cl-f9301f66"><span class="cl-f92b1e80"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f93060cb"><p class="cl-f9301f66"><span class="cl-f92b1e80">StudentE</span></p></td><td class="cl-f93060d4"><p class="cl-f9301f66"><span class="cl-f92b1e80">3</span></p></td><td class="cl-f93060d4"><p class="cl-f9301f66"><span class="cl-f92b1e80">4</span></p></td><td class="cl-f93060d4"><p class="cl-f9301f66"><span class="cl-f92b1e80">6</span></p></td><td class="cl-f93060d5"><p class="cl-f9301f66"><span class="cl-f92b1e80">2</span></p></td></tr></tbody></table></div>
<p>Based on this distance matrix, we can now implement a cluster analysis in R.</p>
</section>
<section id="cluster-analysis-on-numeric-data" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="cluster-analysis-on-numeric-data">Cluster Analysis on Numeric Data</h2>
<p>To create a simple cluster object in R, we use the <code>hclust</code> function from the <code>cluster</code> package. The resulting object is then plotted to create a dendrogram which shows how students have been amalgamated (combined) by the clustering algorithm (which, in the present case, is called <code>ward.D</code>).</p>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create hierarchical cluster object with ward.D as linkage method</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>clusterstudents <span class="ot">&lt;-</span> <span class="fu">hclust</span>(diststudents, <span class="at">method =</span> <span class="st">"ward.D"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># plot result as dendrogram</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(clusterstudents, <span class="at">hang =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="clust_files/figure-html/cl8-1.png" class="img-fluid" width="672"></p>
<p>Let us have a look at how the clustering algorithm has amalgamated the students. The amalgamation process takes the distance matrix from above as a starting point and, in a first step, has merged Student A and Student B (because they were the most similar students in the data based on the distance matrix). After collapsing Student A and Student B, the resulting distance matrix looks like the distance matrix below (notice that Student A and Student B now form a cluster that is represented by the means of the grades of the two students).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>students2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">1.5</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">3</span>),</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">byrow =</span> T</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>students2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(students2)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(students2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Cluster1"</span>, <span class="st">"StudentC"</span>, <span class="st">"StudentD"</span>, <span class="st">"StudentE"</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>diststudents2 <span class="ot">&lt;-</span> <span class="fu">dist</span>(students2, <span class="at">method =</span> <span class="st">"manhattan"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="tabwid"><style>.cl-f969fff6{table-layout:auto;width:50%;}.cl-f95e56ba{font-family:'Arial';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f95e56c4{font-family:'Arial';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f963113c{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-f96340f8{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f96340f9{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f9634102{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f963410c{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f963410d{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f963410e{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f9634116{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f9634117{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f9634118{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f9634120{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f963412a{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f963412b{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-f969fff6"><thead><tr style="overflow-wrap:break-word;"><th class="cl-f96340f8"><p class="cl-f963113c"><span class="cl-f95e56ba">Student</span></p></th><th class="cl-f96340f9"><p class="cl-f963113c"><span class="cl-f95e56ba">Cluster 1</span></p></th><th class="cl-f96340f9"><p class="cl-f963113c"><span class="cl-f95e56ba">Student C</span></p></th><th class="cl-f9634102"><p class="cl-f963113c"><span class="cl-f95e56ba">Student D</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-f963410c"><p class="cl-f963113c"><span class="cl-f95e56c4">Student C</span></p></td><td class="cl-f963410d"><p class="cl-f963113c"><span class="cl-f95e56c4">2.5</span></p></td><td class="cl-f963410d"><p class="cl-f963113c"><span class="cl-f95e56c4"></span></p></td><td class="cl-f963410e"><p class="cl-f963113c"><span class="cl-f95e56c4"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f9634116"><p class="cl-f963113c"><span class="cl-f95e56c4">Student D</span></p></td><td class="cl-f9634117"><p class="cl-f963113c"><span class="cl-f95e56c4">3.5</span></p></td><td class="cl-f9634117"><p class="cl-f963113c"><span class="cl-f95e56c4">6.0</span></p></td><td class="cl-f9634118"><p class="cl-f963113c"><span class="cl-f95e56c4"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f9634120"><p class="cl-f963113c"><span class="cl-f95e56c4">Student E</span></p></td><td class="cl-f963412a"><p class="cl-f963113c"><span class="cl-f95e56c4">3.5</span></p></td><td class="cl-f963412a"><p class="cl-f963113c"><span class="cl-f95e56c4">6.0</span></p></td><td class="cl-f963412b"><p class="cl-f963113c"><span class="cl-f95e56c4">2.0</span></p></td></tr></tbody></table></div>
<p>The next lowest distance now is 2.0 between Student D and Student E which means that these two students are merged next. The resulting distance matrix is shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>students3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">1.5</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="fl">2.5</span>, <span class="dv">4</span>, <span class="fl">3.5</span>),</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">byrow =</span> T</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>students3 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(students3)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(students3) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Cluster1"</span>, <span class="st">"StudentC"</span>, <span class="st">"Cluster2"</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>diststudents3 <span class="ot">&lt;-</span> <span class="fu">dist</span>(students3,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"manhattan"</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-f98be68e{table-layout:auto;width:50%;}.cl-f9815408{font-family:'Arial';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f981541c{font-family:'Arial';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f985ab5c{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-f985de9c{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f985de9d{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f985dea6{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f985deb0{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f985deba{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f985debb{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f985dece{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f985decf{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f985ded0{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-f98be68e"><thead><tr style="overflow-wrap:break-word;"><th class="cl-f985de9c"><p class="cl-f985ab5c"><span class="cl-f9815408">Student</span></p></th><th class="cl-f985de9d"><p class="cl-f985ab5c"><span class="cl-f9815408">Cluster 1</span></p></th><th class="cl-f985dea6"><p class="cl-f985ab5c"><span class="cl-f9815408">Student C</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-f985deb0"><p class="cl-f985ab5c"><span class="cl-f981541c">Student C</span></p></td><td class="cl-f985deba"><p class="cl-f985ab5c"><span class="cl-f981541c">2.5</span></p></td><td class="cl-f985debb"><p class="cl-f985ab5c"><span class="cl-f981541c"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f985dece"><p class="cl-f985ab5c"><span class="cl-f981541c">Cluster 2</span></p></td><td class="cl-f985decf"><p class="cl-f985ab5c"><span class="cl-f981541c">3.5</span></p></td><td class="cl-f985ded0"><p class="cl-f985ab5c"><span class="cl-f981541c">6.0</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>Now, the lowest distance value occurs between Cluster 1 and Student C. Thus, Student C and Cluster 1 are merged. In the final step, the Cluster 2 is merged with the new cluster encompassing Student C and Cluster 1. This amalgamation process can then be displayed visually as a dendrogram (see above).</p>
<p>How and which elements are merged depends on the what is understood as distance. Since “distance” is such an important concept in cluster analyses, we will briefly discuss this notion to understand why there are so many different types of clustering algorithms and this cluster analyses.</p>
</section>
<section id="distance-and-similarity-measures" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="distance-and-similarity-measures">Distance and Similarity Measures</h2>
<p>To understand how a cluster analysis determines to which cluster a given data point belongs, we need to understand what different distance measures represent. Have a look at the Figure below which visually represents three different ways to conceptualize distance.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="clust_files/figure-html/cl13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The Figure above depicts three ways to measure distance: the <code>euclidean</code> distance represents the distance between points as the hypotenuse of the x- and y-axis distances while the “maximum distance” represents distance as the longer distance of either the distance on the x- or the y-axis. The <code>manhatten</code> distance (or block distance) is the sum of the distances on the x- and the y-axis.</p>
<p>We will now turn to another example in order to delve a little deeper into how clustering algorithms work. In this example, we will find cluster of varieties of English based on the relative frequency of selected non-standard features (such as the relative frequencies of cleft constructions and tag questions). As a first step, we generate some fictional data set for this analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate data</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>IrishEnglish <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">sqrt</span>((<span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="fl">9.5</span>, .<span class="dv">5</span>))<span class="sc">^</span><span class="dv">2</span>), <span class="dv">3</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>ScottishEnglish <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">sqrt</span>((<span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="fl">9.3</span>, .<span class="dv">4</span>))<span class="sc">^</span><span class="dv">2</span>), <span class="dv">3</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>BritishEnglish <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">sqrt</span>((<span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="fl">6.4</span>, .<span class="dv">7</span>))<span class="sc">^</span><span class="dv">2</span>), <span class="dv">3</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>AustralianEnglish <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">sqrt</span>((<span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="fl">6.6</span>, .<span class="dv">5</span>))<span class="sc">^</span><span class="dv">2</span>), <span class="dv">3</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>NewZealandEnglish <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">sqrt</span>((<span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="fl">6.5</span>, .<span class="dv">4</span>))<span class="sc">^</span><span class="dv">2</span>), <span class="dv">3</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>AmericanEnglish <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">sqrt</span>((<span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="fl">4.6</span>, .<span class="dv">8</span>))<span class="sc">^</span><span class="dv">2</span>), <span class="dv">3</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>CanadianEnglish <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">sqrt</span>((<span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="fl">4.5</span>, .<span class="dv">7</span>))<span class="sc">^</span><span class="dv">2</span>), <span class="dv">3</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>JamaicanEnglish <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">sqrt</span>((<span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="fl">1.4</span>, .<span class="dv">2</span>))<span class="sc">^</span><span class="dv">2</span>), <span class="dv">3</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>PhillipineEnglish <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">sqrt</span>((<span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="fl">1.5</span>, .<span class="dv">4</span>))<span class="sc">^</span><span class="dv">2</span>), <span class="dv">3</span>)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>IndianEnglish <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">sqrt</span>((<span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="fl">1.3</span>, .<span class="dv">5</span>))<span class="sc">^</span><span class="dv">2</span>), <span class="dv">3</span>)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>clus <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  IrishEnglish, ScottishEnglish, BritishEnglish,</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  AustralianEnglish, NewZealandEnglish, AmericanEnglish,</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  CanadianEnglish, JamaicanEnglish, PhillipineEnglish, IndianEnglish</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="co"># add row names</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(clus) <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">"nae_neg"</span>, <span class="st">"like"</span>, <span class="st">"clefts"</span>, <span class="st">"tags"</span>, <span class="st">"youse"</span>, <span class="st">"soitwas"</span>,</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">"dt"</span>, <span class="st">"nsr"</span>, <span class="st">"invartag"</span>, <span class="st">"wh_cleft"</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-f9d4232c{table-layout:auto;width:50%;}.cl-f9cae94c{font-family:'Arial';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f9cae956{font-family:'Arial';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f9ce1fae{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-f9ce1fc2{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-f9ce4b0a{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f9ce4b14{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f9ce4b15{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f9ce4b1e{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f9ce4b1f{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f9ce4b20{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f9ce4b28{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f9ce4b29{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f9ce4b2a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f9ce4b32{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f9ce4b33{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f9ce4b3c{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-f9d4232c"><thead><tr style="overflow-wrap:break-word;"><th class="cl-f9ce4b0a"><p class="cl-f9ce1fae"><span class="cl-f9cae94c">Feature</span></p></th><th class="cl-f9ce4b14"><p class="cl-f9ce1fc2"><span class="cl-f9cae94c">IrishEnglish</span></p></th><th class="cl-f9ce4b14"><p class="cl-f9ce1fc2"><span class="cl-f9cae94c">ScottishEnglish</span></p></th><th class="cl-f9ce4b14"><p class="cl-f9ce1fc2"><span class="cl-f9cae94c">BritishEnglish</span></p></th><th class="cl-f9ce4b14"><p class="cl-f9ce1fc2"><span class="cl-f9cae94c">AustralianEnglish</span></p></th><th class="cl-f9ce4b14"><p class="cl-f9ce1fc2"><span class="cl-f9cae94c">NewZealandEnglish</span></p></th><th class="cl-f9ce4b14"><p class="cl-f9ce1fc2"><span class="cl-f9cae94c">AmericanEnglish</span></p></th><th class="cl-f9ce4b14"><p class="cl-f9ce1fc2"><span class="cl-f9cae94c">CanadianEnglish</span></p></th><th class="cl-f9ce4b14"><p class="cl-f9ce1fc2"><span class="cl-f9cae94c">JamaicanEnglish</span></p></th><th class="cl-f9ce4b14"><p class="cl-f9ce1fc2"><span class="cl-f9cae94c">PhillipineEnglish</span></p></th><th class="cl-f9ce4b15"><p class="cl-f9ce1fc2"><span class="cl-f9cae94c">IndianEnglish</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-f9ce4b1e"><p class="cl-f9ce1fae"><span class="cl-f9cae956">nae_neg</span></p></td><td class="cl-f9ce4b1f"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">9.553</span></p></td><td class="cl-f9ce4b1f"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">9.645</span></p></td><td class="cl-f9ce4b1f"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">6.126</span></p></td><td class="cl-f9ce4b1f"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">5.845</span></p></td><td class="cl-f9ce4b1f"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">6.240</span></p></td><td class="cl-f9ce4b1f"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">4.602</span></p></td><td class="cl-f9ce4b1f"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">3.749</span></p></td><td class="cl-f9ce4b1f"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">1.247</span></p></td><td class="cl-f9ce4b1f"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">0.895</span></p></td><td class="cl-f9ce4b20"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">1.549</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f9ce4b28"><p class="cl-f9ce1fae"><span class="cl-f9cae956">like</span></p></td><td class="cl-f9ce4b29"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">9.944</span></p></td><td class="cl-f9ce4b29"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">9.065</span></p></td><td class="cl-f9ce4b29"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">7.404</span></p></td><td class="cl-f9ce4b29"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">6.272</span></p></td><td class="cl-f9ce4b29"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">6.751</span></p></td><td class="cl-f9ce4b29"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">3.441</span></p></td><td class="cl-f9ce4b29"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">3.241</span></p></td><td class="cl-f9ce4b29"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">1.587</span></p></td><td class="cl-f9ce4b29"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">1.357</span></p></td><td class="cl-f9ce4b2a"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">2.095</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f9ce4b1e"><p class="cl-f9ce1fae"><span class="cl-f9cae956">clefts</span></p></td><td class="cl-f9ce4b1f"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">9.758</span></p></td><td class="cl-f9ce4b1f"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">9.313</span></p></td><td class="cl-f9ce4b1f"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">6.120</span></p></td><td class="cl-f9ce4b1f"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">6.715</span></p></td><td class="cl-f9ce4b1f"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">6.512</span></p></td><td class="cl-f9ce4b1f"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">5.301</span></p></td><td class="cl-f9ce4b1f"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">3.510</span></p></td><td class="cl-f9ce4b1f"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">1.421</span></p></td><td class="cl-f9ce4b1f"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">1.861</span></p></td><td class="cl-f9ce4b20"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">1.434</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f9ce4b28"><p class="cl-f9ce1fae"><span class="cl-f9cae956">tags</span></p></td><td class="cl-f9ce4b29"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">9.578</span></p></td><td class="cl-f9ce4b29"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">9.351</span></p></td><td class="cl-f9ce4b29"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">6.184</span></p></td><td class="cl-f9ce4b29"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">7.054</span></p></td><td class="cl-f9ce4b29"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">6.440</span></p></td><td class="cl-f9ce4b29"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">3.445</span></p></td><td class="cl-f9ce4b29"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">3.308</span></p></td><td class="cl-f9ce4b29"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">1.324</span></p></td><td class="cl-f9ce4b29"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">1.029</span></p></td><td class="cl-f9ce4b2a"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">0.814</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f9ce4b1e"><p class="cl-f9ce1fae"><span class="cl-f9cae956">youse</span></p></td><td class="cl-f9ce4b1f"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">10.330</span></p></td><td class="cl-f9ce4b1f"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">9.564</span></p></td><td class="cl-f9ce4b1f"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">5.490</span></p></td><td class="cl-f9ce4b1f"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">7.080</span></p></td><td class="cl-f9ce4b1f"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">6.511</span></p></td><td class="cl-f9ce4b1f"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">4.736</span></p></td><td class="cl-f9ce4b1f"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">2.764</span></p></td><td class="cl-f9ce4b1f"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">1.648</span></p></td><td class="cl-f9ce4b1f"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">1.291</span></p></td><td class="cl-f9ce4b20"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">1.168</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f9ce4b28"><p class="cl-f9ce1fae"><span class="cl-f9cae956">soitwas</span></p></td><td class="cl-f9ce4b29"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">10.196</span></p></td><td class="cl-f9ce4b29"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">9.242</span></p></td><td class="cl-f9ce4b29"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">6.431</span></p></td><td class="cl-f9ce4b29"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">6.172</span></p></td><td class="cl-f9ce4b29"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">7.319</span></p></td><td class="cl-f9ce4b29"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">4.529</span></p></td><td class="cl-f9ce4b29"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">4.782</span></p></td><td class="cl-f9ce4b29"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">1.527</span></p></td><td class="cl-f9ce4b29"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">1.722</span></p></td><td class="cl-f9ce4b2a"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">1.933</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f9ce4b1e"><p class="cl-f9ce1fae"><span class="cl-f9cae956">dt</span></p></td><td class="cl-f9ce4b1f"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">10.116</span></p></td><td class="cl-f9ce4b1f"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">9.278</span></p></td><td class="cl-f9ce4b1f"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">7.378</span></p></td><td class="cl-f9ce4b1f"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">6.893</span></p></td><td class="cl-f9ce4b1f"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">5.810</span></p></td><td class="cl-f9ce4b1f"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">2.226</span></p></td><td class="cl-f9ce4b1f"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">5.460</span></p></td><td class="cl-f9ce4b1f"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">1.212</span></p></td><td class="cl-f9ce4b1f"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">1.875</span></p></td><td class="cl-f9ce4b20"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">1.966</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f9ce4b28"><p class="cl-f9ce1fae"><span class="cl-f9cae956">nsr</span></p></td><td class="cl-f9ce4b29"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">8.816</span></p></td><td class="cl-f9ce4b29"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">9.063</span></p></td><td class="cl-f9ce4b29"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">7.529</span></p></td><td class="cl-f9ce4b29"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">6.953</span></p></td><td class="cl-f9ce4b29"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">6.250</span></p></td><td class="cl-f9ce4b29"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">2.372</span></p></td><td class="cl-f9ce4b29"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">5.216</span></p></td><td class="cl-f9ce4b29"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">1.495</span></p></td><td class="cl-f9ce4b29"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">2.000</span></p></td><td class="cl-f9ce4b2a"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">0.867</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f9ce4b1e"><p class="cl-f9ce1fae"><span class="cl-f9cae956">invartag</span></p></td><td class="cl-f9ce4b1f"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">8.685</span></p></td><td class="cl-f9ce4b1f"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">9.160</span></p></td><td class="cl-f9ce4b1f"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">6.807</span></p></td><td class="cl-f9ce4b1f"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">7.482</span></p></td><td class="cl-f9ce4b1f"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">6.093</span></p></td><td class="cl-f9ce4b1f"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">3.655</span></p></td><td class="cl-f9ce4b1f"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">3.861</span></p></td><td class="cl-f9ce4b1f"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">1.227</span></p></td><td class="cl-f9ce4b1f"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">1.742</span></p></td><td class="cl-f9ce4b20"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">1.537</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f9ce4b32"><p class="cl-f9ce1fae"><span class="cl-f9cae956">wh_cleft</span></p></td><td class="cl-f9ce4b33"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">8.835</span></p></td><td class="cl-f9ce4b33"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">8.655</span></p></td><td class="cl-f9ce4b33"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">6.119</span></p></td><td class="cl-f9ce4b33"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">6.885</span></p></td><td class="cl-f9ce4b33"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">6.267</span></p></td><td class="cl-f9ce4b33"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">4.746</span></p></td><td class="cl-f9ce4b33"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">4.047</span></p></td><td class="cl-f9ce4b33"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">1.234</span></p></td><td class="cl-f9ce4b33"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">1.411</span></p></td><td class="cl-f9ce4b3c"><p class="cl-f9ce1fc2"><span class="cl-f9cae956">1.497</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>As a next step, we create a cluster object based on the data we have just generated.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># clean data</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>clusm <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(clus)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>clust <span class="ot">&lt;-</span> <span class="fu">t</span>(clusm) <span class="co"># transpose data</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>clust <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(clust) <span class="co"># remove missing values</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>clusts <span class="ot">&lt;-</span> <span class="fu">scale</span>(clust) <span class="co"># standardize variables</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>clusts <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(clusts) <span class="co"># convert into matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-fa0a5730{table-layout:auto;width:50%;}.cl-f9fcc0ac{font-family:'Arial';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f9fcc0b6{font-family:'Arial';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fa012dc2{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-fa012dcc{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-fa017a34{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fa017a52{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fa017a5c{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fa017a5d{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fa017a66{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fa017a67{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fa017a7a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fa017a84{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fa017a8e{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fa017a8f{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fa017a98{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fa017a99{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-fa0a5730"><thead><tr style="overflow-wrap:break-word;"><th class="cl-fa017a34"><p class="cl-fa012dc2"><span class="cl-f9fcc0ac">Variety</span></p></th><th class="cl-fa017a52"><p class="cl-fa012dcc"><span class="cl-f9fcc0ac">nae_neg</span></p></th><th class="cl-fa017a52"><p class="cl-fa012dcc"><span class="cl-f9fcc0ac">like</span></p></th><th class="cl-fa017a52"><p class="cl-fa012dcc"><span class="cl-f9fcc0ac">clefts</span></p></th><th class="cl-fa017a52"><p class="cl-fa012dcc"><span class="cl-f9fcc0ac">tags</span></p></th><th class="cl-fa017a52"><p class="cl-fa012dcc"><span class="cl-f9fcc0ac">youse</span></p></th><th class="cl-fa017a52"><p class="cl-fa012dcc"><span class="cl-f9fcc0ac">soitwas</span></p></th><th class="cl-fa017a52"><p class="cl-fa012dcc"><span class="cl-f9fcc0ac">dt</span></p></th><th class="cl-fa017a52"><p class="cl-fa012dcc"><span class="cl-f9fcc0ac">nsr</span></p></th><th class="cl-fa017a52"><p class="cl-fa012dcc"><span class="cl-f9fcc0ac">invartag</span></p></th><th class="cl-fa017a5c"><p class="cl-fa012dcc"><span class="cl-f9fcc0ac">wh_cleft</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-fa017a5d"><p class="cl-fa012dc2"><span class="cl-f9fcc0b6">IrishEnglish</span></p></td><td class="cl-fa017a66"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">9.553</span></p></td><td class="cl-fa017a66"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">9.944</span></p></td><td class="cl-fa017a66"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">9.758</span></p></td><td class="cl-fa017a66"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">9.578</span></p></td><td class="cl-fa017a66"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">10.330</span></p></td><td class="cl-fa017a66"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">10.196</span></p></td><td class="cl-fa017a66"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">10.116</span></p></td><td class="cl-fa017a66"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">8.816</span></p></td><td class="cl-fa017a66"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">8.685</span></p></td><td class="cl-fa017a67"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">8.835</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fa017a7a"><p class="cl-fa012dc2"><span class="cl-f9fcc0b6">ScottishEnglish</span></p></td><td class="cl-fa017a84"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">9.645</span></p></td><td class="cl-fa017a84"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">9.065</span></p></td><td class="cl-fa017a84"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">9.313</span></p></td><td class="cl-fa017a84"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">9.351</span></p></td><td class="cl-fa017a84"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">9.564</span></p></td><td class="cl-fa017a84"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">9.242</span></p></td><td class="cl-fa017a84"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">9.278</span></p></td><td class="cl-fa017a84"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">9.063</span></p></td><td class="cl-fa017a84"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">9.160</span></p></td><td class="cl-fa017a8e"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">8.655</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fa017a5d"><p class="cl-fa012dc2"><span class="cl-f9fcc0b6">BritishEnglish</span></p></td><td class="cl-fa017a66"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">6.126</span></p></td><td class="cl-fa017a66"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">7.404</span></p></td><td class="cl-fa017a66"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">6.120</span></p></td><td class="cl-fa017a66"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">6.184</span></p></td><td class="cl-fa017a66"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">5.490</span></p></td><td class="cl-fa017a66"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">6.431</span></p></td><td class="cl-fa017a66"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">7.378</span></p></td><td class="cl-fa017a66"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">7.529</span></p></td><td class="cl-fa017a66"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">6.807</span></p></td><td class="cl-fa017a67"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">6.119</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fa017a7a"><p class="cl-fa012dc2"><span class="cl-f9fcc0b6">AustralianEnglish</span></p></td><td class="cl-fa017a84"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">5.845</span></p></td><td class="cl-fa017a84"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">6.272</span></p></td><td class="cl-fa017a84"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">6.715</span></p></td><td class="cl-fa017a84"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">7.054</span></p></td><td class="cl-fa017a84"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">7.080</span></p></td><td class="cl-fa017a84"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">6.172</span></p></td><td class="cl-fa017a84"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">6.893</span></p></td><td class="cl-fa017a84"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">6.953</span></p></td><td class="cl-fa017a84"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">7.482</span></p></td><td class="cl-fa017a8e"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">6.885</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fa017a5d"><p class="cl-fa012dc2"><span class="cl-f9fcc0b6">NewZealandEnglish</span></p></td><td class="cl-fa017a66"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">6.240</span></p></td><td class="cl-fa017a66"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">6.751</span></p></td><td class="cl-fa017a66"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">6.512</span></p></td><td class="cl-fa017a66"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">6.440</span></p></td><td class="cl-fa017a66"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">6.511</span></p></td><td class="cl-fa017a66"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">7.319</span></p></td><td class="cl-fa017a66"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">5.810</span></p></td><td class="cl-fa017a66"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">6.250</span></p></td><td class="cl-fa017a66"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">6.093</span></p></td><td class="cl-fa017a67"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">6.267</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fa017a7a"><p class="cl-fa012dc2"><span class="cl-f9fcc0b6">AmericanEnglish</span></p></td><td class="cl-fa017a84"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">4.602</span></p></td><td class="cl-fa017a84"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">3.441</span></p></td><td class="cl-fa017a84"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">5.301</span></p></td><td class="cl-fa017a84"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">3.445</span></p></td><td class="cl-fa017a84"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">4.736</span></p></td><td class="cl-fa017a84"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">4.529</span></p></td><td class="cl-fa017a84"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">2.226</span></p></td><td class="cl-fa017a84"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">2.372</span></p></td><td class="cl-fa017a84"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">3.655</span></p></td><td class="cl-fa017a8e"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">4.746</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fa017a5d"><p class="cl-fa012dc2"><span class="cl-f9fcc0b6">CanadianEnglish</span></p></td><td class="cl-fa017a66"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">3.749</span></p></td><td class="cl-fa017a66"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">3.241</span></p></td><td class="cl-fa017a66"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">3.510</span></p></td><td class="cl-fa017a66"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">3.308</span></p></td><td class="cl-fa017a66"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">2.764</span></p></td><td class="cl-fa017a66"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">4.782</span></p></td><td class="cl-fa017a66"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">5.460</span></p></td><td class="cl-fa017a66"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">5.216</span></p></td><td class="cl-fa017a66"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">3.861</span></p></td><td class="cl-fa017a67"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">4.047</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fa017a7a"><p class="cl-fa012dc2"><span class="cl-f9fcc0b6">JamaicanEnglish</span></p></td><td class="cl-fa017a84"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">1.247</span></p></td><td class="cl-fa017a84"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">1.587</span></p></td><td class="cl-fa017a84"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">1.421</span></p></td><td class="cl-fa017a84"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">1.324</span></p></td><td class="cl-fa017a84"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">1.648</span></p></td><td class="cl-fa017a84"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">1.527</span></p></td><td class="cl-fa017a84"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">1.212</span></p></td><td class="cl-fa017a84"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">1.495</span></p></td><td class="cl-fa017a84"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">1.227</span></p></td><td class="cl-fa017a8e"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">1.234</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fa017a5d"><p class="cl-fa012dc2"><span class="cl-f9fcc0b6">PhillipineEnglish</span></p></td><td class="cl-fa017a66"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">0.895</span></p></td><td class="cl-fa017a66"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">1.357</span></p></td><td class="cl-fa017a66"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">1.861</span></p></td><td class="cl-fa017a66"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">1.029</span></p></td><td class="cl-fa017a66"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">1.291</span></p></td><td class="cl-fa017a66"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">1.722</span></p></td><td class="cl-fa017a66"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">1.875</span></p></td><td class="cl-fa017a66"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">2.000</span></p></td><td class="cl-fa017a66"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">1.742</span></p></td><td class="cl-fa017a67"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">1.411</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fa017a8f"><p class="cl-fa012dc2"><span class="cl-f9fcc0b6">IndianEnglish</span></p></td><td class="cl-fa017a98"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">1.549</span></p></td><td class="cl-fa017a98"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">2.095</span></p></td><td class="cl-fa017a98"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">1.434</span></p></td><td class="cl-fa017a98"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">0.814</span></p></td><td class="cl-fa017a98"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">1.168</span></p></td><td class="cl-fa017a98"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">1.933</span></p></td><td class="cl-fa017a98"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">1.966</span></p></td><td class="cl-fa017a98"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">0.867</span></p></td><td class="cl-fa017a98"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">1.537</span></p></td><td class="cl-fa017a99"><p class="cl-fa012dcc"><span class="cl-f9fcc0b6">1.497</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>We assess if data is “clusterable” by testing if the data contains non-randomness. To this end, we calculate the <em>Hopkins statistic</em> which indicates how similar the data is to a random distribution.</p>
<ul>
<li><p>A Hopkins value of 0.5 indicates that the data is random and that there are no inherent clusters.</p></li>
<li><p>If the Hopkins statistic is close to 1, then the data is highly clusterable.</p></li>
<li><p>Values of 0 indicate that the data is uniform <span class="citation" data-cites="aggarwal2015data">(<a href="#ref-aggarwal2015data" role="doc-biblioref">Aggarwal, 158</a>)</span>.</p></li>
</ul>
<p>The <code>n</code> in the <code>get_clust_tendency</code> functions represents the maximum number of clusters to be tested which should be number of predictors in the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># apply get_clust_tendency to cluster object</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>clusttendency <span class="ot">&lt;-</span> <span class="fu">get_clust_tendency</span>(clusts,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># define number of points from sample space</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="dv">9</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">gradient =</span> <span class="fu">list</span>(</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># define color for low values</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">low =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># define color for high values</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">high =</span> <span class="st">"white"</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>clusttendency[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$hopkins_stat
[1] 0.7175819</code></pre>
</div>
</div>
<p>As the Hopkins value is substantively higher than .5 (randomness) and closer to 1 (highly clusterable) than to .5, thus indicating that there is sufficient structure in the data to warrant a cluster analysis. As such, we can assume that there are actual clusters in the data and continue by generating a distance matrix using euclidean distances.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>clustd <span class="ot">&lt;-</span> <span class="fu">dist</span>(clusts, <span class="co"># create distance matrix</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"euclidean"</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>) <span class="co"># use euclidean (!) distance</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-fa70189a{table-layout:auto;width:50%;}.cl-fa6765b0{font-family:'Arial';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fa6765c4{font-family:'Arial';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fa6a6422{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-fa6a642c{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-fa6a8510{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fa6a8524{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fa6a8525{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fa6a852e{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fa6a8538{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fa6a8542{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fa6a8543{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fa6a854c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fa6a854d{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fa6a854e{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fa6a8556{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fa6a8557{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-fa70189a"><thead><tr style="overflow-wrap:break-word;"><th class="cl-fa6a8510"><p class="cl-fa6a6422"><span class="cl-fa6765b0">Variety</span></p></th><th class="cl-fa6a8524"><p class="cl-fa6a642c"><span class="cl-fa6765b0">IrishEnglish</span></p></th><th class="cl-fa6a8524"><p class="cl-fa6a642c"><span class="cl-fa6765b0">ScottishEnglish</span></p></th><th class="cl-fa6a8524"><p class="cl-fa6a642c"><span class="cl-fa6765b0">BritishEnglish</span></p></th><th class="cl-fa6a8524"><p class="cl-fa6a642c"><span class="cl-fa6765b0">AustralianEnglish</span></p></th><th class="cl-fa6a8524"><p class="cl-fa6a642c"><span class="cl-fa6765b0">NewZealandEnglish</span></p></th><th class="cl-fa6a8524"><p class="cl-fa6a642c"><span class="cl-fa6765b0">AmericanEnglish</span></p></th><th class="cl-fa6a8524"><p class="cl-fa6a642c"><span class="cl-fa6765b0">CanadianEnglish</span></p></th><th class="cl-fa6a8524"><p class="cl-fa6a642c"><span class="cl-fa6765b0">JamaicanEnglish</span></p></th><th class="cl-fa6a8524"><p class="cl-fa6a642c"><span class="cl-fa6765b0">PhillipineEnglish</span></p></th><th class="cl-fa6a8525"><p class="cl-fa6a642c"><span class="cl-fa6765b0">IndianEnglish</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-fa6a852e"><p class="cl-fa6a6422"><span class="cl-fa6765c4">IrishEnglish</span></p></td><td class="cl-fa6a8538"><p class="cl-fa6a642c"><span class="cl-fa6765c4">0.00</span></p></td><td class="cl-fa6a8538"><p class="cl-fa6a642c"><span class="cl-fa6765c4">0.60</span></p></td><td class="cl-fa6a8538"><p class="cl-fa6a642c"><span class="cl-fa6765c4">3.16</span></p></td><td class="cl-fa6a8538"><p class="cl-fa6a642c"><span class="cl-fa6765c4">2.98</span></p></td><td class="cl-fa6a8538"><p class="cl-fa6a642c"><span class="cl-fa6765c4">3.20</span></p></td><td class="cl-fa6a8538"><p class="cl-fa6a642c"><span class="cl-fa6765c4">5.77</span></p></td><td class="cl-fa6a8538"><p class="cl-fa6a642c"><span class="cl-fa6765c4">5.70</span></p></td><td class="cl-fa6a8538"><p class="cl-fa6a642c"><span class="cl-fa6765c4">8.26</span></p></td><td class="cl-fa6a8538"><p class="cl-fa6a642c"><span class="cl-fa6765c4">8.13</span></p></td><td class="cl-fa6a8542"><p class="cl-fa6a642c"><span class="cl-fa6765c4">8.15</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fa6a8543"><p class="cl-fa6a6422"><span class="cl-fa6765c4">ScottishEnglish</span></p></td><td class="cl-fa6a854c"><p class="cl-fa6a642c"><span class="cl-fa6765c4">0.60</span></p></td><td class="cl-fa6a854c"><p class="cl-fa6a642c"><span class="cl-fa6765c4">0.00</span></p></td><td class="cl-fa6a854c"><p class="cl-fa6a642c"><span class="cl-fa6765c4">2.79</span></p></td><td class="cl-fa6a854c"><p class="cl-fa6a642c"><span class="cl-fa6765c4">2.58</span></p></td><td class="cl-fa6a854c"><p class="cl-fa6a642c"><span class="cl-fa6765c4">2.86</span></p></td><td class="cl-fa6a854c"><p class="cl-fa6a642c"><span class="cl-fa6765c4">5.43</span></p></td><td class="cl-fa6a854c"><p class="cl-fa6a642c"><span class="cl-fa6765c4">5.34</span></p></td><td class="cl-fa6a854c"><p class="cl-fa6a642c"><span class="cl-fa6765c4">7.91</span></p></td><td class="cl-fa6a854c"><p class="cl-fa6a642c"><span class="cl-fa6765c4">7.78</span></p></td><td class="cl-fa6a854d"><p class="cl-fa6a642c"><span class="cl-fa6765c4">7.81</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fa6a852e"><p class="cl-fa6a6422"><span class="cl-fa6765c4">BritishEnglish</span></p></td><td class="cl-fa6a8538"><p class="cl-fa6a642c"><span class="cl-fa6765c4">3.16</span></p></td><td class="cl-fa6a8538"><p class="cl-fa6a642c"><span class="cl-fa6765c4">2.79</span></p></td><td class="cl-fa6a8538"><p class="cl-fa6a642c"><span class="cl-fa6765c4">0.00</span></p></td><td class="cl-fa6a8538"><p class="cl-fa6a642c"><span class="cl-fa6765c4">0.81</span></p></td><td class="cl-fa6a8538"><p class="cl-fa6a642c"><span class="cl-fa6765c4">0.84</span></p></td><td class="cl-fa6a8538"><p class="cl-fa6a642c"><span class="cl-fa6765c4">3.09</span></p></td><td class="cl-fa6a8538"><p class="cl-fa6a642c"><span class="cl-fa6765c4">2.66</span></p></td><td class="cl-fa6a8538"><p class="cl-fa6a642c"><span class="cl-fa6765c4">5.27</span></p></td><td class="cl-fa6a8538"><p class="cl-fa6a642c"><span class="cl-fa6765c4">5.11</span></p></td><td class="cl-fa6a8542"><p class="cl-fa6a642c"><span class="cl-fa6765c4">5.16</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fa6a8543"><p class="cl-fa6a6422"><span class="cl-fa6765c4">AustralianEnglish</span></p></td><td class="cl-fa6a854c"><p class="cl-fa6a642c"><span class="cl-fa6765c4">2.98</span></p></td><td class="cl-fa6a854c"><p class="cl-fa6a642c"><span class="cl-fa6765c4">2.58</span></p></td><td class="cl-fa6a854c"><p class="cl-fa6a642c"><span class="cl-fa6765c4">0.81</span></p></td><td class="cl-fa6a854c"><p class="cl-fa6a642c"><span class="cl-fa6765c4">0.00</span></p></td><td class="cl-fa6a854c"><p class="cl-fa6a642c"><span class="cl-fa6765c4">0.82</span></p></td><td class="cl-fa6a854c"><p class="cl-fa6a642c"><span class="cl-fa6765c4">3.08</span></p></td><td class="cl-fa6a854c"><p class="cl-fa6a642c"><span class="cl-fa6765c4">2.92</span></p></td><td class="cl-fa6a854c"><p class="cl-fa6a642c"><span class="cl-fa6765c4">5.42</span></p></td><td class="cl-fa6a854c"><p class="cl-fa6a642c"><span class="cl-fa6765c4">5.28</span></p></td><td class="cl-fa6a854d"><p class="cl-fa6a642c"><span class="cl-fa6765c4">5.34</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fa6a852e"><p class="cl-fa6a6422"><span class="cl-fa6765c4">NewZealandEnglish</span></p></td><td class="cl-fa6a8538"><p class="cl-fa6a642c"><span class="cl-fa6765c4">3.20</span></p></td><td class="cl-fa6a8538"><p class="cl-fa6a642c"><span class="cl-fa6765c4">2.86</span></p></td><td class="cl-fa6a8538"><p class="cl-fa6a642c"><span class="cl-fa6765c4">0.84</span></p></td><td class="cl-fa6a8538"><p class="cl-fa6a642c"><span class="cl-fa6765c4">0.82</span></p></td><td class="cl-fa6a8538"><p class="cl-fa6a642c"><span class="cl-fa6765c4">0.00</span></p></td><td class="cl-fa6a8538"><p class="cl-fa6a642c"><span class="cl-fa6765c4">2.67</span></p></td><td class="cl-fa6a8538"><p class="cl-fa6a642c"><span class="cl-fa6765c4">2.62</span></p></td><td class="cl-fa6a8538"><p class="cl-fa6a642c"><span class="cl-fa6765c4">5.09</span></p></td><td class="cl-fa6a8538"><p class="cl-fa6a642c"><span class="cl-fa6765c4">4.97</span></p></td><td class="cl-fa6a8542"><p class="cl-fa6a642c"><span class="cl-fa6765c4">5.00</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fa6a8543"><p class="cl-fa6a6422"><span class="cl-fa6765c4">AmericanEnglish</span></p></td><td class="cl-fa6a854c"><p class="cl-fa6a642c"><span class="cl-fa6765c4">5.77</span></p></td><td class="cl-fa6a854c"><p class="cl-fa6a642c"><span class="cl-fa6765c4">5.43</span></p></td><td class="cl-fa6a854c"><p class="cl-fa6a642c"><span class="cl-fa6765c4">3.09</span></p></td><td class="cl-fa6a854c"><p class="cl-fa6a642c"><span class="cl-fa6765c4">3.08</span></p></td><td class="cl-fa6a854c"><p class="cl-fa6a642c"><span class="cl-fa6765c4">2.67</span></p></td><td class="cl-fa6a854c"><p class="cl-fa6a642c"><span class="cl-fa6765c4">0.00</span></p></td><td class="cl-fa6a854c"><p class="cl-fa6a642c"><span class="cl-fa6765c4">1.63</span></p></td><td class="cl-fa6a854c"><p class="cl-fa6a642c"><span class="cl-fa6765c4">2.75</span></p></td><td class="cl-fa6a854c"><p class="cl-fa6a642c"><span class="cl-fa6765c4">2.69</span></p></td><td class="cl-fa6a854d"><p class="cl-fa6a642c"><span class="cl-fa6765c4">2.68</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fa6a852e"><p class="cl-fa6a6422"><span class="cl-fa6765c4">CanadianEnglish</span></p></td><td class="cl-fa6a8538"><p class="cl-fa6a642c"><span class="cl-fa6765c4">5.70</span></p></td><td class="cl-fa6a8538"><p class="cl-fa6a642c"><span class="cl-fa6765c4">5.34</span></p></td><td class="cl-fa6a8538"><p class="cl-fa6a642c"><span class="cl-fa6765c4">2.66</span></p></td><td class="cl-fa6a8538"><p class="cl-fa6a642c"><span class="cl-fa6765c4">2.92</span></p></td><td class="cl-fa6a8538"><p class="cl-fa6a642c"><span class="cl-fa6765c4">2.62</span></p></td><td class="cl-fa6a8538"><p class="cl-fa6a642c"><span class="cl-fa6765c4">1.63</span></p></td><td class="cl-fa6a8538"><p class="cl-fa6a642c"><span class="cl-fa6765c4">0.00</span></p></td><td class="cl-fa6a8538"><p class="cl-fa6a642c"><span class="cl-fa6765c4">2.79</span></p></td><td class="cl-fa6a8538"><p class="cl-fa6a642c"><span class="cl-fa6765c4">2.59</span></p></td><td class="cl-fa6a8542"><p class="cl-fa6a642c"><span class="cl-fa6765c4">2.68</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fa6a8543"><p class="cl-fa6a6422"><span class="cl-fa6765c4">JamaicanEnglish</span></p></td><td class="cl-fa6a854c"><p class="cl-fa6a642c"><span class="cl-fa6765c4">8.26</span></p></td><td class="cl-fa6a854c"><p class="cl-fa6a642c"><span class="cl-fa6765c4">7.91</span></p></td><td class="cl-fa6a854c"><p class="cl-fa6a642c"><span class="cl-fa6765c4">5.27</span></p></td><td class="cl-fa6a854c"><p class="cl-fa6a642c"><span class="cl-fa6765c4">5.42</span></p></td><td class="cl-fa6a854c"><p class="cl-fa6a642c"><span class="cl-fa6765c4">5.09</span></p></td><td class="cl-fa6a854c"><p class="cl-fa6a642c"><span class="cl-fa6765c4">2.75</span></p></td><td class="cl-fa6a854c"><p class="cl-fa6a642c"><span class="cl-fa6765c4">2.79</span></p></td><td class="cl-fa6a854c"><p class="cl-fa6a642c"><span class="cl-fa6765c4">0.00</span></p></td><td class="cl-fa6a854c"><p class="cl-fa6a642c"><span class="cl-fa6765c4">0.40</span></p></td><td class="cl-fa6a854d"><p class="cl-fa6a642c"><span class="cl-fa6765c4">0.46</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fa6a852e"><p class="cl-fa6a6422"><span class="cl-fa6765c4">PhillipineEnglish</span></p></td><td class="cl-fa6a8538"><p class="cl-fa6a642c"><span class="cl-fa6765c4">8.13</span></p></td><td class="cl-fa6a8538"><p class="cl-fa6a642c"><span class="cl-fa6765c4">7.78</span></p></td><td class="cl-fa6a8538"><p class="cl-fa6a642c"><span class="cl-fa6765c4">5.11</span></p></td><td class="cl-fa6a8538"><p class="cl-fa6a642c"><span class="cl-fa6765c4">5.28</span></p></td><td class="cl-fa6a8538"><p class="cl-fa6a642c"><span class="cl-fa6765c4">4.97</span></p></td><td class="cl-fa6a8538"><p class="cl-fa6a642c"><span class="cl-fa6765c4">2.69</span></p></td><td class="cl-fa6a8538"><p class="cl-fa6a642c"><span class="cl-fa6765c4">2.59</span></p></td><td class="cl-fa6a8538"><p class="cl-fa6a642c"><span class="cl-fa6765c4">0.40</span></p></td><td class="cl-fa6a8538"><p class="cl-fa6a642c"><span class="cl-fa6765c4">0.00</span></p></td><td class="cl-fa6a8542"><p class="cl-fa6a642c"><span class="cl-fa6765c4">0.51</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fa6a854e"><p class="cl-fa6a6422"><span class="cl-fa6765c4">IndianEnglish</span></p></td><td class="cl-fa6a8556"><p class="cl-fa6a642c"><span class="cl-fa6765c4">8.15</span></p></td><td class="cl-fa6a8556"><p class="cl-fa6a642c"><span class="cl-fa6765c4">7.81</span></p></td><td class="cl-fa6a8556"><p class="cl-fa6a642c"><span class="cl-fa6765c4">5.16</span></p></td><td class="cl-fa6a8556"><p class="cl-fa6a642c"><span class="cl-fa6765c4">5.34</span></p></td><td class="cl-fa6a8556"><p class="cl-fa6a642c"><span class="cl-fa6765c4">5.00</span></p></td><td class="cl-fa6a8556"><p class="cl-fa6a642c"><span class="cl-fa6765c4">2.68</span></p></td><td class="cl-fa6a8556"><p class="cl-fa6a642c"><span class="cl-fa6765c4">2.68</span></p></td><td class="cl-fa6a8556"><p class="cl-fa6a642c"><span class="cl-fa6765c4">0.46</span></p></td><td class="cl-fa6a8556"><p class="cl-fa6a642c"><span class="cl-fa6765c4">0.51</span></p></td><td class="cl-fa6a8557"><p class="cl-fa6a642c"><span class="cl-fa6765c4">0.00</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>Below are other methods to create distance matrices with some comments on when using which metric is appropriate.</p>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create distance matrix (euclidean method: not good when dealing with many dimensions)</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>clustd <span class="ot">&lt;-</span> <span class="fu">dist</span>(clusts, <span class="at">method =</span> <span class="st">"euclidean"</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># create distance matrix (maximum method: here the difference between points dominates)</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>clustd_maximum <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">dist</span>(clusts, <span class="at">method =</span> <span class="st">"maximum"</span>), <span class="dv">2</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># create distance matrix (manhattan method: most popular choice)</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>clustd_manhatten <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">dist</span>(clusts, <span class="at">method =</span> <span class="st">"manhattan"</span>), <span class="dv">2</span>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># create distance matrix (canberra method: for count data only - focuses on small differences and neglects larger differences)</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>clustd_canberra <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">dist</span>(clusts, <span class="at">method =</span> <span class="st">"canberra"</span>), <span class="dv">2</span>)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co"># create distance matrix (binary method: for binary data only!)</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>clustd_binary <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">dist</span>(clusts, <span class="at">method =</span> <span class="st">"binary"</span>), <span class="dv">2</span>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co"># create distance matrix (minkowski method: is not a true distance measure)</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>clustd_minkowski <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">dist</span>(clusts, <span class="at">method =</span> <span class="st">"minkowski"</span>), <span class="dv">2</span>)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co"># distance method for words: daisy (other possible distances are "manhattan" and "gower")</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>clustd_daisy <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">daisy</span>(clusts, <span class="at">metric =</span> <span class="st">"euclidean"</span>), <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If you call the individual distance matrices, you will see that depending on which distance measure is used, the distance matrices differ dramatically! Have a look at the distance matrix created using the <code>manhatten</code> metric and compare it to the distance matrix created using the <code>euclidian</code> metric (see above).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>clustd_maximum</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-faa9e82c{table-layout:auto;width:50%;}.cl-fa9a77fc{font-family:'Arial';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fa9a7810{font-family:'Arial';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-faa1113e{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-faa11152{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-faa14ec4{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-faa14ece{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-faa14ed8{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-faa14ee2{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-faa14ee3{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-faa14eec{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-faa14eed{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-faa14ef6{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-faa14f0a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-faa14f14{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-faa14f15{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-faa14f1e{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-faa9e82c"><thead><tr style="overflow-wrap:break-word;"><th class="cl-faa14ec4"><p class="cl-faa1113e"><span class="cl-fa9a77fc">Variety</span></p></th><th class="cl-faa14ece"><p class="cl-faa11152"><span class="cl-fa9a77fc">IrishEnglish</span></p></th><th class="cl-faa14ece"><p class="cl-faa11152"><span class="cl-fa9a77fc">ScottishEnglish</span></p></th><th class="cl-faa14ece"><p class="cl-faa11152"><span class="cl-fa9a77fc">BritishEnglish</span></p></th><th class="cl-faa14ece"><p class="cl-faa11152"><span class="cl-fa9a77fc">AustralianEnglish</span></p></th><th class="cl-faa14ece"><p class="cl-faa11152"><span class="cl-fa9a77fc">NewZealandEnglish</span></p></th><th class="cl-faa14ece"><p class="cl-faa11152"><span class="cl-fa9a77fc">AmericanEnglish</span></p></th><th class="cl-faa14ece"><p class="cl-faa11152"><span class="cl-fa9a77fc">CanadianEnglish</span></p></th><th class="cl-faa14ece"><p class="cl-faa11152"><span class="cl-fa9a77fc">JamaicanEnglish</span></p></th><th class="cl-faa14ece"><p class="cl-faa11152"><span class="cl-fa9a77fc">PhillipineEnglish</span></p></th><th class="cl-faa14ed8"><p class="cl-faa11152"><span class="cl-fa9a77fc">IndianEnglish</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-faa14ee2"><p class="cl-faa1113e"><span class="cl-fa9a7810">IrishEnglish</span></p></td><td class="cl-faa14ee3"><p class="cl-faa11152"><span class="cl-fa9a7810">0.00</span></p></td><td class="cl-faa14ee3"><p class="cl-faa11152"><span class="cl-fa9a7810">0.31</span></p></td><td class="cl-faa14ee3"><p class="cl-faa11152"><span class="cl-fa9a7810">1.45</span></p></td><td class="cl-faa14ee3"><p class="cl-faa11152"><span class="cl-fa9a7810">1.31</span></p></td><td class="cl-faa14ee3"><p class="cl-faa11152"><span class="cl-fa9a7810">1.32</span></p></td><td class="cl-faa14ee3"><p class="cl-faa11152"><span class="cl-fa9a7810">2.43</span></p></td><td class="cl-faa14ee3"><p class="cl-faa11152"><span class="cl-fa9a7810">2.26</span></p></td><td class="cl-faa14ee3"><p class="cl-faa11152"><span class="cl-fa9a7810">2.82</span></p></td><td class="cl-faa14ee3"><p class="cl-faa11152"><span class="cl-fa9a7810">2.76</span></p></td><td class="cl-faa14eec"><p class="cl-faa11152"><span class="cl-fa9a7810">2.74</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-faa14eed"><p class="cl-faa1113e"><span class="cl-fa9a7810">ScottishEnglish</span></p></td><td class="cl-faa14ef6"><p class="cl-faa11152"><span class="cl-fa9a7810">0.31</span></p></td><td class="cl-faa14ef6"><p class="cl-faa11152"><span class="cl-fa9a7810">0.00</span></p></td><td class="cl-faa14ef6"><p class="cl-faa11152"><span class="cl-fa9a7810">1.22</span></p></td><td class="cl-faa14ef6"><p class="cl-faa11152"><span class="cl-fa9a7810">1.20</span></p></td><td class="cl-faa14ef6"><p class="cl-faa11152"><span class="cl-fa9a7810">1.07</span></p></td><td class="cl-faa14ef6"><p class="cl-faa11152"><span class="cl-fa9a7810">2.17</span></p></td><td class="cl-faa14ef6"><p class="cl-faa11152"><span class="cl-fa9a7810">2.03</span></p></td><td class="cl-faa14ef6"><p class="cl-faa11152"><span class="cl-fa9a7810">2.65</span></p></td><td class="cl-faa14ef6"><p class="cl-faa11152"><span class="cl-fa9a7810">2.76</span></p></td><td class="cl-faa14f0a"><p class="cl-faa11152"><span class="cl-fa9a7810">2.62</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-faa14ee2"><p class="cl-faa1113e"><span class="cl-fa9a7810">BritishEnglish</span></p></td><td class="cl-faa14ee3"><p class="cl-faa11152"><span class="cl-fa9a7810">1.45</span></p></td><td class="cl-faa14ee3"><p class="cl-faa11152"><span class="cl-fa9a7810">1.22</span></p></td><td class="cl-faa14ee3"><p class="cl-faa11152"><span class="cl-fa9a7810">0.00</span></p></td><td class="cl-faa14ee3"><p class="cl-faa11152"><span class="cl-fa9a7810">0.48</span></p></td><td class="cl-faa14ee3"><p class="cl-faa11152"><span class="cl-fa9a7810">0.48</span></p></td><td class="cl-faa14ee3"><p class="cl-faa11152"><span class="cl-fa9a7810">1.65</span></p></td><td class="cl-faa14ee3"><p class="cl-faa11152"><span class="cl-fa9a7810">1.32</span></p></td><td class="cl-faa14ee3"><p class="cl-faa11152"><span class="cl-fa9a7810">1.93</span></p></td><td class="cl-faa14ee3"><p class="cl-faa11152"><span class="cl-fa9a7810">1.91</span></p></td><td class="cl-faa14eec"><p class="cl-faa11152"><span class="cl-fa9a7810">2.13</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-faa14eed"><p class="cl-faa1113e"><span class="cl-fa9a7810">AustralianEnglish</span></p></td><td class="cl-faa14ef6"><p class="cl-faa11152"><span class="cl-fa9a7810">1.31</span></p></td><td class="cl-faa14ef6"><p class="cl-faa11152"><span class="cl-fa9a7810">1.20</span></p></td><td class="cl-faa14ef6"><p class="cl-faa11152"><span class="cl-fa9a7810">0.48</span></p></td><td class="cl-faa14ef6"><p class="cl-faa11152"><span class="cl-fa9a7810">0.00</span></p></td><td class="cl-faa14ef6"><p class="cl-faa11152"><span class="cl-fa9a7810">0.46</span></p></td><td class="cl-faa14ef6"><p class="cl-faa11152"><span class="cl-fa9a7810">1.46</span></p></td><td class="cl-faa14ef6"><p class="cl-faa11152"><span class="cl-fa9a7810">1.29</span></p></td><td class="cl-faa14ef6"><p class="cl-faa11152"><span class="cl-fa9a7810">2.08</span></p></td><td class="cl-faa14ef6"><p class="cl-faa11152"><span class="cl-fa9a7810">1.91</span></p></td><td class="cl-faa14f0a"><p class="cl-faa11152"><span class="cl-fa9a7810">1.98</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-faa14ee2"><p class="cl-faa1113e"><span class="cl-fa9a7810">NewZealandEnglish</span></p></td><td class="cl-faa14ee3"><p class="cl-faa11152"><span class="cl-fa9a7810">1.32</span></p></td><td class="cl-faa14ee3"><p class="cl-faa11152"><span class="cl-fa9a7810">1.07</span></p></td><td class="cl-faa14ee3"><p class="cl-faa11152"><span class="cl-fa9a7810">0.48</span></p></td><td class="cl-faa14ee3"><p class="cl-faa11152"><span class="cl-fa9a7810">0.46</span></p></td><td class="cl-faa14ee3"><p class="cl-faa11152"><span class="cl-fa9a7810">0.00</span></p></td><td class="cl-faa14ee3"><p class="cl-faa11152"><span class="cl-fa9a7810">1.24</span></p></td><td class="cl-faa14ee3"><p class="cl-faa11152"><span class="cl-fa9a7810">1.12</span></p></td><td class="cl-faa14ee3"><p class="cl-faa11152"><span class="cl-fa9a7810">1.89</span></p></td><td class="cl-faa14ee3"><p class="cl-faa11152"><span class="cl-fa9a7810">1.82</span></p></td><td class="cl-faa14eec"><p class="cl-faa11152"><span class="cl-fa9a7810">1.75</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-faa14eed"><p class="cl-faa1113e"><span class="cl-fa9a7810">AmericanEnglish</span></p></td><td class="cl-faa14ef6"><p class="cl-faa11152"><span class="cl-fa9a7810">2.43</span></p></td><td class="cl-faa14ef6"><p class="cl-faa11152"><span class="cl-fa9a7810">2.17</span></p></td><td class="cl-faa14ef6"><p class="cl-faa11152"><span class="cl-fa9a7810">1.65</span></p></td><td class="cl-faa14ef6"><p class="cl-faa11152"><span class="cl-fa9a7810">1.46</span></p></td><td class="cl-faa14ef6"><p class="cl-faa11152"><span class="cl-fa9a7810">1.24</span></p></td><td class="cl-faa14ef6"><p class="cl-faa11152"><span class="cl-fa9a7810">0.00</span></p></td><td class="cl-faa14ef6"><p class="cl-faa11152"><span class="cl-fa9a7810">0.99</span></p></td><td class="cl-faa14ef6"><p class="cl-faa11152"><span class="cl-fa9a7810">1.26</span></p></td><td class="cl-faa14ef6"><p class="cl-faa11152"><span class="cl-fa9a7810">1.17</span></p></td><td class="cl-faa14f0a"><p class="cl-faa11152"><span class="cl-fa9a7810">1.26</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-faa14ee2"><p class="cl-faa1113e"><span class="cl-fa9a7810">CanadianEnglish</span></p></td><td class="cl-faa14ee3"><p class="cl-faa11152"><span class="cl-fa9a7810">2.26</span></p></td><td class="cl-faa14ee3"><p class="cl-faa11152"><span class="cl-fa9a7810">2.03</span></p></td><td class="cl-faa14ee3"><p class="cl-faa11152"><span class="cl-fa9a7810">1.32</span></p></td><td class="cl-faa14ee3"><p class="cl-faa11152"><span class="cl-fa9a7810">1.29</span></p></td><td class="cl-faa14ee3"><p class="cl-faa11152"><span class="cl-fa9a7810">1.12</span></p></td><td class="cl-faa14ee3"><p class="cl-faa11152"><span class="cl-fa9a7810">0.99</span></p></td><td class="cl-faa14ee3"><p class="cl-faa11152"><span class="cl-fa9a7810">0.00</span></p></td><td class="cl-faa14ee3"><p class="cl-faa11152"><span class="cl-fa9a7810">1.31</span></p></td><td class="cl-faa14ee3"><p class="cl-faa11152"><span class="cl-fa9a7810">1.10</span></p></td><td class="cl-faa14eec"><p class="cl-faa11152"><span class="cl-fa9a7810">1.39</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-faa14eed"><p class="cl-faa1113e"><span class="cl-fa9a7810">JamaicanEnglish</span></p></td><td class="cl-faa14ef6"><p class="cl-faa11152"><span class="cl-fa9a7810">2.82</span></p></td><td class="cl-faa14ef6"><p class="cl-faa11152"><span class="cl-fa9a7810">2.65</span></p></td><td class="cl-faa14ef6"><p class="cl-faa11152"><span class="cl-fa9a7810">1.93</span></p></td><td class="cl-faa14ef6"><p class="cl-faa11152"><span class="cl-fa9a7810">2.08</span></p></td><td class="cl-faa14ef6"><p class="cl-faa11152"><span class="cl-fa9a7810">1.89</span></p></td><td class="cl-faa14ef6"><p class="cl-faa11152"><span class="cl-fa9a7810">1.26</span></p></td><td class="cl-faa14ef6"><p class="cl-faa11152"><span class="cl-fa9a7810">1.31</span></p></td><td class="cl-faa14ef6"><p class="cl-faa11152"><span class="cl-fa9a7810">0.00</span></p></td><td class="cl-faa14ef6"><p class="cl-faa11152"><span class="cl-fa9a7810">0.20</span></p></td><td class="cl-faa14f0a"><p class="cl-faa11152"><span class="cl-fa9a7810">0.23</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-faa14ee2"><p class="cl-faa1113e"><span class="cl-fa9a7810">PhillipineEnglish</span></p></td><td class="cl-faa14ee3"><p class="cl-faa11152"><span class="cl-fa9a7810">2.76</span></p></td><td class="cl-faa14ee3"><p class="cl-faa11152"><span class="cl-fa9a7810">2.76</span></p></td><td class="cl-faa14ee3"><p class="cl-faa11152"><span class="cl-fa9a7810">1.91</span></p></td><td class="cl-faa14ee3"><p class="cl-faa11152"><span class="cl-fa9a7810">1.91</span></p></td><td class="cl-faa14ee3"><p class="cl-faa11152"><span class="cl-fa9a7810">1.82</span></p></td><td class="cl-faa14ee3"><p class="cl-faa11152"><span class="cl-fa9a7810">1.17</span></p></td><td class="cl-faa14ee3"><p class="cl-faa11152"><span class="cl-fa9a7810">1.10</span></p></td><td class="cl-faa14ee3"><p class="cl-faa11152"><span class="cl-fa9a7810">0.20</span></p></td><td class="cl-faa14ee3"><p class="cl-faa11152"><span class="cl-fa9a7810">0.00</span></p></td><td class="cl-faa14eec"><p class="cl-faa11152"><span class="cl-fa9a7810">0.36</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-faa14f14"><p class="cl-faa1113e"><span class="cl-fa9a7810">IndianEnglish</span></p></td><td class="cl-faa14f15"><p class="cl-faa11152"><span class="cl-fa9a7810">2.74</span></p></td><td class="cl-faa14f15"><p class="cl-faa11152"><span class="cl-fa9a7810">2.62</span></p></td><td class="cl-faa14f15"><p class="cl-faa11152"><span class="cl-fa9a7810">2.13</span></p></td><td class="cl-faa14f15"><p class="cl-faa11152"><span class="cl-fa9a7810">1.98</span></p></td><td class="cl-faa14f15"><p class="cl-faa11152"><span class="cl-fa9a7810">1.75</span></p></td><td class="cl-faa14f15"><p class="cl-faa11152"><span class="cl-fa9a7810">1.26</span></p></td><td class="cl-faa14f15"><p class="cl-faa11152"><span class="cl-fa9a7810">1.39</span></p></td><td class="cl-faa14f15"><p class="cl-faa11152"><span class="cl-fa9a7810">0.23</span></p></td><td class="cl-faa14f15"><p class="cl-faa11152"><span class="cl-fa9a7810">0.36</span></p></td><td class="cl-faa14f1e"><p class="cl-faa11152"><span class="cl-fa9a7810">0.00</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>Next, we create a distance plot using the <code>distplot</code> function. If the distance plot shows different regions (non-random, non-uniform gray areas) then clustering the data is permittable as the data contains actual structures.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create distance plot</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dissplot</span>(clustd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="clust_files/figure-html/cl20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The most common method for clustering is called <code>ward.D</code> or <code>ward.D2</code>. Both of these linkage functions seek to minimize variance. This means that they cluster in a way that the amount of variance is at a minimum (comparable to the regression line in an <em>ordinary least squares</em> (OLS) design).</p>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create cluster object</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>cd <span class="ot">&lt;-</span> <span class="fu">hclust</span>(clustd, <span class="at">method =</span> <span class="st">"ward.D2"</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># display dendrogram</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cd, <span class="at">hang =</span> <span class="sc">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="clust_files/figure-html/cl21-1.png" class="img-fluid" width="672"></p>
<p>We will briefly go over some other, alternative linkage methods. Which linkage method is and should be used depends on various factors, for example, the type of variables (nominal versus numeric) or whether the focus should be placed on commonalities or differences.</p>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># single linkage: cluster with nearest data point</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>cd_single <span class="ot">&lt;-</span> <span class="fu">hclust</span>(clustd, <span class="at">method =</span> <span class="st">"single"</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># create cluster object (ward.D linkage)</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>cd_wardd <span class="ot">&lt;-</span> <span class="fu">hclust</span>(clustd, <span class="at">method =</span> <span class="st">"ward.D"</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co"># create cluster object (ward.D2 linkage):</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co"># cluster in a way to achieve minimum variance</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>cd_wardd2 <span class="ot">&lt;-</span> <span class="fu">hclust</span>(clustd, <span class="at">method =</span> <span class="st">"ward.D2"</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co"># average linkage: cluster with closest mean</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>cd_average <span class="ot">&lt;-</span> <span class="fu">hclust</span>(clustd, <span class="at">method =</span> <span class="st">"average"</span>)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co"># mcquitty linkage</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>cd_mcquitty <span class="ot">&lt;-</span> <span class="fu">hclust</span>(clustd, <span class="at">method =</span> <span class="st">"mcquitty"</span>)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co"># median linkage: cluster with closest median</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>cd_median <span class="ot">&lt;-</span> <span class="fu">hclust</span>(clustd, <span class="at">method =</span> <span class="st">"median"</span>)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co"># centroid linkage: cluster with closest prototypical point of target cluster</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>cd_centroid <span class="ot">&lt;-</span> <span class="fu">hclust</span>(clustd, <span class="at">method =</span> <span class="st">"centroid"</span>)</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="co"># complete linkage: cluster with nearest/furthest data point of target cluster</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>cd_complete <span class="ot">&lt;-</span> <span class="fu">hclust</span>(clustd, <span class="at">method =</span> <span class="st">"complete"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Now, we determine the optimal number of clusters based on silhouette widths which shows the ratio of internal similarity of clusters against the similarity between clusters. If the silhouette widths have values lower than .2 then this indicates that clustering is not appropriate <span class="citation" data-cites="levshina2015linguistics">(<a href="#ref-levshina2015linguistics" role="doc-biblioref">Levshina, 311</a>)</span>. The function below displays the silhouette width values of 2 to 8 clusters.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>optclus <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">8</span>, <span class="cf">function</span>(x) <span class="fu">summary</span>(<span class="fu">silhouette</span>(<span class="fu">cutree</span>(cd, <span class="at">k =</span> x), clustd))<span class="sc">$</span>avg.width)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>optclus <span class="co"># inspect results</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6016991 0.6123545 0.6984762 0.6161677 0.4117305 0.4055162 0.2485658</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>optnclust <span class="ot">&lt;-</span> <span class="fu">which</span>(optclus <span class="sc">==</span> <span class="fu">max</span>(optclus)) <span class="co"># determine optimal number of clusters</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>groups <span class="ot">&lt;-</span> <span class="fu">cutree</span>(cd, <span class="at">k =</span> optnclust) <span class="co"># cut tree into optimal number of clusters</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The optimal number of clusters is the cluster solution with the highest silhouette width. We cut the tree into the optimal number of clusters and plot the result.</p>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>groups <span class="ot">&lt;-</span> <span class="fu">cutree</span>(cd, <span class="at">k =</span> optnclust) <span class="co"># cut tree into optimal clusters</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cd, <span class="at">hang =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">cex =</span> .<span class="dv">75</span>) <span class="co"># plot result as dendrogram</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rect.hclust</span>(cd, <span class="at">k =</span> optnclust, <span class="at">border =</span> <span class="st">"red"</span>) <span class="co"># draw red borders around clusters</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="clust_files/figure-html/cl24-1.png" class="img-fluid" width="672"></p>
<p>In a next step, we aim to determine which factors are particularly important for the clustering - this step is comparable to measuring the effect size in inferential designs.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># which factors are particularly important</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>celtic <span class="ot">&lt;-</span> clusts[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), ]</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>others <span class="ot">&lt;-</span> clusts[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), ]</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate column means</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>celtic.cm <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(celtic)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>others.cm <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(others)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate difference between celtic and other englishes</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>diff <span class="ot">&lt;-</span> celtic.cm <span class="sc">-</span> others.cm</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(diff, <span class="at">decreasing =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     nsr invartag wh_cleft       dt     like     tags  soitwas   clefts 
1.551243 1.619531 1.637253 1.720996 1.733090 1.734183 1.764887 1.765329 
   youse  nae_neg 
1.826002 1.835906 </code></pre>
</div>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">sort</span>(diff), <span class="co"># y-values</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(diff), <span class="co"># x-values</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"n"</span>, <span class="co"># plot type (empty)</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex.axis =</span> .<span class="dv">75</span>, <span class="co"># axis font size</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex.lab =</span> .<span class="dv">75</span>, <span class="co"># label font size</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Prototypical for Non-Celtic Varieties (Cluster 2) &lt;-----&gt; Prototypical for Celtic Varieties (Cluster 1)"</span>, <span class="co"># x-axis label</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">yaxt =</span> <span class="st">"n"</span>, <span class="co"># no y-axis tick marks</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">""</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>) <span class="co"># no y-axis label</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fu">sort</span>(diff), <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(diff), <span class="fu">names</span>(<span class="fu">sort</span>(diff)), <span class="at">cex =</span> .<span class="dv">75</span>) <span class="co"># plot text into plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="clust_files/figure-html/cl26-1.png" class="img-fluid" width="672"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>Outer <span class="ot">&lt;-</span> clusts[<span class="fu">c</span>(<span class="dv">6</span><span class="sc">:</span><span class="dv">8</span>), ] <span class="co"># data of outer circle varieties</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>Inner <span class="ot">&lt;-</span> clusts[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">6</span><span class="sc">:</span><span class="dv">8</span>), ] <span class="co"># data of inner circle varieties</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>Outer.cm <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(Outer) <span class="co"># column means for outer circle</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>Inner.cm <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(Inner) <span class="co"># column means for inner circle</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>diff <span class="ot">&lt;-</span> Outer.cm <span class="sc">-</span> Inner.cm <span class="co"># difference between inner and outer circle</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(diff, <span class="at">decreasing =</span> F) <span class="co"># order difference between inner and outer circle</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      like   invartag         dt       tags        nsr      youse     clefts 
-1.0647872 -1.0022660 -0.9911610 -0.9284189 -0.9260202 -0.8575156 -0.8290527 
   soitwas   wh_cleft    nae_neg 
-0.8250282 -0.8064983 -0.7870668 </code></pre>
</div>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>( <span class="co"># start plot</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sort</span>(diff), <span class="co"># y-values</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(diff), <span class="co"># x-values</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"n"</span>, <span class="co"># plot type (empty)</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex.axis =</span> .<span class="dv">75</span>, <span class="co"># axis font size</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex.lab =</span> .<span class="dv">75</span>, <span class="co"># label font size</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Prototypical for Inner Circle Varieties (Cluster 2) &lt;-----&gt; Prototypical for Outer Circle Varieties (Cluster 1)"</span>, <span class="co"># x-axis label</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">yaxt =</span> <span class="st">"n"</span>, <span class="co"># no y-axis tick marks</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">""</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>) <span class="co"># no y-axis label</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fu">sort</span>(diff), <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(diff), <span class="fu">names</span>(<span class="fu">sort</span>(diff)), <span class="at">cex =</span> .<span class="dv">75</span>) <span class="co"># plot text into plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="clust_files/figure-html/cl28-1.png" class="img-fluid" width="672"></p>
<p>We see that discourse <em>like</em> is typical for other varieties and that the use of <em>youse</em> as 2<sup>nd</sup> person plural pronoun and invariant tags are typical for Celtic Englishes.</p>
<p>We will now test whether the cluster is justified by validating the cluster solution using bootstrapping.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>res.pv <span class="ot">&lt;-</span> <span class="fu">pvclust</span>(clus, <span class="co"># apply pvclust method to clus data</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">method.dist =</span> <span class="st">"euclidean"</span>, <span class="co"># use eucledian distance</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">method.hclust =</span> <span class="st">"ward.D2"</span>, <span class="co"># use ward.d2 linkage</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">nboot =</span> <span class="dv">100</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>) <span class="co"># use 100 bootstrap runs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Bootstrap (r = 0.5)... Done.
Bootstrap (r = 0.6)... Done.
Bootstrap (r = 0.7)... Done.
Bootstrap (r = 0.8)... Done.
Bootstrap (r = 0.9)... Done.
Bootstrap (r = 1.0)... Done.
Bootstrap (r = 1.1)... Done.
Bootstrap (r = 1.2)... Done.
Bootstrap (r = 1.3)... Done.
Bootstrap (r = 1.4)... Done.</code></pre>
</div>
</div>
<p>The clustering provides approximately unbiased p-values and bootstrap probability value <span class="citation" data-cites="levshina2015linguistics">(see <a href="#ref-levshina2015linguistics" role="doc-biblioref">Levshina, 316</a>)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(res.pv, <span class="at">cex =</span> .<span class="dv">75</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pvrect</span>(res.pv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="clust_files/figure-html/cl30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can also use other packages to customize the dendrograms.</p>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as.phylo</span>(cd), <span class="co"># plot cluster object</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex =</span> <span class="fl">0.75</span>, <span class="co"># .75 font size</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">label.offset =</span> .<span class="dv">5</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>) <span class="co"># .5 label offset</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="clust_files/figure-html/cl31-1.png" class="img-fluid" width="672"></p>
<p>One useful customization is to display an unrooted rather than a rooted tree diagram.</p>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot as unrooted tree</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as.phylo</span>(cd), <span class="co"># plot cluster object</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"unrooted"</span>, <span class="co"># plot as unrooted tree</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex =</span> .<span class="dv">75</span>, <span class="co"># .75 font size</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">label.offset =</span> <span class="dv">1</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>) <span class="co"># .5 label offset</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="clust_files/figure-html/cl32-1.png" class="img-fluid" width="672"></p>
</section>
<section id="cluster-analysis-on-nominal-data" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="cluster-analysis-on-nominal-data">Cluster Analysis on Nominal Data</h2>
<p>So far, all analyses were based on numeric data. However, especially when working with language data, the data is nominal or categorical rather than numeric. The following will thus show to implement a clustering method for nominal data.</p>
<p>In a first step, we will create a simple data set representing the presence and absence of features across varieties of English.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate data</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>IrishEnglish <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>ScottishEnglish <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>BritishEnglish <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>AustralianEnglish <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>NewZealandEnglish <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>AmericanEnglish <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>CanadianEnglish <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>JamaicanEnglish <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>PhillipineEnglish <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>IndianEnglish <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>clus <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>  IrishEnglish, ScottishEnglish, BritishEnglish,</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  AustralianEnglish, NewZealandEnglish, AmericanEnglish,</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  CanadianEnglish, JamaicanEnglish, PhillipineEnglish, IndianEnglish</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a><span class="co"># add row names</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(clus) <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">"nae_neg"</span>, <span class="st">"like"</span>, <span class="st">"clefts"</span>, <span class="st">"tags"</span>, <span class="st">"youse"</span>, <span class="st">"soitwas"</span>,</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">"dt"</span>, <span class="st">"nsr"</span>, <span class="st">"invartag"</span>, <span class="st">"wh_cleft"</span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a><span class="co"># convert into factors</span></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>clus <span class="ot">&lt;-</span> <span class="fu">apply</span>(clus, <span class="dv">1</span>, <span class="cf">function</span>(x) {</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(x)</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-fc4e5faa{table-layout:auto;width:50%;}.cl-fc3e2996{font-family:'Arial';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fc3e29a0{font-family:'Arial';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fc448624{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-fc44cd00{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc44cd14{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc44cd1e{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc44cd28{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc44cd29{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc44cd32{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc44cd3c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc44cd46{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc44cd47{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc44cd50{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc44cd64{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc44cd6e{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-fc4e5faa"><thead><tr style="overflow-wrap:break-word;"><th class="cl-fc44cd00"><p class="cl-fc448624"><span class="cl-fc3e2996">Variety</span></p></th><th class="cl-fc44cd14"><p class="cl-fc448624"><span class="cl-fc3e2996">nae_neg</span></p></th><th class="cl-fc44cd14"><p class="cl-fc448624"><span class="cl-fc3e2996">like</span></p></th><th class="cl-fc44cd14"><p class="cl-fc448624"><span class="cl-fc3e2996">clefts</span></p></th><th class="cl-fc44cd14"><p class="cl-fc448624"><span class="cl-fc3e2996">tags</span></p></th><th class="cl-fc44cd14"><p class="cl-fc448624"><span class="cl-fc3e2996">youse</span></p></th><th class="cl-fc44cd14"><p class="cl-fc448624"><span class="cl-fc3e2996">soitwas</span></p></th><th class="cl-fc44cd14"><p class="cl-fc448624"><span class="cl-fc3e2996">dt</span></p></th><th class="cl-fc44cd14"><p class="cl-fc448624"><span class="cl-fc3e2996">nsr</span></p></th><th class="cl-fc44cd14"><p class="cl-fc448624"><span class="cl-fc3e2996">invartag</span></p></th><th class="cl-fc44cd1e"><p class="cl-fc448624"><span class="cl-fc3e2996">wh_cleft</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-fc44cd28"><p class="cl-fc448624"><span class="cl-fc3e29a0">IrishEnglish</span></p></td><td class="cl-fc44cd29"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd29"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd29"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd29"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd29"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd29"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd29"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd29"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd29"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd32"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc44cd3c"><p class="cl-fc448624"><span class="cl-fc3e29a0">ScottishEnglish</span></p></td><td class="cl-fc44cd46"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd46"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd46"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd46"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd46"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd46"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd46"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd46"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd46"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd47"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc44cd28"><p class="cl-fc448624"><span class="cl-fc3e29a0">BritishEnglish</span></p></td><td class="cl-fc44cd29"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td><td class="cl-fc44cd29"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd29"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd29"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd29"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td><td class="cl-fc44cd29"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td><td class="cl-fc44cd29"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd29"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td><td class="cl-fc44cd29"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd32"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc44cd3c"><p class="cl-fc448624"><span class="cl-fc3e29a0">AustralianEnglish</span></p></td><td class="cl-fc44cd46"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td><td class="cl-fc44cd46"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd46"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd46"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd46"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td><td class="cl-fc44cd46"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td><td class="cl-fc44cd46"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd46"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td><td class="cl-fc44cd46"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd47"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc44cd28"><p class="cl-fc448624"><span class="cl-fc3e29a0">NewZealandEnglish</span></p></td><td class="cl-fc44cd29"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td><td class="cl-fc44cd29"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd29"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd29"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd29"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td><td class="cl-fc44cd29"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td><td class="cl-fc44cd29"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd29"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td><td class="cl-fc44cd29"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd32"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc44cd3c"><p class="cl-fc448624"><span class="cl-fc3e29a0">AmericanEnglish</span></p></td><td class="cl-fc44cd46"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td><td class="cl-fc44cd46"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd46"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd46"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd46"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td><td class="cl-fc44cd46"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td><td class="cl-fc44cd46"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td><td class="cl-fc44cd46"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td><td class="cl-fc44cd46"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd47"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc44cd28"><p class="cl-fc448624"><span class="cl-fc3e29a0">CanadianEnglish</span></p></td><td class="cl-fc44cd29"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td><td class="cl-fc44cd29"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd29"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd29"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd29"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td><td class="cl-fc44cd29"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td><td class="cl-fc44cd29"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td><td class="cl-fc44cd29"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td><td class="cl-fc44cd29"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd32"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc44cd3c"><p class="cl-fc448624"><span class="cl-fc3e29a0">JamaicanEnglish</span></p></td><td class="cl-fc44cd46"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td><td class="cl-fc44cd46"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td><td class="cl-fc44cd46"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd46"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td><td class="cl-fc44cd46"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td><td class="cl-fc44cd46"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td><td class="cl-fc44cd46"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td><td class="cl-fc44cd46"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td><td class="cl-fc44cd46"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd47"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc44cd28"><p class="cl-fc448624"><span class="cl-fc3e29a0">PhillipineEnglish</span></p></td><td class="cl-fc44cd29"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td><td class="cl-fc44cd29"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td><td class="cl-fc44cd29"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd29"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td><td class="cl-fc44cd29"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td><td class="cl-fc44cd29"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td><td class="cl-fc44cd29"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td><td class="cl-fc44cd29"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td><td class="cl-fc44cd29"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd32"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc44cd50"><p class="cl-fc448624"><span class="cl-fc3e29a0">IndianEnglish</span></p></td><td class="cl-fc44cd64"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td><td class="cl-fc44cd64"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td><td class="cl-fc44cd64"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd64"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td><td class="cl-fc44cd64"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td><td class="cl-fc44cd64"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td><td class="cl-fc44cd64"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td><td class="cl-fc44cd64"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td><td class="cl-fc44cd64"><p class="cl-fc448624"><span class="cl-fc3e29a0">1</span></p></td><td class="cl-fc44cd6e"><p class="cl-fc448624"><span class="cl-fc3e29a0">0</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>Now that we have our data, we will create a distance matrix but in contrast to previous methods, we will use a different distance measure that takes into account that we are dealing with nominal (or binary) data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># clean data</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>clusts <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(clus)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co"># create distance matrix</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>clustd <span class="ot">&lt;-</span> <span class="fu">dist</span>(clusts, <span class="at">method =</span> <span class="st">"binary"</span>) <span class="co"># create a distance object with binary (!) distance</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-fc8aca12{table-layout:auto;width:50%;}.cl-fc7af9e8{font-family:'Arial';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fc7af9f2{font-family:'Arial';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fc804de4{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-fc804e02{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-fc809222{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc809240{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc809241{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc80924a{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc809254{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc80925e{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc809268{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc809269{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc809272{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc80927c{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc80927d{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fc809286{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-fc8aca12"><thead><tr style="overflow-wrap:break-word;"><th class="cl-fc809222"><p class="cl-fc804de4"><span class="cl-fc7af9e8">Variety</span></p></th><th class="cl-fc809240"><p class="cl-fc804e02"><span class="cl-fc7af9e8">IrishEnglish</span></p></th><th class="cl-fc809240"><p class="cl-fc804e02"><span class="cl-fc7af9e8">ScottishEnglish</span></p></th><th class="cl-fc809240"><p class="cl-fc804e02"><span class="cl-fc7af9e8">BritishEnglish</span></p></th><th class="cl-fc809240"><p class="cl-fc804e02"><span class="cl-fc7af9e8">AustralianEnglish</span></p></th><th class="cl-fc809240"><p class="cl-fc804e02"><span class="cl-fc7af9e8">NewZealandEnglish</span></p></th><th class="cl-fc809240"><p class="cl-fc804e02"><span class="cl-fc7af9e8">AmericanEnglish</span></p></th><th class="cl-fc809240"><p class="cl-fc804e02"><span class="cl-fc7af9e8">CanadianEnglish</span></p></th><th class="cl-fc809240"><p class="cl-fc804e02"><span class="cl-fc7af9e8">JamaicanEnglish</span></p></th><th class="cl-fc809240"><p class="cl-fc804e02"><span class="cl-fc7af9e8">PhillipineEnglish</span></p></th><th class="cl-fc809241"><p class="cl-fc804e02"><span class="cl-fc7af9e8">IndianEnglish</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-fc80924a"><p class="cl-fc804de4"><span class="cl-fc7af9f2">IrishEnglish</span></p></td><td class="cl-fc809254"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.0</span></p></td><td class="cl-fc809254"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.0</span></p></td><td class="cl-fc809254"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.40</span></p></td><td class="cl-fc809254"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.40</span></p></td><td class="cl-fc809254"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.40</span></p></td><td class="cl-fc809254"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.60</span></p></td><td class="cl-fc809254"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.60</span></p></td><td class="cl-fc809254"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.80</span></p></td><td class="cl-fc809254"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.80</span></p></td><td class="cl-fc80925e"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.80</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc809268"><p class="cl-fc804de4"><span class="cl-fc7af9f2">ScottishEnglish</span></p></td><td class="cl-fc809269"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.0</span></p></td><td class="cl-fc809269"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.0</span></p></td><td class="cl-fc809269"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.40</span></p></td><td class="cl-fc809269"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.40</span></p></td><td class="cl-fc809269"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.40</span></p></td><td class="cl-fc809269"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.60</span></p></td><td class="cl-fc809269"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.60</span></p></td><td class="cl-fc809269"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.80</span></p></td><td class="cl-fc809269"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.80</span></p></td><td class="cl-fc809272"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.80</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc80924a"><p class="cl-fc804de4"><span class="cl-fc7af9f2">BritishEnglish</span></p></td><td class="cl-fc809254"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.4</span></p></td><td class="cl-fc809254"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.4</span></p></td><td class="cl-fc809254"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.00</span></p></td><td class="cl-fc809254"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.00</span></p></td><td class="cl-fc809254"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.00</span></p></td><td class="cl-fc809254"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.33</span></p></td><td class="cl-fc809254"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.33</span></p></td><td class="cl-fc809254"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.67</span></p></td><td class="cl-fc809254"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.67</span></p></td><td class="cl-fc80925e"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.67</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc809268"><p class="cl-fc804de4"><span class="cl-fc7af9f2">AustralianEnglish</span></p></td><td class="cl-fc809269"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.4</span></p></td><td class="cl-fc809269"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.4</span></p></td><td class="cl-fc809269"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.00</span></p></td><td class="cl-fc809269"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.00</span></p></td><td class="cl-fc809269"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.00</span></p></td><td class="cl-fc809269"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.33</span></p></td><td class="cl-fc809269"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.33</span></p></td><td class="cl-fc809269"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.67</span></p></td><td class="cl-fc809269"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.67</span></p></td><td class="cl-fc809272"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.67</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc80924a"><p class="cl-fc804de4"><span class="cl-fc7af9f2">NewZealandEnglish</span></p></td><td class="cl-fc809254"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.4</span></p></td><td class="cl-fc809254"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.4</span></p></td><td class="cl-fc809254"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.00</span></p></td><td class="cl-fc809254"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.00</span></p></td><td class="cl-fc809254"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.00</span></p></td><td class="cl-fc809254"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.33</span></p></td><td class="cl-fc809254"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.33</span></p></td><td class="cl-fc809254"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.67</span></p></td><td class="cl-fc809254"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.67</span></p></td><td class="cl-fc80925e"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.67</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc809268"><p class="cl-fc804de4"><span class="cl-fc7af9f2">AmericanEnglish</span></p></td><td class="cl-fc809269"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.6</span></p></td><td class="cl-fc809269"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.6</span></p></td><td class="cl-fc809269"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.33</span></p></td><td class="cl-fc809269"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.33</span></p></td><td class="cl-fc809269"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.33</span></p></td><td class="cl-fc809269"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.00</span></p></td><td class="cl-fc809269"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.00</span></p></td><td class="cl-fc809269"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.50</span></p></td><td class="cl-fc809269"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.50</span></p></td><td class="cl-fc809272"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.50</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc80924a"><p class="cl-fc804de4"><span class="cl-fc7af9f2">CanadianEnglish</span></p></td><td class="cl-fc809254"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.6</span></p></td><td class="cl-fc809254"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.6</span></p></td><td class="cl-fc809254"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.33</span></p></td><td class="cl-fc809254"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.33</span></p></td><td class="cl-fc809254"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.33</span></p></td><td class="cl-fc809254"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.00</span></p></td><td class="cl-fc809254"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.00</span></p></td><td class="cl-fc809254"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.50</span></p></td><td class="cl-fc809254"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.50</span></p></td><td class="cl-fc80925e"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.50</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc809268"><p class="cl-fc804de4"><span class="cl-fc7af9f2">JamaicanEnglish</span></p></td><td class="cl-fc809269"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.8</span></p></td><td class="cl-fc809269"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.8</span></p></td><td class="cl-fc809269"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.67</span></p></td><td class="cl-fc809269"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.67</span></p></td><td class="cl-fc809269"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.67</span></p></td><td class="cl-fc809269"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.50</span></p></td><td class="cl-fc809269"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.50</span></p></td><td class="cl-fc809269"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.00</span></p></td><td class="cl-fc809269"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.00</span></p></td><td class="cl-fc809272"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.00</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc80924a"><p class="cl-fc804de4"><span class="cl-fc7af9f2">PhillipineEnglish</span></p></td><td class="cl-fc809254"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.8</span></p></td><td class="cl-fc809254"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.8</span></p></td><td class="cl-fc809254"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.67</span></p></td><td class="cl-fc809254"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.67</span></p></td><td class="cl-fc809254"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.67</span></p></td><td class="cl-fc809254"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.50</span></p></td><td class="cl-fc809254"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.50</span></p></td><td class="cl-fc809254"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.00</span></p></td><td class="cl-fc809254"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.00</span></p></td><td class="cl-fc80925e"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.00</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fc80927c"><p class="cl-fc804de4"><span class="cl-fc7af9f2">IndianEnglish</span></p></td><td class="cl-fc80927d"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.8</span></p></td><td class="cl-fc80927d"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.8</span></p></td><td class="cl-fc80927d"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.67</span></p></td><td class="cl-fc80927d"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.67</span></p></td><td class="cl-fc80927d"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.67</span></p></td><td class="cl-fc80927d"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.50</span></p></td><td class="cl-fc80927d"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.50</span></p></td><td class="cl-fc80927d"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.00</span></p></td><td class="cl-fc80927d"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.00</span></p></td><td class="cl-fc809286"><p class="cl-fc804e02"><span class="cl-fc7af9f2">0.00</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>As before, we can now use hierarchical clustering to display the results as a dendrogram</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create cluster object (ward.D2 linkage)   : cluster in a way to achieve minimum variance</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>cd <span class="ot">&lt;-</span> <span class="fu">hclust</span>(clustd, <span class="at">method =</span> <span class="st">"ward.D2"</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># plot result as dendrogram</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cd, <span class="at">hang =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="co"># display dendogram</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="clust_files/figure-html/cl35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In a next step, we want to determine which features are particularly distinctive for one cluster (the “Celtic” cluster containing Irish and Scottish English).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create factor with celtic varieties on one hand and other varieties on other</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>cluster <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">ifelse</span>(<span class="fu">as.character</span>(<span class="fu">rownames</span>(clusts)) <span class="sc">==</span> <span class="st">"IrishEnglish"</span>, <span class="st">"1"</span>,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(<span class="fu">as.character</span>(<span class="fu">rownames</span>(clusts)) <span class="sc">==</span> <span class="st">"ScottishEnglish"</span>, <span class="st">"1"</span>, <span class="st">"0"</span>)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="co"># convert into data frame</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>clsts.df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(clusts)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="co"># determine significance</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(exact2x2)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>pfish <span class="ot">&lt;-</span> <span class="fu">fisher.exact</span>(<span class="fu">table</span>(cluster, clsts.df<span class="sc">$</span>youse))</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>pfish[[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.02222222</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># determine effect size</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">assocstats</span>(<span class="fu">table</span>(cluster, clsts.df<span class="sc">$</span>youse))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    X^2 df  P(&gt; X^2)
Likelihood Ratio 10.008  1 0.0015586
Pearson          10.000  1 0.0015654

Phi-Coefficient   : 1 
Contingency Coeff.: 0.707 
Cramer's V        : 1 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">assocstats</span>(<span class="fu">table</span>(cluster, clsts.df<span class="sc">$</span>like))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    X^2 df P(&gt; X^2)
Likelihood Ratio 1.6323  1  0.20139
Pearson          1.0714  1  0.30062

Phi-Coefficient   : 0.327 
Contingency Coeff.: 0.311 
Cramer's V        : 0.327 </code></pre>
</div>
</div>
<p>Clustering is a highly complex topic and there many more complexities to it. However, this should have helped to get you started.</p>
</section>
</section>
<section id="correspondence-analysis" class="level1">
<h1>Correspondence Analysis</h1>
<p>Correspondence analysis (CA) represents a multivariate statistical technique that provides a graphic method of exploring the relationship between variables in a contingency table. CA is conceptually similar to principal component analysis (PCA), but applies to categorical rather than continuous data.</p>
<p>CA consists out of the following four steps:</p>
<ol type="1">
<li>Computing row and column averages</li>
<li>Computing expected values</li>
<li>Computing the residuals</li>
<li>Plotting residuals</li>
</ol>
<p>In this tutorial, we investigate similarities among amplifiers based on their co-occurrences (word embeddings) with adjectives. Adjective amplifiers are elements such as those in 1. to 5.</p>
<ol type="1">
<li>The <em>very</em><sub>amplifier</sub> <em>nice</em><sub>adjective</sub> man.</li>
<li>A <em>truely</em><sub>amplifier</sub> <em>remarkable</em><sub>adjective</sub> woman.</li>
<li>He was <em>really</em><sub>amplifier</sub> <em>hesitant</em><sub>adjective</sub>.</li>
<li>The child was <em>awfully</em><sub>amplifier</sub> <em>loud</em><sub>adjective</sub>.</li>
<li>The festival was <em>so</em><sub>amplifier</sub> <em>amazing</em><sub>adjective</sub>!</li>
</ol>
<p>The similarity among adjective amplifiers can then be used to find clusters or groups of amplifiers that <em>behave</em> similarly and are interchangeable. To elaborate, adjective amplifiers are interchangeable with some variants but not with others (consider 6. to 8.; the question mark signifies that the example is unlikely to be used or grammatically not acceptable by L1 speakers of English).</p>
<ol start="6" type="1">
<li>The <em>very</em><sub>amplifier</sub> <em>nice</em><sub>adjective</sub> man.</li>
<li>The <em>really</em><sub>amplifier</sub> <em>nice</em><sub>adjective</sub> man.</li>
<li><sup>?</sup>The <em>completely</em><sub>amplifier</sub> <em>nice</em><sub>adjective</sub> man.</li>
</ol>
<p>We start by loading the data, and then displaying the data which is called <code>vsmdata</code> and consist of 5,000 observations of adjectives and contains two columns: one column with the adjectives (Adjectives) and another column which has the amplifiers (0 means that the adjective occurred without an amplifier).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load data</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>vsmdata <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="st">"tutorials/clust/data/vsd.rda"</span>, <span class="st">"rb"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-fcc8b5c0{table-layout:auto;width:50%;}.cl-fcb9b390{font-family:'Arial';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fcb9b3b8{font-family:'Arial';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fcbe3730{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-fcbe8244{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fcbe8258{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fcbe8259{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fcbe8262{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fcbe826c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fcbe826d{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fcbe8276{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fcbe8280{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-fcc8b5c0"><thead><tr style="overflow-wrap:break-word;"><th class="cl-fcbe8244"><p class="cl-fcbe3730"><span class="cl-fcb9b390">Amplifier</span></p></th><th class="cl-fcbe8258"><p class="cl-fcbe3730"><span class="cl-fcb9b390">Adjective</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-fcbe8259"><p class="cl-fcbe3730"><span class="cl-fcb9b3b8">0</span></p></td><td class="cl-fcbe8262"><p class="cl-fcbe3730"><span class="cl-fcb9b3b8">serious</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fcbe826c"><p class="cl-fcbe3730"><span class="cl-fcb9b3b8">0</span></p></td><td class="cl-fcbe826d"><p class="cl-fcbe3730"><span class="cl-fcb9b3b8">sure</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fcbe8259"><p class="cl-fcbe3730"><span class="cl-fcb9b3b8">so</span></p></td><td class="cl-fcbe8262"><p class="cl-fcbe3730"><span class="cl-fcb9b3b8">many</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fcbe826c"><p class="cl-fcbe3730"><span class="cl-fcb9b3b8">0</span></p></td><td class="cl-fcbe826d"><p class="cl-fcbe3730"><span class="cl-fcb9b3b8">many</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fcbe8259"><p class="cl-fcbe3730"><span class="cl-fcb9b3b8">0</span></p></td><td class="cl-fcbe8262"><p class="cl-fcbe3730"><span class="cl-fcb9b3b8">good</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fcbe826c"><p class="cl-fcbe3730"><span class="cl-fcb9b3b8">0</span></p></td><td class="cl-fcbe826d"><p class="cl-fcbe3730"><span class="cl-fcb9b3b8">much</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fcbe8259"><p class="cl-fcbe3730"><span class="cl-fcb9b3b8">0</span></p></td><td class="cl-fcbe8262"><p class="cl-fcbe3730"><span class="cl-fcb9b3b8">good</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fcbe826c"><p class="cl-fcbe3730"><span class="cl-fcb9b3b8">0</span></p></td><td class="cl-fcbe826d"><p class="cl-fcbe3730"><span class="cl-fcb9b3b8">good</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fcbe8259"><p class="cl-fcbe3730"><span class="cl-fcb9b3b8">0</span></p></td><td class="cl-fcbe8262"><p class="cl-fcbe3730"><span class="cl-fcb9b3b8">last</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fcbe8276"><p class="cl-fcbe3730"><span class="cl-fcb9b3b8">0</span></p></td><td class="cl-fcbe8280"><p class="cl-fcbe3730"><span class="cl-fcb9b3b8">nice</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>For this tutorial, we will reduce the number of amplifiers and adjectives and thus simplify the data to render it easier to understand what is going on. To simplify the data, we remove</p>
<ul>
<li>all non-amplified adjectives</li>
<li>the adjectives many and much</li>
<li>adjectives that are amplified less than 10 times</li>
</ul>
<p>In addition, we collapse all amplifiers that occur less than 20 times into a bin category (<em>other</em>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simplify data</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>vsmdata_simp <span class="ot">&lt;-</span> vsmdata <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove non-amplifier adjectives</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    Amplifier <span class="sc">!=</span> <span class="dv">0</span>,</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    Adjective <span class="sc">!=</span> <span class="st">"many"</span>,</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    Adjective <span class="sc">!=</span> <span class="st">"much"</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># collapse infrequent amplifiers</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(Amplifier) <span class="sc">%&gt;%</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">AmpFreq =</span> dplyr<span class="sc">::</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Amplifier =</span> <span class="fu">ifelse</span>(AmpFreq <span class="sc">&gt;</span> <span class="dv">20</span>, Amplifier, <span class="st">"other"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># collapse infrequent adjectives</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(Adjective) <span class="sc">%&gt;%</span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">AdjFreq =</span> dplyr<span class="sc">::</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Adjective =</span> <span class="fu">ifelse</span>(AdjFreq <span class="sc">&gt;</span> <span class="dv">10</span>, Adjective, <span class="st">"other"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Adjective <span class="sc">!=</span> <span class="st">"other"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>AmpFreq, <span class="sc">-</span>AdjFreq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-fcedb924{table-layout:auto;width:50%;}.cl-fce34c64{font-family:'Arial';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fce34c6e{font-family:'Arial';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-fce731d0{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-fce74e72{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fce74e86{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fce74e90{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fce74e9a{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fce74ea4{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fce74eae{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fce74ec2{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-fce74ecc{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-fcedb924"><thead><tr style="overflow-wrap:break-word;"><th class="cl-fce74e72"><p class="cl-fce731d0"><span class="cl-fce34c64">Amplifier</span></p></th><th class="cl-fce74e86"><p class="cl-fce731d0"><span class="cl-fce34c64">Adjective</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-fce74e90"><p class="cl-fce731d0"><span class="cl-fce34c6e">very</span></p></td><td class="cl-fce74e9a"><p class="cl-fce731d0"><span class="cl-fce34c6e">good</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fce74ea4"><p class="cl-fce731d0"><span class="cl-fce34c6e">really</span></p></td><td class="cl-fce74eae"><p class="cl-fce731d0"><span class="cl-fce34c6e">nice</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fce74e90"><p class="cl-fce731d0"><span class="cl-fce34c6e">really</span></p></td><td class="cl-fce74e9a"><p class="cl-fce731d0"><span class="cl-fce34c6e">good</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fce74ea4"><p class="cl-fce731d0"><span class="cl-fce34c6e">really</span></p></td><td class="cl-fce74eae"><p class="cl-fce731d0"><span class="cl-fce34c6e">bad</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fce74e90"><p class="cl-fce731d0"><span class="cl-fce34c6e">very</span></p></td><td class="cl-fce74e9a"><p class="cl-fce731d0"><span class="cl-fce34c6e">nice</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fce74ea4"><p class="cl-fce731d0"><span class="cl-fce34c6e">really</span></p></td><td class="cl-fce74eae"><p class="cl-fce731d0"><span class="cl-fce34c6e">nice</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fce74e90"><p class="cl-fce731d0"><span class="cl-fce34c6e">very</span></p></td><td class="cl-fce74e9a"><p class="cl-fce731d0"><span class="cl-fce34c6e">hard</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fce74ea4"><p class="cl-fce731d0"><span class="cl-fce34c6e">other</span></p></td><td class="cl-fce74eae"><p class="cl-fce731d0"><span class="cl-fce34c6e">good</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fce74e90"><p class="cl-fce731d0"><span class="cl-fce34c6e">really</span></p></td><td class="cl-fce74e9a"><p class="cl-fce731d0"><span class="cl-fce34c6e">nice</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-fce74ec2"><p class="cl-fce731d0"><span class="cl-fce34c6e">really</span></p></td><td class="cl-fce74ecc"><p class="cl-fce731d0"><span class="cl-fce34c6e">good</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>We now use a balloon plot to see if there are any potential correlations between amplifiers and adjectives.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. convert the data as a table</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">table</span>(vsmdata_simp))</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Graph</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="fu">balloonplot</span>(<span class="fu">t</span>(dt),</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"vsmdata_simp"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>,</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="cn">FALSE</span>, <span class="at">show.margins =</span> <span class="cn">FALSE</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="clust_files/figure-html/ca3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The balloon plot suggests that there are potential correlations as the dots (balloons) are not distributed evenly according to frequency. To validate if there is significant correlation between the amplifier types and the adjectives using a <span class="math inline">\(\chi\)</span><sup>2</sup>- test.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>chisq <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(dt)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>chisq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  dt
X-squared = 124.4, df = 40, p-value = 1.375e-10</code></pre>
</div>
</div>
<p>The <span class="math inline">\(\chi\)</span><sup>2</sup>- test confirms that there is a significant correlations between amplifier types and the adjectives.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>res.ca <span class="ot">&lt;-</span> FactoMineR<span class="sc">::</span><span class="fu">CA</span>(dt, <span class="at">graph =</span> <span class="cn">FALSE</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect results of the CA</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co"># print(res.ca)</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>eig.val <span class="ot">&lt;-</span> <span class="fu">get_eigenvalue</span>(res.ca)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>eig.val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      eigenvalue variance.percent cumulative.variance.percent
Dim.1 0.24138007        49.868237                    49.86824
Dim.2 0.14687839        30.344536                    80.21277
Dim.3 0.06125177        12.654392                    92.86716
Dim.4 0.03452547         7.132836                   100.00000</code></pre>
</div>
</div>
<p>The display of the <em>eigenvalues</em> provides information on the amount of variance that is explained by each dimension. The first dimension explains 49.87 percent of the variance, the second dimension explains another 30.34 percent of the variance, leaving all other variables with relative moderate explanatory power as they only account for 20 percent variance. We now plot and interpret the results of the CA.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># repel= TRUE to avoid text overlapping (slow if many point)</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_ca_biplot</span>(res.ca,</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">repel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">col.row =</span> <span class="st">"orange"</span>,</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">col.col =</span> <span class="st">"darkgray"</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="clust_files/figure-html/ca6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The results of the CA show that the adjective <em>different</em> is collocating with <em>other</em> amplifiers while <em>very</em> is collocating with <em>difficult</em> and <em>important</em>, <em>pretty</em> is collocating with <em>big</em>, <em>really</em> is collocating with <em>nice</em>, and <em>so</em> is collocating with <em>bad</em>.</p>
</section>
<section id="citation-session-info" class="level1 unnumbered">
<h1 class="unnumbered">Citation &amp; Session Info</h1>
<p>Schweinberger, Martin. 2023. <em>Cluster and Correspondence Analysis in R</em>. Brisbane: The University of Queensland. url: https://ladal.edu.au/tutorials/clust.html (Version 2023.05.31).</p>
<pre><code>@manual{schweinberger2023clust,
  author = {Schweinberger, Martin},
  title = {Cluster and Correspondence Analysis in R},
  note = {tutorials/clust/clust.html},
  year = {2023},
  organization = "The University of Queensland, Australia. School of Languages and Cultures},
  address = {Brisbane},
  edition = {2023.05.31}
}</code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.4.2 (2024-10-31 ucrt)
Platform: x86_64-w64-mingw32/x64
Running under: Windows 11 x64 (build 26100)

Matrix products: default


locale:
[1] LC_COLLATE=English_United States.utf8 
[2] LC_CTYPE=English_United States.utf8   
[3] LC_MONETARY=English_United States.utf8
[4] LC_NUMERIC=C                          
[5] LC_TIME=English_United States.utf8    

time zone: Australia/Brisbane
tzcode source: internal

attached base packages:
[1] grid      stats     graphics  grDevices datasets  utils     methods  
[8] base     

other attached packages:
 [1] gplots_3.2.0     tibble_3.2.1     flextable_0.9.7  exact2x2_1.6.9  
 [5] exactci_1.4-4    testthat_3.2.3   ssanv_1.1        vcd_1.4-13      
 [9] ape_5.8-1        pvclust_2.2-0    seriation_1.5.7  factoextra_1.0.7
[13] ggplot2_3.5.1    cluster_2.1.6   

loaded via a namespace (and not attached):
  [1] bitops_1.0-9            sandwich_3.1-1          rlang_1.1.5            
  [4] magrittr_2.0.3          multcomp_1.4-28         compiler_4.4.2         
  [7] systemfonts_1.2.1       vctrs_0.6.5             reshape2_1.4.4         
 [10] stringr_1.5.1           pkgconfig_2.0.3         fastmap_1.2.0          
 [13] backports_1.5.0         labeling_0.4.3          caTools_1.18.3         
 [16] ca_0.71.1               rmarkdown_2.29          ragg_1.3.3             
 [19] purrr_1.0.4             xfun_0.51               jsonlite_1.9.0         
 [22] flashClust_1.01-2       uuid_1.2-1              broom_1.0.7            
 [25] parallel_4.4.2          R6_2.6.1                stringi_1.8.4          
 [28] car_3.1-3               brio_1.1.5              lmtest_0.9-40          
 [31] estimability_1.5.1      Rcpp_1.0.14             assertthat_0.2.1       
 [34] iterators_1.0.14        knitr_1.49              zoo_1.8-13             
 [37] klippy_0.0.0.9500       Matrix_1.7-1            splines_4.4.2          
 [40] tidyselect_1.2.1        abind_1.4-8             rstudioapi_0.17.1      
 [43] yaml_2.3.10             TSP_1.2-4               codetools_0.2-20       
 [46] lattice_0.22-6          plyr_1.8.9              withr_3.0.2            
 [49] askpass_1.2.1           coda_0.19-4.1           evaluate_1.0.3         
 [52] survival_3.7-0          zip_2.3.2               xml2_1.3.6             
 [55] pillar_1.10.1           ggpubr_0.6.0            carData_3.0-5          
 [58] KernSmooth_2.23-24      renv_1.1.1              DT_0.33                
 [61] foreach_1.5.2           generics_0.1.3          munsell_0.5.1          
 [64] scales_1.3.0            gtools_3.9.5            xtable_1.8-4           
 [67] leaps_3.2               glue_1.8.0              gdtools_0.4.1          
 [70] emmeans_1.10.7          scatterplot3d_0.3-44    tools_4.4.2            
 [73] data.table_1.17.0       ggsignif_0.6.4          registry_0.5-1         
 [76] mvtnorm_1.3-3           tidyr_1.3.1             colorspace_2.1-1       
 [79] nlme_3.1-166            Formula_1.2-5           cli_3.6.4              
 [82] textshaping_1.0.0       officer_0.6.7           fontBitstreamVera_0.1.1
 [85] dplyr_1.1.4             gtable_0.3.6            rstatix_0.7.2          
 [88] digest_0.6.37           fontquiver_0.2.1        ggrepel_0.9.6          
 [91] TH.data_1.1-3           FactoMineR_2.11         htmlwidgets_1.6.4      
 [94] farver_2.1.2            htmltools_0.5.8.1       lifecycle_1.0.4        
 [97] multcompView_0.1-10     fontLiberation_0.1.0    openssl_2.3.2          
[100] MASS_7.3-61            </code></pre>
</div>
</div>
<hr>
<p><a href="#introduction">Back to top</a></p>
<p><a href="../..">Back to HOME</a></p>
<hr>
</section>
<section id="references" class="level1 unnumbered">




</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-aggarwal2015data" class="csl-entry" role="listitem">
Aggarwal, Charu C. <em>Data Mining: The Textbook</em>. Springer.
</div>
<div id="ref-blashfield1988methods" class="csl-entry" role="listitem">
Blashfield, Roger K, and Mark S Aldenderfer. <span>“The Methods and Problems of Cluster Analysis.”</span> In <em>Handbook of Multivariate Experimental Psychology</em>, 447–73. Springer.
</div>
<div id="ref-kassambara2017practical" class="csl-entry" role="listitem">
Kassambara, Alboukadel. <em>Practical Guide to Cluster Analysis in r: Unsupervised Machine Learning</em>. Sthda.
</div>
<div id="ref-kettenring2006practice" class="csl-entry" role="listitem">
Kettenring, Jon R. <span>“The Practice of Cluster Analysis.”</span> <em>Journal of Classification</em>, 3–30.
</div>
<div id="ref-king2015cluster" class="csl-entry" role="listitem">
King, Ronald S. <em>Cluster Analysis and Data Mining: An Introduction</em>. Stylus Publishing, LLC.
</div>
<div id="ref-levshina2015linguistics" class="csl-entry" role="listitem">
Levshina, Natalia. <em>How to Do Linguistics with r: Data Exploration and Statistical Analysis</em>. Amsterdam: John Benjamins Publishing Company.
</div>
<div id="ref-romesburg2004cluster" class="csl-entry" role="listitem">
Romesburg, Charles. <em>Cluster Analysis for Researchers</em>. Lulu Press.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>If you want to render the R Notebook on your machine, i.e.&nbsp;knitting the document to html or a pdf, you need to make sure that you have R and RStudio installed and you also need to download the [<strong>bibliography file</strong>](/assets/bibliography.bib and store it in the same folder where you store the Rmd file.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>