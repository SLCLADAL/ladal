<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Martin Schweinberger">

<title>Spell checking text data with R – Language Technology and Data Analysis Laboratory (LADAL)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-c00ead3b610a61ca0c1a529afe17c12f.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-VSGK4KYDQZ"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-VSGK4KYDQZ', { 'anonymize_ip': true});
</script>
<style>html{ scroll-behavior: smooth; }</style>
<script>
    // Wait for the document to be fully loaded
    document.addEventListener("DOMContentLoaded", function () {
        // Create a new div element to hold the dynamic content
        var newContainer = document.createElement("div");
        newContainer.classList.add("custom-banner");  // You can assign a class to the new container for styling

        // You can also add content inside the new container
        newContainer.innerHTML = `
          <div class="banner">
              <img src="/images/ladal_icon_white.png" alt="Icon" class="banner-icon">
              <span class="banner-text">Language Technology and Data Analysis Laboratory</span>
          </div>
      `

        // Select the header element
        var header = document.getElementById("quarto-header");

        // Select the nav element inside the header to place the new container just above it
        var navbar = header.querySelector("nav");

        // Insert the new container before the navbar element
        header.insertBefore(newContainer, navbar);
    });
</script>
<script src="../../site_libs/clipboard-1.7.1/clipboard.min.js"></script>
<link href="../../site_libs/primer-tooltips-1.4.0/build.css" rel="stylesheet">
<link href="../../site_libs/klippy-0.0.0.9500/css/klippy.min.css" rel="stylesheet">
<script src="../../site_libs/klippy-0.0.0.9500/js/klippy.min.js"></script>
<link href="../../site_libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">
<script src="../../site_libs/tabwid-1.1.3/tabwid.js"></script>


<link rel="stylesheet" href="../../css/styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Language Technology and Data Analysis Laboratory (LADAL)</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">HOME</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">ABOUT</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../events.html"> 
<span class="menu-text">EVENTS</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials.html"> 
<span class="menu-text">TUTORIALS</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../tools.html"> 
<span class="menu-text">TOOLS</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../resources.html"> 
<span class="menu-text">RESOURCES</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../contact.html"> 
<span class="menu-text">CONTACT</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul class="collapse">
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#what-is-spell-checking" id="toc-what-is-spell-checking" class="nav-link" data-scroll-target="#what-is-spell-checking">What is spell checking?</a></li>
  <li><a href="#spell-checking-in-r-with-hunspell" id="toc-spell-checking-in-r-with-hunspell" class="nav-link" data-scroll-target="#spell-checking-in-r-with-hunspell">Spell checking in R with hunspell</a>
  <ul class="collapse">
  <li><a href="#checking-individual-words" id="toc-checking-individual-words" class="nav-link" data-scroll-target="#checking-individual-words">Checking individual words</a></li>
  <li><a href="#checking-documents" id="toc-checking-documents" class="nav-link" data-scroll-target="#checking-documents">Checking documents</a></li>
  <li><a href="#stemming-words" id="toc-stemming-words" class="nav-link" data-scroll-target="#stemming-words">Stemming Words</a></li>
  <li><a href="#working-with-texts" id="toc-working-with-texts" class="nav-link" data-scroll-target="#working-with-texts">Working with texts</a></li>
  <li><a href="#setting-a-language" id="toc-setting-a-language" class="nav-link" data-scroll-target="#setting-a-language">Setting a Language</a></li>
  </ul></li>
  <li><a href="#citation-session-info" id="toc-citation-session-info" class="nav-link" data-scroll-target="#citation-session-info">Citation &amp; Session Info</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Spell checking text data with R</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Martin Schweinberger </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<p><img src="../../images/uq1.jpg" class="img-fluid" style="width:100.0%"></p>
<section id="introduction" class="level1 unnumbered">
<h1 class="unnumbered">Introduction</h1>
<p>This tutorial focuses on spell checking and shows how to perform spell checking in R. This tutorial builds heavily on (the documentation site of the <code>hunspell</code> package)[https://cran.r-project.org/web/packages/hunspell/vignettes/intro.html] <span class="citation" data-cites="hunspell">(<a href="#ref-hunspell" role="doc-biblioref">Ooms</a>)</span>.</p>
<p><img src="../../images/gy_chili.png" class="img-fluid" style="float:right; padding:10px;width:15.0%"></p>
<p>This tutorial is aimed at beginners and intermediate users of R with the aim of showcasing how to perform spell checking of textual data using R. The aim is not to provide a fully-fledged analysis but rather to show and exemplify selected useful aspects of spell checking.</p>
<div class="warning" style="padding:0.1em; background-color:#f2f2f2; color:#51247a">
<span>
<p style="margin-top:1em; text-align:center">
The entire R Notebook for the tutorial can be downloaded <a href="tutorials/spellcheck/spellcheck.qmd">here</a>. If you want to render the R Notebook on your machine, i.e.&nbsp;knitting the document to html or a pdf, you need to make sure that you have R and RStudio installed and you also need to download the <a href="../../assets/bibliography.bib"><strong>bibliography file</strong></a> and store it in the same folder where you store the Rmd file.
</p>
<div class="text-center">
<p><a href="https://binderhub.atap-binder.cloud.edu.au/v2/gh/SLCLADAL/interactive-notebooks-environment/main?urlpath=git-pull%3Frepo=https://github.com/SLCLADAL/interactive-notebooks%26urlpath=lab/tree/interactive-notebooks/notebooks/spellcheck_cb.ipynb%26branch=main"><img src="https://mybinder.org/badge_logo.svg" class="img-fluid"></a></p>
<p>Click <a href="https://binderhub.atap-binder.cloud.edu.au/v2/gh/SLCLADAL/interactive-notebooks-environment/main?urlpath=git-pull%3Frepo=https://github.com/SLCLADAL/interactive-notebooks%26urlpath=lab/tree/interactive-notebooks/notebooks/spellcheck_cb.ipynb%26branch=main"><strong>here</strong></a> to open an interactive Jupyter notebook that allows you execute, change, and edit the code as well as upload your own data.</p>
</div>
<p style="margin-left:1em;">
</p>
<p></p>
</span></div>
<p><br></p>
</section>
<section id="what-is-spell-checking" class="level1 unnumbered">
<h1 class="unnumbered">What is spell checking?</h1>
<p>Spell checking is the process of checking for and identifying spelling errors in a piece of text. It works by comparing each word in the text against a dictionary of correctly spelled words, and marking any words that are not found in the dictionary as potentially misspelled.</p>
<p>Spell checking is used in a variety of applications, including word processors, email clients, and online text editors, to help users produce error-free written material. The goal of spell checking is to improve the accuracy and readability of written text by catching and correcting spelling errors before they are published or sent.</p>
<p>Spell checking of textual data consists of the following steps:</p>
<ul>
<li>First, the text in a document is tokenized, i.e.&nbsp;the text is broken down into individual words.</li>
<li>Each word is then broken down in it’s root (stemming) and affix(es)</li>
<li>Next, it i checked if the word (plus affix combination) occurs in a dictionary</li>
<li>Optionally, for words (or combinations), corrections are suggested based on similar words in the dictionary</li>
</ul>
</section>
<section id="spell-checking-in-r-with-hunspell" class="level1 unnumbered">
<h1 class="unnumbered">Spell checking in R with hunspell</h1>
<p>The <code>hunspell</code> package provides access to Hunspell which is a spell checker library used in various software applications such as OpenOffice, Mozilla Firefox, or RStudio. In addition to simple spell checking, the <code>hunspell</code> package also provides additional funtionalities like tokenization or stemming and and its spell checking capabilities encompass almost any language or alphabet. Tokenization and stemming are part of the <code>hunspell</code> package in order to split texts into individual words but also to extract text from several file formats such as basic text, html, pdf, or xml.</p>
<p>The <code>hunspell</code> package checks if words occur in a given dictionary with the (default) dictionary being “en_US”. However each function can be used in another language by setting a custom dictionary in the <code>dict</code> parameter.</p>
<p><strong>Preparation and session set up</strong></p>
<p>This tutorial is based on R. If you have not installed R or are new to it, you will find an introduction to and more information how to use R <a href="tutorials/intror/intror.html">here</a>. For this tutorials, we need to install certain <em>packages</em> from an R <em>library</em> so that the scripts shown below are executed without errors. Before turning to the code below, please install the packages by running the code below this paragraph. If you have already installed the packages mentioned below, then you can skip ahead and ignore this section. To install the necessary packages, simply run the following code - it may take some time (between 1 and 5 minutes to install all of the packages so you do not need to worry if it takes some time).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"dplyr"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"stringr"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"quanteda"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"hunspell"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"flextable"</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># install klippy for copy-to-clipboard button in code chunks</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"remotes"</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"rlesur/klippy"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now that we have installed the packages, we activate them as shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r klippy code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># activate packages</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quanteda)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hunspell)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># activate klippy for copy-to-clipboard button</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>klippy<span class="sc">::</span><span class="fu">klippy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<script>
  addClassKlippyTo("pre.r, pre.markdown");
  addKlippy('left', 'top', 'auto', '1', 'Copy code', 'Copied!');
</script>
</div>
</div>
<p>Once you have installed R and RStudio and initiated the session by executing the code shown above, you are good to go.</p>
<p>In the following, we will perform spell checking and explore several useful functions associated with spell checking in the <code>hunspell</code> package.</p>
<section id="checking-individual-words" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="checking-individual-words">Checking individual words</h2>
<p>We start by checking a vector of individual words.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>words <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"analyze"</span>, <span class="st">"langauge"</span>, <span class="st">"data"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>correct <span class="ot">&lt;-</span> <span class="fu">hunspell_check</span>(words)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(correct)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE FALSE  TRUE</code></pre>
</div>
</div>
<p>The output shows that the second word was not found in the dictionary, i.e., it is identified as being incorrect. Next, we can ask for suggestions, i.e.&nbsp;the correct form of the word.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "language" "melange" </code></pre>
</div>
</div>
<p>In this case, there are two words that are deemed as potential alternatives.</p>
</section>
<section id="checking-documents" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="checking-documents">Checking documents</h2>
<p>Since we rarely want to check individual words, we will now focus on spell checking full texts rather than individual vectors with words.</p>
<p>First, we load a text (in this case an explanation of what grammer is that is taken from Wikipedia).</p>
<div class="cell" data-cmessage="false">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read in text</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>exampletext <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">readRDS</span>(<span class="st">"tutorials/spellcheck/data/tx1.rda"</span>, <span class="st">"rb"</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>exampletext</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Grammar is a system of rules which governs the production and use of utterances in a given language. These rules apply to sound as well as meaning, and include componential subsets of rules, such as those pertaining to phonology (the organisation of phonetic sound systems), morphology (the formation and composition of words), and syntax (the formation and composition of phrases and sentences). Many modern theories that deal with the principles of grammar are based on Noam Chomsky's framework of generative linguistics."</code></pre>
</div>
</div>
<p>We now use the <code>hunspell</code> function to find incorrect words (or, more precisely, words that are not in the default dictionary). The output shows that <em>organisation</em> is considered an error as it follows British spelling conventions (more about this in the section on setting a language).</p>
<div class="cell" data-cmessage="false">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>errors <span class="ot">&lt;-</span> <span class="fu">hunspell</span>(exampletext)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>errors[[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "componential" "organisation" "Noam"        </code></pre>
</div>
</div>
<p>We check what suggestions we get for these words.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hunspell_suggest</span>(errors[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "component"   "exponential" "continental"

[[2]]
[1] "organization" "organist"     "sanitation"  

[[3]]
[1] "Nam"   "Roam"  "Loam"  "Noah"  "Foam"  "No am" "No-am" "Moan"  "Norm" </code></pre>
</div>
</div>
<p>In our case, the words are not errors but simply terms that do not occur in the dictionary, either because they are specialist terminology (<em>componential</em>), they follow British spelling conventions (<em>organisation</em>), or they represent an uncommon proper name (<em>Noam</em>). Thus, so we will not replace them.</p>
</section>
<section id="stemming-words" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="stemming-words">Stemming Words</h2>
<p>The <code>hunspell_stem</code> looks up words from the dictionary which match the root of the given word (sometimes multiple items are returned if there are multiple matches in the dictionary).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>toks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"love"</span>, <span class="st">"loving"</span>, <span class="st">"lovingly"</span>, <span class="st">"loved"</span>, <span class="st">"lover"</span>, <span class="st">"lovely"</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hunspell_stem</span>(toks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "love"

[[2]]
[1] "loving" "love"  

[[3]]
[1] "loving"

[[4]]
[1] "loved" "love" 

[[5]]
[1] "lover" "love" 

[[6]]
[1] "lovely" "love"  </code></pre>
</div>
</div>
<p>The <code>hunspell_stem</code> function can be very useful when trying to find the stems of words in a corpusto see, e.g., how many word types a text contains.</p>
</section>
<section id="working-with-texts" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="working-with-texts">Working with texts</h2>
<p>It is quite common that we work with texts rather than individual word vectors. As such, in the following, we will go through a workflow that resembles what one might use spell checking for in their research.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>texttable <span class="ot">&lt;-</span> quanteda<span class="sc">::</span><span class="fu">tokens</span>(<span class="st">"Noam said he loves to analyze langauge and collors."</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unlist</span>() <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">words =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(.),</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">error =</span> hunspell<span class="sc">::</span><span class="fu">hunspell_check</span>(words)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">relocate</span>(id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-d8c4c810{table-layout:auto;width:95%;}.cl-d8bdbf16{font-family:'DejaVu Sans';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-d8bdbf20{font-family:'DejaVu Sans';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-d8c0a24e{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-d8c0a262{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-d8c0bbe4{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d8c0bbee{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d8c0bbef{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d8c0bbf0{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d8c0bbf8{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d8c0bbf9{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d8c0bc02{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d8c0bc03{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d8c0bc0c{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d8c0bc0d{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d8c0bc0e{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d8c0bc0f{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-d8c4c810"><thead><tr style="overflow-wrap:break-word;"><th class="cl-d8c0bbe4"><p class="cl-d8c0a24e"><span class="cl-d8bdbf16">id</span></p></th><th class="cl-d8c0bbee"><p class="cl-d8c0a262"><span class="cl-d8bdbf16">words</span></p></th><th class="cl-d8c0bbef"><p class="cl-d8c0a24e"><span class="cl-d8bdbf16">error</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-d8c0bbf0"><p class="cl-d8c0a24e"><span class="cl-d8bdbf20">1</span></p></td><td class="cl-d8c0bbf8"><p class="cl-d8c0a262"><span class="cl-d8bdbf20">Noam</span></p></td><td class="cl-d8c0bbf9"><p class="cl-d8c0a24e"><span class="cl-d8bdbf20">FALSE</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d8c0bc02"><p class="cl-d8c0a24e"><span class="cl-d8bdbf20">2</span></p></td><td class="cl-d8c0bc03"><p class="cl-d8c0a262"><span class="cl-d8bdbf20">said</span></p></td><td class="cl-d8c0bc0c"><p class="cl-d8c0a24e"><span class="cl-d8bdbf20">TRUE</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d8c0bbf0"><p class="cl-d8c0a24e"><span class="cl-d8bdbf20">3</span></p></td><td class="cl-d8c0bbf8"><p class="cl-d8c0a262"><span class="cl-d8bdbf20">he</span></p></td><td class="cl-d8c0bbf9"><p class="cl-d8c0a24e"><span class="cl-d8bdbf20">TRUE</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d8c0bc02"><p class="cl-d8c0a24e"><span class="cl-d8bdbf20">4</span></p></td><td class="cl-d8c0bc03"><p class="cl-d8c0a262"><span class="cl-d8bdbf20">loves</span></p></td><td class="cl-d8c0bc0c"><p class="cl-d8c0a24e"><span class="cl-d8bdbf20">TRUE</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d8c0bbf0"><p class="cl-d8c0a24e"><span class="cl-d8bdbf20">5</span></p></td><td class="cl-d8c0bbf8"><p class="cl-d8c0a262"><span class="cl-d8bdbf20">to</span></p></td><td class="cl-d8c0bbf9"><p class="cl-d8c0a24e"><span class="cl-d8bdbf20">TRUE</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d8c0bc02"><p class="cl-d8c0a24e"><span class="cl-d8bdbf20">6</span></p></td><td class="cl-d8c0bc03"><p class="cl-d8c0a262"><span class="cl-d8bdbf20">analyze</span></p></td><td class="cl-d8c0bc0c"><p class="cl-d8c0a24e"><span class="cl-d8bdbf20">TRUE</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d8c0bbf0"><p class="cl-d8c0a24e"><span class="cl-d8bdbf20">7</span></p></td><td class="cl-d8c0bbf8"><p class="cl-d8c0a262"><span class="cl-d8bdbf20">langauge</span></p></td><td class="cl-d8c0bbf9"><p class="cl-d8c0a24e"><span class="cl-d8bdbf20">FALSE</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d8c0bc02"><p class="cl-d8c0a24e"><span class="cl-d8bdbf20">8</span></p></td><td class="cl-d8c0bc03"><p class="cl-d8c0a262"><span class="cl-d8bdbf20">and</span></p></td><td class="cl-d8c0bc0c"><p class="cl-d8c0a24e"><span class="cl-d8bdbf20">TRUE</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d8c0bbf0"><p class="cl-d8c0a24e"><span class="cl-d8bdbf20">9</span></p></td><td class="cl-d8c0bbf8"><p class="cl-d8c0a262"><span class="cl-d8bdbf20">collors</span></p></td><td class="cl-d8c0bbf9"><p class="cl-d8c0a24e"><span class="cl-d8bdbf20">FALSE</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d8c0bc0d"><p class="cl-d8c0a24e"><span class="cl-d8bdbf20">10</span></p></td><td class="cl-d8c0bc0e"><p class="cl-d8c0a262"><span class="cl-d8bdbf20">.</span></p></td><td class="cl-d8c0bc0f"><p class="cl-d8c0a24e"><span class="cl-d8bdbf20">TRUE</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>The output shows the original word and if it was identified as an errors (i.e., it did not occur in the dictionary). Next, we extract suggestions for the words that were identified as errors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>texttable2 <span class="ot">&lt;-</span> texttable <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add suggestions</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">suggestions =</span> <span class="fu">ifelse</span>(error <span class="sc">==</span> F,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>            <span class="fu">paste0</span>(<span class="fu">hunspell_suggest</span>(words), <span class="st">", "</span>),</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">""</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>        <span class="co"># clean suggestions</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">suggestions =</span> stringr<span class="sc">::</span><span class="fu">str_remove_all</span>(suggestions, <span class="fu">fixed</span>(<span class="st">"c("</span>)),</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">suggestions =</span> stringr<span class="sc">::</span><span class="fu">str_remove_all</span>(suggestions, <span class="fu">fixed</span>(<span class="st">")"</span>)),</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">suggestions =</span> stringr<span class="sc">::</span><span class="fu">str_remove_all</span>(suggestions, <span class="st">", {0,1}$"</span>)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-d8e55a58{table-layout:auto;width:95%;}.cl-d8df8132{font-family:'DejaVu Sans';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-d8df8146{font-family:'DejaVu Sans';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-d8e1967a{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-d8e19684{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-d8e1ac50{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d8e1ac5a{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d8e1ac64{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d8e1ac65{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d8e1ac66{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d8e1ac67{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d8e1ac6e{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d8e1ac6f{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d8e1ac78{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d8e1ac79{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d8e1ac7a{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d8e1ac82{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d8e1ac83{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d8e1ac84{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d8e1ac85{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d8e1ac8c{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-d8e55a58"><thead><tr style="overflow-wrap:break-word;"><th class="cl-d8e1ac50"><p class="cl-d8e1967a"><span class="cl-d8df8132">id</span></p></th><th class="cl-d8e1ac5a"><p class="cl-d8e19684"><span class="cl-d8df8132">words</span></p></th><th class="cl-d8e1ac64"><p class="cl-d8e1967a"><span class="cl-d8df8132">error</span></p></th><th class="cl-d8e1ac65"><p class="cl-d8e19684"><span class="cl-d8df8132">suggestions</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-d8e1ac66"><p class="cl-d8e1967a"><span class="cl-d8df8146">1</span></p></td><td class="cl-d8e1ac67"><p class="cl-d8e19684"><span class="cl-d8df8146">Noam</span></p></td><td class="cl-d8e1ac6e"><p class="cl-d8e1967a"><span class="cl-d8df8146">FALSE</span></p></td><td class="cl-d8e1ac6f"><p class="cl-d8e19684"><span class="cl-d8df8146">"Nam", "Roam", "Loam", "Noah", "Foam", "No am", "No-am", "Moan", "Norm"</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d8e1ac78"><p class="cl-d8e1967a"><span class="cl-d8df8146">2</span></p></td><td class="cl-d8e1ac79"><p class="cl-d8e19684"><span class="cl-d8df8146">said</span></p></td><td class="cl-d8e1ac7a"><p class="cl-d8e1967a"><span class="cl-d8df8146">TRUE</span></p></td><td class="cl-d8e1ac82"><p class="cl-d8e19684"><span class="cl-d8df8146"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d8e1ac66"><p class="cl-d8e1967a"><span class="cl-d8df8146">3</span></p></td><td class="cl-d8e1ac67"><p class="cl-d8e19684"><span class="cl-d8df8146">he</span></p></td><td class="cl-d8e1ac6e"><p class="cl-d8e1967a"><span class="cl-d8df8146">TRUE</span></p></td><td class="cl-d8e1ac6f"><p class="cl-d8e19684"><span class="cl-d8df8146"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d8e1ac78"><p class="cl-d8e1967a"><span class="cl-d8df8146">4</span></p></td><td class="cl-d8e1ac79"><p class="cl-d8e19684"><span class="cl-d8df8146">loves</span></p></td><td class="cl-d8e1ac7a"><p class="cl-d8e1967a"><span class="cl-d8df8146">TRUE</span></p></td><td class="cl-d8e1ac82"><p class="cl-d8e19684"><span class="cl-d8df8146"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d8e1ac66"><p class="cl-d8e1967a"><span class="cl-d8df8146">5</span></p></td><td class="cl-d8e1ac67"><p class="cl-d8e19684"><span class="cl-d8df8146">to</span></p></td><td class="cl-d8e1ac6e"><p class="cl-d8e1967a"><span class="cl-d8df8146">TRUE</span></p></td><td class="cl-d8e1ac6f"><p class="cl-d8e19684"><span class="cl-d8df8146"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d8e1ac78"><p class="cl-d8e1967a"><span class="cl-d8df8146">6</span></p></td><td class="cl-d8e1ac79"><p class="cl-d8e19684"><span class="cl-d8df8146">analyze</span></p></td><td class="cl-d8e1ac7a"><p class="cl-d8e1967a"><span class="cl-d8df8146">TRUE</span></p></td><td class="cl-d8e1ac82"><p class="cl-d8e19684"><span class="cl-d8df8146"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d8e1ac66"><p class="cl-d8e1967a"><span class="cl-d8df8146">7</span></p></td><td class="cl-d8e1ac67"><p class="cl-d8e19684"><span class="cl-d8df8146">langauge</span></p></td><td class="cl-d8e1ac6e"><p class="cl-d8e1967a"><span class="cl-d8df8146">FALSE</span></p></td><td class="cl-d8e1ac6f"><p class="cl-d8e19684"><span class="cl-d8df8146">"language", "melange"</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d8e1ac78"><p class="cl-d8e1967a"><span class="cl-d8df8146">8</span></p></td><td class="cl-d8e1ac79"><p class="cl-d8e19684"><span class="cl-d8df8146">and</span></p></td><td class="cl-d8e1ac7a"><p class="cl-d8e1967a"><span class="cl-d8df8146">TRUE</span></p></td><td class="cl-d8e1ac82"><p class="cl-d8e19684"><span class="cl-d8df8146"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d8e1ac66"><p class="cl-d8e1967a"><span class="cl-d8df8146">9</span></p></td><td class="cl-d8e1ac67"><p class="cl-d8e19684"><span class="cl-d8df8146">collors</span></p></td><td class="cl-d8e1ac6e"><p class="cl-d8e1967a"><span class="cl-d8df8146">FALSE</span></p></td><td class="cl-d8e1ac6f"><p class="cl-d8e19684"><span class="cl-d8df8146">"colors", "collars", "collators", "color's", "color"</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d8e1ac83"><p class="cl-d8e1967a"><span class="cl-d8df8146">10</span></p></td><td class="cl-d8e1ac84"><p class="cl-d8e19684"><span class="cl-d8df8146">.</span></p></td><td class="cl-d8e1ac85"><p class="cl-d8e1967a"><span class="cl-d8df8146">TRUE</span></p></td><td class="cl-d8e1ac8c"><p class="cl-d8e19684"><span class="cl-d8df8146"></span></p></td></tr></tbody></table></div>
</div>
</div>
<p>We now want to replace the errors with the correct words but aso retain words that are erroneously regraded as errors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>texttable3 <span class="ot">&lt;-</span> texttable2 <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># replace errors with the first suggestion</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">corrected =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>        error <span class="sc">==</span> T <span class="sc">~</span> words,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>        error <span class="sc">==</span> F <span class="sc">~</span> stringr<span class="sc">::</span><span class="fu">str_remove_all</span>(suggestions, <span class="st">'</span><span class="sc">\\</span><span class="st">", .*'</span>),</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>        T <span class="sc">~</span> words</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    )) <span class="sc">%&gt;%</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># clean the corrected words</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">corrected =</span> stringr<span class="sc">::</span><span class="fu">str_remove_all</span>(corrected, <span class="st">'^</span><span class="sc">\\</span><span class="st">"'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># insert words where we do not want the suggestions but the original word</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">corrected =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>        words <span class="sc">==</span> <span class="st">"Noam"</span> <span class="sc">~</span> words,</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>        T <span class="sc">~</span> corrected</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-d8fab1f0{table-layout:auto;width:95%;}.cl-d8f4e554{font-family:'DejaVu Sans';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-d8f4e568{font-family:'DejaVu Sans';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-d8f6f8f8{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-d8f6f90c{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-d8f71040{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d8f7104a{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d8f71054{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d8f71055{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d8f7105e{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d8f71068{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d8f71069{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d8f7106a{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d8f7106b{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d8f71072{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d8f71073{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d8f71074{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d8f7107c{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d8f7107d{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d8f71086{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d8f71087{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-d8fab1f0"><thead><tr style="overflow-wrap:break-word;"><th class="cl-d8f71040"><p class="cl-d8f6f8f8"><span class="cl-d8f4e554">id</span></p></th><th class="cl-d8f7104a"><p class="cl-d8f6f90c"><span class="cl-d8f4e554">words</span></p></th><th class="cl-d8f71054"><p class="cl-d8f6f8f8"><span class="cl-d8f4e554">error</span></p></th><th class="cl-d8f7104a"><p class="cl-d8f6f90c"><span class="cl-d8f4e554">suggestions</span></p></th><th class="cl-d8f71055"><p class="cl-d8f6f90c"><span class="cl-d8f4e554">corrected</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-d8f7105e"><p class="cl-d8f6f8f8"><span class="cl-d8f4e568">1</span></p></td><td class="cl-d8f71068"><p class="cl-d8f6f90c"><span class="cl-d8f4e568">Noam</span></p></td><td class="cl-d8f71069"><p class="cl-d8f6f8f8"><span class="cl-d8f4e568">FALSE</span></p></td><td class="cl-d8f71068"><p class="cl-d8f6f90c"><span class="cl-d8f4e568">"Nam", "Roam", "Loam", "Noah", "Foam", "No am", "No-am", "Moan", "Norm"</span></p></td><td class="cl-d8f7106a"><p class="cl-d8f6f90c"><span class="cl-d8f4e568">Noam</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d8f7106b"><p class="cl-d8f6f8f8"><span class="cl-d8f4e568">2</span></p></td><td class="cl-d8f71072"><p class="cl-d8f6f90c"><span class="cl-d8f4e568">said</span></p></td><td class="cl-d8f71073"><p class="cl-d8f6f8f8"><span class="cl-d8f4e568">TRUE</span></p></td><td class="cl-d8f71072"><p class="cl-d8f6f90c"><span class="cl-d8f4e568"></span></p></td><td class="cl-d8f71074"><p class="cl-d8f6f90c"><span class="cl-d8f4e568">said</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d8f7105e"><p class="cl-d8f6f8f8"><span class="cl-d8f4e568">3</span></p></td><td class="cl-d8f71068"><p class="cl-d8f6f90c"><span class="cl-d8f4e568">he</span></p></td><td class="cl-d8f71069"><p class="cl-d8f6f8f8"><span class="cl-d8f4e568">TRUE</span></p></td><td class="cl-d8f71068"><p class="cl-d8f6f90c"><span class="cl-d8f4e568"></span></p></td><td class="cl-d8f7106a"><p class="cl-d8f6f90c"><span class="cl-d8f4e568">he</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d8f7106b"><p class="cl-d8f6f8f8"><span class="cl-d8f4e568">4</span></p></td><td class="cl-d8f71072"><p class="cl-d8f6f90c"><span class="cl-d8f4e568">loves</span></p></td><td class="cl-d8f71073"><p class="cl-d8f6f8f8"><span class="cl-d8f4e568">TRUE</span></p></td><td class="cl-d8f71072"><p class="cl-d8f6f90c"><span class="cl-d8f4e568"></span></p></td><td class="cl-d8f71074"><p class="cl-d8f6f90c"><span class="cl-d8f4e568">loves</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d8f7105e"><p class="cl-d8f6f8f8"><span class="cl-d8f4e568">5</span></p></td><td class="cl-d8f71068"><p class="cl-d8f6f90c"><span class="cl-d8f4e568">to</span></p></td><td class="cl-d8f71069"><p class="cl-d8f6f8f8"><span class="cl-d8f4e568">TRUE</span></p></td><td class="cl-d8f71068"><p class="cl-d8f6f90c"><span class="cl-d8f4e568"></span></p></td><td class="cl-d8f7106a"><p class="cl-d8f6f90c"><span class="cl-d8f4e568">to</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d8f7106b"><p class="cl-d8f6f8f8"><span class="cl-d8f4e568">6</span></p></td><td class="cl-d8f71072"><p class="cl-d8f6f90c"><span class="cl-d8f4e568">analyze</span></p></td><td class="cl-d8f71073"><p class="cl-d8f6f8f8"><span class="cl-d8f4e568">TRUE</span></p></td><td class="cl-d8f71072"><p class="cl-d8f6f90c"><span class="cl-d8f4e568"></span></p></td><td class="cl-d8f71074"><p class="cl-d8f6f90c"><span class="cl-d8f4e568">analyze</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d8f7105e"><p class="cl-d8f6f8f8"><span class="cl-d8f4e568">7</span></p></td><td class="cl-d8f71068"><p class="cl-d8f6f90c"><span class="cl-d8f4e568">langauge</span></p></td><td class="cl-d8f71069"><p class="cl-d8f6f8f8"><span class="cl-d8f4e568">FALSE</span></p></td><td class="cl-d8f71068"><p class="cl-d8f6f90c"><span class="cl-d8f4e568">"language", "melange"</span></p></td><td class="cl-d8f7106a"><p class="cl-d8f6f90c"><span class="cl-d8f4e568">language</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d8f7106b"><p class="cl-d8f6f8f8"><span class="cl-d8f4e568">8</span></p></td><td class="cl-d8f71072"><p class="cl-d8f6f90c"><span class="cl-d8f4e568">and</span></p></td><td class="cl-d8f71073"><p class="cl-d8f6f8f8"><span class="cl-d8f4e568">TRUE</span></p></td><td class="cl-d8f71072"><p class="cl-d8f6f90c"><span class="cl-d8f4e568"></span></p></td><td class="cl-d8f71074"><p class="cl-d8f6f90c"><span class="cl-d8f4e568">and</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d8f7105e"><p class="cl-d8f6f8f8"><span class="cl-d8f4e568">9</span></p></td><td class="cl-d8f71068"><p class="cl-d8f6f90c"><span class="cl-d8f4e568">collors</span></p></td><td class="cl-d8f71069"><p class="cl-d8f6f8f8"><span class="cl-d8f4e568">FALSE</span></p></td><td class="cl-d8f71068"><p class="cl-d8f6f90c"><span class="cl-d8f4e568">"colors", "collars", "collators", "color's", "color"</span></p></td><td class="cl-d8f7106a"><p class="cl-d8f6f90c"><span class="cl-d8f4e568">colors</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-d8f7107c"><p class="cl-d8f6f8f8"><span class="cl-d8f4e568">10</span></p></td><td class="cl-d8f7107d"><p class="cl-d8f6f90c"><span class="cl-d8f4e568">.</span></p></td><td class="cl-d8f71086"><p class="cl-d8f6f8f8"><span class="cl-d8f4e568">TRUE</span></p></td><td class="cl-d8f7107d"><p class="cl-d8f6f90c"><span class="cl-d8f4e568"></span></p></td><td class="cl-d8f71087"><p class="cl-d8f6f90c"><span class="cl-d8f4e568">.</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>We can now check how many errors there are in our text.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>texttable4 <span class="ot">&lt;-</span> texttable3 <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">tokens =</span> <span class="fu">nrow</span>(.),</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">types =</span> <span class="fu">length</span>(<span class="fu">names</span>(<span class="fu">table</span>(<span class="fu">tolower</span>(words)))),</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">errors_n =</span> <span class="fu">sum</span>(<span class="fu">ifelse</span>(corrected <span class="sc">==</span> words, <span class="dv">0</span>, <span class="dv">1</span>)),</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">errors_percent =</span> errors_n <span class="sc">/</span> tokens <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-d90e7b86{table-layout:auto;width:95%;}.cl-d9080ba2{font-family:'DejaVu Sans';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-d9080bb6{font-family:'DejaVu Sans';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-d90a3b3e{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-d90a5182{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d90a5183{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d90a518c{background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d90a518d{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 1pt solid rgba(102, 102, 102, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d90a5196{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-d90a5197{background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 1pt solid rgba(102, 102, 102, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-d90e7b86"><thead><tr style="overflow-wrap:break-word;"><th class="cl-d90a5182"><p class="cl-d90a3b3e"><span class="cl-d9080ba2">tokens</span></p></th><th class="cl-d90a5183"><p class="cl-d90a3b3e"><span class="cl-d9080ba2">types</span></p></th><th class="cl-d90a5183"><p class="cl-d90a3b3e"><span class="cl-d9080ba2">errors_n</span></p></th><th class="cl-d90a518c"><p class="cl-d90a3b3e"><span class="cl-d9080ba2">errors_percent</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-d90a518d"><p class="cl-d90a3b3e"><span class="cl-d9080bb6">10</span></p></td><td class="cl-d90a5196"><p class="cl-d90a3b3e"><span class="cl-d9080bb6">10</span></p></td><td class="cl-d90a5196"><p class="cl-d90a3b3e"><span class="cl-d9080bb6">2</span></p></td><td class="cl-d90a5197"><p class="cl-d90a3b3e"><span class="cl-d9080bb6">20</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>Finally, we can put the corrected text back together.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>correctedtext <span class="ot">&lt;-</span> <span class="fu">paste0</span>(texttable3<span class="sc">$</span>corrected, <span class="at">collapse =</span> <span class="st">" "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="st">" </span><span class="sc">\\</span><span class="st">."</span>, <span class="st">"."</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>correctedtext</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Noam said he loves to analyze language and colors."</code></pre>
</div>
</div>
</section>
<section id="setting-a-language" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="setting-a-language">Setting a Language</h2>
<p>By default, the <code>hunspell</code> package includes dictionaries for <code>en_US</code> and <code>en_GB</code> which means that you can easily switch from US American to British English spelling. As a default, <code>hunspell</code> uses the <code>en_US</code> dictionary but we can easily switch to British English instead as shown below.</p>
<p>First, we use the default <code>en_US</code> dictionary which returns <em>LADAL</em> as well as the British spellings of <em>analyse</em> and <em>colours</em> as errors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hunspell</span>(<span class="st">"At LADAL we like to analyse language and colours."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "LADAL"   "analyse" "colours"</code></pre>
</div>
</div>
<p>If we switch to the <code>en_GB</code> dictionary, only <em>LADAL</em> is identified as not occuring in the dictionary.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hunspell</span>(<span class="st">"At LADAL we like to analyse language and colours."</span>, <span class="at">dict =</span> <span class="st">"en_GB"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "LADAL"</code></pre>
</div>
</div>
<p><img src="../../images/InstallLanguages.png" class="img-fluid" style="float:right; padding:10px;width:40.0%"></p>
<p>If you want to use another language you need to make sure that the dictionary is available in your system so that RStudio can access the dictionary. You can install dictionaries very easily in RStudio. Simply go to <code>Tools</code> &gt; <code>Global options</code> &gt; <code>Spelling</code> and then under <code>Main dictionary language</code> select <code>Install More Languages</code> from the drop-down menu. Once the additional languages are installed, their dictionaries are available to the <code>hunspell</code> package in RStudio.</p>
<p>However, you may want to install dictionaries directly, e.g., into your working directory so that you can use the dictionary when working with text data either on your computer or in a cloud environment. In this case, you can go to the <a href="https://github.com/wooorm/dictionaries">wooorm dictionary GitHub repository</a>, which has dict and aff files (i.e., the files that are needed to create a dictionary) for many different languages, and install the dict and aff files manually. In our case, I downloaded the dict and aff files from the German dictionary, stored them together with the other dictionary files in the <code>hunspell</code> package library, and renamed the files as <code>de.dict</code> and <code>de.aff</code>.</p>
<p>If you then want to use the dictionary, you simply specify the <code>dict</code> argument as shown below for a German sentence.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hunspell</span>(<span class="st">"Im LADAL analysieren wir Sprachen und Farben."</span>, <span class="at">dict =</span> <span class="st">"de"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This is the end of this short tutorial on spell checking with R. If you want to go deeper, please check out the documentation site of the <code>hunspell</code> package)[https://cran.r-project.org/web/packages/hunspell/vignettes/intro.html] <span class="citation" data-cites="hunspell">(<a href="#ref-hunspell" role="doc-biblioref">Ooms</a>)</span>.</p>
</section>
</section>
<section id="citation-session-info" class="level1 unnumbered">
<h1 class="unnumbered">Citation &amp; Session Info</h1>
<p>Schweinberger, Martin. (2023)` <em>Spell checking text data with R</em>. Brisbane: The University of Queensland. url: https://ladal.edu.au/tutorials/spellcheck.html (Version 2023.02.08).</p>
<pre><code>@manual{schweinberger2023spellcheck,
  author = {Schweinberger, Martin},
  title = {Spell checking text data with R},
  note = {tutorials/spellcheck/spellcheck.html},
  year = {2022},
  organization = {The University of Queensland, School of Languages and Cultures},
  address = {Brisbane},
  edition = {2023.02.08}
}</code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.4.2 (2024-10-31)
Platform: x86_64-pc-linux-gnu
Running under: Ubuntu 24.04.1 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.12.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.12.0

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

time zone: Australia/Brisbane
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices datasets  utils     methods   base     

other attached packages:
[1] flextable_0.9.7 hunspell_3.0.5  quanteda_4.1.0  stringr_1.5.1  
[5] dplyr_1.1.4    

loaded via a namespace (and not attached):
 [1] Matrix_1.7-2            jsonlite_1.8.9          compiler_4.4.2         
 [4] renv_1.0.11             stopwords_2.3           zip_2.3.1              
 [7] tidyselect_1.2.1        Rcpp_1.0.13-1           xml2_1.3.6             
[10] assertthat_0.2.1        fontquiver_0.2.1        textshaping_0.4.1      
[13] systemfonts_1.1.0       uuid_1.2-1              yaml_2.3.10            
[16] fastmap_1.2.0           lattice_0.22-6          R6_2.5.1               
[19] gdtools_0.4.1           generics_0.1.3          knitr_1.49             
[22] htmlwidgets_1.6.4       tibble_3.2.1            openssl_2.3.0          
[25] pillar_1.10.1           rlang_1.1.5             fastmatch_1.1-4        
[28] stringi_1.8.4           xfun_0.49               cli_3.6.3              
[31] withr_3.0.2             magrittr_2.0.3          digest_0.6.37          
[34] grid_4.4.2              askpass_1.2.1           lifecycle_1.0.4        
[37] vctrs_0.6.5             evaluate_1.0.3          glue_1.8.0             
[40] data.table_1.16.4       officer_0.6.7           fontLiberation_0.1.0   
[43] ragg_1.3.3              codetools_0.2-20        klippy_0.0.0.9500      
[46] fontBitstreamVera_0.1.1 rmarkdown_2.29          tools_4.4.2            
[49] pkgconfig_2.0.3         htmltools_0.5.8.1      </code></pre>
</div>
</div>
<hr>
<p><a href="#introduction">Back to top</a></p>
<p><a href="../..">Back to HOME</a></p>
<hr>
</section>
<section id="references" class="level1 unnumbered">




</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-hunspell" class="csl-entry" role="listitem">
Ooms, Jeroen. <span>“Hunspell: High-Performance Stemmer, Tokenizer, and Spell Checker.”</span> <a href="https://cran.r-project.org/web/packages/hunspell/index.html">https://cran.r-project.org/web/packages/hunspell/index.html</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>